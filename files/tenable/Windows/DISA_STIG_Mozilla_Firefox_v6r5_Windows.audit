#TRUSTED 3908c05593c8ee418f95cddc0fb847c6c1580576d82d1fd6a2ae4f8718bb1eecd3a4d9601eecb850daa7f02b0a43826564964ab8c9a10cc40a76c97f4df93807bcfe1623781f910af52f9f8032fa5092f1e1cfb13bc2e2de24f98b70080e465fd8b0e585dd0a13a9855a201ecd0a571a862a76a59147247bc9152638d6b377574a85ee26383e86037cbe299e02ff3d9d9f7e5b00835ad792c0cfc46b1eb3d677a9edce1a4ab002cc04b454f36b4d0d9fc16d09701e0f099574760037550ed4c13fc047fa768c0302f9ce4333b61ee4536f4c53acbafbe59fc3de297ae4ccc3a70922619b6413e80f0584b14e09a78e326864291dc574625c1c97c644cd85ffb876f7e3146d024a1ddf6838256686b50cfee900dddc7c4e3259abaaa5f43797fe47dd421246da3100467221bd6a180a13d72c5f16043e26e99ebf2db20c5e851efa301efe71da8f6c31c645c7666da249d94a82df20f31d34a0e7c069b3a9af45e29372cfa57b1b7cccc5a9f77b6d81318a5ebbff2c21501d46174efefd611250cfd40846013766ae489dca8be5155b45323bcfe4bc4d6bf78c4c0524cf330515224c580b48039e52e095c999b3430677d46e55c67542c1e4bf957104362771e0f04dda872a5654fd1d2ac00c880d6713e6b294f704e1ed85e65ce4a8c471042fabb109e64693ebed4b8fd55d0937c7d4e983771eee640629e56be3b3c11f5fe9
#TRUST-RSA-SHA256 2dfa6da1b0bc2dae164ba608e77590e65c20dd44ab276ce816685603ff13993c9d3a067b99a52a85ec0198b361ebfe00b45e38bb94f2cf8e946f2a663fffe63e4a2874efc683df724de9cd74ba5d94d4cf886c2428a58e94b8029087abe9c22982482e979aa55245d132c6fce61c3a9dfc29b24b7522fc4cddaaff6f6063d5898d2c6655725c19ec8323b55c48c2c76eef5d9da36700139c16ebb792d156001a85e2e4b9d5870c90a0020273ddd616ae98b78f253dafa8dd637679911c07ff7172c86b4d32aebd912de50fd0e60b58c79535c8e696bb7f97751eb4cb88967b10518785ac6efaccc28bb735600d8119a06c2f1750c837aa4d2c0430cee5b1cc2b06add41efdbf92664ec62bcceaa0233d425d759aeff522ac36c12100fef98c4fa9be038a79401ede7ebfc1ec0b50654b62b1cc95b38985e3e1d47268374b2cf643c6478108d6264166a372d8f878f6f6046d1324db64b4cd9a20fdd2c4a7e832bdba3f9c1044827d8625098077b8bf326999000011ede40fc23b5139a59aa964566b907b1bbe95fd334944915a05fa9e5d80591c2f7ed3cee32e66cded93598fe994c8a0079e0fe6ebe73d916ecc84f267663327d27d7b0b5632bb7febc712f72d47ea81ba8dbbb7c74d9e1e774fa752fb3eac8904a7a82ba9fb8252e78ceba9ea7f9450cbe01826ffe8e68978e097568e614a5f11b5ffed2b26f59a1a082094
#
# This script is Copyright (C) 2004-2024 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.3 $
# $Date: 2024/06/17 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Mozilla Firefox v6r5 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Mozilla Firefox Windows v6r5</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Mozilla Firefox</name>
#  <profile>OS Windows</profile>
#  <version>6.5.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip</link>
#</spec>
#<labels>windows_firefox,update_20230227</labels>
#<benchmark_refs>CAT,CCE,CCI,DISA_Benchmark,Group-ID,Rule-ID,STIG-ID,STIG-Legacy,Vuln-ID</benchmark_refs>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Firefox">

<if>
  <condition type:"OR">
    <custom_item>
      type        : REG_CHECK
      description : "Firefox is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox"
      reg_option  : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "Firefox ESR is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox ESR"
      reg_option  : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_Mozilla_Firefox_v6r5_Windows.audit from DISA Mozilla Firefox v6r5 STIG"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
    </report>

    <if>
      <condition auto:"WARNING" type:"OR">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Firefox"
          value_type  : POLICY_TEXT
          value_data  : "Manual Review Required"
          reg_key     : "HKLM\Software\Mozilla\Mozilla Firefox"
          reg_item    : "CurrentVersion"
          check_type  : CHECK_REGEX
          severity    : MEDIUM
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Firefox ESR"
          value_type  : POLICY_TEXT
          value_data  : "Manual Review Required"
          reg_key     : "HKLM\Software\Mozilla\Mozilla Firefox ESR"
          reg_item    : "CurrentVersion"
          check_type  : CHECK_REGEX
          severity    : MEDIUM
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "FFOX-00-000001 - The installed version of Firefox must be supported."
          info        : "Using versions of an application that are not supported by the vendor is not permitted. Vendors respond to security flaws with updates and patches. These updates are not available for unsupported versions, which can leave the application vulnerable to attack.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Upgrade the version of the browser to an approved version by obtaining software from the vendor or other trusted source."
          reference   : "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CAT|I,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-251545r879827_rule,STIG-ID|FFOX-00-000001,SWIFT-CSCv1|2.2,Vuln-ID|V-251545"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000002 - Firefox must be configured to allow only TLS 1.2 or above."
      info        : "Use of versions prior to TLS 1.2 are not permitted. SSL 2.0 and SSL 3.0 contain a number of security flaws. These versions must be disabled in compliance with the Network Infrastructure and Secure Remote Computing STIGs."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Minimum SSL version enabled
Policy State: Enabled
Policy Value: TLS 1.2   (or TLS 1.3)

macOS 'plist' file:
Add the following:
<key>SSLVersionMin</key>
<string>tls1.2</string>   (or <string>tls1.3</string>)

Linux 'policies.json' file:
Add the following in the policies section:
'SSLVersionMin': 'tls1.2'   or ('SSLVersionMin': 'tls1.3')"
      reference   : "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-251546r879889_rule,STIG-ID|FFOX-00-000002,SWIFT-CSCv1|2.6,Vuln-ID|V-251546"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "tls1.2" || "tls1.3"
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "SSLVersionMin"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000003 - Firefox must be configured to ask which certificate to present to a website when a certificate is required."
      info            : "When a website asks for a certificate for user authentication, Firefox must be configured to have the user choose which certificate to present. Websites within DoD require user authentication for access, which increases security for DoD information. Access will be denied to the user if certificate management is not configured."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'security.default_personal_cert': {
    'Value': 'Ask Every Time',
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>security.default_personal_cert</key>
  <dict>
    <key>Value</key>
    <string>Ask Every Time</string>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
  'security.default_personal_cert': {
    'Value': 'Ask Every Time',
    'Status': 'locked'
  }
}"
      reference       : "800-171|3.5.2,800-53|IA-5(2)(c),800-53r5|IA-5(2)(c),CAT|II,CCI|CCI-000187,CSF|PR.AC-1,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(c),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-251547r879614_rule,STIG-ID|FFOX-00-000003,Vuln-ID|V-251547"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "security.default_personal_cert[\s]*: @{Value=Ask Every Time; Status=locked}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000004 - Firefox must be configured to not automatically check for updated versions of installed search plugins."
      info            : "Updates must be controlled and installed from authorized and trusted servers. This setting overrides a number of other settings that may direct the application to access external URLs."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'browser.search.update': {
    'Value': false,
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>browser.search.update</key>
  <dict>
    <key>Value</key>
    <false/>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
  'browser.search.update': {
    'Value': false,
    'Status': 'locked'
  }
}"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251548r879587_rule,STIG-ID|FFOX-00-000004,SWIFT-CSCv1|2.3,Vuln-ID|V-251548"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "browser.search.update[\s]*:[\s]*@{(?i)Value=False;[\s]*Status=locked(?-i)}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000005 - Firefox must be configured to not automatically update installed add-ons and plugins."
      info        : "Set this to false to disable checking for updated versions of the Extensions/Themes. Automatic updates from untrusted sites puts the enclave at risk of attack and may override security settings."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Extensions
Policy Name: Extension Update
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>ExtensionUpdate</key>
<false/>

Linux 'policies.json' file:
Add the following in the policies section:
'ExtensionUpdate': false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251549r879587_rule,STIG-ID|FFOX-00-000005,SWIFT-CSCv1|2.3,Vuln-ID|V-251549"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "ExtensionUpdate"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "FFOX-00-000006 - Firefox must be configured to not automatically execute or download MIME types that are not authorized for auto-download."
      info        : "Some files can be downloaded or execute without user interaction. This setting ensures these files are not downloaded and executed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Remove any unauthorized extensions from the auto-download list."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-251550r879664_rule,STIG-ID|FFOX-00-000006,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-251550"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000007 - Firefox must be configured to disable form fill assistance."
      info        : "To protect privacy and sensitive data, Firefox provides the ability to configure the program so that data entered into forms is not saved. This mitigates the risk of a website gleaning private information from prefilled information."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Form History
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisableFormHistory</key>
<true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableFormHistory': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251551r879587_rule,STIG-ID|FFOX-00-000007,SWIFT-CSCv1|2.3,Vuln-ID|V-251551"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableFormHistory"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000008 - Firefox must be configured to not use a password store with or without a master password."
      info        : "Firefox can be set to store passwords for sites visited by the user. These individual passwords are stored in a file and can be protected by a master password. Autofill of the password can then be enabled when the site is visited. This feature could also be used to autofill the certificate PIN, which could lead to compromise of DoD information."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: PasswordManager
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>PasswordManagerEnabled</key>
<false/>

Linux 'policies.json' file:
Add the following in the policies section:
'PasswordManagerEnabled': false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251552r879587_rule,STIG-ID|FFOX-00-000008,SWIFT-CSCv1|2.3,Vuln-ID|V-251552"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "PasswordManagerEnabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Default"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\PopupBlocking"
          reg_item    : "Default"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Locked"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\PopupBlocking"
          reg_item    : "Locked"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type              : AUDIT_POWERSHELL
          description       : "Allowed Sites"
          value_type        : POLICY_TEXT
          value_data        : "Allow"
          powershell_args   : "$output = (get-item -path HKLM:\software\Policies\Mozilla\Firefox\PopupBlocking\Allow -ErrorAction 'SilentlyContinue'); ForEach-Object { if(!$output) { $result = 'No entries found for PopupBlocking - Allow' } else { $result=$output }; $result };"
          check_type        : CHECK_REGEX
          powershell_option : CAN_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "FFOX-00-000009 - Firefox must be configured to block pop-up windows"
          info        : "Pop-up windows may be used to launch an attack within a new browser window with altered settings. This setting blocks pop-up windows created while the page is loading."
          solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Popups
Policy Name: Block pop-ups from websites
Policy State: Enabled

Policy Name: Do not allow preferences to be changed
Policy State: Enabled

Optional:
Policy Name: Allowed Sites
Policy State: Enabled
Click 'Show...' and enter a list of websites to be allowlisted.

macOS 'plist' file:
Add the following:
<key>PopupBlocking</key>
  <dict>
    <key>Allow</key>
    <array>
      <string>http://example.mil</string>
      <string>http://example.gov</string>
    </array>
    <key>Default</key>
    <true/>
    <key>Locked</key>
    <true/>
  </dict>

Linux 'policies.json' file:
Add the following in the policies section:
'PopupBlocking': {
      'Allow': ['http://example.mil/',
                'http://example.gov/'],
      'Default': true,
      'Locked': true}"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251553r879587_rule,STIG-ID|FFOX-00-000009,SWIFT-CSCv1|2.3,Vuln-ID|V-251553"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000010 - Firefox must be configured to prevent JavaScript from moving or resizing windows."
      info            : "JavaScript can make changes to the browser's appearance. This activity can help disguise an attack taking place in a minimized background window. Configure the browser setting to prevent scripts on visited websites from moving and resizing browser windows."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'dom.disable_window_move_resize': {
    'Value': true,
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>dom.disable_window_move_resize</key>
  <dict>
    <key>Value</key>
    <true/>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
  'dom.disable_window_move_resize': {
    'Value': true,
    'Status': 'locked'
  }
}"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251554r879587_rule,STIG-ID|FFOX-00-000010,SWIFT-CSCv1|2.3,Vuln-ID|V-251554"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "dom.disable_window_move_resize[\s]*:[\s]*@{(?i)Value=True;[\s]*Status=locked(?-i)}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000011 - Firefox must be configured to prevent JavaScript from raising or lowering windows."
      info            : "JavaScript can raise and lower browser windows to cause improper input. Configure the browser setting to prevent scripts on visited websites from raising and lowering browser windows."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'dom.disable_window_flip': {
    'Value': true,
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>dom.disable_window_flip</key>
  <dict>
    <key>Value</key>
    <true/>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
  'dom.disable_window_flip': {
    'Value': true,
    'Status': 'locked'
  }
}"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251555r879587_rule,STIG-ID|FFOX-00-000011,SWIFT-CSCv1|2.3,Vuln-ID|V-251555"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "dom.disable_window_flip[\s]*:[\s]*@{(?i)Value=True;[\s]*Status=locked(?-i)}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000013 - Firefox must be configured to disable the installation of extensions."
      info        : "A browser extension is a program that has been installed into the browser to add functionality. Where a plug-in interacts only with a web page and usually a third-party external application (e.g., Flash, Adobe Reader), an extension interacts with the browser program itself. Extensions are not embedded in web pages and must be downloaded and installed in order to work. Extensions allow browsers to avoid restrictions that apply to web pages.

For example, an extension can be written to combine data from multiple domains and present it when a certain page is accessed, which can be considered cross-site scripting. If a browser is configured to allow unrestricted use of extensions, plug-ins can be loaded and installed from malicious sources and used on the browser."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Addons
Policy Name: Allow add-on installs from websites
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>InstallAddonsPermission</key>
<false/>

Linux 'policies.json' file:
Add the following in the policies section:
'InstallAddonsPermission': {
      'Default': false
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251557r879587_rule,STIG-ID|FFOX-00-000013,SWIFT-CSCv1|2.3,Vuln-ID|V-251557"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\InstallAddonsPermission"
      reg_item    : "Default"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000014 - Background submission of information to Mozilla must be disabled."
      info        : "Firefox by default sends information about Firefox to Mozilla servers. There should be no background submission of technical and other information from DoD computers to Mozilla with portions posted publicly."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Telemetry
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisableTelemetry</key>
<true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableTelemetry': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251558r879587_rule,STIG-ID|FFOX-00-000014,SWIFT-CSCv1|2.3,Vuln-ID|V-251558"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableTelemetry"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000015 - Firefox development tools must be disabled."
      info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web browser includes any information about the web browser and plug-ins or modules being used. When debugging or trace information is enabled in a production web browser, information about the web browser, such as web browser type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any back ends being used for data storage may be displayed. Because this information may be placed in logs and general messages during normal operation of the web browser, an attacker does not have to cause an error condition to gain this information."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Developer Tools
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisableDeveloperTools</key>
<true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableDeveloperTools': true"
      reference   : "800-53|SI-11a.,800-53r5|SI-11a.,CAT|III,CCI|CCI-001312,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,Rule-ID|SV-251559r879655_rule,STIG-ID|FFOX-00-000015,Vuln-ID|V-251559"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableDeveloperTools"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "FFOX-00-000016 - Firefox must have the DOD root certificates installed."
      info        : "The DOD root certificates will ensure that the trust chain is established for server certificates issued from the DOD Certificate Authority (CA).

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Install the DOD root certificates. Other AO-approved certificates may also be used. Certificates designed for SIPRNet may be used as appropriate.

On Windows, import certificates from the operating system by using Certificates >> Import Enterprise Roots (Certificates) via policy or Group Policy Object (GPO)."
      reference   : "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(a),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-251560r918133_rule,STIG-ID|FFOX-00-000016,Vuln-ID|V-251560"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
    </report>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Cache"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "Cache"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Cookies"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "Cookies"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Downloads"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "Downloads"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "FormData"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "FormData"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "History"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "History"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "OfflineApps"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "OfflineApps"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Sessions"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "Sessions"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "SiteSettings"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\SanitizeOnShutdown"
          reg_item    : "SiteSettings"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "FFOX-00-000017 - Firefox must be configured to not delete data upon shutdown"
          info        : "For diagnostic purposes, data must remain behind when the browser is closed. This is required to meet non-repudiation controls."
          solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Clear data when browser is closed
Policy Name: Cache, Cookies, Download History, Form & Search History, Browsing History, Active Logins, Site Preferences, Offline Website Data
Policy State: Disabled
Policy Name: Locked
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>SanitizeOnShutdown</key>
<dict>
  <key>Cache</key>
  <false/>
  <key>Cookies</key>
  <false/>
  <key>Downloads</key>
  <false/>
  <key>FormData</key>
  <false/>
  <key>History</key>
  <false/>
  <key>Sessions</key>
  <false/>
  <key>SiteSettings</key>
  <false/>
  <key>OfflineApps</key>
  <false/>
  <key>Locked</key>
  <true/>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'SanitizeOnShutdown': {
  'Cache': false,
  'Cookies': false,
  'Downloads': false,
  'FormData': false,
  'History': false,
  'Sessions': false,
  'SiteSettings': false,
  'OfflineApps': false,
  'Locked': true
}"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-252881r879587_rule,STIG-ID|FFOX-00-000017,SWIFT-CSCv1|2.3,Vuln-ID|V-252881"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000018 - Firefox must prevent the user from quickly deleting data."
      info        : "There should not be an option for a user to 'forget' work they have done. This is required to meet non-repudiation controls."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Forget Button
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisableForgetButton</key>
<true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableForgetButton': true"
      reference   : "800-53|AC-24(2),800-53r5|AC-24(2),CAT|II,CCI|CCI-002355,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-251562r879703_rule,STIG-ID|FFOX-00-000018,Vuln-ID|V-251562"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableForgetButton"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000019 - Firefox private browsing must be disabled."
      info        : "Private browsing allows the user to browse the internet without recording their browsing history/activity. From a forensics perspective, this is unacceptable. Best practice requires that browser history is retained."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Private Browsing
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisablePrivateBrowsing</key>
<true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisablePrivateBrowsing': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251563r879587_rule,STIG-ID|FFOX-00-000019,SWIFT-CSCv1|2.3,Vuln-ID|V-251563"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisablePrivateBrowsing"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000020 - Firefox search suggestions must be disabled."
      info        : "Search suggestions must be disabled as this could lead to searches being conducted that were never intended to be made."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Search
Policy Name: Search Suggestions
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>SearchSuggestEnabled</key>
<false/>

Linux 'policies.json' file:
Add the following in the policies section:
'SearchSuggestEnabled': false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251564r879587_rule,STIG-ID|FFOX-00-000020,SWIFT-CSCv1|2.3,Vuln-ID|V-251564"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "SearchSuggestEnabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000021 - Firefox autoplay must be disabled."
      info        : "Autoplay allows the user to control whether videos can play automatically (without user consent) with audio content. The user must be able to select content that is run within the browser window."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Permissions\Autoplay
Policy Name: Default autoplay level
Policy State: Enabled
Policy Value: Block Audio and Video

macOS 'plist' file:
Add the following:
<key>Permissions</key>
<dict>
  <key>Autoplay</key>
  <dict>
    <string>block-audio-video</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Permissions': {
  'Autoplay': {
    'Default': 'block-audio-video'
  }
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251565r879587_rule,STIG-ID|FFOX-00-000021,SWIFT-CSCv1|2.3,Vuln-ID|V-251565"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "block-audio-video"
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\Permissions\Autoplay"
      reg_item    : "Default"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000022 - Firefox network prediction must be disabled."
      info        : "If network prediction is enabled, requests to URLs are made without user consent. The browser should always make a direct DNS request without prefetching occurring."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Network Prediction
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>NetworkPrediction</key>
<false/>

Linux 'policies.json' file:
Add the following in the policies section:
'NetworkPrediction': false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251566r879587_rule,STIG-ID|FFOX-00-000022,SWIFT-CSCv1|2.3,Vuln-ID|V-251566"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "NetworkPrediction"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000023 - Firefox fingerprinting protection must be enabled."
      info        : "The Content Blocking/Tracking Protection feature stops Firefox from loading content from malicious sites. The content might be a script or an image, for example. If a site is on one of the tracker lists that Firefox is set to use, the fingerprinting script (or other tracking script/image) will not be loaded from that site.

Fingerprinting scripts collect information about browser and device configuration, such as operating system, screen resolution, and other settings. By compiling these pieces of data, fingerprinters create a unique profile that can be used to track the user around the web."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Tracking Protection
Policy Name: Fingerprinting
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>EnableTrackingProtection</key>
  <dict>
    <key>Fingerprinting</key>
 <true/>
  </dict>

Linux 'policies.json' file:
Add the following in the policies section:
'EnableTrackingProtection': {
  'Fingerprinting': true
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251567r879587_rule,STIG-ID|FFOX-00-000023,SWIFT-CSCv1|2.3,Vuln-ID|V-251567"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\EnableTrackingProtection"
      reg_item    : "Fingerprinting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000024 - Firefox cryptomining protection must be enabled."
      info        : "The Content Blocking/Tracking Protection feature stops Firefox from loading content from malicious sites. The content might be a script or an image, for example. If a site is on one of the tracker lists that Firefox is set to use, the fingerprinting script (or other tracking script/image) will not be loaded from that site.

Cryptomining scripts use a computer's central processing unit to invisibly mine cryptocurrency."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Tracking Protection
Policy Name: Cryptomining
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>EnableTrackingProtection</key>
  <dict>
    <key>Cryptomining</key>
 <true/>
  </dict>

Linux 'policies.json' file:
Add the following in the policies section:
'EnableTrackingProtection': {
  'Cryptomining': true
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251568r879587_rule,STIG-ID|FFOX-00-000024,SWIFT-CSCv1|2.3,Vuln-ID|V-251568"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\EnableTrackingProtection"
      reg_item    : "Cryptomining"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000025 - Firefox Enhanced Tracking Protection must be enabled."
      info            : "Tracking generally refers to content, cookies, or scripts that can collect browsing data across multiple sites.

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include but are not limited to advertising software or browser plug-ins that are not related to requirements or provide a wide array of functionality not required for every mission but that cannot be disabled."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'browser.contentblocking.category': {
    'Value': 'strict',
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>browser.contentblocking.category</key>
  <dict>
    <key>Value</key>
    <string>strict</string>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
  'browser.contentblocking.category': {
    'Value': 'strict',
    'Status': 'locked'
  }
}"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251569r879587_rule,STIG-ID|FFOX-00-000025,SWIFT-CSCv1|2.3,Vuln-ID|V-251569"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "browser.contentblocking.category[\s]*:[\s]*@{(?i)Value=strict;[\s]*Status=locked(?-i)}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "FFOX-00-000026 - Firefox extension recommendations must be disabled."
      info            : "The Recommended Extensions program makes it easier for users to discover extensions that have been reviewed for security, functionality, and user experience. Allowed extensions are to be centrally managed."
      solution        : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Preferences
Policy State: Enabled
Policy Value:
{
  'extensions.htmlaboutaddons.recommendations.enabled': {
    'Value': false,
    'Status': 'locked'
  }
}

macOS 'plist' file:
Add the following:
<key>Preferences</key>
<dict>
  <key>extensions.htmlaboutaddons.recommendations.enabled</key>
  <dict>
    <key>Value</key>
    <false/>
    <key>Status</key>
    <string>locked</string>
  </dict>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'Preferences': {
'extensions.htmlaboutaddons.recommendations.enabled': {
'Value': false,
'Status': 'locked'
},"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251570r879587_rule,STIG-ID|FFOX-00-000026,SWIFT-CSCv1|2.3,Vuln-ID|V-251570"
      see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "extensions.htmlaboutaddons.recommendations.enabled[\s]*:[\s]*@{(?i)Value=False;[\s]*Status=locked(?-i)}"
      powershell_args : '[string]$prefs = (Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Policies\\Mozilla\\Firefox -Name Preferences);
        if ($prefs.Length -gt 0) {
          if ($prefs -match "<enabled/>") {
            $prefs = $prefs -replace "\\s*<enabled/>\\s*<data\\s+id=`"JSON`"\\s+value=`\'\\s*", "" -replace "`\'/>" , "" ;
          }
        $result = ($prefs | ConvertFrom-JSON) | Format-List;
        }
        else {
          $result="Policy object not set" ;
        }
        $result;'
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000027 - Firefox deprecated ciphers must be disabled."
      info        : "A weak cipher is defined as an encryption/decryption algorithm that uses a key of insufficient length. Using an insufficient length for a key in an encryption/decryption algorithm opens up the possibility (or probability) that the encryption scheme could be broken."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Disabled Ciphers
Policy Name: TLS_RSA_WITH_3DES_EDE_CBC_SHA
Policy State: Enabled

macOS 'plist' file:
Add the following:
<key>DisabledCiphers</key>
  <dict>
    <key>TLS_RSA_WITH_3DES_EDE_CBC_SHA</key>
    <true/>
  </dict>

Linux 'policies.json' file:
Add the following in the policies section:
'DisabledCiphers': {
  'TLS_RSA_WITH_3DES_EDE_CBC_SHA': true
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251571r879587_rule,STIG-ID|FFOX-00-000027,SWIFT-CSCv1|2.3,Vuln-ID|V-251571"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\DisabledCiphers"
      reg_item    : "TLS_RSA_WITH_3DES_EDE_CBC_SHA"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000028 - Firefox must not recommend extensions as the user is using the browser."
      info        : "The Recommended Extensions program recommends extensions to users as they surf the web.

The user must not be encouraged to install extensions from the websites they visit. Allowed extensions are to be centrally managed."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\User Messaging
Policy Name: Extension Recommendations
Policy State: Disabled

macOS 'plist' file:
Add the following:
<key>UserMessaging</key>
<dict>
  <key>ExtensionRecommendations</key>
  <false/>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'UserMessaging': {
  'ExtensionRecommendations': false
}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251572r879587_rule,STIG-ID|FFOX-00-000028,SWIFT-CSCv1|2.3,Vuln-ID|V-251572"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\UserMessaging"
      reg_item    : "ExtensionRecommendations"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Search"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "Search"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "TopSites"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "TopSites"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "SponsoredTopSites"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "SponsoredTopSites"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Pocket"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "Pocket"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "SponsoredPocket"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "SponsoredPocket"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Highlights"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "Highlights"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Snippets"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "Snippets"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Locked"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\FirefoxHome"
          reg_item    : "Locked"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "FFOX-00-000029 - The Firefox New Tab page must not show Top Sites, Sponsored Top Sites, Pocket Recommendations, Sponsored Pocket Stories, Searches, Highlights, or Snippets"
          info        : "The New Tab page by default shows a list of built-in top sites, as well as the top sites the user has visited.

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include but are not limited to advertising software or browser plug-ins that are not related to requirements or provide a wide array of functionality not required for every mission but that cannot be disabled.

The new tab page must not actively show user activity."
          solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Customize Firefox Home
Policy State: Enabled
Policy Value: Uncheck 'Search'
Policy Value: Uncheck 'Top Sites'
Policy Value: Uncheck 'Sponsored Top Sites'
Policy Value: Uncheck 'Recommended by Pocket'
Policy Value: Uncheck 'Sponsored Pocket Stories'
Policy Value: Uncheck 'Download History'
Policy Value: Uncheck 'Snippets'
Policy Value: Check 'Do not allow settings to be changed'

macOS 'plist' file:
Add the following:
<key>FirefoxHome</key>
<dict>
<key>Search</key>
  <false/>
<key>TopSites</key>
  <false/>
<key>SponsoredTopSites</key>
  <false/>
<key>Pocket</key>
  <false/>
<key>SponsoredPocket</key>
  <false/>
<key>Highlights</key>
  <false/>
<key>Snippets</key>
  <false/>
<key>Locked</key>
  <true/>
</dict>

Linux 'policies.json' file:
Add the following in the policies section:
'FirefoxHome': {
  'Search': false,
  'TopSites': false,
  'SponsoredTopSites': false,
  'Pocket': false,
  'SponsoredPocket': false,
  'Highlights': false,
  'Snippets': false,
  'locked': true
}"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251573r879587_rule,STIG-ID|FFOX-00-000029,SWIFT-CSCv1|2.3,Vuln-ID|V-251573"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000033 - Firefox must be configured so that DNS over HTTPS is disabled."
      info        : "DNS over HTTPS has generally not been adopted in the DoD. DNS is tightly controlled.

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\DNS Over HTTPS
Policy Name: Enabled
Policy State: Disabled

macOS 'plist' file:
<key>DNSOverHTTPS</key>
  <dict>
    <key>Enabled</key>
    <false/>

Linux 'policies.json' file:
Add the following in the policies section:
'DNSOverHTTPS': {'Enabled': false}"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251577r879587_rule,STIG-ID|FFOX-00-000033,SWIFT-CSCv1|2.3,Vuln-ID|V-251577"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\DNSOverHTTPS"
      reg_item    : "Enabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000034 - Firefox accounts must be disabled."
      info        : "Disable Firefox Accounts integration (Sync).

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include but are not limited to advertising software or browser plug-ins that are not related to requirements or provide a wide array of functionality not required for every mission but that cannot be disabled."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Disable Firefox Accounts
Policy State: Enabled

macOS 'plist' file:
<key>DisableFirefoxAccounts</key>
  <true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableFirefoxAccounts': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251578r879587_rule,STIG-ID|FFOX-00-000034,SWIFT-CSCv1|2.3,Vuln-ID|V-251578"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableFirefoxAccounts"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000036 - Firefox feedback reporting must be disabled."
      info        : "Disable the menus for reporting sites (Submit Feedback, Report Deceptive Site).

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include but are not limited to advertising software or browser plug-ins that are not related to requirements or provide a wide array of functionality not required for every mission but that cannot be disabled."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\
Policy Name: Disable Feedback Commands
Policy State: Enabled

macOS 'plist' file:
<key>DisableFeedbackCommands</key>
  <true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableFeedbackCommands': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251580r879587_rule,STIG-ID|FFOX-00-000036,SWIFT-CSCv1|2.3,Vuln-ID|V-251580"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableFeedbackCommands"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition auto:"FAILED" type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Enabled"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\EncryptedMediaExtensions"
          reg_item    : "Enabled"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "Locked"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Mozilla\Firefox\EncryptedMediaExtensions"
          reg_item    : "Locked"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "FFOX-00-000037 - Firefox encrypted media extensions must be disabled"
          info        : "Enable or disable Encrypted Media Extensions and optionally lock it.

If 'Enabled' is set to 'false', Firefox does not download encrypted media extensions (such as Widevine) unless the user consents to installing them.

If 'Locked' is set to 'true' and 'Enabled' is set to 'false', Firefox will not download encrypted media extensions (such as Widevine) or ask the user to install them.

It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

Examples of non-essential capabilities include but are not limited to advertising software or browser plug-ins that are not related to requirements or provide a wide array of functionality not required for every mission but that cannot be disabled."
          solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox\Encrypted Media Extensions
Policy Name: Enable Encrypted Media Extensions
Policy State: Disabled
Policy Name: Lock Encrypted Media Extensions
Policy State: Enabled

macOS 'plist' file:
<key>EncryptedMediaExtensions</key>
  <dict>
    <key>Enabled</key>
    <false/>
    <key>Locked</key>
    <true/>

Linux 'policies.json' file:
Add the following in the policies section:
'EncryptedMediaExtensions': {
  'Enabled': false,
  'Locked': true
}"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-251581r879587_rule,STIG-ID|FFOX-00-000037,SWIFT-CSCv1|2.3,Vuln-ID|V-251581"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
          show_output : YES
        </report>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000038 - Pocket must be disabled."
      info        : "Pocket, previously known as Read It Later, is a social bookmarking service for storing, sharing, and discovering web bookmarks. Data gathering cloud services such as this are generally disabled in the DoD."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Pocket
Policy State: Enabled

macOS 'plist' file:
<key>DisablePocket</key>
 <true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisablePocket': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-252908r879587_rule,STIG-ID|FFOX-00-000038,SWIFT-CSCv1|2.3,Vuln-ID|V-252908"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisablePocket"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "FFOX-00-000039 - Firefox Studies must be disabled."
      info        : "Studies try out different features and ideas before they are released to all Firefox users. Testing beta software is not in the DoD user's mission."
      solution    : "Windows group policy:
1. Open the group policy editor tool with 'gpedit.msc'.
2. Navigate to Policy Path: Computer Configuration\Administrative Templates\Mozilla\Firefox
Policy Name: Disable Firefox Studies
Policy State: Enabled

macOS 'plist' file:
<key>DisableFirefoxStudies</key>
 <true/>

Linux 'policies.json' file:
Add the following in the policies section:
'DisableFirefoxStudies': true"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MOZ_Firefox_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-252909r879587_rule,STIG-ID|FFOX-00-000039,SWIFT-CSCv1|2.3,Vuln-ID|V-252909"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Mozilla\Firefox"
      reg_item    : "DisableFirefoxStudies"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_Mozilla_Firefox_v6r5_Windows.audit from DISA Mozilla Firefox v6r5 STIG"
      info        : "Firefox is not installed or remote registry service is disabled.

      NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MOZ_Firefox_V6R5_STIG.zip"
    </report>
  </else>
</if>

</group_policy>
</check_type>
