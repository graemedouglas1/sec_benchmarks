<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Google_Kubernetes_Engine_GKE_AutoPilot_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2024-07-11">draft</xccdf:status>
   <xccdf:title xml:lang="en">CIS Google Kubernetes Engine (GKE) AutoPilot Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>This document provides prescriptive guidance for running Google Kubernetes Engine (GKE) AutoPilot following recommended security controls. This benchmark only includes controls which can be modified by an end user of GKE AutoPilot.</xhtml:p>
      <xhtml:p>
To obtain the latest version of this guide, please visit       <xhtml:a href="http://www.cisecurity.org">www.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:support@cisecurity.org">support@cisecurity.org</xhtml:a>
.    </xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <xccdf:version>1.0.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
      <xccdf:title xml:lang="en">Level 1</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:p>be practical and prudent;
provide a clear security benefit; and
not inhibit the utility of the technology beyond acceptable means.</xhtml:p>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_that_default_service_accounts_are_not_actively_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Avoid_use_of_systemmasters_group" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Limit_use_of_the_Bind_Impersonate_and_Escalate_permissions_in_the_Kubernetes_cluster" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Avoid_bindings_to_systemanonymous" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Avoid_non-default_bindings_to_systemunauthenticated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Avoid_non-default_bindings_to_systemauthenticated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_cluster_enforces_Pod_Security_Standard_Baseline_profile_or_stricter_for_all_namespaces." selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Enable_VPC_Flow_Logs_and_Intranode_Visibility" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
      <xccdf:title xml:lang="en">Level 2</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Level 2</xhtml:p>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_that_default_service_accounts_are_not_actively_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Avoid_use_of_systemmasters_group" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Limit_use_of_the_Bind_Impersonate_and_Escalate_permissions_in_the_Kubernetes_cluster" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Avoid_bindings_to_systemanonymous" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Avoid_non-default_bindings_to_systemunauthenticated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Avoid_non-default_bindings_to_systemauthenticated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_cluster_enforces_Pod_Security_Standard_Baseline_profile_or_stricter_for_all_namespaces." selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_that_all_Namespaces_have_Network_Policies_defined" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Consider_external_secret_storage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.1_Configure_Image_Provenance_using_ImagePolicyWebhook_admission_controller" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Ensure_that_the_seccomp_profile_is_set_to_RuntimeDefault_in_the_pod_definitions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.3_Apply_Security_Context_to_Pods_and_Containers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.4_The_default_namespace_should_not_be_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_Container_Image_repositories" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_Container_Image_repositories" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_only_trusted_container_images_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_GKE_clusters_are_not_running_using_the_Compute_Engine_default_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_keys_managed_in_Cloud_KMS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Enable_VPC_Flow_Logs_and_Intranode_Visibility" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_Control_Plane_Authorized_Networks_is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.3_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.4_Ensure_clusters_are_created_with_Private_Nodes" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.5_Ensure_use_of_Google-managed_SSL_Certificates" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Manage_Kubernetes_RBAC_users_with_Google_Groups_for_GKE" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Enable_Customer-Managed_Encryption_Keys_CMEK_for_GKE_Persistent_Disks_PD" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Enable_Security_Posture" selected="true"/>
   </xccdf:Profile>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645823_var" operator="pattern match" type="string">
      <title>Ensure that the cluster-admin role is only used where required</title>
      <description>This value is used in Rule: Ensure that the cluster-admin role is only used where required</description>
      <value>cluster-admin</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645825_var" operator="pattern match" type="string">
      <title>Minimize access to secrets</title>
      <description>This value is used in Rule: Minimize access to secrets</description>
      <value>no</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645827_var" operator="pattern match" type="string">
      <title>Minimize wildcard use in Roles and ClusterRoles</title>
      <description>This value is used in Rule: Minimize wildcard use in Roles and ClusterRoles</description>
      <value>"*"</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645829_var" operator="pattern match" type="string">
      <title>Minimize wildcard use in Roles and ClusterRoles</title>
      <description>This value is used in Rule: Minimize wildcard use in Roles and ClusterRoles</description>
      <value>"*"</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645831_var" operator="pattern match" type="string">
      <title>Ensure that default service accounts are not actively used</title>
      <description>This value is used in Rule: Ensure that default service accounts are not actively used</description>
      <value>automountServiceAccountToken.*false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645832_var" operator="pattern match" type="string">
      <title>Ensure that Service Account Tokens are only mounted where necessary</title>
      <description>This value is used in Rule: Ensure that Service Account Tokens are only mounted where necessary</description>
      <value>automountServiceAccountToken.*false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645834_var" operator="pattern match" type="string">
      <title>Ensure that Service Account Tokens are only mounted where necessary</title>
      <description>This value is used in Rule: Ensure that Service Account Tokens are only mounted where necessary</description>
      <value>automountServiceAccountToken.*false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645836_var" operator="pattern match" type="string">
      <title>Avoid use of system:masters group</title>
      <description>This value is used in Rule: Avoid use of system:masters group</description>
      <value>system:masters</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645838_var" operator="pattern match" type="string">
      <title>Avoid bindings to system:anonymous</title>
      <description>This value is used in Rule: Avoid bindings to system:anonymous</description>
      <value>anonymous-access</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645841_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:unauthenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:unauthenticated</description>
      <value>system:public-info-viewer</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645842_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:unauthenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:unauthenticated</description>
      <value>unauthenticated</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5838409_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:authenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:authenticated</description>
      <value>authenticated</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645844_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:authenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:authenticated</description>
      <value>system:public-info-viewer</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645846_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:authenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:authenticated</description>
      <value>system:basic-user</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645847_var" operator="pattern match" type="string">
      <title>Avoid non-default bindings to system:authenticated</title>
      <description>This value is used in Rule: Avoid non-default bindings to system:authenticated</description>
      <value>system:discovery</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645857_var" operator="pattern match" type="string">
      <title>Ensure that all Namespaces have Network Policies defined</title>
      <description>This value is used in Rule: Ensure that all Namespaces have Network Policies defined</description>
      <value>.+</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645863_var" operator="pattern match" type="string">
      <title>Ensure that the seccomp profile is set to RuntimeDefault in the pod definitions</title>
      <description>This value is used in Rule: Ensure that the seccomp profile is set to RuntimeDefault in the pod definitions</description>
      <value>seccompProfile.*RuntimeDefault</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645866_var" operator="pattern match" type="string">
      <title>The default namespace should not be used</title>
      <description>This value is used in Rule: The default namespace should not be used</description>
      <value>.+</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645849_var" operator="pattern match" type="string">
      <title>Ensure Image Vulnerability Scanning is enabled</title>
      <description>This value is used in Rule: Ensure Image Vulnerability Scanning is enabled</description>
      <value>Container Registry API</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645850_var" operator="pattern match" type="string">
      <title>Ensure Image Vulnerability Scanning is enabled</title>
      <description>This value is used in Rule: Ensure Image Vulnerability Scanning is enabled</description>
      <value>Container Analysis API</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5837923_var" operator="pattern match" type="string">
      <title>Ensure only trusted container images are used</title>
      <description>This value is used in Rule: Ensure only trusted container images are used</description>
      <value>evaluationMode.*DISABLED</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5747961_var" operator="pattern match" type="string">
      <title>Ensure GKE clusters are not running using the Compute Engine default service account</title>
      <description>This value is used in Rule: Ensure GKE clusters are not running using the Compute Engine default service account</description>
      <value>default</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645856_var" operator="pattern match" type="string">
      <title>Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</title>
      <description>This value is used in Rule: Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</description>
      <value>state.*ENCRYPTED</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5645870_var" operator="pattern match" type="string">
      <title>Enable VPC Flow Logs and Intranode Visibility</title>
      <description>This value is used in Rule: Enable VPC Flow Logs and Intranode Visibility</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5747962_var" operator="pattern match" type="string">
      <title>Ensure Control Plane Authorized Networks is Enabled</title>
      <description>This value is used in Rule: Ensure Control Plane Authorized Networks is Enabled</description>
      <value>enabled.*true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5747963_var" operator="pattern match" type="string">
      <title>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</title>
      <description>This value is used in Rule: Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5747964_var" operator="pattern match" type="string">
      <title>Ensure clusters are created with Private Nodes</title>
      <description>This value is used in Rule: Ensure clusters are created with Private Nodes</description>
      <value>true</value>
   </Value>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Control_Plane_Components">
      <xccdf:title xml:lang="en">Control Plane Components</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Under the GKE shared responsibility model, Google GKE AutoPilot mode provides a more managed Kubernetes experience than standard mode and implements more pre-configured security best practices by default. It also utilizes Container-Optimized OS reducing controls required to harden a Kubernetes cluster. You as the end user are responsible for securing your nodes, containers, and Pods and that is what this Benchmark specifically addresses.</xhtml:p>
      </xccdf:description>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Control_Plane_Configuration">
      <xccdf:title xml:lang="en">Control Plane Configuration</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Under the GKE shared responsibility model, Google GKE AutoPilot mode provides a more managed Kubernetes experience than standard mode and implements more pre-configured security best practices by default. It also utilizes Container-Optimized OS reducing controls required to harden a Kubernetes cluster. You as the end user are responsible for securing your nodes, containers, and Pods and that is what this Benchmark specifically addresses.</xhtml:p>
         <xhtml:p>
The community has reviewed the Control Plane Configuration Section and have determined that at this time no additional security relevant configuration recommendations are required outside of the         <xhtml:em>pre-configured</xhtml:em>
 default configurations supplied by Autopilot, which already follow the applicable full CIS GKE Benchmark recommendations.      </xhtml:p>
      </xccdf:description>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Worker_Nodes">
      <xccdf:title xml:lang="en">Worker Nodes</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Under the GKE shared responsibility model, Google GKE AutoPilot mode provides a more managed Kubernetes experience than standard mode and implements more pre-configured security best practices by default. It also utilizes Container-Optimized OS reducing controls required to harden a Kubernetes cluster. You as the end user are responsible for securing your nodes, containers, and Pods and that is what this Benchmark specifically addresses.</xhtml:p>
         <xhtml:p>
The community has reviewed the Worker Node Section and have determined that at this time additional security relevant recommendations are required outside of the         <xhtml:em>pre-configured</xhtml:em>
 default configurations supplied by Autopilot, which already follow the applicable full CIS GKE Benchmark recommendations.      </xhtml:p>
      </xccdf:description>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Policies">
      <xccdf:title xml:lang="en">Policies</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for various Kubernetes policies which are important to the security of the GKE AutoPilot Cluster environment.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_RBAC_and_Service_Accounts">
         <xccdf:title xml:lang="en">RBAC and Service Accounts</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure that the cluster-admin role is only used where required</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
The RBAC role             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provides wide-ranging powers over the environment and should be used only where and when needed.          </xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 allow super-user access to perform any action on any resource. When used in a             <xhtml:span class="inline_block">ClusterRoleBinding</xhtml:span>
, it gives full control over every resource in the cluster and in all namespaces. When used in a             <xhtml:span class="inline_block">RoleBinding</xhtml:span>
, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/cluster-administration/</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Identify all clusterrolebindings to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges.</xhtml:p>
                     <xhtml:p>Where possible, first bind users to a lower-privileged role and then remove the clusterrolebinding to the cluster-admin role :</xhtml:p>
                     <xhtml:code class="code_block">kubectl delete clusterrolebinding [name]
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
Care should be taken before removing any                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Specifically, modifications should not be made to                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 with the                   <xhtml:span class="inline_block">system:</xhtml:span>
 prefix as they are required for the operation of system components.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645823" value-id="xccdf_org.cisecurity.benchmarks_value_5645823_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645823"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Minimize access to secrets</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster.  Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Where possible, remove                 <xhtml:span class="inline_block">get</xhtml:span>
,                 <xhtml:span class="inline_block">list</xhtml:span>
 and                 <xhtml:span class="inline_block">watch</xhtml:span>
 access to                 <xhtml:span class="inline_block">secret</xhtml:span>
 objects in the cluster.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Care should be taken not to remove access to secrets to system components which require this for their operation</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645825" value-id="xccdf_org.cisecurity.benchmarks_value_5645825_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645825"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Minimize wildcard use in Roles and ClusterRoles</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects.  It is possible to set either of these to be the wildcard "*", which matches all items.</xhtml:p>
               <xhtml:p>Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The principle of least privilege recommends that users are provided only the access required for their role and nothing more.  The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions.</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645827" value-id="xccdf_org.cisecurity.benchmarks_value_5645827_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645827"/>
               </check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645829" value-id="xccdf_org.cisecurity.benchmarks_value_5645829_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645829"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_that_default_service_accounts_are_not_actively_used" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure that default service accounts are not actively used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
The             <xhtml:span class="inline_block">default</xhtml:span>
 service account should not be used to ensure that rights granted to applications can be more easily audited and reviewed.          </xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:7.0:16:9">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Kubernetes provides a             <xhtml:span class="inline_block">default</xhtml:span>
 service account which is used by cluster workloads where no specific service account is assigned to the pod.          </xhtml:p>
               <xhtml:p>Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account.</xhtml:p>
               <xhtml:p>The default service account should be configured such that it does not provide a service account token and does not have any explicit rights assignments.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Create explicit service accounts wherever a Kubernetes workload requires specific access to the Kubernetes API server.</xhtml:p>
                     <xhtml:p>Modify the configuration of each default service account to include this value</xhtml:p>
                     <xhtml:code class="code_block">automountServiceAccountToken: false
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>All workloads which require access to the Kubernetes API will require an explicit service account to be created.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645831" value-id="xccdf_org.cisecurity.benchmarks_value_5645831_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645831"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure that Service Account Tokens are only mounted where necessary</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Enforce Access Control to Data through Automated Tools" urn="urn:cisecurity.org:controls:7.0:14:7">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.</xhtml:p>
               <xhtml:p>Avoiding mounting these tokens removes this attack avenue.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Pods mounted without service account tokens will not be able to communicate with the API server, except where the resource is available to unauthenticated principals.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645832" value-id="xccdf_org.cisecurity.benchmarks_value_5645832_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645832"/>
               </check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645834" value-id="xccdf_org.cisecurity.benchmarks_value_5645834_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645834"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Avoid_use_of_systemmasters_group" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Avoid use of system:masters group</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
The special group             <xhtml:span class="inline_block">system:masters</xhtml:span>
 should not be used to grant permissions to any user or service account, except where strictly necessary (e.g. bootstrapping access prior to RBAC being fully available)          </xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Controlled Use of Administrative Privileges" urn="urn:cisecurity.org:controls:7.0:4"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
The             <xhtml:span class="inline_block">system:masters</xhtml:span>
 group has unrestricted access to the Kubernetes API hard-coded into the API server source code. An authenticated user who is a member of this group cannot have their access reduced, even if all bindings and cluster role bindings which mention it, are removed.          </xhtml:p>
               <xhtml:p>When combined with client certificate authentication, use of this group can allow for irrevocable cluster-admin level credentials to exist for a cluster.</xhtml:p>
               <xhtml:p>
GKE includes the             <xhtml:span class="inline_block">CertificateSubjectRestriction</xhtml:span>
 admission controller which rejects requests for the             <xhtml:span class="inline_block">system:masters</xhtml:span>
 group.          </xhtml:p>
               <xhtml:p>
                  <xhtml:span class="inline_block">CertificateSubjectRestriction</xhtml:span>
 "This admission controller observes creation of             <xhtml:span class="inline_block">CertificateSigningRequest</xhtml:span>
 resources that have a spec.signerName of kubernetes.io/kube-apiserver-client. It rejects any request that specifies a 'group' (or 'organization attribute') of system:masters."             <xhtml:a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#certificatesubjectrestriction">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#certificatesubjectrestriction</xhtml:a>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/pkg/registry/rbac/escalation_check.go#L38</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Remove the                 <xhtml:span class="inline_block">system:masters</xhtml:span>
 group from all users in the cluster.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
Once the RBAC system is operational in a cluster                   <xhtml:span class="inline_block">system:masters</xhtml:span>
 should not be specifically required, as ordinary bindings from principals to the                   <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 cluster role can be made where unrestricted access is required.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645836" value-id="xccdf_org.cisecurity.benchmarks_value_5645836_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645836"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Limit_use_of_the_Bind_Impersonate_and_Escalate_permissions_in_the_Kubernetes_cluster" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Cluster roles and roles with the impersonate, bind or escalate permissions should not be granted unless strictly required. Each of these permissions allow a particular subject to escalate their privileges beyond those explicitly granted by cluster administrators</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Controlled Use of Administrative Privileges" urn="urn:cisecurity.org:controls:7.0:4"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The impersonate privilege allows a subject to impersonate other users gaining their rights to the cluster. The bind privilege allows the subject to add a binding to a cluster role or role which escalates their effective permissions in the cluster. The escalate privilege allows a subject to modify cluster roles to which they are bound, increasing their rights to that level.</xhtml:p>
               <xhtml:p>Each of these permissions has the potential to allow for privilege escalation to cluster-admin level.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://www.impidio.com/blog/kubernetes-rbac-security-pitfalls</xccdf:ident>
            <xccdf:ident system="URL">https://raesene.github.io/blog/2020/12/12/Escalating_Away/</xccdf:ident>
            <xccdf:ident system="URL">https://raesene.github.io/blog/2021/01/16/Getting-Into-A-Bind-with-Kubernetes/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Where possible, remove the impersonate, bind and escalate rights from subjects.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There are some cases where these permissions are required for cluster service operation, and care should be taken before removing these permissions from system service accounts.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Avoid_bindings_to_systemanonymous" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Avoid bindings to system:anonymous</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Avoid ClusterRoleBindings nor RoleBindings with the user             <xhtml:span class="inline_block">system:anonymous</xhtml:span>
.          </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Kubernetes assigns user             <xhtml:span class="inline_block">system:anonymous</xhtml:span>
 to API server requests that have no authentication information provided. Binding a role to user             <xhtml:span class="inline_block">system:anonymous</xhtml:span>
 gives any unauthenticated user the permissions granted by that role and is strongly discouraged.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/#discovery-roles</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Identify all                 <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 and                 <xhtml:span class="inline_block">rolebindings</xhtml:span>
 to the user system:anonymous. Check if they are used and review the permissions associated with the binding using the commands in the Audit section above or refer to GKE                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/best-practices/rbac#detect-prevent-default">documentation</xhtml:a>
.              </xhtml:p>
                     <xhtml:p>Strongly consider replacing unsafe bindings with an authenticated, user-defined group. Where possible, bind to non-default, user-defined groups with least-privilege roles.</xhtml:p>
                     <xhtml:p>
If there are any unsafe bindings to the user                 <xhtml:span class="inline_block">system:anonymous</xhtml:span>
, proceed to delete them after consideration for cluster operations with only necessary, safer bindings.              </xhtml:p>
                     <xhtml:code class="code_block">
kubectl delete clusterrolebinding                <br/>
[CLUSTER_ROLE_BINDING_NAME]
              </xhtml:code>
                     <xhtml:code class="code_block">
kubectl delete rolebinding                <br/>
[ROLE_BINDING_NAME]                <br/>
--namespace                <br/>
[ROLE_BINDING_NAMESPACE]
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Unauthenticated users will have privileges and permissions associated with roles associated with the configured bindings.</xhtml:p>
                        <xhtml:p>
Care should be taken before removing any                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 or                   <xhtml:span class="inline_block">rolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Use a more specific and authenticated user for cluster operations.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645838" value-id="xccdf_org.cisecurity.benchmarks_value_5645838_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645838"/>
               </check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645839"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Avoid_non-default_bindings_to_systemunauthenticated" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Avoid non-default bindings to system:unauthenticated</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Avoid non-default             <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 and             <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 with the group             <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
, except the             <xhtml:span class="inline_block">ClusterRoleBinding</xhtml:span>
                  <xhtml:span class="inline_block">system:public-info-viewer</xhtml:span>
.          </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Kubernetes assigns the group             <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
 to API server requests that have no authentication information provided. Binding a role to this group gives any unauthenticated user the permissions granted by that role and is strongly discouraged.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/#discovery-roles</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Identify all non-default                 <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 and                 <xhtml:span class="inline_block">rolebindings</xhtml:span>
 to the group                 <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
. Check if they are used and review the permissions associated with the binding using the commands in the Audit section above or refer to GKE                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/best-practices/rbac#detect-prevent-default">documentation</xhtml:a>
.              </xhtml:p>
                     <xhtml:p>Strongly consider replacing non-default, unsafe bindings with an authenticated, user-defined group. Where possible, bind to non-default, user-defined groups with least-privilege roles.</xhtml:p>
                     <xhtml:p>
If there are any non-default, unsafe bindings to the group                 <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
, proceed to delete them after consideration for cluster operations with only necessary, safer bindings.              </xhtml:p>
                     <xhtml:code class="code_block">
kubectl delete clusterrolebinding                <br/>
[CLUSTER_ROLE_BINDING_NAME]
              </xhtml:code>
                     <xhtml:code class="code_block">
kubectl delete rolebinding                <br/>
[ROLE_BINDING_NAME]                <br/>
--                <br/>
namespace                <br/>
[ROLE_BINDING_NAMESPACE]
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Unauthenticated users will have privileges and permissions associated with roles associated with the configured bindings.</xhtml:p>
                        <xhtml:p>
Care should be taken before removing any non-default                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 or                   <xhtml:span class="inline_block">rolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Leverage a more specific and authenticated user for cluster operations.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645841" value-id="xccdf_org.cisecurity.benchmarks_value_5645841_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645841"/>
               </check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645842" value-id="xccdf_org.cisecurity.benchmarks_value_5645842_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645842"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Avoid_non-default_bindings_to_systemauthenticated" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Avoid non-default bindings to system:authenticated</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Avoid non-default             <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 and             <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 with the group             <xhtml:span class="inline_block">system:authenticated</xhtml:span>
, except the             <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
                  <xhtml:span class="inline_block">system:basic-user</xhtml:span>
,             <xhtml:span class="inline_block">system:discovery</xhtml:span>
, and             <xhtml:span class="inline_block">system:public-info-viewer</xhtml:span>
.          </xhtml:p>
               <xhtml:p>
Google's approach to authentication is to make authenticating to Google Cloud and GKE as simple and secure as possible without adding complex configuration steps. The group             <xhtml:span class="inline_block">system:authenticated</xhtml:span>
 includes all users with a Google account, which includes all Gmail accounts. Consider your authorization controls with this extended group scope when granting permissions. Thus, group             <xhtml:span class="inline_block">system:authenticated</xhtml:span>
 is not recommended for non-default use.          </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
GKE assigns the group             <xhtml:span class="inline_block">system:authenticated</xhtml:span>
 to API server requests made by any user who is signed in with a Google Account, including all Gmail accounts. In practice, this isn't meaningfully different from             <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
 because anyone can create a Google Account.          </xhtml:p>
               <xhtml:p>
Binding a role to the group             <xhtml:span class="inline_block">system:authenticated</xhtml:span>
 gives any user with a Google Account, including all Gmail accounts, the permissions granted by that role and is strongly discouraged.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/#discovery-roles</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Identify all non-default                 <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 and                 <xhtml:span class="inline_block">rolebindings</xhtml:span>
 to the group                 <xhtml:span class="inline_block">system:authenticated</xhtml:span>
. Check if they are used and review the permissions associated with the binding using the commands in the Audit section above or refer to GKE documentation.              </xhtml:p>
                     <xhtml:p>Strongly consider replacing non-default, unsafe bindings with an authenticated, user-defined group. Where possible, bind to non-default, user-defined groups with least-privilege roles.</xhtml:p>
                     <xhtml:p>
If there are any non-default, unsafe bindings to the group                 <xhtml:span class="inline_block">system:authenticated</xhtml:span>
, proceed to delete them after consideration for cluster operations with only necessary, safer bindings.              </xhtml:p>
                     <xhtml:code class="code_block">
kubectl delete clusterrolebinding                <br/>
[CLUSTER_ROLE_BINDING_NAME]
              </xhtml:code>
                     <xhtml:code class="code_block">
kubectl delete rolebinding                <br/>
[ROLE_BINDING_NAME]                <br/>
--namespace                <br/>
[ROLE_BINDING_NAMESPACE]
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
Authenticated users in group                   <xhtml:span class="inline_block">system:authenticated</xhtml:span>
 should be treated similarly to users in                   <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
, having privileges and permissions associated with roles associated with the configured bindings.                </xhtml:p>
                        <xhtml:p>
Care should be taken before removing any non-default                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 or                   <xhtml:span class="inline_block">rolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Leverage a more specific and authenticated user for cluster operations.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5838409" value-id="xccdf_org.cisecurity.benchmarks_value_5838409_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5838409"/>
               </check>
               <xccdf:complex-check operator="OR">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645844" value-id="xccdf_org.cisecurity.benchmarks_value_5645844_var"/>
                     <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645844"/>
                  </check>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645846" value-id="xccdf_org.cisecurity.benchmarks_value_5645846_var"/>
                        <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645846"/>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645847" value-id="xccdf_org.cisecurity.benchmarks_value_5645847_var"/>
                        <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645847"/>
                     </check>
                  </xccdf:complex-check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.2_Pod_Security_Standards">
         <xccdf:title xml:lang="en">Pod Security Standards</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_cluster_enforces_Pod_Security_Standard_Baseline_profile_or_stricter_for_all_namespaces." role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure that the cluster enforces Pod Security Standard Baseline profile or stricter for all namespaces.</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The Pod Security Standard Baseline profile defines a baseline for container security. You can enforce this by using the built-in Pod Security Admission controller.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Without an active mechanism to enforce the Pod Security Standard Baseline profile, it is not possible to limit the use of containers with access to underlying cluster nodes, via mechanisms like privileged containers, or the use of hostPath volume mounts.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/security/pod-security-admission</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/security/pod-security-standards</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/about-security-posture-dashboard</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that Pod Security Admission is in place for every namespace which contains user workloads.</xhtml:p>
                     <xhtml:p>Run the following command to enforce the Baseline profile in a namespace:</xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block">kubectl label namespace &lt;namespace-name&gt; pod-security.kubernetes.io/enforce=baseline</xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.3_Network_Policies_and_CNI">
         <xccdf:title xml:lang="en">Network Policies and CNI</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_that_all_Namespaces_have_Network_Policies_defined" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure that all Namespaces have Network Policies defined</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Use network policies to isolate traffic in the cluster network.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Perform Traffic Filtering Between Network Segments" urn="urn:cisecurity.org:controls:8.0:13:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Enable Firewall Filtering Between VLANs" urn="urn:cisecurity.org:controls:7.0:14:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints.</xhtml:p>
               <xhtml:p>Network Policies are namespace scoped.  When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy#creating_a_network_policy</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/network-overview</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Follow the documentation and create                 <xhtml:span class="inline_block">NetworkPolicy</xhtml:span>
 objects as needed.
See:                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy#creating_a_network_policy">https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy#creating_a_network_policy</xhtml:a>
 for more information.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Once network policies are in use within a given namespace, traffic not explicitly allowed by a network policy will be denied.  As such it is important to ensure that, when introducing network policies, legitimate traffic is not blocked.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645857" value-id="xccdf_org.cisecurity.benchmarks_value_5645857_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645857"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.4_Secrets_Management">
         <xccdf:title xml:lang="en">Secrets Management</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Consider_external_secret_storage" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Consider external secret storage</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Consider the use of an external secrets storage and management system instead of using Kubernetes Secrets directly, if more complex secret management is required. Ensure the solution requires authentication to access secrets, has auditing of access to and use of secrets, and encrypts secrets. Some solutions also make it easier to rotate secrets.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:control title="Data Protection" urn="urn:cisecurity.org:controls:8.0:3"/>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Data Protection" urn="urn:cisecurity.org:controls:7.0:13"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Kubernetes supports secrets as first-class objects, but care needs to be taken to ensure that access to secrets is carefully limited. Using an external secrets provider can ease the management of access to secrets, especially where secrests are used across both Kubernetes and non-Kubernetes environments.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/configuration/secret/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/secret-manager/docs/overview</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Refer to the secrets management options offered by the cloud service provider or a third-party secrets management solution.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>None</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.5_Extensible_Admission_Control">
         <xccdf:title xml:lang="en">Extensible Admission Control</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.1_Configure_Image_Provenance_using_ImagePolicyWebhook_admission_controller" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Configure Image Provenance using ImagePolicyWebhook admission controller</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Configure Image Provenance for the deployment.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Kubernetes supports plugging in provenance rules to accept or reject the images in deployments. Rules can be configured to ensure that only approved images are deployed in the cluster.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/containers/images/</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Follow the Kubernetes documentation and setup image provenance.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Regular maintenance for the provenance configuration should be carried out, based on container image updates.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.6_General_Policies">
         <xccdf:title xml:lang="en">General Policies</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>These policies relate to general cluster management topics, like namespace best practices and policies applied to pod objects in the cluster.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Create administrative boundaries between resources using namespaces</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Use namespaces to isolate your Kubernetes objects.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:control title="Network Monitoring and Defense" urn="urn:cisecurity.org:controls:8.0:13"/>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Boundary Defense" urn="urn:cisecurity.org:controls:7.0:12"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called             <xhtml:span class="inline_block">default</xhtml:span>
. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/#viewing-namespaces</xccdf:ident>
            <xccdf:ident system="URL">http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html</xccdf:ident>
            <xccdf:ident system="URL">https://github.com/kubernetes/enhancements/tree/master/keps/sig-node/589-efficient-node-heartbeats</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Follow the documentation and create namespaces for objects in your deployment as you need them.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>You need to switch between namespaces for administration.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Ensure_that_the_seccomp_profile_is_set_to_RuntimeDefault_in_the_pod_definitions" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure that the seccomp profile is set to RuntimeDefault in the pod definitions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Enable             <xhtml:span class="inline_block">RuntimeDefault</xhtml:span>
 seccomp profile in the pod definitions.          </xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. It should be enabled to ensure that the workloads have restricted actions available within the container.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/tutorials/security/seccomp/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/seccomp-in-gke</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Use security context to enable the                 <xhtml:span class="inline_block">RuntimeDefault</xhtml:span>
 seccomp profile in your pod definitions. An example is as below:              </xhtml:p>
                     <xhtml:code class="code_block">
{                <br/>
  "namespace": "kube-system",                <br/>
  "name": "metrics-server-v0.7.0-dbcc8ddf6-gz7d4",                <br/>
  "seccompProfile": "RuntimeDefault"                <br/>
}
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
If the                   <xhtml:span class="inline_block">RuntimeDefault</xhtml:span>
 seccomp profile is too restrictive for you, you would have to create/manage your own                   <xhtml:span class="inline_block">Localhost</xhtml:span>
 seccomp profiles.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645863" value-id="xccdf_org.cisecurity.benchmarks_value_5645863_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645863"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.3_Apply_Security_Context_to_Pods_and_Containers" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Apply Security Context to Pods and Containers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apply Security Context to Pods and Containers</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:control title="Secure Configuration of Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4"/>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing containers and pods, make sure that the security context is configured for pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/workloads/pods/</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/containers/</xccdf:ident>
            <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/security-context/</xccdf:ident>
            <xccdf:ident system="URL">https://learn.cisecurity.org/benchmarks</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Google Container-Optimized OS Benchmark.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If you incorrectly apply security contexts, there may be issues running the pods.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.4_The_default_namespace_should_not_be_used" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">The default namespace should not be used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them.  Placing objects in this namespace makes application of RBAC and other controls more difficult.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Physically or Logically Segregate High Risk Applications" urn="urn:cisecurity.org:controls:7.0:2:10">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/10" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>None</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645866" value-id="xccdf_org.cisecurity.benchmarks_value_5645866_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645866"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Managed_services">
      <xccdf:title xml:lang="en">Managed services</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section consists of security recommendations for the direct configuration of GKE AutoPilot managed service components, namely, Google Kubernetes Engine (GKE) AutoPilot mode. These recommendations are directly applicable for features which exist only as part of a managed service.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_Image_Registry_and_Image_Scanning">
         <xccdf:title xml:lang="en">Image Registry and Image Scanning</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to container image registries and securing images in those registries, such as Google Container Registry (GCR).</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_is_enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Image Vulnerability Scanning is enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Note: GCR is now deprecated, being superseded by Artifact Registry starting 15th May 2024. Runtime Vulnerability scanning is available via GKE Security Posture</xhtml:p>
               <xhtml:p>Scan images stored in Google Container Registry (GCR) or Artifact Registry (AR) for vulnerabilities.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Identify</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Continuous Vulnerability Management" urn="urn:cisecurity.org:controls:7.0:3"/>
                     <controls:safeguard title="Run Automated Vulnerability Scanning Tools" urn="urn:cisecurity.org:controls:7.0:3:1">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Perform Authenticated Vulnerability Scanning" urn="urn:cisecurity.org:controls:7.0:3:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Vulnerabilities in software packages can be exploited by malicious users to obtain unauthorized access to local cloud resources. GCR Container Analysis API or Artifact Registry Container Scanning API allow images stored in GCR or AR respectively to be scanned for known vulnerabilities.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/artifact-registry/docs/analysis</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/artifact-analysis/docs/os-overview</xccdf:ident>
            <xccdf:ident system="URL">https://console.cloud.google.com/marketplace/product/google/containerregistry.googleapis.com</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/about-configuration-scanning</xccdf:ident>
            <xccdf:ident system="URL">https://containersecurity.googleapis.com</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:h4>For Images Hosted in GCR:</xhtml:h4>
                     <xhtml:h5>Using Google Cloud Console</xhtml:h5>
                     <xhtml:ol>
                        <xhtml:li>
Go to GCR by visiting:                   <xhtml:a href="https://console.cloud.google.com/gcr">https://console.cloud.google.com/gcr</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Select Settings and, under the Vulnerability Scanning heading, click the TURN ON button.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:h5>Using Command Line</xhtml:h5>
                     <xhtml:code class="code_block">gcloud services enable containeranalysis.googleapis.com
</xhtml:code>
                     <xhtml:h4>For Images Hosted in AR:</xhtml:h4>
                     <xhtml:h5>Using Google Cloud Console</xhtml:h5>
                     <xhtml:ol>
                        <xhtml:li>
Go to GCR by visiting:                   <xhtml:a href="https://console.cloud.google.com/artifacts">https://console.cloud.google.com/artifacts</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Select Settings and, under the Vulnerability Scanning heading, click the ENABLE button.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:h5>Using Command Line</xhtml:h5>
                     <xhtml:code class="code_block">gcloud services enable containerscanning.googleapis.com
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>None.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645849" value-id="xccdf_org.cisecurity.benchmarks_value_5645849_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645849"/>
               </check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645850" value-id="xccdf_org.cisecurity.benchmarks_value_5645850_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645850"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_Container_Image_repositories" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Minimize user access to Container Image repositories</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Note: GCR is now deprecated, see the references for more details.</xhtml:p>
               <xhtml:p>Restrict user access to GCR or AR, limiting interaction with build images to only authorized personnel and service accounts.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Weak access control to GCR or AR may allow malicious users to replace built images with vulnerable or back-doored containers.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/container-registry/docs/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/service-accounts</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/iam</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/artifact-registry/docs/access-control#grant</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:h4>For Images Hosted in AR:</xhtml:h4>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Artifacts Browser by visiting                   <xhtml:a href="https://console.cloud.google.com/artifacts">https://console.cloud.google.com/artifacts</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>
From the list of artifacts select each repository with format                   <xhtml:span class="inline_block">Docker</xhtml:span>
                        </xhtml:li>
                        <xhtml:li>Under the Permissions tab, modify the roles for each member and ensure only authorized users have the Artifact Registry Administrator, Artifact Registry Reader, Artifact Registry Repository Administrator and Artifact Registry Writer roles.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:code class="code_block">gcloud artifacts repositories set-iam-policy &lt;repository-name&gt; &lt;path-to-policy-file&gt; --location &lt;repository-location&gt;
</xhtml:code>
                     <xhtml:p>
To learn how to configure policy files see:                 <xhtml:a href="https://cloud.google.com/artifact-registry/docs/access-control#grant">https://cloud.google.com/artifact-registry/docs/access-control#grant</xhtml:a>
                     </xhtml:p>
                     <xhtml:h4>For Images Hosted in GCR:</xhtml:h4>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:p>To modify roles granted at the GCR bucket level:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Storage Browser by visiting:                   <xhtml:a href="https://console.cloud.google.com/storage/browser">https://console.cloud.google.com/storage/browser</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>
From the list of storage buckets, select                   <xhtml:span class="inline_block">artifacts.&lt;project_id&gt;.appspot.com</xhtml:span>
 for the GCR bucket                </xhtml:li>
                        <xhtml:li>
Under the Permissions tab, modify permissions of the identified member via the drop-down role menu and change the Role to                   <xhtml:span class="inline_block">Storage Object Viewer</xhtml:span>
 for read-only access.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>
For a User or Service account with Project level permissions inherited by the GCR bucket, or the                 <xhtml:span class="inline_block">Service Account User Role</xhtml:span>
:              </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to IAM by visiting:                   <xhtml:a href="https://console.cloud.google.com/iam-admin/iam">https://console.cloud.google.com/iam-admin/iam</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Find the User or Service account to be modified and click on the corresponding pencil icon.</xhtml:li>
                        <xhtml:li>
Remove the                   <xhtml:span class="inline_block">create</xhtml:span>
/                  <xhtml:span class="inline_block">modify</xhtml:span>
 role (                  <xhtml:span class="inline_block">Storage Admin</xhtml:span>
 /                   <xhtml:span class="inline_block">Storage Object Admin</xhtml:span>
 /                   <xhtml:span class="inline_block">Storage Object Creator</xhtml:span>
 /                   <xhtml:span class="inline_block">Service Account User</xhtml:span>
) on the user or service account.                </xhtml:li>
                        <xhtml:li>
If required add the                   <xhtml:span class="inline_block">Storage Object Viewer</xhtml:span>
 role - note with caution that this permits the account to view all objects stored in GCS for the project.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>To change roles at the GCR bucket level:
Firstly, run the following if read permissions are required:</xhtml:p>
                     <xhtml:code class="code_block">gsutil iam ch &lt;type&gt;:&lt;email_address&gt;:objectViewer gs://artifacts.&lt;project_id&gt;.appspot.com
</xhtml:code>
                     <xhtml:p>
Then remove the excessively privileged role (                <xhtml:span class="inline_block">Storage Admin</xhtml:span>
 /                 <xhtml:span class="inline_block">Storage Object Admin</xhtml:span>
 /                 <xhtml:span class="inline_block">Storage Object Creator</xhtml:span>
) using:              </xhtml:p>
                     <xhtml:code class="code_block">gsutil iam ch -d &lt;type&gt;:&lt;email_address&gt;:&lt;role&gt; gs://artifacts.&lt;project_id&gt;.appspot.com
</xhtml:code>
                     <xhtml:p>where:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>
                           <xhtml:span class="inline_block">&lt;type&gt;</xhtml:span>
 can be one of the following:
                  <xhtml:ul>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">user</xhtml:span>
, if the                       <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 is a Google account.                    </xhtml:li>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">serviceAccount</xhtml:span>
, if                       <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 specifies a Service account.                    </xhtml:li>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 can be one of the following:
                      <xhtml:ul>
                                    <xhtml:li>
a Google account (for example,                           <xhtml:span class="inline_block">someone@example.com</xhtml:span>
).                        </xhtml:li>
                                    <xhtml:li>a Cloud IAM service account.</xhtml:li>
                                 </xhtml:ul>
                              </xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>To modify roles defined at the project level and subsequently inherited within the GCR bucket, or the Service Account User role, extract the IAM policy file, modify it accordingly and apply it using:</xhtml:p>
                     <xhtml:code class="code_block">gcloud projects set-iam-policy &lt;project_id&gt; &lt;policy_file&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Care should be taken not to remove access to GCR or AR for accounts that require this for their operation.
Any account granted the Storage Object Viewer role at the project level can view all objects stored in GCS for the project.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_Container_Image_repositories" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Minimize cluster access to read-only for Container Image repositories</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Note: GCR is now deprecated, see the references for more details.</xhtml:p>
               <xhtml:p>Configure the Cluster Service Account with Artifact Registry Viewer Role to only allow read-only access to AR repositories.
Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to GCR.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Perform Authenticated Vulnerability Scanning" urn="urn:cisecurity.org:controls:7.0:3:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The Cluster Service Account does not require administrative access to GCR or AR, only requiring pull access to containers to deploy onto GKE. Restricting permissions follows the principles of least privilege and prevents credentials from being abused beyond the required role.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/container-registry/docs/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/service-accounts</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/iam</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:h4>For Images Hosted in AR:</xhtml:h4>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Artifacts Browser by visiting                   <xhtml:a href="https://console.cloud.google.com/artifacts">https://console.cloud.google.com/artifacts</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>From the list of repositories, for each repository with Format Docker</xhtml:li>
                        <xhtml:li>Under the Permissions tab, modify the permissions for GKE Service account and ensure that only the Artifact Registry Viewer role is set.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:
Add artifactregistry.reader role</xhtml:p>
                     <xhtml:code class="code_block">
gcloud artifacts repositories add-iam-policy-binding &lt;repository&gt; \                <br/>
--location=&lt;repository-location&gt; \                <br/>
--member='serviceAccount:&lt;email-address&gt;' \                <br/>
--role='roles/artifactregistry.reader'
              </xhtml:code>
                     <xhtml:p>
Remove any roles other than                 <xhtml:span class="inline_block">artifactregistry.reader</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="code_block">
gcloud artifacts repositories remove-iam-policy-binding &lt;repository&gt; \                <br/>
--location &lt;repository-location&gt; \                <br/>
--member='serviceAccount:&lt;email-address&gt;' \                <br/>
--role='&lt;role-name&gt;'
              </xhtml:code>
                     <xhtml:h4>For Images Hosted in GCR:</xhtml:h4>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:p>For an account explicitly granted access to the bucket:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Storage Browser by visiting:                   <xhtml:a href="https://console.cloud.google.com/storage/browser">https://console.cloud.google.com/storage/browser</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>
From the list of storage buckets, select                   <xhtml:span class="inline_block">artifacts.&lt;project_id&gt;.appspot.com</xhtml:span>
 for the GCR bucket.                </xhtml:li>
                        <xhtml:li>
Under the Permissions tab, modify permissions of the identified GKE Service Account via the drop-down role menu and change to the Role to                   <xhtml:span class="inline_block">Storage Object Viewer</xhtml:span>
 for read-only access.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>For an account that inherits access to the bucket through Project level permissions:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to IAM console by visiting:                   <xhtml:a href="https://console.cloud.google.com/iam-admin">https://console.cloud.google.com/iam-admin</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>From the list of accounts, identify the required service account and select the corresponding pencil icon.</xhtml:li>
                        <xhtml:li>
Remove the                   <xhtml:span class="inline_block">Storage Admin</xhtml:span>
 /                   <xhtml:span class="inline_block">Storage Object Admin</xhtml:span>
 /                   <xhtml:span class="inline_block">Storage Object Creator</xhtml:span>
 roles.                </xhtml:li>
                        <xhtml:li>
Add the                   <xhtml:span class="inline_block">Storage Object Viewer</xhtml:span>
 role - note with caution that this permits the account to view all objects stored in GCS for the project.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>For an account explicitly granted to the bucket:
Firstly add read access to the Kubernetes Service Account:</xhtml:p>
                     <xhtml:code class="code_block">gsutil iam ch &lt;type&gt;:&lt;email_address&gt;:objectViewer gs://artifacts.&lt;project_id&gt;.appspot.com
</xhtml:code>
                     <xhtml:p>where:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>
                           <xhtml:span class="inline_block">&lt;type&gt;</xhtml:span>
 can be one of the following:
                  <xhtml:ul>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">user</xhtml:span>
, if the                       <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 is a Google account.                    </xhtml:li>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">serviceAccount</xhtml:span>
, if                       <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 specifies a Service account.                    </xhtml:li>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">&lt;email_address&gt;</xhtml:span>
 can be one of the following:
                      <xhtml:ul>
                                    <xhtml:li>
a Google account (for example,                           <xhtml:span class="inline_block">someone@example.com</xhtml:span>
).                        </xhtml:li>
                                    <xhtml:li>a Cloud IAM service account.</xhtml:li>
                                 </xhtml:ul>
                              </xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>
Then remove the excessively privileged role (                <xhtml:span class="inline_block">Storage Admin</xhtml:span>
 /                 <xhtml:span class="inline_block">Storage Object Admin</xhtml:span>
 /                 <xhtml:span class="inline_block">Storage Object Creator</xhtml:span>
) using:              </xhtml:p>
                     <xhtml:code class="code_block">gsutil iam ch -d &lt;type&gt;:&lt;email_address&gt;:&lt;role&gt; gs://artifacts.&lt;project_id&gt;.appspot.com
</xhtml:code>
                     <xhtml:p>For an account that inherits access to the GCR Bucket through Project level permissions, modify the Projects IAM policy file accordingly, then upload it using:</xhtml:p>
                     <xhtml:code class="code_block">gcloud projects set-iam-policy &lt;project_id&gt; &lt;policy_file&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>A separate dedicated service account may be required for use by build servers and other robot users pushing or managing container images.</xhtml:p>
                        <xhtml:p>Any account granted the Storage Object Viewer role at the project level can view all objects stored in GCS for the project.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_only_trusted_container_images_are_used" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure only trusted container images are used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Use Binary Authorization to allowlist (whitelist) only approved container registries.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Allowing unrestricted access to external container registries provides the opportunity for malicious or unapproved containers to be deployed into the cluster. Ensuring only trusted container images are used reduces this risk.</xhtml:p>
               <xhtml:p>Also see recommendation 5.10.4.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/binary-authorization/docs/setting-up</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Binary Authorization by visiting:                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Enable Binary Authorization API (if disabled).</xhtml:li>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Select Kubernetes cluster for which Binary Authorization is disabled.</xhtml:li>
                        <xhtml:li>
Within the                   <xhtml:span class="inline_block">Details</xhtml:span>
 pane, under the                   <xhtml:span class="inline_block">Security</xhtml:span>
 heading, click on the pencil icon called                   <xhtml:span class="inline_block">Edit binary authorization</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Ensure that                   <xhtml:span class="inline_block">Enable Binary Authorization</xhtml:span>
 is checked.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE CHANGES</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Return to the Binary Authorization by visiting:                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Set an appropriate policy for the cluster and enter the approved container registries under Image paths.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>Update the cluster to enable Binary Authorization:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container cluster update &lt;cluster_name&gt; --enable-binauthz
</xhtml:code>
                     <xhtml:p>
Create a Binary Authorization Policy using the Binary Authorization Policy Reference:                 <xhtml:a href="https://cloud.google.com/binary-authorization/docs/policy-yaml-reference">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</xhtml:a>
 for guidance.              </xhtml:p>
                     <xhtml:p>Import the policy file into Binary Authorization:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container binauthz policy import &lt;yaml_policy&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>All container images to be deployed to the cluster must be hosted within an approved container image registry. If public registries are not on the allowlist, a process for bringing commonly used container images into an approved private registry and keeping them up to date will be required.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5837923" value-id="xccdf_org.cisecurity.benchmarks_value_5837923_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5837923"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Identity_and_Access_Management_IAM">
         <xccdf:title xml:lang="en">Identity and Access Management (IAM)</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to using Cloud IAM with GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_GKE_clusters_are_not_running_using_the_Compute_Engine_default_service_account" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure GKE clusters are not running using the Compute Engine default service account</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Create and use minimally privileged Service accounts to run GKE clusters instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A GCP service account (as distinct from a Kubernetes ServiceAccount) is an identity that an instance or an application can be used to run GCP API requests. This identity is used to identify virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes use the Compute Engine default service account. This account has broad access by default, as defined by access scopes, making it useful to a wide variety of applications on the VM, but it has more permissions than are required to run your Kubernetes Engine cluster.</xhtml:p>
               <xhtml:p>A minimally privileged service account should be created and used to run the Kubernetes Engine cluster instead of using the Compute Engine default service account, and create separate service accounts for each Kubernetes Workload (See recommendation 5.2.2).</xhtml:p>
               <xhtml:p>
Kubernetes Engine requires, at a minimum, the node service account to have the             <xhtml:span class="inline_block">monitoring.viewer</xhtml:span>
,             <xhtml:span class="inline_block">monitoring.metricWriter</xhtml:span>
, and             <xhtml:span class="inline_block">logging.logWriter</xhtml:span>
 roles. Additional roles may need to be added for the nodes to pull images from GCR.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/compute/docs/access/service-accounts#compute_engine_default_service_account</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:p>To create a minimally privileged service account:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Service Accounts by visiting:                   <xhtml:a href="https://console.cloud.google.com/iam-admin/serviceaccounts">https://console.cloud.google.com/iam-admin/serviceaccounts</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>
Click on                   <xhtml:span class="inline_block">CREATE SERVICE ACCOUNT</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>Enter Service Account Details.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CREATE AND CONTINUE</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Within Service Account permissions add the following roles:
                  <xhtml:ul>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">Logs Writer</xhtml:span>
.                    </xhtml:li>
                              <xhtml:li>
                                 <xhtml:span class="inline_block">Monitoring Metric Writer</xhtml:span>
.                    </xhtml:li>
                              <xhtml:li>`Monitoring Viewer.</xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CONTINUE</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>Grant users access to this service account and create keys as required.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">DONE</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Note: A new cluster will need to be created specifying the minimally privileged service account, and workloads will need to be migrated to the new cluster and the old cluster deleted.</xhtml:p>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>To create a minimally privileged service account:</xhtml:p>
                     <xhtml:code class="code_block">
gcloud iam service-accounts create &lt;node_sa_name&gt; --display-name "GKE Node Service Account"                <br/>
export NODE_SA_EMAIL=gcloud iam service-accounts list --format='value(email)' --filter='displayName:GKE Node Service Account'
              </xhtml:code>
                     <xhtml:p>Grant the following roles to the service account:</xhtml:p>
                     <xhtml:code class="code_block">
export PROJECT_ID=gcloud config get-value project                <br/>
gcloud projects add-iam-policy-binding &lt;project_id&gt; --member serviceAccount:&lt;node_sa_email&gt; --role roles/monitoring.metricWriter                <br/>
gcloud projects add-iam-policy-binding &lt;project_id&gt; --member serviceAccount:&lt;node_sa_email&gt; --role roles/monitoring.viewer                <br/>
gcloud projects add-iam-policy-binding &lt;project_id&gt; --member serviceAccount:&lt;node_sa_email&gt; --role roles/logging.logWriter
              </xhtml:code>
                     <xhtml:p>Note: A new cluster will need to be created specifying the minimally privileged service account, and workloads will need to be migrated to the new cluster and the old cluster deleted.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
Instances are automatically granted the                   <xhtml:a href="https://www.googleapis.com/auth/cloud-platform">https://www.googleapis.com/auth/cloud-platform</xhtml:a>
 scope to allow full access to all Google Cloud APIs. This is so that the IAM permissions of the instance are completely determined by the IAM roles of the Service account. Thus if Kubernetes workloads were using cluster access scopes to perform actions using Google APIs, they may no longer be able to, if not permitted by the permissions of the Service account. To remediate, follow recommendation 5.2.2.                </xhtml:p>
                        <xhtml:p>The Service account roles listed here are the minimum required to run the cluster. Additional roles may be required to pull from a private instance of Google Container Registry (GCR).</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5747961" value-id="xccdf_org.cisecurity.benchmarks_value_5747961_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5747961"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.3_Cloud_Key_Management_Service_Cloud_KMS">
         <xccdf:title xml:lang="en">Cloud Key Management Service (Cloud KMS)</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to using Cloud KMS with GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_keys_managed_in_Cloud_KMS" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-managed key in Cloud KMS.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>By default, GKE encrypts customer content stored at rest, including Secrets. GKE handles and manages this default encryption for you without any additional action on your part.</xhtml:p>
               <xhtml:p>Application-layer Secrets Encryption provides an additional layer of security for sensitive data, such as user defined Secrets and Secrets required for the operation of the cluster, such as service account keys, which are all stored in etcd.</xhtml:p>
               <xhtml:p>Using this functionality, you can use a key, that you manage in Cloud KMS, to encrypt data at the application layer. This protects against attackers in the event that they manage to gain access to etcd.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To enable Application-layer Secrets Encryption, several configuration items are required. These include:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>A key ring</xhtml:li>
                        <xhtml:li>A key</xhtml:li>
                        <xhtml:li>
A GKE service account with                   <xhtml:span class="inline_block">Cloud KMS CryptoKey Encrypter/Decrypter</xhtml:span>
 role                </xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>Once these are created, Application-layer Secrets Encryption can be enabled on an existing or new cluster.</xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:p>To create a key</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Cloud KMS by visiting                   <xhtml:a href="https://console.cloud.google.com/security/kms">https://console.cloud.google.com/security/kms</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">CREATE KEY RING</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>Enter a Key ring name and the region where the keys will be stored.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CREATE</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>Enter a Key name and appropriate rotation period within the Create key pane.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CREATE</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>To enable on a new cluster</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CREATE CLUSTER</xhtml:span>
, and choose the required cluster mode.                </xhtml:li>
                        <xhtml:li>
Within the                   <xhtml:span class="inline_block">Security</xhtml:span>
 heading, under                   <xhtml:span class="inline_block">CLUSTER</xhtml:span>
, check                   <xhtml:span class="inline_block">Encrypt secrets at the application layer</xhtml:span>
 checkbox.                </xhtml:li>
                        <xhtml:li>Select the kms key as the customer-managed key and, if prompted, grant permissions to the GKE Service account.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">CREATE</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>To enable on an existing cluster</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Select the cluster to be updated.</xhtml:li>
                        <xhtml:li>Under the Details pane, within the Security heading, click on the pencil named Application-layer secrets encryption.</xhtml:li>
                        <xhtml:li>
Enable                   <xhtml:span class="inline_block">Encrypt secrets at the application layer</xhtml:span>
 and choose a kms key.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE CHANGES</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>To create a key:
Create a key ring:</xhtml:p>
                     <xhtml:code class="code_block">gcloud kms keyrings create &lt;ring_name&gt; --location &lt;location&gt; --project &lt;key_project_id&gt;
</xhtml:code>
                     <xhtml:p>Create a key:</xhtml:p>
                     <xhtml:code class="code_block">gcloud kms keys create &lt;key_name&gt; --location &lt;location&gt; --keyring &lt;ring_name&gt; --purpose encryption --project &lt;key_project_id&gt;
</xhtml:code>
                     <xhtml:p>
Grant the Kubernetes Engine Service Agent service account the                 <xhtml:span class="inline_block">Cloud KMS CryptoKey Encrypter/Decrypter</xhtml:span>
 role:              </xhtml:p>
                     <xhtml:code class="code_block">gcloud kms keys add-iam-policy-binding &lt;key_name&gt; --location &lt;location&gt; --keyring &lt;ring_name&gt; --member serviceAccount:&lt;service_account_name&gt; --role roles/cloudkms.cryptoKeyEncrypterDecrypter --project &lt;key_project_id&gt;
</xhtml:code>
                     <xhtml:p>To create a new cluster with Application-layer Secrets Encryption:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters create &lt;cluster_name&gt; --cluster-version=latest --zone &lt;zone&gt; --database-encryption-key projects/&lt;key_project_id&gt;/locations/&lt;location&gt;/keyRings/&lt;ring_name&gt;/cryptoKeys/&lt;key_name&gt; --project &lt;cluster_project_id&gt;
</xhtml:code>
                     <xhtml:p>To enable on an existing cluster:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters update &lt;cluster_name&gt; --zone &lt;zone&gt; --database-encryption-key projects/&lt;key_project_id&gt;/locations/&lt;location&gt;/keyRings/&lt;ring_name&gt;/cryptoKeys/&lt;key_name&gt; --project &lt;cluster_project_id&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>To use the Cloud KMS CryptoKey to protect etcd in the cluster, the 'Kubernetes Engine Service Agent' Service account must hold the 'Cloud KMS CryptoKey Encrypter/Decrypter' role.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645856" value-id="xccdf_org.cisecurity.benchmarks_value_5645856_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645856"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.4_Cluster_Networking">
         <xccdf:title xml:lang="en">Cluster Networking</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to network security configurations in GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Enable_VPC_Flow_Logs_and_Intranode_Visibility" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Enable VPC Flow Logs and Intranode Visibility</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic within a worker node.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Enabling Intranode Visibility makes intranode pod to pod traffic visible to the networking fabric. With this feature, VPC Flow Logs or other VPC features can be used for intranode traffic.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/intranode-visibility</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/vpc/docs/using-flow-logs</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Enable Intranode Visibility:
Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Select Kubernetes clusters for which intranode visibility is disabled.</xhtml:li>
                        <xhtml:li>
Within the                   <xhtml:span class="inline_block">Details</xhtml:span>
 pane, under the                   <xhtml:span class="inline_block">Network</xhtml:span>
 section, click on the pencil icon named                   <xhtml:span class="inline_block">Edit intranode visibility</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Check the box next to                   <xhtml:span class="inline_block">Enable Intranode visibility</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE CHANGES</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>To enable intranode visibility on an existing cluster, run the following command:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters update &lt;cluster_name&gt; --enable-intra-node-visibility
</xhtml:code>
                     <xhtml:p>Enable VPC Flow Logs:
Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Select Kubernetes clusters for which VPC Flow Logs are disabled.</xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">Nodes</xhtml:span>
 tab.                </xhtml:li>
                        <xhtml:li>Select Node Pool without VPC Flow Logs enabled.</xhtml:li>
                        <xhtml:li>Select an Instance Group within the node pool.</xhtml:li>
                        <xhtml:li>
Select an                   <xhtml:span class="inline_block">Instance Group Member</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Select the                   <xhtml:span class="inline_block">Subnetwork</xhtml:span>
 under Network Interfaces.                </xhtml:li>
                        <xhtml:li>
Click on                   <xhtml:span class="inline_block">EDIT</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Set Flow logs to                   <xhtml:span class="inline_block">On</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Find the subnetwork name associated with the cluster.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">gcloud container clusters describe &lt;cluster_name&gt; --region &lt;cluster_region&gt; --format json | jq '.subnetwork'
</xhtml:code>
                     <xhtml:ol start="2">
                        <xhtml:li>Update the subnetwork to enable VPC Flow Logs.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">gcloud compute networks subnets update &lt;subnet_name&gt; --enable-flow-logs
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Enabling it on existing cluster causes the cluster master and the cluster nodes to restart, which might cause disruption.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5645870" value-id="xccdf_org.cisecurity.benchmarks_value_5645870_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645870"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_Control_Plane_Authorized_Networks_is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Control Plane Authorized Networks is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Enable Control Plane Authorized Networks to restrict access to the cluster's control plane to only an allowlist of authorized IPs.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Authorized networks are a way of specifying a restricted range of IP addresses that are permitted to access your cluster's control plane. Kubernetes Engine uses both Transport Layer Security (TLS) and authentication to provide secure access to your cluster's control plane from the public internet. This provides you the flexibility to administer your cluster from anywhere; however, you might want to further restrict access to a set of IP addresses that you control. You can set this restriction by specifying an authorized network.</xhtml:p>
               <xhtml:p>Control Plane Authorized Networks blocks untrusted IP addresses. Google Cloud Platform IPs (such as traffic from Compute Engine VMs) can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</xhtml:p>
               <xhtml:p>Restricting access to an authorized network can provide additional security benefits for your container cluster, including:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Better protection from outsider attacks: Authorized networks provide an additional layer of security by limiting external, non-GCP access to a specific set of addresses you designate, such as those that originate from your premises. This helps protect access to your cluster in the case of a vulnerability in the cluster's authentication or authorization mechanism.</xhtml:li>
                  <xhtml:li>Better protection from insider attacks: Authorized networks help protect your cluster from accidental leaks of master certificates from your company's premises. Leaked certificates used from outside GCP and outside the authorized IP ranges (for example, from addresses outside your company) are still denied access.</xhtml:li>
               </xhtml:ul>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Select Kubernetes clusters for which Control Plane Authorized Networks is disabled</xhtml:li>
                        <xhtml:li>Within the Details pane, under the Networking heading, click on the pencil icon named Edit control plane authorised networks.</xhtml:li>
                        <xhtml:li>Check the box next to Enable control plane authorised networks.</xhtml:li>
                        <xhtml:li>Click SAVE CHANGES.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>To enable Control Plane Authorized Networks for an existing cluster, run the following sample command changing the IP range for fit your network:</xhtml:p>
                     <xhtml:code class="code_block">
gcloud container clusters update $CLUSTER_NAME --region $REGION --enable-master-authorized-networks --master-authorized-networks 192.168.1.0/24                <br/>
                     </xhtml:code>
                     <xhtml:p>
Along with this, you can list authorized networks using the                 <xhtml:span class="inline_block">--master-authorized-networks</xhtml:span>
 flag which contains a list of up to 20 external networks that are allowed to connect to your cluster's control plane through HTTPS. You provide these networks as a comma-separated list of addresses in CIDR notation (such as                 <xhtml:span class="inline_block">90.90.100.0/24</xhtml:span>
).              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>When implementing Control Plane Authorized Networks, be careful to ensure all desired networks are on the allowlist to prevent inadvertently blocking external access to your cluster's control plane.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5747962" value-id="xccdf_org.cisecurity.benchmarks_value_5747962_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5747962"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.3_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Disable access to the Kubernetes API from outside the node network if it is not required.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Boundary Defense" urn="urn:cisecurity.org:controls:7.0:12"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In a private cluster, the master node has two endpoints, a private and public endpoint. The private endpoint is the internal IP address of the master, behind an internal load balancer in the master's VPC network. Nodes communicate with the master using the private endpoint. The public endpoint enables the Kubernetes API to be accessed from outside the master's VPC network.</xhtml:p>
               <xhtml:p>Although Kubernetes API requires an authorized token to perform sensitive actions, a vulnerability could potentially expose the Kubernetes publically with unrestricted access. Additionally, an attacker may be able to identify the current cluster and Kubernetes API version and determine whether it is vulnerable to an attack. Unless required, disabling public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Once a cluster is created without enabling Private Endpoint only, it cannot be remediated. Rather, the cluster must be recreated.</xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                        </xhtml:li>
                        <xhtml:li>Click CREATE CLUSTER, and choose CONFIGURE for the Standard mode cluster.</xhtml:li>
                        <xhtml:li>Configure the cluster as required then click Networking under CLUSTER in the navigation pane.</xhtml:li>
                        <xhtml:li>Under IPv4 network access, click the Private cluster radio button.</xhtml:li>
                        <xhtml:li>Uncheck the Access control plane using its external IP address checkbox.</xhtml:li>
                        <xhtml:li>In the Control plane IP range textbox, provide an IP range for the control plane.</xhtml:li>
                        <xhtml:li>Configure the other settings as required, and click CREATE.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>
Create a cluster with a Private Endpoint enabled and Public Access disabled by including the                 <xhtml:span class="inline_block">--enable-private-endpoint</xhtml:span>
 flag within the cluster create command:              </xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters create-auto &lt;cluster_name&gt; --location $LOCATION --enable-private-endpoint
</xhtml:code>
                     <xhtml:p>
Setting this flag also requires the setting of                 <xhtml:span class="inline_block">--enable-private-nodes</xhtml:span>
 and                 <xhtml:span class="inline_block">--enable-master-authorized-networks</xhtml:span>
.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>To enable a Private Endpoint, the cluster has to also be configured with private nodes, a private master IP range and IP aliasing enabled.</xhtml:p>
                        <xhtml:p>
If the Private Endpoint flag                   <xhtml:span class="inline_block">--enable-private-endpoint</xhtml:span>
 is passed to the gcloud CLI, or the external IP address undefined in the Google Cloud Console during cluster creation, then all access from a public IP address is prohibited.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5747963" value-id="xccdf_org.cisecurity.benchmarks_value_5747963_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5747963"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.4_Ensure_clusters_are_created_with_Private_Nodes" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure clusters are created with Private Nodes</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Private Nodes are nodes with no public IP addresses. Disable public IP addresses for cluster nodes, so that they only have private IP addresses.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:control title="Boundary Defense" urn="urn:cisecurity.org:controls:7.0:12"/>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Once a cluster is created without enabling Private Nodes, it cannot be remediated. Rather the cluster must be recreated.</xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
.                </xhtml:li>
                        <xhtml:li>Click CREATE CLUSTER.</xhtml:li>
                        <xhtml:li>Configure the cluster as required then click Networking under CLUSTER in the navigation pane.</xhtml:li>
                        <xhtml:li>Under IPv4 network access, click the Private cluster radio button.</xhtml:li>
                        <xhtml:li>Configure the other settings as required, and click CREATE.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>
To create a cluster with Private Nodes enabled, include the                 <xhtml:span class="inline_block">--enable-private-nodes</xhtml:span>
 flag within the cluster create command:              </xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters create &lt;cluster_name&gt; --location $LOCATION --enable-private-nodes
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>To enable Private Nodes, the cluster has to also be configured with a private master IP range and IP Aliasing enabled.</xhtml:p>
                        <xhtml:p>Private Nodes do not have outbound access to the public internet. If you want to provide outbound Internet access for your private nodes, you can use Cloud NAT or you can manage your own NAT gateway.</xhtml:p>
                        <xhtml:p>To access Google Cloud APIs and services from private nodes, Private Google Access needs to be set on Kubernetes Engine Cluster Subnets.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:5747964" value-id="xccdf_org.cisecurity.benchmarks_value_5747964_var"/>
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5747964"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.5_Ensure_use_of_Google-managed_SSL_Certificates" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure use of Google-managed SSL Certificates</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Encrypt traffic to HTTPS load balancers using Google-managed SSL certificates.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Encrypting traffic between users and the Kubernetes workload is fundamental to protecting data sent over the web.</xhtml:p>
               <xhtml:p>
Google-managed SSL Certificates are provisioned, renewed, and managed for domain names. This is only available for HTTPS load balancers created using Ingress Resources, and not TCP/UDP load balancers created using Service of             <xhtml:span class="inline_block">type:LoadBalancer</xhtml:span>
.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/ingress</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
If services of                 <xhtml:span class="inline_block">type:LoadBalancer</xhtml:span>
 are discovered, consider replacing the Service with an Ingress.              </xhtml:p>
                     <xhtml:p>
To configure the Ingress and use Google-managed SSL certificates, follow the instructions as listed at:                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs">https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs</xhtml:a>
.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Google-managed SSL Certificates are less flexible than certificates that are self obtained and managed. Managed certificates support a single, non-wildcard domain. Self-managed certificates can support wildcards and multiple subject alternative names (SANs).</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_AutoPilot_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:5645875"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.5_Authentication_and_Authorization">
         <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to authentication and authorization in GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Manage_Kubernetes_RBAC_users_with_Google_Groups_for_GKE" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Manage Kubernetes RBAC users with Google Groups for GKE</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Cluster Administrators should leverage G Suite Groups and Cloud IAM to assign Kubernetes user roles to a collection of users, instead of to individual emails using only Cloud IAM.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>On- and off-boarding users is often difficult to automate and prone to error. Using a single source of truth for user permissions via G Suite Groups reduces the number of locations that an individual must be off-boarded from, and prevents users gaining unique permissions sets that increase the cost of audit.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/google-groups-rbac</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Follow the G Suite Groups instructions at:                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#google-groups-for-gke">https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#google-groups-for-gke</xhtml:a>
.              </xhtml:p>
                     <xhtml:p>Then, create a cluster with:</xhtml:p>
                     <xhtml:code class="code_block">gcloud container clusters create &lt;cluster_name&gt; --security-group &lt;security_group_name&gt;
</xhtml:code>
                     <xhtml:p>
Finally create                 <xhtml:span class="inline_block">Roles</xhtml:span>
,                 <xhtml:span class="inline_block">ClusterRoles</xhtml:span>
,                 <xhtml:span class="inline_block">RoleBindings</xhtml:span>
, and                 <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 that reference the G Suite Groups.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
When migrating to using security groups, an audit of                   <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 and                   <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 is required to ensure all users of the cluster are managed using the new groups and not individually.                </xhtml:p>
                        <xhtml:p>
When managing                   <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 and                   <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
, be wary of inadvertently removing bindings required by service accounts.                </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.6_Storage">
         <xccdf:title xml:lang="en">Storage</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to security-related configurations for storage in GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Enable_Customer-Managed_Encryption_Keys_CMEK_for_GKE_Persistent_Disks_PD" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Enable Customer-Managed Encryption Keys (CMEK) for GKE Persistent Disks (PD)</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Use Customer-Managed Encryption Keys (CMEK) to encrypt dynamically-provisioned attached Google Compute Engine Persistent Disks (PDs) using keys managed within Cloud Key Management Service (Cloud KMS).</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>GCE persistent disks are encrypted at rest by default using envelope encryption with keys managed by Google. For additional protection, users can manage the Key Encryption Keys using Cloud KMS.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/compute/docs/disks/customer-managed-encryption</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/security/encryption-at-rest/default-encryption/</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes</xccdf:ident>
            <xccdf:ident system="URL">https://cloud.google.com/sdk/gcloud/reference/container/node-pools/create</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>This cannot be remediated by updating an existing cluster. The node pool must either be recreated or a new cluster created.</xhtml:p>
                     <xhtml:p>Using Google Cloud Console:</xhtml:p>
                     <xhtml:p>This is not possible using Google Cloud Console.</xhtml:p>
                     <xhtml:p>Using Command Line:</xhtml:p>
                     <xhtml:p>
Follow the instructions detailed at:                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek">https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek</xhtml:a>
.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Encryption of dynamically-provisioned attached disks requires the use of the self-provisioned Compute Engine Persistent Disk CSI Driver v0.5.1 or higher.</xhtml:p>
                        <xhtml:p>If CMEK is being configured with a regional cluster, the cluster must run GKE 1.14 or higher.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.7_Other_Cluster_Configurations">
         <xccdf:title xml:lang="en">Other Cluster Configurations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations relating to any remaining security-related cluster configurations in GKE.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Enable_Security_Posture" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Enable Security Posture</xccdf:title>
            <xccdf:description xml:lang="en"/>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Utilize Automated Software Inventory Tools" urn="urn:cisecurity.org:controls:8.0:2:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Implement Automated Configuration Monitoring Systems" urn="urn:cisecurity.org:controls:7.0:5:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The security posture dashboard provides insights about your workload security posture at the runtime phase of the software delivery life-cycle.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/about-security-posture-dashboard</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Enable security posture via the UI, gCloud or API.                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/protect-workload-configuration">https://cloud.google.com/kubernetes-engine/docs/how-to/protect-workload-configuration</xhtml:a>
                     </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
GKE security posture configuration auditing checks your workloads against a set of defined best practices. Each configuration check has its own impact or risk. Learn more about the checks:                   <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/concepts/about-configuration-scanning">https://cloud.google.com/kubernetes-engine/docs/concepts/about-configuration-scanning</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Example: The host namespace check identifies pods that share host namespaces. Pods that share host namespaces allow Pod processes to communicate with host processes and gather host information, which could lead to a container escape</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
<ds:DigestValue>aT4PFgIlIdNk9coWjQl/gZIrgSGceWBc8dyV8MBrOSc=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
iFbHM5yJx6aHcp4dd0w/Fh+tPXN8nBva1gATQdpKqwfA684bzybnEvZ0s0U9E0puC+r9Kq2SifvS
4TwzN85oLldR8fxYFfdt0F5krfQQWZ+9MZuJgOP5slODfgGfm+UiLlDsH5r3kz3PSqreMdE25YqL
/aU0NUloACU6/RqkmpGCTkPQDhO5KOZje8QoofUdHEh5OQ8Ya1kGHFZ5qMzVSHstD/JiuVOMoSH1
12umFjprA0wSyThUvs9g+TY1cB65FsXWTkNgp/imwNf+GiQdlr8IoI5DX/vDQqcuUiQWSf55HV5q
J+4C4aTlZUTHA4h4aFmcxLEnXKuA7cKHX3ZN1Qd/2WYqYQsW4DiAq6vq7sx7e/3Pk0INAMwXgf4D
p9cjOXYFe9OXnXeRs1aUjzLyr7hplbcKtC7iSUQoQU5PFs/5q93ROshYGxGioW5yA0+EngEUVYwb
/1ETT35H0JSMlxtw/wxoeB/9vI9oR3pLubiwckJ9YiwQNfu+euA0ncoH
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>