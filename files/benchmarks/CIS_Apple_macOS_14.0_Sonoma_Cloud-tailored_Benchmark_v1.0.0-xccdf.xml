<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2024-05-15">interim</xccdf:status>
   <xccdf:title xml:lang="en">CIS Apple macOS 14.0 Sonoma Cloud-tailored Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>
This document, CIS Apple macOS 14.0 Sonoma Cloud-tailored Benchmark, provides prescriptive guidance for establishing a secure configuration posture for Apple macOS 14.0 Sonoma running on a cloud platform. This guide was tested against Apple macOS 14.0 Sonoma. To obtain the latest version of this guide, please visit       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>
.    </xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <xccdf:platform idref="cpe:2.3:o:apple:mac_os_x:14.0.0:*:*:*:*:*:*:*"/>
   <xccdf:version>1.0.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
      <xccdf:title xml:lang="en">Level 1</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Install_of_macOS_Updates_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_Install_Application_Updates_from_the_App_Store_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_Security_Responses_and_System_Files_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Firewall_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1.1_Ensure_Set_Time_and_Date_Automatically_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2.1_Ensure_Screen_Sharing_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2.2_Ensure_Remote_Apple_Events_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_Limit_Ad_Tracking_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_Gatekeeper_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Require_Password_After_Screen_Saver_Begins_or_Display_Is_Turned_Off_Is_Enabled_for_5_Seconds_or_Immediately" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Show_Password_Hints_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Ensure_Guest_Account_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Ensure_Automatic_Login_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Signed_System_Volume_SSV_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Folders_Exist_in_the_System_Folder" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_the_Guest_Home_Folder_Does_Not_Exist" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_XProtect_Is_Running_and_Updated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
      <xccdf:title xml:lang="en">Level 2</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Install_of_macOS_Updates_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_Install_Application_Updates_from_the_App_Store_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_Security_Responses_and_System_Files_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Firewall_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1.1_Ensure_Set_Time_and_Date_Automatically_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2.1_Ensure_Screen_Sharing_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2.2_Ensure_Remote_Apple_Events_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2.3_Ensure_Content_Caching_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_Sending_Diagnostic_and_Usage_Data_to_Apple_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_Limit_Ad_Tracking_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_Gatekeeper_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Require_Password_After_Screen_Saver_Begins_or_Display_Is_Turned_Off_Is_Enabled_for_5_Seconds_or_Immediately" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Show_Password_Hints_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Ensure_Guest_Account_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Ensure_Automatic_Login_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_Security_Auditing_Flags_For_User-Attributable_Events_Are_Configured_Per_Local_Organizational_Requirements" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Bonjour_Advertising_Services_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Signed_System_Volume_SSV_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Folders_Exist_in_the_System_Folder" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_No_World_Writable_Folders_Exist_in_the_Library_Folder" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_Complex_Password_Must_Contain_Alphabetic_Characters_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_Complex_Password_Must_Contain_Numeric_Character_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_Complex_Password_Must_Contain_Special_Character_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_Complex_Password_Must_Contain_Uppercase_and_Lowercase_Characters_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_a_Login_Window_Banner_Exists" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_the_Guest_Home_Folder_Does_Not_Exist" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_XProtect_Is_Running_and_Updated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" selected="true"/>
   </xccdf:Profile>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Install_Updates_Patches_and_Additional_Security_Software">
      <xccdf:title xml:lang="en">Install Updates, Patches and Additional Security Software</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Install Updates, Patches and Additional Security Software</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure All Apple-provided Software Is Current</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.</xhtml:p>
            <xhtml:p>Software updates should be run at minimum every 30 days. Run the following command to verify when software update was previously run:</xhtml:p>
            <xhtml:p>
               <xhtml:span class="inline_block">$ /usr/bin/sudo defaults read /Library/Preferences/com.apple.SoftwareUpdate | grep -e LastFullSuccessfulDate</xhtml:span>
.        </xhtml:p>
            <xhtml:p>
The response should be in the last 30 days (          <xhtml:em>Example</xhtml:em>
):           <xhtml:span class="inline_block">LastFullSuccessfulDate = "2020-07-30 12:45:25 +0000";</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-40r4.pdf</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to verify what packages need to be installed:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/softwareupdate -l 
</xhtml:code>
                  <xhtml:p>
The output will include the following:
              <xhtml:span class="inline_block">Software Update found the following new or updated software:</xhtml:span>
                  </xhtml:p>
                  <xhtml:p>Run the following command to install all the packages that need to be updated:</xhtml:p>
                  <xhtml:p>To install all updates run the command:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/softwareupdate -i -a
</xhtml:code>
                  <xhtml:p>Or run the following command to install individual packages:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/softwareupdate -i '&lt;package name&gt;'
</xhtml:code>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 If one of the software updates listed includes               <xhtml:span class="inline_block">Action: restart</xhtml:span>
, then you must attach the               <xhtml:span class="inline_block">-R</xhtml:span>
 flag to force a system restart. If the system update is complete but no restart occurs, then the system is in an unknown state that requires a future restart. It is advised to run updates and forced restarts during system downtime and not while in active use.            </xhtml:p>
                  <xhtml:p>
                     <xhtml:em>example:</xhtml:em>
                  </xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/softwareupdate -l               <br/>
                     <br/>
Software Update Tool              <br/>
                     <br/>
Finding available software              <br/>
Software Update found the following new or updated software:              <br/>
* Label: ProVideoFormats-2.2.7              <br/>
	Title: Pro Video Formats, Version: 2.2.7, Size: 9693KiB, Recommended: YES,               <br/>
* Label: Command Line Tools for Xcode-15.0              <br/>
	Title: Command Line Tools for Xcode, Version: 15.0, Size: 721962KiB, Recommended: YES,               <br/>
                     <br/>
% /usr/bin/sudo /usr/sbin/softwareupdate -i 'ProVideoFormats-2.2.7'              <br/>
                     <br/>
Software Update Tool              <br/>
                     <br/>
Finding available software              <br/>
Attempting to quit apps: (              <br/>
    "com.apple.Compressor"              <br/>
)              <br/>
Waiting for user to quit any relevant apps              <br/>
Successfully quit all apps              <br/>
                     <br/>
Downloaded Pro Video Formats              <br/>
Installing Pro Video Formats              <br/>
Done with Pro Video Formats              <br/>
Done.
            </xhtml:code>
                  <xhtml:p>
In the above example, if a restart was required, the command to remediate would be               <xhtml:span class="inline_block">/usr/bin/sudo /usr/sbin/softwareupdate -i 'ProVideoFormats-2.2.7' -R</xhtml:span>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Installation of updates can be disruptive to the users especially if a restart is required. Major updates need to be applied after creating an organizational patch policy. It is also advised to run updates and forced restarts during system downtime and not while in active use.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_software_update_current.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Auto Update Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Auto Update verifies that your system has the newest security patches and software updates. If "Automatically check for updates" is not selected, background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.</xhtml:p>
            <xhtml:p>
               <xhtml:a href="http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/">http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/">https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to enable auto update:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true  
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Without automatic update, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_auto_update.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Download New Updates When Available Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>In the GUI, both "Install macOS updates" and "Install app updates from the App Store" are dependent on whether "Download new updates when available" is selected.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is important that a system has the newest updates downloaded so that they can be applied.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to enable auto update:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool true  
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If "Download new updates when available" is not selected, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_auto_download.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Install_of_macOS_Updates_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Install of macOS Updates Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off simply to allow the administrator to contact users in order to verify installation. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to to enable automatic checking and installing of macOS updates:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates -bool TRUE
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_update_os.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_Install_Application_Updates_from_the_App_Store_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Install Application Updates from the App Store Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to turn on App Store auto updating:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_cloud_appstore.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_Security_Responses_and_System_Files_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Install Security Responses and System Files Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights.</xhtml:p>
            <xhtml:p>Apple has introduced a security feature that allows for smaller downloads and the installation of security updates when a reboot is not required. This feature is only available when the last regular update has already been applied. This feature emphasizes that a Mac must be up-to-date on patches so that Apple's security tools can be used to quickly patch when a rapid response is necessary.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Remediate Detected Vulnerabilities" urn="urn:cisecurity.org:controls:8.0:7:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Respond</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://eclecticlight.co/2021/10/27/silently-updated-security-data-files-in-monterey/</xccdf:ident>
         <xccdf:ident system="URL">https://support.apple.com/en-us/HT202491</xccdf:ident>
         <xccdf:ident system="URL">https://support.apple.com/guide/security/protecting-against-malware-sec469d47bd8/web</xccdf:ident>
         <xccdf:ident system="URL">https://support.apple.com/guide/deployment/rapid-security-responses-dep93ff7ea78/1/web/1.0</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following commands to enable automatic checking of system data files and security updates:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo  /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true               <br/>
                     <br/>
% /usr/bin/sudo  /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_security_system_download.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_System_Settings">
      <xccdf:title xml:lang="en">System Settings</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>
This section contains recommendations related to configurable options in the         <xhtml:span class="inline_block">System Settings</xhtml:span>
 application.      </xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Network">
         <xccdf:title xml:lang="en">Network</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">Network</xhtml:span>
               <xhtml:span class="inline_block">System Settings</xhtml:span>
 pane includes the firewall settings. macOS has a built-in firewall that has two main configuration aspects. Both the Application Layer Firewall (ALF) and the Packet Filter Firewall (PF) can be used to secure running ports and services on a Mac. The Application Firewall is the one accessible in System Preferences under Security. The PF firewall contains many more capabilities than ALF, but also requires a greater understanding of firewall recipes and rule configurations. For standard use cases on a Mac, the PF firewall is not necessary. macOS may expose server services that are reachable remotely, but that is not the primary use case or design. If custom use cases are required, the PF firewall can provide additional security. Macs that are used as mobile desktops do not need to use the PF firewall capabilities unless permanently open ports need to be protected with more granular IP access controls.        </xhtml:p>
            <xhtml:p>
               <xhtml:strong>Additional information</xhtml:strong>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://www.muo.com/tag/mac-really-need-firewall/">https://www.muo.com/tag/mac-really-need-firewall/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://blog.neilsabol.site/post/quickly-easily-adding-pf-packet-filter-firewall-rules-macos-osx/">https://blog.neilsabol.site/post/quickly-easily-adding-pf-packet-filter-firewall-rules-macos-osx/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="http://marckerr.com/a-simple-guild-to-the-mac-pf-firewall/">http://marckerr.com/a-simple-guild-to-the-mac-pf-firewall/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/">https://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Firewall_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Firewall Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Centralize Security Event Alerting" urn="urn:cisecurity.org:controls:8.0:13:1">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Implement Application Firewalls" urn="urn:cisecurity.org:controls:7.0:9:5">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A firewall minimizes the threat of unauthorized users gaining access to your system while connected to a network or the Internet.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://support.apple.com/en-us/guide/security/seca0e83763f/web</xccdf:ident>
            <xccdf:ident system="URL">http://support.apple.com/en-us/HT201642</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable the firewall:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.alf globalstate -int &lt;value&gt;
</xhtml:code>
                     <xhtml:p>
For the                 <xhtml:span class="inline_block">&lt;value&gt;</xhtml:span>
, use either                 <xhtml:span class="inline_block">1</xhtml:span>
, specific services, or                 <xhtml:span class="inline_block">2</xhtml:span>
, essential services only.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The firewall may block legitimate traffic. Applications that are unsigned will require special handling.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_firewall_enable.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Firewall Stealth Mode Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>While in Stealth mode, the computer will not respond to unsolicited probes, dropping that traffic.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Stealth mode on the firewall minimizes the threat of system discovery tools while connected to a network or the Internet.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">http://support.apple.com/en-us/HT201642</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable stealth mode:</xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on                <br/>
                        <br/>
Stealth mode enabled
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Traditional network discovery tools like ping will not succeed. Other network tools that measure activity and approved applications will work as expected.</xhtml:p>
                        <xhtml:p>This control aligns with the primary macOS use case of a laptop that is often connected to untrusted networks where host segregation may be non-existent. In that use case, hiding from the other inmates is likely more than desirable. In use cases where use is only on trusted LANs with static IP addresses, stealth mode may not be desirable.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_firewall_stealth.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_General">
         <xccdf:title xml:lang="en">General</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2.1_Date__Time">
            <xccdf:title xml:lang="en">Date &amp; Time</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
This section contains recommendations related to the configurable items under the             <xhtml:span class="inline_block">Date &amp; Time</xhtml:span>
 panel.          </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1.1_Ensure_Set_Time_and_Date_Automatically_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Set Time and Date Automatically Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.</xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required, use the Date &amp; Time System Preference with each server separated by a space.            </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Additional Note:</xhtml:strong>
 The default Apple time server is time.apple.com. Variations include time.euro.apple.com. While it is certainly more efficient to use internal time servers, there is no reason to block access to global Apple time servers or to add a time.apple.com alias to internal DNS records. There are no reports that Apple gathers any information from NTP synchronization, as the computers already phone home to Apple for Apple services including iCloud use and software updates. Best practice is to allow DNS resolution to an authoritative time service for time.apple.com, preferably to connect to Apple servers, but local servers are acceptable as well.            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>
To learn more about                 <xhtml:span class="inline_block">timed</xhtml:span>
, read:                 <xhtml:a href="https://eclecticlight.co/2017/10/27/has-anyone-got-the-time-how-high-sierra-has-changed-time-synchronisation/">Has anyone got the time? How High Sierra has changed time synchronisation</xhtml:a>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following commands to enable the date and time setting automatically:</xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver &lt;your.time.server&gt;                  <br/>
                           <br/>
setNetworkTimeServer: &lt;your.time.server&gt;                  <br/>
                           <br/>
% /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on                  <br/>
                           <br/>
setUsingNetworkTime: On
                </xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>
:                </xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver time.apple.com                  <br/>
                           <br/>
setNetworkTimeServer: time.apple.com                  <br/>
                           <br/>
% /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on                  <br/>
                           <br/>
setUsingNetworkTime: On
                </xhtml:code>
                        <xhtml:p>Run the following commands if you have not set, or need to set, a new time zone:</xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -listtimezones                  <br/>
                           <br/>
% /usr/bin/sudo /usr/sbin/systemsetup -settimezone &lt;selected time zone&gt;                  <br/>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>
:                </xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -listtimezones                  <br/>
                           <br/>
Time Zones:                  <br/>
 Africa/Abidjan                  <br/>
 Africa/Accra                  <br/>
 Africa/Addis_Ababa                  <br/>
 ...                  <br/>
                           <br/>
                           <br/>
% /usr/bin/sudo /usr/sbin/systemsetup -settimezone America/New_York                  <br/>
                           <br/>
Set TimeZone: America/New_York
                </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>
The                     <xhtml:span class="inline_block">timed</xhtml:span>
 service will periodically synchronize with named time servers and will make the computer time more accurate.                  </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5359971"/>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Time Is Set Within Appropriate Limits</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds. For this audit, a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of macOS integration into Directory systems, the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time, this check is not strict, so it may be too great for your organization. Your organization can adjust to a smaller offset value as needed.</xhtml:p>
                  <xhtml:p>If there are consistent drift issues on the OS, some of the most common drift issues should be investigated:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
                        <xhtml:p>The chosen time server is not reachable based on network firewall rules on the current network</xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>The computer is offline often and the battery drains, and the network is not immediately available</xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>The chosen time server is a special internal or non-public time server that does not provide a reliable time source</xhtml:p>
                     </xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
                     <xhtml:span class="inline_block">ntpdate</xhtml:span>
 has been deprecated with 10.14.               <xhtml:span class="inline_block">sntp</xhtml:span>
 replaces that command.            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>The associated check will fail if no network connection is available.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following commands to ensure your time is set within an appropriate limit:</xhtml:p>
                        <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver    
</xhtml:code>
                        <xhtml:p>
The output will include                   <xhtml:span class="inline_block">Network Time Server: </xhtml:span>
 and the name of your time server
                  <xhtml:em>example</xhtml:em>
:                   <xhtml:span class="inline_block">Network Time Server: time.apple.com</xhtml:span>
.                </xhtml:p>
                        <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/sntp -sS &lt;your.time.server&gt;
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>
:                </xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver                  <br/>
                           <br/>
Network Time Server: time.apple.com                  <br/>
                           <br/>
% /usr/bin/sudo /usr/bin/sntp -sS time.apple.com
                </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Accurate time is required for many computer functions.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"/>
                     <check-content-ref href="sce/macOS_time_server_sync.sh"/>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2.2_Sharing">
            <xccdf:title xml:lang="en">Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
This section contains recommendations related to the configurable items under the             <xhtml:span class="inline_block">Sharing</xhtml:span>
 panel. The expectation is that no in-bound or out-bound service is directly accessible to the internet. Macs in this environment are expected to be subject to several layers of access control, firewalls, and authorizations to use essential services.          </xhtml:p>
               <xhtml:p>
Services like             <xhtml:span class="inline_block">Remote Login</xhtml:span>
,             <xhtml:span class="inline_block">Screen Sharing</xhtml:span>
, and             <xhtml:span class="inline_block">Remote Management (ARD)</xhtml:span>
 that are normally disabled in the CIS macOS Benchmarks are services that may be required for standard usage in a cloud platform environment.          </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2.1_Ensure_Screen_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Screen Sharing Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Screen Sharing allows a computer to connect to another computer on a network and display the computers screen. While sharing the computers screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.</xhtml:p>
                  <xhtml:p>While mature administration and management does not use graphical connections for standard maintenance, most help desks have capabilities to assist users in performing their work when they have technical issues and need support. Help desks use graphical remote tools to understand what the user sees and assist them so they can get back to work. For MacOS, some of these remote capabilities can use Apple's OS tools. Control is therefore not meant to prohibit the use of a just-in-time graphical view from authorized personnel with authentication controls. Sharing should not be enabled except in narrow windows when help desk support is required.</xhtml:p>
                  <xhtml:p>Screen Sharing on macOS can allow the use of the insecure VNC protocol. VNC is a clear text protocol that should not be used on macOS.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Disabling Screen Sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/turn-screen-sharing-on-or-off-mh11848/mac</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following command to turn off Screen Sharing:</xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing                  <br/>
                           <br/>
% /usr/bin/sudo /bin/launchctl bootout system/com.apple.screensharing
                </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Help desks may require the periodic use of a graphical connection mechanism to assist users. Any support that relies on native MacOS components will not work unless a scripted solution to enable and disable sharing as neccessary.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"/>
                     <check-content-ref href="sce/macOS_screensharing.sh"/>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2.2_Ensure_Remote_Apple_Events_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Remote Apple Events Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Disabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following commands to set Remote Apple Events to Off:</xhtml:p>
                        <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/systemsetup -setremoteappleevents off                   <br/>
                           <br/>
setremoteappleevents: Off
                </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>With remote Apple events turned on, an AppleScript program running on another Mac can interact with the local computer.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5359976"/>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2.3_Ensure_Content_Caching_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Content Caching Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Starting with 10.13 (macOS High Sierra), Apple introduced a service to make it easier to deploy data from Apple, including software updates, where there are bandwidth constraints to the Internet and fewer constraints or greater bandwidth exist on the local subnet. This capability can be very valuable for organizations that have throttled and possibly metered Internet connections. In heterogeneous enterprise networks with multiple subnets, the effectiveness of this capability would be determined by how many Macs were on each subnet at the time new, large updates were made available upstream.
This capability requires the use of mac OS clients as P2P nodes for updated Apple content. Unless there is a business requirement to manage operational Internet connectivity and bandwidth, user endpoints should not store content and act as a cluster to provision data.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-us/HT204675">Content types supported by Content Caching in macOS</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"/>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The main use case for Mac computers is as mobile user endpoints. P2P sharing services should not be enabled on laptops that are using untrusted networks. Content Caching can allow a computer to be a server for local nodes on an untrusted network. While there are certainly logical controls that could be used to mitigate risk, they add to the management complexity. Since the value of the service is in specific use cases, organizations with the use case described above can accept risk as necessary.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
               <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/about-content-caching-mchl9388ba1b/</xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/set-up-content-caching-on-mac-mchl3b6c3720/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following command to disable Content Caching:</xhtml:p>
                        <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/AssetCacheManagerUtil deactivate
</xhtml:code>
                        <xhtml:p>
The output will include                   <xhtml:span class="inline_block">Content caching deactivated</xhtml:span>
                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This setting will adversely affect bandwidth usage between local subnets and the Internet.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"/>
                     <check-content-ref href="sce/macOS_content_caching.sh"/>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.3_Privacy__Security">
         <xccdf:title xml:lang="en">Privacy &amp; Security</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
This section contains recommendations for configurable options under the           <xhtml:span class="inline_block">Privacy &amp; Security</xhtml:span>
 panel.        </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://support.apple.com/en-ca/guide/mac-help/mh32356/mac">Additional privacy preference information from Apple</xhtml:a>
            </xhtml:p>
            <xhtml:p>If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the Mac should be configured appropriately for the sensitive area.</xhtml:p>
            <xhtml:p>Camera:
If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area.</xhtml:p>
            <xhtml:p>Microphone:
If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the microphone input should be set to zero in the input tab of the Sound preference pane at those times. Individual management of applications with access to the microphone may be managed in the Security &amp; Privacy Preference Pane under Microphone.</xhtml:p>
            <xhtml:p>WiFi and Bluetooth:
Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are often specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that may include disabling the wireless capability in either software or hardware, or both. Wireless access is part of the feature set required for mobile computers and is considered essential for most users.</xhtml:p>
            <xhtml:p>
Malware is continuously discovered that circumvents the privacy controls of the built-in video, audio, or network capabilities. No computer has perfect security, and even if all the drivers are disabled or removed, working drivers can be reintroduced by a determined attacker.
Additional info
          <xhtml:a href="https://threatpost.com/apple-bug-bounty-mac-webcam-hack/178114/">Apple Pays $100.5K Bug Bounty for Mac Webcam Hack</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://www.tomsguide.com/news/zoom-mac-microphone-listening">Mac users, update Zoom now  your microphone may be spying on you</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://support.apple.com/en-vn/HT202068">Recommended settings for Wi-Fi routers and access points</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://support.apple.com/guide/mac-help/control-access-to-the-microphone-on-mac-mchla1b1e1fe/mac">Control access to the microphone on Mac</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://support.apple.com/guide/security/bluetooth-security-sec82597d97e/web">Bluetooth security</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_Sending_Diagnostic_and_Usage_Data_to_Apple_Is_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Sending Diagnostic and Usage Data to Apple Is Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple provides a mechanism to send diagnostic and analytics data back to Apple to help them improve the platform. Information sent to Apple may contain internal organizational information that should be controlled and not available for processing by Apple.
Turn off all Analytics and Improvements sharing.</xhtml:p>
               <xhtml:p>Share Mac Analytics (Share with App Developers dependent on Mac Analytic sharing)</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Includes diagnostics, usage and location data</xhtml:li>
               </xhtml:ul>
               <xhtml:p>Share iCloud Analytics</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Includes iCloud data and usage information</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Organizations should have knowledge of what is shared with the vendor and that this setting automatically forwards information to Apple.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/mac-help/mh27990/mac</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following commands to disable the sending of diagnostic data to Apple:</xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/defaults write /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist AutoSubmit -bool false                <br/>
                        <br/>
/usr/bin/sudo /usr/bin/defaults write /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist ThirdPartyDataSubmit -bool false                <br/>
                        <br/>
% /usr/bin/sudo /bin/chmod 644 /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist                <br/>
                        <br/>
% /usr/bin/sudo /usr/bin/chgrp admin /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist                <br/>
                        <br/>
% /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.assistant.support "Siri Data Sharing Opt-In Status" -int 2
              </xhtml:code>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5542329"/>
               </check>
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_diagnostic_data.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_Limit_Ad_Tracking_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Limit Ad Tracking Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer to see advertising that is relevant to them and their interests, the detailed information that is collected, correlated, and available to advertisers in repositories via data mining is often disconcerting. This information is valuable to both advertisers and attackers, and has been used with other metadata to reveal users' identities.</xhtml:p>
               <xhtml:p>Organizations should manage advertising settings on computers rather than allow users to configure the settings.</xhtml:p>
               <xhtml:p>
                  <xhtml:a href="https://support.apple.com/en-us/HT205223">Apple Information</xhtml:a>
               </xhtml:p>
               <xhtml:p>Ad tracking should be limited on 10.15 and prior.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Organizations should manage user privacy settings on managed devices to align with organizational policies and user data protection requirements.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>For each needed user, run the following command to enable limited ad tracking:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.Adlib.plist allowApplePersonalizedAdvertising -bool false
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Uses will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5359979"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_Gatekeeper_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Gatekeeper Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Gatekeeper is Apples application that utilizes allowlisting to restrict downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization. In an update to Gatekeeper in macOS 13 Ventura, Gatekeeper checks every application on every launch, not just quarantined apps.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Deploy and Maintain Anti-Malware Software" urn="urn:cisecurity.org:controls:8.0:10:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Configure Automatic Anti-Malware Signature Updates" urn="urn:cisecurity.org:controls:8.0:10:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure Anti-Malware Software and Signatures are Updated" urn="urn:cisecurity.org:controls:7.0:8:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Configure Anti-Malware Scanning of Removable Devices" urn="urn:cisecurity.org:controls:7.0:8:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Detect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable Gatekeeper to allow applications from App Store and identified developers:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/spctl --master-enable
</xhtml:code>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5359980"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.4_Lock_Screen">
         <xccdf:title xml:lang="en">Lock Screen</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure an Inactivity Interval of 20 Minutes Or Less for the Screen Saver Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A locking screen saver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS, the screen saver starts after a value is selected in the drop-down menu. 20 minutes or less is an acceptable value. Any value can be selected through the command line or script, but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting an inactivity interval for the screen saver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to verify that the idle time of the screen saver to 20 minutes of less (1200)</xhtml:p>
                     <xhtml:code class="code_block">% sudo -u &lt;username&gt; defaults -currentHost write com.apple.screensaver idleTime -int &lt;value 1200&gt;
</xhtml:code>
                     <xhtml:p>
                        <xhtml:em>Note:</xhtml:em>
 Issues arise if the command line is used to make the setting something other than what is available in the GUI Menu. The GUI allows the options of 1 (60), 2 (120), 5 (300), 10 (600), or 20 (120) minutes, so use one of those values to avoid any issues.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If the screen saver is not set, users may leave the computer available for an unauthorized person to access information.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_inactivity_interval_screen_saver.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Require_Password_After_Screen_Saver_Begins_or_Display_Is_Turned_Off_Is_Enabled_for_5_Seconds_or_Immediately" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Require Password After Screen Saver Begins or Display Is Turned Off Is Enabled for 5 Seconds or Immediately</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Sleep and screen saver modes are low power modes that reduce electrical consumption while the system is not in use.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>This only protects the system when the screen saver is running.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Prompting for a password when waking from sleep or screen saver mode mitigates the threat of an unauthorized person gaining access to a system in the user's absence.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://blog.kolide.com/screensaver-security-on-macos-10-13-is-broken-a385726e2ae2</xccdf:ident>
            <xccdf:ident system="URL">https://github.com/rtrouton/profiles/blob/master/SetDefaultScreensaver/SetDefaultScreensaver.mobileconfig</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to require a password to unlock the computer after the screen saver engages or the computer sleeps:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/sysadminctl -screenLock immediate -password &lt;administrator password&gt;
</xhtml:code>
                     <xhtml:p>or</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/sysadminctl -screenLock 5 seconds -password &lt;administrator password&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Without a screenlock in place, anyone with physical access to the computer would be logged in and able to use the active user's session.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_wake_password.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure a Custom Message for the Login Screen Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable a custom login screen message:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText -string "&lt;custom message&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If users are not informed of their responsibilities, unapproved activities may occur. Users that are not approved for access may take the lack of a warning banner as implied consent to access.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_login_message.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Login Window Displays as Name and Password Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The login window prompts a user for his/her credentials, verifies their authorization level, and then allows or denies the user access to the system.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Prompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable the login window to display name and password:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow SHOWFULLNAME -bool true
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>
 The GUI will not display the updated setting until the current user(s) logs out.              </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_login_show_fullname.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Show_Password_Hints_Is_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Show Password Hints Is Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Password hints are user-created text displayed when an incorrect password is used for an account.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Password hints make it easier for unauthorized persons to gain access to systems by displaying information provided by the user to assist in remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to disable password hints:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow RetriesUntilHint -int 0
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The user can set the hint to any value, including the password itself or clues that allow trivial social engineering attacks.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_show_password_hints.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5_Login_Password">
         <xccdf:title xml:lang="en">Login Password</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">Touch ID &amp; Password</xhtml:span>
               <xhtml:span class="inline_block">System Settings</xhtml:span>
 pane is named           <xhtml:span class="inline_block">Login Password</xhtml:span>
 on Macs that do not have Touch ID and does not contain any details about Touch ID.        </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Users' Accounts Do Not Have a Password Hint</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>Organizations might consider entering an organizational help desk phone number or other text (such as a warning to the user). A help desk number is only appropriate for organizations with trained help desk personnel that are validating user identities for password resets.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Password hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to remove a user's password hint:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/&lt;username&gt; hint
</xhtml:code>
                     <xhtml:p>
                        <xhtml:em>example</xhtml:em>
:              </xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/firstuser hint                <br/>
                        <br/>
% /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/seconduser hint
              </xhtml:code>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_no_password_hints.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.6_Users__Groups">
         <xccdf:title xml:lang="en">Users &amp; Groups</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Account management is a central part of security for any computer system, including macOS. General practices should be followed to ensure that all accounts on a system are still needed, and that default accounts have been removed. Users with administrator roles should have distinct accounts for both administrator functions as well as day-to-day work where the passwords are different and known only by the user assigned to the account. Accounts with elevated privileges should not be easily discerned from the account name from standard accounts.</xhtml:p>
            <xhtml:p>When any computer system is added to a directory system there are additional controls available, including user account management, that are not available in a standalone computer. One of the drawbacks is the local computer is no longer in control of the accounts that can access or manage it if given permission. For macOS, if the computer is connected to a directory, any standard user can now log into the computer at console, which by default may be desirable or not depending on the use case. If an administrator group is allowed to administer the local computer, the membership of that group is controlled completely in the directory.</xhtml:p>
            <xhtml:p>macOS computers connected to a directory should be configured so that the risk is appropriate for the mission use of the computer. Only those accounts that require local authentication should be allowed, and only required administrator accounts should be in the local administrator group. Authenticated users for console access and domain admins for administration may be too broad or too limited.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Ensure_Guest_Account_Is_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Guest Account Is Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes and cannot remotely login to the system. All files, caches, and passwords created by the guest user are deleted upon logging out.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>By default, the guest account is enabled for access to sharing services but is not allowed to log into the computer.</xhtml:p>
                  <xhtml:p>The guest account does not need a password when it is enabled to log into the computer.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to disable the guest account:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool false
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>A guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5542322"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Guest Access to Shared Folders Is Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following commands to verify that shared folders are not accessible to guest users:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/sysadminctl -smbGuestAccess off
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Unauthorized users could access shared files on the system.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_guest_sharing.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Ensure_Automatic_Login_Is_Disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Automatic Login Is Disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The automatic login feature saves a user's system access credentials and bypasses the login screen. Instead, the system automatically loads to the user's desktop screen.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling automatic login decreases the likelihood of an unauthorized person gaining access to a system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to disable automatic login:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If automatic login is not disabled, an unauthorized user could gain access to the system without supplying any credentials.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_disable_automatic_login.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging_and_Auditing">
      <xccdf:title xml:lang="en">Logging and Auditing</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section provides guidance on configuring the logging and auditing facilities available in macOS. Starting with macOS 10.12, Apple introduced unified logging. This capability replaces the previous logging methodology with centralized, system-wide common controls. A full explanation of macOS logging behavior is beyond the scope of this Benchmark. These changes impact previous logging controls from macOS Benchmarks. At this point, many of the syslog controls have been or are being removed since the old logging methods have been deprecated. Controls that still appear useful will be retained. Some legacy controls have been removed for this release.</xhtml:p>
         <xhtml:p>More info:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>
               <xhtml:a href="https://developer.apple.com/documentation/os/logging">https://developer.apple.com/documentation/os/logging</xhtml:a>
            </xhtml:li>
            <xhtml:li>
               <xhtml:a href="https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/">https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/</xhtml:a>
            </xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Security Auditing Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
macOS's audit facility,           <xhtml:span class="inline_block">auditd</xhtml:span>
, receives notifications from the kernel when certain system calls, such as           <xhtml:span class="inline_block">open</xhtml:span>
,           <xhtml:span class="inline_block">fork</xhtml:span>
, and           <xhtml:span class="inline_block">exit</xhtml:span>
, are made. These notifications are captured and written to an audit log.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Logs generated by           <xhtml:span class="inline_block">auditd</xhtml:span>
 may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to load auditd:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_security_audit.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_Security_Auditing_Flags_For_User-Attributable_Events_Are_Configured_Per_Local_Organizational_Requirements" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Security Auditing Flags For User-Attributable Events Are Configured Per Local Organizational Requirements</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Auditing is the capture and maintenance of information about security-related events. Auditable events often depend on differing organizational requirements.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Log Sensitive Data Access" urn="urn:cisecurity.org:controls:8.0:3:14">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enforce Detail Logging for Access or Changes to Sensitive Data" urn="urn:cisecurity.org:controls:7.0:14:9">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
Flag settings are currently based on the guidance provided by the NIST through the macOS Security guidance they are providing in their GitHub repository. You can find that guidance             <xhtml:a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171r2.pdf">here</xhtml:a>
.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.</xhtml:p>
            <xhtml:p>Depending on the governing authority, organizations can have vastly different auditing requirements. In this control we have selected a minimal set of audit flags that should be a part of any organizational requirements. The flags selected below may not adequately meet organizational requirements for users of this benchmark. The auditing checks for the flags proposed here will not impact additional flags that are selected.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/14" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">https://derflounder.wordpress.com/2012/01/30/openbsm-auditing-on-mac-os-x/</xccdf:ident>
         <xccdf:ident system="URL">https://csrc.nist.gov/CSRC/media/Publications/sp/800-179/rev-1/draft/documents/sp800-179r1-draft.pdf</xccdf:ident>
         <xccdf:ident system="URL">https://www.scip.ch/en/?labs.20150108</xccdf:ident>
         <xccdf:ident system="URL">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171r2.pdf</xccdf:ident>
         <xccdf:ident system="URL">https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to set the required Security Auditing Flags:</xhtml:p>
                  <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>
 file and add               <xhtml:span class="inline_block">-fm</xhtml:span>
,               <xhtml:span class="inline_block">ad</xhtml:span>
,               <xhtml:span class="inline_block">-ex</xhtml:span>
,               <xhtml:span class="inline_block">aa</xhtml:span>
,               <xhtml:span class="inline_block">-fr</xhtml:span>
,               <xhtml:span class="inline_block">lo</xhtml:span>
, and               <xhtml:span class="inline_block">-fw</xhtml:span>
 to               <xhtml:span class="inline_block">flags</xhtml:span>
. You can also substitute               <xhtml:span class="inline_block">-all</xhtml:span>
 for               <xhtml:span class="inline_block">-fm</xhtml:span>
,               <xhtml:span class="inline_block">-ex</xhtml:span>
,               <xhtml:span class="inline_block">-fr</xhtml:span>
, and               <xhtml:span class="inline_block">-fw</xhtml:span>
.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_audit_flags.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure install.log Is Retained for 365 or More Days and No Maximum Size</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
macOS writes information pertaining to system-related events to the file           <xhtml:span class="inline_block">/var/log/install.log</xhtml:span>
 and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.        </xhtml:p>
            <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention, and a less precise rotation argument.</xhtml:p>
            <xhtml:p>The all_max flag control will remove old log entries based only on the size of the log files. Log size can vary widely depending on how verbose installing applications are in their log entries. The decision here is to ensure that logs go back a year, and depending on the applications a size restriction could compromise the ability to store a full year.</xhtml:p>
            <xhtml:p>While this Benchmark is not scoring for a rotation flag, the default rotation is sequential rather than using a timestamp. Auditors may prefer timestamps in order to simply review specific dates where event information is desired.</xhtml:p>
            <xhtml:p>Please review the File Rotation section in the man page for more information.</xhtml:p>
            <xhtml:code class="code_block">man asl.conf
</xhtml:code>
            <xhtml:ul>
               <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
               <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
               <xhtml:li>The rotation should be set with timestamps "rotate=utc" or "rotate=local"</xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Regularly Review Logs" urn="urn:cisecurity.org:controls:7.0:6:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Archiving and retaining           <xhtml:span class="inline_block">install.log</xhtml:span>
 for at least a year is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to ensure that install logs are retained for at least 365 days:</xhtml:p>
                  <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/asl/com.apple.install</xhtml:span>
 file and add or modify the               <xhtml:span class="inline_block">ttl</xhtml:span>
 value to               <xhtml:span class="inline_block">365</xhtml:span>
 or greater on the               <xhtml:span class="inline_block">file</xhtml:span>
 line. Also, remove the               <xhtml:span class="inline_block">all_max=</xhtml:span>
 setting and value from the               <xhtml:span class="inline_block">file</xhtml:span>
 line.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_retain_install_log.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Security Auditing Retention Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The macOS audit capability contains important information to investigate security or operational issues. This resource is only completely useful if it is retained long enough to allow technical staff to find the root cause of anomalies in the records.</xhtml:p>
            <xhtml:p>Retention can be set to respect both size and longevity. To retain as much as possible under a certain size, the recommendation is to use the following:</xhtml:p>
            <xhtml:p>
               <xhtml:span class="inline_block">expire-after:60d OR 5G</xhtml:span>
            </xhtml:p>
            <xhtml:p>This recomendation is based on minimum storage for review and investigation. When a third party tool is in use to allow remote logging or the store and forwarding of logs, this local storage requirement is not required.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Regularly Review Logs" urn="urn:cisecurity.org:controls:7.0:6:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The audit records need to be retained long enough to be reviewed as necessary.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to set the audit retention length:</xhtml:p>
                  <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>
 file so that               <xhtml:span class="inline_block">expire-after:</xhtml:span>
 is at least               <xhtml:span class="inline_block">60d OR 5G</xhtml:span>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The recommendation is that at least 60 days or 5 gigabytes of audit records are retained. Systems that have very little remaining disk space may have issues retaining sufficient data.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_audit_retention.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Access to Audit Records Is Controlled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The audit system on macOS writes important operational and security information that can be both useful for an attacker and a place for an attacker to attempt to obfuscate unwanted changes that were recorded. As part of defense-in-depth, the /etc/security/audit_control configuration and the files in /var/audit should be owned only by root with group wheel with read-only rights and no other access allowed. macOS ACLs should not be used for these files.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>From ls man page</xhtml:p>
               <xhtml:code class="code_block">
-e      Print the Access Control List (ACL) associated with the file, if            <br/>
             present, in long (-l) output.
          </xhtml:code>
               <xhtml:p>More info:</xhtml:p>
               <xhtml:p>
                  <xhtml:a href="https://www.techrepublic.com/blog/apple-in-the-enterprise/introduction-to-os-x-access-control-lists-acls/">https://www.techrepublic.com/blog/apple-in-the-enterprise/introduction-to-os-x-access-control-lists-acls/</xhtml:a>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:a href="http://ahaack.net/technology/OS-X-Access-Control-Lists-ACL.html">http://ahaack.net/technology/OS-X-Access-Control-Lists-ACL.html</xhtml:a>
               </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Audit records should never be changed except by the system daemon posting events. Records may be viewed or extracts manipulated, but the authoritative files should be protected from unauthorized changes.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following to commands to set the audit records to the root user and wheel group:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/chown -R root:wheel /etc/security/audit_control              <br/>
                     <br/>
% /usr/bin/sudo /bin/chmod -R o-rw /etc/security/audit_control              <br/>
                     <br/>
% /usr/bin/sudo /usr/sbin/chown -R root:wheel /var/audit/              <br/>
                     <br/>
% /usr/bin/sudo /bin/chmod -R o-rw /var/audit/
            </xhtml:code>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 It is recommended to do a thorough verification process on why the audit logs have been changed before following the remediation steps. If the system has different access controls on the audit logs, and the changes cannot be traced, a new install may be prudent. Check for signs of file tampering as well as unapproved OS changes.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This control is only checking the default configuration to ensure that unwanted access to audit records is not available.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_audit_record_access.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Firewall Logging Is Enabled and Configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The socketfilter Firewall is what is used when the Firewall is turned on in the Security &amp; Privacy Preference Pane. In order to appropriately monitor what access is allowed and denied, logging must be enabled.
The logging level must be set to "detailed" to be useful in monitoring connection attempts that the firewall detects. Throttled login is not sufficient for examining Firewall connection attempts.</xhtml:p>
            <xhtml:p>In-depth log monitoring on macOS may require changes to the "Enable-Private-Data" key in SystemLogging.System to ensure more complete logging.</xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://www.mandiant.com/resources/blog/reviewing-macos-unified-logs">Reviewing macOS Unified Logs</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
More info
            <xhtml:a href="http://krypted.com/tag/socketfilterfw/">http://krypted.com/tag/socketfilterfw/</xhtml:a>
               </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>In order to troubleshoot the successes and failures of a Firewall, detailed logging should be enabled.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://developer.apple.com/documentation/devicemanagement/firewall?language=objc</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to enable logging of the firewall:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on              <br/>
                     <br/>
Turning on log mode              <br/>
                     <br/>
% /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingopt detail              <br/>
                     <br/>
Setting detail log option 
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Detailed logging may result in excessive storage.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_firewall_logging.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Network_Configurations">
      <xccdf:title xml:lang="en">Network Configurations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>
This section contains guidance on configuring the networking-related aspects of macOS that have been removed from         <xhtml:span class="inline_block">System Settings</xhtml:span>
 but still can be set through         <xhtml:span class="inline_block">Terminal</xhtml:span>
.      </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Bonjour_Advertising_Services_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Bonjour Advertising Services Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerates devices and services within a local subnet. DNS on macOS is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>Anything Bonjour discovers is already available on the network and probably discoverable with network scanning tools. The security benefit of disabling Bonjour for that reason is minimal.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Bonjour can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour's multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. Implementing this control disables the continuous broadcasting of "I'm here!" messages. Typical end-user endpoints should not have to advertise services to other computers. This setting does not stop the computer from sending out service discovery messages when looking for services on an internal subnet, if the computer is looking for a printer or server and using service discovery. To block all Bonjour traffic except to approved devices, the pf or other firewall would be needed.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to disable Bonjour Advertising services:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>
Some applications may not operate properly if the                 <xhtml:span class="inline_block">mDNSResponder</xhtml:span>
 is turned off. This will also affect AirDrop functionality.              </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_bonjour_services.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure HTTP Server Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>macOS used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. Apache, however, is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end-user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Web serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230793</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/security/vulnerabilities_24.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to disable the HTTP server services:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/apachectl stop              <br/>
                     <br/>
% /usr/bin/sudo /bin/launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The web server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_httpd_disabled.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure NFS Server Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>macOS can act as an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end-user computer.</xhtml:p>
            <xhtml:p>The etc/exports file contains the list of NFS shared directories. If the file exists, it is likely that NFS sharing has been enabled in the past or may be available periodically. As an additional check, the audit verifies that there is no /etc/exports file.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>File serving should not be done from a user desktop. Dedicated servers should be used. Open ports make it easier to exploit the computer.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to disable the nfsd fileserver services:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /sbin/nfsd stop              <br/>
                     <br/>
% /usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd
            </xhtml:code>
                  <xhtml:p>Remove the exported Directory listing.</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /bin/rm /etc/exports
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The nfs server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_nfs_disabled.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_System_Access_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">System Access, Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>The controls in this section are a combination of hardening controls that are not specifically in a System Preference pane. Many of these controls are only accessible using the Command Line or a Device Profile and not available in the Graphical User Interface. The Benchmark does contain simple, easy to follow instructions for technical staff to audit and implement recommended controls.</xhtml:p>
         <xhtml:p>FileVault is enabled in the CIS macOS Benchmarks, but in a cloud platform environment FileVault probably does need not be enabled since there is no direct physical access to the system. FileVault may not be needed if the physical environment, where the system resides, is properly protected and secure.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_File_System_Permissions_and_Access_Controls">
         <xccdf:title xml:lang="en">File System Permissions and Access Controls</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>File system permissions have always been part of computer security. There are several principles that are part of best practices for a POSIX-based system which are contained in this section. This section does not contain a complete list of every permission on a macOS System that might be problematic. Developers and use cases differ, and what some administrators who are long in the profession might consider a travesty are issues to which a risk assessor steeped in BYOD trends may not give a second glance. Here we document controls that should point out truly bad practices or anomalies which should be looked at and considered closely. Many of the controls are to mitigate the risk of privilege escalation attacks and data exposure to unauthorized parties.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Home Folders Are Secure</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>By default, macOS allows all valid users into the top level of every other user's home folder and restricts access to the Apple default folders within. Another user on the same system can see you have a "Documents" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system.</xhtml:p>
               <xhtml:p>The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures. Similarly with macOS, users can see into every new Directory that is created because of the default permissions.</xhtml:p>
               <xhtml:p>Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Allowing all users to view the top level of all networked users' home folder may not be desirable since it may lead to the revelation of sensitive information.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>For each user, run the following command to secure all home folders:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /bin/chmod -R og-rwx /Users/&lt;username&gt;
</xhtml:code>
                     <xhtml:p>Alternately, run the following command if there needs to be executable access for a home folder:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /bin/chmod -R og-rw /Users/&lt;username&gt;
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If implemented, users will not be able to use the "Public" folders in other users' home folders. "Public" folders with appropriate permissions would need to be set up in the /Shared folder.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_secure_homefolder.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure System Integrity Protection Status (SIP) Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>System Integrity Protection is a security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Allowlist Authorized Libraries" urn="urn:cisecurity.org:controls:8.0:2:6">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>Related to SIP controls, Library Validation is a security feature introduced in macOS 10.10 Yosemite. Library Validation protects processes from loading arbitrary libraries. This stops root from loading arbitrary libraries into any process (depending on SIP status), and keeps root from becoming more powerful. Security is strengthened, because some user processes can no longer be fooled to run additional code without root's explicit request, which may grant access to daemons that depend on Library Validation for secure validation of code identity.</xhtml:p>
                  <xhtml:p>With SIP enabled, Library Validation cannot be disabled. To test against a non-validated library, you will need to disabled SIP AND disable Library Validation.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Running without System Integrity Protection on a production system runs the risk of the modification of system binaries or code injection of system processes that would otherwise be protected by SIP.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection</xccdf:ident>
            <xccdf:ident system="URL">https://support.apple.com/en-us/HT204899</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following steps to enable System Integrity Protection:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
Reboot into the                   <xhtml:span class="inline_block">Recovery Partition</xhtml:span>
 (reboot and hold down                   <xhtml:span class="inline_block">Command ()</xhtml:span>
 +                   <xhtml:span class="inline_block">R</xhtml:span>
)                </xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">Utilities</xhtml:span>
                        </xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">Terminal</xhtml:span>
                        </xhtml:li>
                        <xhtml:li>Run the following command:</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/csrutil enable                <br/>
                        <br/>
Successfully enabled System Integrity Protection. Please restart the machine for the changes to take effect.
              </xhtml:code>
                     <xhtml:ol start="5">
                        <xhtml:li>Reboot the computer</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>
 You should research why the system had SIP disabled. It might be a better option to erase the Mac and reinstall the operating system. That is at your discretion.              </xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>
 You cannot enable System Integrity Protection from the booted operating system. If the remediation is attempted in the booted OS and not the Recovery Partition the output will give the error                 <xhtml:span class="inline_block">csrutil: failed to modify system integrity configuration. This tool needs to be executed from the Recovery OS.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>System binaries and processes could become compromised.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_sip_enabled.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Apple Mobile File Integrity (AMFI) Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple Mobile File Integrity (AMFI) was first released in macOS 10.12. The daemon and service block attempts to run unsigned code. AMFI uses launchd, code signatures, certificates, entitlements, and provisioning profiles to create a filtered entitlement dictionary for an app. AMFI is the macOS kernel module that enforces code-signing and library validation.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Allowlist Authorized Libraries" urn="urn:cisecurity.org:controls:8.0:2:6">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Apple Mobile File Integrity validates that application code is validated.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://eclecticlight.co/2018/12/29/amfi-checking-file-integrity-on-your-mac/</xccdf:ident>
            <xccdf:ident system="URL">https://github.com/usnistgov/macos_security/issues/39</xccdf:ident>
            <xccdf:ident system="URL">https://github.com/usnistgov/macos_security/issues/40</xccdf:ident>
            <xccdf:ident system="URL">https://www.naut.ca/blog/2020/11/13/forbidden-commands-to-liberate-macos/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to enable the Apple Mobile File Integrity service:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/nvram boot-args="" 
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Applications could be compromised with malicious code.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_amfi_enabled.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Signed_System_Volume_SSV_Is_Enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Signed System Volume (SSV) Is Enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Signed System Volume is a security feature introduced in macOS 11.0 Big Sur.</xhtml:p>
               <xhtml:p>During system installation, a SHA-256 cryptographic hash is calculated for all immutable system files and stored in a Merkle tree which itself is hashed as the Seal. Both are stored in the metadata of the snapshot created of the System volume.</xhtml:p>
               <xhtml:p>The seal is verified by the boot loader at startup. macOS will not boot if system files have been tampered with. If validation fails, the user will be instructed to reinstall the operating system.</xhtml:p>
               <xhtml:p>During read operations for files located in the Signed System Volume, a hash is calculated and compared to the value stored in the Merkle tree.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Data on End-User Devices" urn="urn:cisecurity.org:controls:8.0:3:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Running without Signed System Volume on a production system could run the risk of Apple software that integrates directly with macOS being modified.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://developer.apple.com/news/?id=3xpv8r2m</xccdf:ident>
            <xccdf:ident system="URL">https://eclecticlight.co/2020/11/30/is-big-surs-system-volume-sealed/</xccdf:ident>
            <xccdf:ident system="URL">https://eclecticlight.co/2020/06/25/big-surs-signed-system-volume-added-security-protection/</xccdf:ident>
            <xccdf:ident system="URL">https://support.apple.com/guide/security/signed-system-volume-security-secd698747c9/web</xccdf:ident>
            <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/what-is-a-signed-system-volume-mchl0f9af76f/mac</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>If SSV has been disabled, assume that the operating system has been compromised. Back up any files, and do a clean install to a known good Operating System.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Apple Software that integrates with the operating system could become compromised.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_ssv_enabled.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Appropriate Permissions Are Enabled for System Wide Applications</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Applications in the System Applications Directory (/Applications) should be world-executable since that is their reason to be on the system. They should not be world-writable and allow any process or user to alter them for other processes or users to then execute modified versions.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Unauthorized modifications of applications could lead to the execution of malicious code.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to change the permissions for each application that does not meet the requirements:</xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo IFS=$'\n'                <br/>
for apps in $( /usr/bin/find /System/Volumes/Data/Applications -iname "*\.app" -type d -perm -2 | grep -v Xcode.app ); do                <br/>
  /bin/chmod -R o-w "$apps"                <br/>
done
              </xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>
 Global changes should not be performed where mission-critical applications are part of the improperly permissioned applications.              </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Applications changed will no longer be world-writable. Depending on the environment, there will be different risk tolerances on each non-conforming application. Global changes should not be performed where mission-critical applications are misconfigured.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_application_permissions.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Folders_Exist_in_the_System_Folder" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure No World Writable Folders Exist in the System Folder</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Software sometimes insists on being installed in the             <xhtml:span class="inline_block">/System/Volumes/Data/System</xhtml:span>
 Directory and has inappropriate world-writable permissions.          </xhtml:p>
               <xhtml:p>Macs with writable files in System should be investigated forensically. A file with open writable permissions is a sign of at best a rogue application.  It could also be a sign of a computer compromise and a persistent presence on the system.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Folders in             <xhtml:span class="inline_block">/System/Volumes/Data/System</xhtml:span>
 should not be world-writable. The audit check excludes the             <xhtml:span class="inline_block">downloadDir</xhtml:span>
 folder that is part of Apple's default user template.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set permissions so that folders are not world-writable in the /System folder:</xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo IFS=$'\n'                <br/>
for sysPermissions in $( /usr/bin/sudo /usr/bin/find /System/Volumes/Data/System -type d -perm -2 | /usr/bin/grep -v "downloadDir" ); do                <br/>
  /bin/chmod -R o-w "$sysPermissions"                <br/>
done
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Changing file permissions could disrupt the use of applications that rely on files in the System Folder with vulnerable permissions.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_system_world_writable.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_No_World_Writable_Folders_Exist_in_the_Library_Folder" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure No World Writable Folders Exist in the Library Folder</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
Software sometimes insists on being installed in the             <xhtml:span class="inline_block">/System/Volumes/Data/Library Directory</xhtml:span>
 and has inappropriate world-writable permissions.          </xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
Folders in             <xhtml:span class="inline_block">/System/Volumes/Data/Library</xhtml:span>
 should not be world-writable. The audit check excludes the             <xhtml:span class="inline_block">/System/Volumes/Data/Library/Caches</xhtml:span>
 and             <xhtml:span class="inline_block">/System/Volumes/Data/Library/Preferences/Audio/Data</xhtml:span>
 folders where the sticky bit is set.          </xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
Run the following command to set permissions so that folders are not world-writable in the                 <xhtml:span class="inline_block">/System/Volumes/Data/Library</xhtml:span>
 folder:              </xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo IFS=$'\n'                <br/>
for libPermissions in $( /usr/bin/find /System/Volumes/Data/Library -type d -perm -2 | /usr/bin/grep -v Caches | /usr/bin/grep -v /Preferences/Audio/Data ); do                <br/>
  /bin/chmod -R o-w "$libPermissions"                <br/>
done
              </xhtml:code>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_library_world_writable.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Password_Management">
         <xccdf:title xml:lang="en">Password Management</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Password security is an important part of general IT security where passwords are in use. For macOS, passwords are still much more widely used than other methods for account access. While there are other authentication and authorization methods for access from a macOS computer to organizational services, console access to the Mac is probably done using a password. This section contains password controls.</xhtml:p>
            <xhtml:p>Apple has provided sufficient security controls to resist password attacks against the locked console, thus the CIS benchmark no longer recommends locking the keychain in addition to locking the console or display.</xhtml:p>
            <xhtml:p>Recent updates based on research by NIST in SP800-63 call into question traditional password complexity and rotation requirements. Sticky notes are not a password management program, and password vault APIs are under increasing attack. Ideally, the user will remember their important passwords. The new understanding has informed changes to the previous password recommendations.</xhtml:p>
            <xhtml:p>Length, threshold, and a yearly rotation requirement are the only scored controls below. Other controls will remain as unscored options. Passwords used for macOS are likely to also function as encryption keys for FileVault. Depending on the information confidentiality on FileVault volumes, stronger passwords may be required than are necessary to pass the controls in this Benchmark.</xhtml:p>
            <xhtml:p>Apple-supported solutions for managing local passwords on macOS are to use either an XML file that contains password rules that are imported with pwpolicy or through the use of a profile. In either case, the controls in this section can be implemented with an organizationally-approved password policy.</xhtml:p>
            <xhtml:p>
Before applying your organization's password policy, the existing password policy should be cleared so there is no outdated or conflicting legacy settings in the password policy. A pre-existing password policly could result in false results. To clear the password policy before applying the newest options, use the command           <xhtml:span class="inline_block">/usr/bin/sudo /usr/bin/pwpolicy -clearaccountpolicies</xhtml:span>
            </xhtml:p>
            <xhtml:p>Content is available where security hardening content is available and is native to Management suites and MDM tools.</xhtml:p>
            <xhtml:p>
Content also available here:           <xhtml:a href="https://github.com/ronc-LAemigre/macos-sec-config">https://github.com/ronc-LAemigre/macos-sec-config</xhtml:a>
            </xhtml:p>
            <xhtml:p>NIST guidance on passwords starting at 5.1.1.1</xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://pages.nist.gov/800-63-3/sp800-63b.html">https://pages.nist.gov/800-63-3/sp800-63b.html</xhtml:a>
            </xhtml:p>
            <xhtml:p>Additional references:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>
                  <xhtml:a href="https://developer.apple.com/documentation/devicemanagement/passcode">https://developer.apple.com/documentation/devicemanagement/passcode</xhtml:a>
               </xhtml:li>
               <xhtml:li>
                  <xhtml:a href="https://krypted.com/mac-security/programatically-setting-password-policies/">https://krypted.com/mac-security/programatically-setting-password-policies/</xhtml:a>
               </xhtml:li>
               <xhtml:li>
                  <xhtml:a href="https://www.macworld.co.uk/news/flaw-mac-t2-chip-passwords-3813616/">https://www.macworld.co.uk/news/flaw-mac-t2-chip-passwords-3813616/</xhtml:a>
               </xhtml:li>
            </xhtml:ul>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 The current method of creating and setting password policy is using the           <xhtml:span class="inline_block">pwpolicy -setglobalpolicy</xhtml:span>
 command. That command has been deprecated by Apple, but is still in use in the current version of macOS. The Benchmark will continue to use this command line method for passwords until Apple removes it from the OS. Setting password policy with mobile configuration profiles is the preferred method going forward.        </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Password Account Lockout Threshold Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The account lockout threshold specifies the amount of times a user can enter an incorrect password before a lockout will occur.</xhtml:p>
               <xhtml:p>Ensure that a lockout threshold is part of the password policy on the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Process for Revoking Access" urn="urn:cisecurity.org:controls:7.0:16:7">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The account lockout feature mitigates brute-force password attacks on the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">CIS Password Policy - https://workbench.cisecurity.org/communities/113</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set the maximum number of failed login attempts to less than or equal to 5:</xhtml:p>
                     <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxFailedLoginAttempts=&lt;value5&gt;"                <br/>
                        <br/>
% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "policyAttributeMinutesUntilFailedAuthenticationReset=&lt;value15&gt;"
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The number of incorrect log on attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user log on.</xhtml:p>
                        <xhtml:p>The locked account will auto-unlock after a few minutes when bad password attempts stop. The computer will accept the still-valid password if remembered or recovered.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_pw_max_fail.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Password Minimum Length Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A minimum password length is the fewest number of characters a password can contain to meet a system's requirements.</xhtml:p>
               <xhtml:p>Ensure that a minimum of a 15-character password is part of the password policy on the computer.</xhtml:p>
               <xhtml:p>Where the confidentiality of encrypted information in FileVault is more of a concern, requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Information systems that are not protected with strong password schemes including passwords of minimum length provide a greater opportunity for attackers to crack the password and gain access to the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set the password length to greater than or equal to 15:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "minChars=&lt;value15&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Short passwords can be easily attacked.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_pw_min_length.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_Complex_Password_Must_Contain_Alphabetic_Characters_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Alphabetic Characters Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
               <xhtml:p>Ensure that an Alphabetic character is part of the password policy on the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations               <xhtml:span class="inline_block">5.3</xhtml:span>
 -               <xhtml:span class="inline_block">5.6</xhtml:span>
). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.            </xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Terminal Method:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:p>Run the following command to set that passwords must contain at least one letter:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresAlpha=&lt;value1&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_pw_alpha_character.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_Complex_Password_Must_Contain_Numeric_Character_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Numeric Character Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
               <xhtml:p>Ensure that a number or numeric value is part of the password policy on the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations               <xhtml:span class="inline_block">5.3</xhtml:span>
 -               <xhtml:span class="inline_block">5.6</xhtml:span>
). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.            </xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set passwords to require at least one number:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresNumeric=&lt;value1&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_pw_numeric_character.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_Complex_Password_Must_Contain_Special_Character_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Special Character Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations               <xhtml:span class="inline_block">5.3</xhtml:span>
 -               <xhtml:span class="inline_block">5.6</xhtml:span>
). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.            </xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set passwords to require at least one special character:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresSymbol=&lt;value1&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_pw_special_character_cloud.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_Complex_Password_Must_Contain_Uppercase_and_Lowercase_Characters_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Uppercase and Lowercase Characters Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
               <xhtml:p>Ensure that both uppercase and lowercase letters are part of the password policy on the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations               <xhtml:span class="inline_block">5.3</xhtml:span>
 -               <xhtml:span class="inline_block">5.6</xhtml:span>
). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.            </xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to set passwords to require an upper and lower case letter:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresMixedCase=&lt;value1&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_cloud_pw_uppercase_lowercase.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Password Age Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users should reset passwords periodically.
This control uses 365 days as the acceptable value. Some organizations may be more or less restrictive. This control mainly exists to mitigate against password reuse of the macOS account password in other realms that may be more prone to compromise. Attackers take advantage of exposed information to attack other accounts.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:7.0:16:9">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Respond</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Passwords should be changed periodically to reduce exposure.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to require that passwords expire after at most 365 days:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxMinutesUntilChangePassword=&lt;value525600&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_password_age.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Password History Is Configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous password hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15.
The latest NIST guidance based on exploit research referenced in this section details how one of the greatest risks is password exposure rather than password cracking. Passwords should be changed to a new unique value whenever a password might have been exposed to anyone other than the account holder. Attackers have maintained persistent control based on predictable password change patterns and substantially different patterns should be used in case of a leak.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Old passwords should not be reused.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to require that the password must be different from at least the last 15 passwords:</xhtml:p>
                     <xhtml:code class="code_block">% /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "usingHistory=&lt;value15&gt;"
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://open-scap.org/page/SCE">
                  <check-import import-name="stdout"/>
                  <check-content-ref href="sce/macOS_password_history.sh"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Sudo Timeout Period Is Set to Zero</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The sudo command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system. This control, along with the control to use a separate timestamp for each tty, limits the window where an unauthorized user, process, or attacker could utilize legitimate credentials that are valid for longer than required.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
In previous iterations and OS versions of the macOS Benchmark, the guidance was to edit the sudoers file directly. While this would properly configure the OS, any update would change the settings back to the default configuration. Creating a configuration file in the             <xhtml:span class="inline_block">/etc/sudoers.d/</xhtml:span>
 folder will not be modified on an OS update and will keep the proper configuration.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">sudo</xhtml:span>
 command stays logged in as the root user for five minutes before timing out and re-requesting a password. This five-minute window should be eliminated since it leaves the system extremely vulnerable. This is especially true if an exploit were to gain access to the system, since they would be able to make changes as a root user.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to edit the sudo settings:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/&lt;configuration file name&gt;
</xhtml:code>
                  <xhtml:p>
                     <xhtml:em>example:</xhtml:em>
                     <xhtml:span class="inline_block">$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/10_cissudoconfiguration</xhtml:span>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 Unlike other Unix and/or Linux distros, macOS will ignore configuration files in the sudoers.d folder that contain a               <xhtml:span class="inline_block">.</xhtml:span>
 so do not add a file extension to the configuration file.            </xhtml:p>
                  <xhtml:p>
Add the line               <xhtml:span class="inline_block">Defaults timestamp_timeout=0</xhtml:span>
 to the configuration file.            </xhtml:p>
                  <xhtml:p>If /etc/sudoers.d/ is not owned by root or in the wheel group, run the following to change ownership and group:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/chown -R root:wheel /etc/security/sudoers.d/
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This control has a serious impact where users often have to use sudo. It is even more of an impact where users have to use sudo multiple times in quick succession as part of normal work processes. Organizations with that common use case will likely find this control too onerous and are better to accept the risk of not requiring a 0 grace period.</xhtml:p>
                     <xhtml:p>In some ways the use of sudo -s, which is undesirable, is better than a long grace period since that use does change the hash to show that it is a root shell rather than a normal shell where sudo commands will be implemented without a password.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_sudo_timeout.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure a Separate Timestamp Is Enabled for Each User/tty Combo</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Using tty tickets ensures that a user must enter the sudo password in each Terminal session.</xhtml:p>
            <xhtml:p>With sudo versions 1.8 and higher, introduced in 10.12, the default value is to have tty tickets for each interface so that root access is limited to a specific terminal. The default configuration can be overwritten or not configured correctly on earlier versions of macOS.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
In previous iterations and OS versions of the macOS Benchmark, the guidance was to edit the sudoers file directly. While this would properly configure the OS, any update would change the settings back to the default configuration. Creating a configuration file in the             <xhtml:span class="inline_block">/etc/sudoers.d/</xhtml:span>
 folder will not be modified on an OS update and will keep the proper configuration.          </xhtml:p>
               <xhtml:p>
With the configuration file, there is no need to remove the             <xhtml:span class="inline_block">Defaults !tty_tickets</xhtml:span>
 line from the             <xhtml:span class="inline_block">visudo</xhtml:span>
 settings. The configuration file will take precedent.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>In combination with removing the sudo timeout grace period, a further mitigation should be in place to reduce the possibility of a background process using elevated rights when a user elevates to root in an explicit context or tty.</xhtml:p>
            <xhtml:p>Additional mitigation should be in place to reduce the risk of privilege escalation of background processes.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://github.com/jorangreef/sudo-prompt/issues/33</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to edit the sudo settings:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/&lt;configuration file name&gt;
</xhtml:code>
                  <xhtml:p>
                     <xhtml:em>example:</xhtml:em>
                     <xhtml:span class="inline_block">% /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/10_cissudoconfiguration</xhtml:span>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 Unlike other Unix and/or Linux distros, macOS will ignore configuration files in the sudoers.d folder that contain a               <xhtml:span class="inline_block">.</xhtml:span>
 so do not add a file extension to the configuration file.            </xhtml:p>
                  <xhtml:p>
Add the line               <xhtml:span class="inline_block">Defaults timestamp_type=tty</xhtml:span>
 to the configuration file.            </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 The               <xhtml:span class="inline_block">Defaults timestamp_type=tty</xhtml:span>
 line can be added to an existing configuration file or a new one. That will depend on your organization's preference and works either way.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This control should have no user impact. Developers or installers may have issues if background processes are spawned with different interfaces than where sudo was executed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_tty_seperate_timestamp.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the "root" Account Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. With some versions of Linux, the system administrator may commonly use the root account to perform administrative functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Enabling and using the root account puts the system at risk since any successful exploit or mistake while the root account is in use could have unlimited access privileges within the system. Using the           <xhtml:span class="inline_block">sudo</xhtml:span>
 command allows users to perform functions as a root user while limiting and password protecting the access privileges. By default the root account is not enabled on a macOS computer. An administrator can escalate privileges using the           <xhtml:span class="inline_block">sudo</xhtml:span>
 command (use           <xhtml:span class="inline_block">-s</xhtml:span>
 or           <xhtml:span class="inline_block">-i</xhtml:span>
 to get a root shell).        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to disable the root user:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/dsenableroot -d              <br/>
                     <br/>
username = root              <br/>
user password:
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Some legacy POSIX software might expect an available root account.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_root_disabled.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure an Administrator Account Cannot Login to Another User's Active and Locked Session</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>macOS has a privilege that can be granted to any user that will allow that user to unlock active users' sessions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling the administrator's and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://derflounder.wordpress.com/2014/02/16/managing-the-authorization-database-in-os-x-mavericks/</xccdf:ident>
         <xccdf:ident system="URL">https://www.jamf.com/jamf-nation/discussions/18195/system-login-screensaver</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to disable a user logging into another user's active and/or locked session:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/security authorizationdb write system.login.screensaver authenticate-session-owner              <br/>
                     <br/>
YES (0)
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While Fast user switching is a workaround for some lab environments, especially where there is even less of an expectation of privacy, this setting change may impact some maintenance workflows.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5360023"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_a_Login_Window_Banner_Exists" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure a Login Window Banner Exists</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required. The system recognizes either the           <xhtml:span class="inline_block">.txt</xhtml:span>
 and the           <xhtml:span class="inline_block">.rtf</xhtml:span>
 formats.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://support.apple.com/en-au/HT202277</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following commands to create or edit the login window text and set the proper permissions:</xhtml:p>
                  <xhtml:p>
Edit (or create) a               <xhtml:span class="inline_block">PolicyBanner.txt</xhtml:span>
 or               <xhtml:span class="inline_block">PolicyBanner.rtf</xhtml:span>
 file, in the               <xhtml:span class="inline_block">/Library/Security/</xhtml:span>
 folder, to include the required login window banner text.            </xhtml:p>
                  <xhtml:p>Perform the following to set permissions on the policy banner file:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /usr/sbin/chown o+r /Library/Security/PolicyBanner.txt              <br/>
                     <br/>
% /usr/bin/sudo /usr/sbin/chown o+r /Library/Security/PolicyBanner.rtf 
            </xhtml:code>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 If your organization uses an               <xhtml:span class="inline_block">.rtfd</xhtml:span>
 file to set the policy banner, run               <xhtml:span class="inline_block">% /usr/bin/sudo /usr/sbin/chown -R o+rx /Library/Security/PolicyBanner.rtfd</xhtml:span>
 to update the permissions.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Users will have to click on the window with the Login text before logging into the computer.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_login_banner_window.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_the_Guest_Home_Folder_Does_Not_Exist" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Guest Home Folder Does Not Exist</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>In the previous two controls, the guest account login has been disabled and sharing to guests has been disabled, as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed, you have the option to archive it, leave it in place, or delete. In the case of the guest folder, the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed, it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders, as well. Rather than ignoring the folder's continued existence, it is best removed.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The Guest home folders are unneeded after the Guest account is disabled and could be used inappropriately.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to remove the Guest user home folder:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo /bin/rm -R /Users/Guest 
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The Guest account should not be necessary after it is disabled, and it will be automatically re-created if the Guest account is re-enabled</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_guest_home_folder.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_XProtect_Is_Running_and_Updated" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure XProtect Is Running and Updated</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>XProtect is Apple's native signature-based antivirus technology. XProtect both finds and blocks the execution of known malware. There are many AV and Endpoint Threat Detection and Response (ETDR) tools available for Mac OS. The native Apple provisioned tool looks for specific known malware is completely integrated into the OS. No matter what other tools are being used, XProtect should have the latest signatures available.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Deploy and Maintain Anti-Malware Software" urn="urn:cisecurity.org:controls:8.0:10:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Configure Automatic Anti-Malware Signature Updates" urn="urn:cisecurity.org:controls:8.0:10:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Anti-Malware Software and Signatures are Updated" urn="urn:cisecurity.org:controls:7.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Configure Anti-Malware Scanning of Removable Devices" urn="urn:cisecurity.org:controls:7.0:8:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>To verify the XProtect Remediator logs run the following command:</xhtml:p>
               <xhtml:code class="code_block">
% /usr/bin/sudo /usr/bin/log show --predicate 'subsystem ==            <br/>
"com.apple.XProtectFramework.PluginAPI" AND category ==            <br/>
"XPEvent.structured"' --info --last 1d' to check logs'
          </xhtml:code>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Apple creates signatures for known malware that actually affects Macs and that knowledge should be leveraged.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://eclecticlight.co/2021/10/27/silently-updated-security-data-files-in-monterey/</xccdf:ident>
         <xccdf:ident system="URL">https://eclecticlight.co/2020/12/14/silently-updated-security-data-files-in-big-sur/</xccdf:ident>
         <xccdf:ident system="URL">https://eclecticlight.co/2019/10/17/security-data-files-how-theyve-changed-in-catalina/</xccdf:ident>
         <xccdf:ident system="URL">https://eclecticlight.co/2022/05/12/apple-has-pushed-an-update-to-xprotect-21/</xccdf:ident>
         <xccdf:ident system="URL">https://support.apple.com/guide/security/protecting-against-malware-sec469d47bd8/web</xccdf:ident>
         <xccdf:ident system="URL">https://eclecticlight.co/2023/06/12/malware-detection-and-remediation-by-xprotect-remediator/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to enable and update XProtect:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XProtect.daemon.scan.plist              <br/>
                     <br/>
% /usr/bin/sudo /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XprotectFramework.PluginService.plist              <br/>
                     <br/>
% /usr/bin/sudo /usr/sbin/softwareupdate -l --background-critical              <br/>
                     <br/>
softwareupdate[97180]: Triggering a background check with forced scan (critical and config-data updates only) ...
            </xhtml:code>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 Xprotect can only be enabled/disabled if SIP (System Integrity Protection) is disabled. If Xprotect is disabled, the system might be compromised and needs to be investigated.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Some organizations may have effective Mac OS anti-malware tools that XProtect conflicts with.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_xprotect_enabled.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Secure Keyboard Entry Terminal.app Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal. Unauthorized applications and malicious code could intercept keystrokes entered in the Terminal.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Maintain Inventory of Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling Secure Keyboard Entry minimizes the risk of a key logger detecting what is entered in Terminal.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/terminal/trml109/mac</xccdf:ident>
         <xccdf:ident system="URL">https://developer.apple.com/library/archive/technotes/tn2150/_index.html</xccdf:ident>
         <xccdf:ident system="URL">https://krypted.com/mac-os-x/secure-keyboard-entry-on-macos/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to ensure keyboard entries are secure in Terminal for every user that is non-compliant:</xhtml:p>
                  <xhtml:code class="code_block">% /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Enabling this in Terminal would prevent an application that is otherwise validly intercepting keyboard input from intercepting that input in Terminal.app. This could impact productivity tools.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-content-ref href="CIS_Apple_macOS_14.0_Sonoma_Cloud-tailored_Benchmark_v1.0.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_14:def:5360027"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Show All Filename Extensions Setting is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A filename extension is a suffix added to a base filename that indicates the base filename's file format.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Respond</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Respond</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Visible filename extensions allow the user to identify the file type and the application it is associated with which leads to quick identification of misrepresented malicious files.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://blog.xpnsec.com/macos-filename-homoglyphs-revisited/</xccdf:ident>
         <xccdf:ident system="URL">https://null-byte.wonderhowto.com/how-to/hacking-macos-create-fake-pdf-trojan-with-applescript-part-2-disguising-script-0184706/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following command to enable displaying of file extensions:</xhtml:p>
                  <xhtml:code class="code_block">
% /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Preferences/.GlobalPreferences.plist AppleShowAllExtensions -bool true              <br/>
                     <br/>
% /usr/bin/sudo killall Finder
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The user of the system can open files of unknown or unexpected filetypes if the extension is not visible.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://open-scap.org/page/SCE">
               <check-import import-name="stdout"/>
               <check-content-ref href="sce/macOS_finder_show_file_extensions.sh"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
<ds:DigestValue>Arc1qKCUEuLbgSym42pOjBuVkvpecExAsC8kByHyTYQ=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
DnSeMlMHoPmrVHIuGDjWUbBtOnyHFvCcBI6aInXMrnQvEMk/hseugm4D9hVeZJQxJOjCrAsGhdhZ
rXI73zQE/thWAGEK50LEq+eBoM12hrvhM+PydK3R8n9zPj5WHIhE2Eeb/8yNAGX1FuPyDSUlYHRL
LIbnDkgDylola9WeLznMeDXdsRtMH+K2Ou1f1NC1/PcbpIX7J3Fc6HMJY1JuEh1Qafjr3rL7uvX8
e4AO10HDZqR/8yCZ1qD6tXDD9e3E6F2mrdc4JjDywXU4kQMoiNEU9d4eLVYHxSLw9WDjIn/EwJsT
Anw0PCLnHhw5Lete7IUAQRtXZMLwFuj+tDOjfWLxqBBTksurOx5Sk8IE02P8gBUDKwUv34qght+1
gDrSeQ/h2qRfCTkf9teGFdJaDOAbAxOZ8wtTvcIqqjkVGdy8cLatFPYa+awEMEB+APxL30qHiqyR
u1I2cgvhj7CUZPa/FnrhkAZCs2HF9N13HbXv6/F5oHtvzgJJ+LzrqeQx
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>