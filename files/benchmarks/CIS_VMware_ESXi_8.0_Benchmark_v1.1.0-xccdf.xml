<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_VMware_ESXi_8.0_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2024-03-18">draft</xccdf:status>
   <xccdf:title xml:lang="en">CIS VMware ESXi 8.0 Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>
This document provides prescriptive guidance for establishing a secure configuration posture for VMware ESXi 8.0. To obtain the latest version of this guide, please visit       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>
.    </xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <xccdf:version>1.1.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_L1_-_CorporateEnterprise_Environment_general_use">
      <xccdf:title xml:lang="en">Level 1 (L1) - Corporate/Enterprise Environment (general use)</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be the starting baseline for most organizations;</xhtml:li>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Host_hardware_must_have_auditable_authentic_and_up_to_date_system__device_firmware" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Host_hardware_must_enable_UEFI_Secure_Boot" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Host_hardware_must_enable_Intel_TXT_if_available" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Host_hardware_must_enable_and_configure_a_TPM_2.0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Host_integrated_hardware_management_controller_must_be_secure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Host_integrated_hardware_management_controller_must_enable_time_synchronization" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Host_integrated_hardware_management_controller_must_enable_remote_logging_of_events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Host_must_run_software_that_has_not_reached_End_of_General_Support_status" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Host_must_have_all_software_updates_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Host_must_enable_Secure_Boot_enforcement" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Host_image_profile_acceptance_level_must_be_PartnerSupported_or_higher" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Host_must_only_run_binaries_delivered_via_signed_VIB" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Host_must_have_reliable_time_synchronization_sources" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Host_must_have_time_synchronization_services_enabled_and_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Host_must_require_TPM-based_configuration_encryption" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Host_must_not_suppress_warnings_about_unmitigated_hyperthreading_vulnerabilities" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_L1_Host_must_restrict_inter-VM_transparent_page_sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_L1_Host_must_use_sufficient_entropy_for_cryptographic_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Host_should_deactivate_SSH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Host_must_deactivate_the_ESXi_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Host_must_deactivate_the_ESXi_Managed_Object_Browser_MOB" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Host_must_deactivate_SLP" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_L1_Host_must_deactivate_CIM" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_L1_Host_should_deactivate_SNMP" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Host_must_automatically_terminate_idle_DCUI_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_L1_Host_must_automatically_terminate_idle_shells" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Host_must_automatically_deactivate_shell_services" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Host_must_not_suppress_warnings_that_the_shell_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_L1_Host_must_enforce_password_complexity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.12_L1_Host_must_lock_an_account_after_a_specified_number_of_failed_login_attempts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.13_L1_Host_must_unlock_accounts_after_a_specified_timeout_period" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.14_L1_Host_must_configure_the_password_history_setting_to_restrict_the_reuse_of_passwords" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.15_L1_Host_must_be_configured_with_an_appropriate_maximum_password_age" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.16_L1_Host_must_configure_a_session_timeout_for_the_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.17_L1_Host_must_automatically_terminate_idle_host_client_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.18_L1_Host_must_have_an_accurate_DCUI.Access_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.19_L1_Host_must_have_an_accurate_Exception_Users_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.20_L1_Host_must_enable_normal_lockdown_mode" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.22_L1_Host_must_deny_shell_access_for_the_dcui_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.24_L1_Host_must_display_a_login_banner_for_the_DCUI_and_Host_Client" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.25_L1_Host_must_display_a_login_banner_for_SSH_connections" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.26_L1_Host_must_enable_the_highest_version_of_TLS_supported" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_system_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Host_must_transmit_system_logs_to_a_remote_log_collector" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Host_must_log_sufficient_information_for_events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Host_must_set_the_logging_informational_level_to_info" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Host_must_deactivate_log_filtering" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Host_must_enable_audit_record_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_audit_records" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Host_must_store_one_week_of_audit_records" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Host_must_transmit_audit_records_to_a_remote_log_collector" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Host_must_verify_certificates_for_TLS_remote_logging_endpoints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Host_must_use_strict_x509_verification_for_TLS-enabled_remote_logging_endpoints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Host_firewall_must_only_allow_traffic_from_authorized_networks" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Host_must_block_network_traffic_by_default" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Host_must_restrict_use_of_the_dvFilter_network_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Host_must_filter_Bridge_Protocol_Data_Unit_BPDU_packets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Host_should_reject_forged_transmits_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_L1_Host_should_reject_MAC_address_changes_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Host_should_reject_promiscuous_mode_requests_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Host_must_restrict_access_to_a_default_or_native_VLAN_on_standard_virtual_switches" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Host_must_restrict_the_use_of_Virtual_Guest_Tagging_VGT_on_standard_virtual_switches" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_L1_Host_must_isolate_management_communications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_L1_Host_CIM_services_if_enabled_must_limit_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2.1_L1_Host_must_isolate_storage_communications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2.2_L1_Host_must_ensure_all_datastores_have_unique_names" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3.1_L1_Host_iSCSI_client_if_enabled_must_employ_bidirectionalmutual_CHAP_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3.2_L1_Host_iSCSI_client_if_enabled_must_employ_unique_CHAP_authentication_secrets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4.1_L1_Host_SNMP_services_if_enabled_must_limit_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.1_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.2_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_cryptographic_modules" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.3_L1_Host_SSH_daemon_if_enabled_must_not_allow_use_of_gateway_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.4_L1_Host_SSH_daemon_if_enabled_must_not_allow_host-based_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.5_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_count_on_idle_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.6_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_interval_on_idle_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.7_L1_Host_SSH_daemon_if_enabled_must_display_the_system_login_banner_before_granting_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.8_L1_Host_SSH_daemon_if_enabled_must_ignore_.rhosts_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.9_L1_Host_SSH_daemon_if_enabled_must_disable_stream_local_forwarding" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.10_L1_Host_SSH_daemon_if_enabled_must_disable_TCP_forwarding" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.11_L1_Host_SSH_daemon_if_enabled_must_not_permit_tunnels" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.12_L1_Host_SSH_daemon_if_enabled_must_not_permit_user_environment_settings" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Virtual_machines_must_enable_Secure_Boot" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Virtual_machines_must_require_encryption_for_vMotion" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Virtual_machines_must_require_encryption_for_Fault_Tolerance" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Virtual_machines_must_be_configured_to_lock_when_the_last_console_connection_is_closed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Virtual_machines_must_limit_console_sharing." selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Virtual_machines_must_limit_PCIPCIe_device_passthrough_functionality" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Virtual_machines_must_prevent_unauthorized_modification_of_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Virtual_machines_must_remove_unnecessary_audio_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Virtual_machines_must_remove_unnecessary_AHCI_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Virtual_machines_must_remove_unnecessary_USBXHCI_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.12_L1_Virtual_machines_must_remove_unnecessary_serial_port_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.13_L1_Virtual_machines_must_remove_unnecessary_parallel_port_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.15_L1_Virtual_machines_must_remove_unnecessary_floppy_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.16_L1_Virtual_machines_must_deactivate_console_drag_and_drop_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.17_L1_Virtual_machines_must_deactivate_console_copy_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.18_L1_Virtual_machines_must_deactivate_console_paste_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.19_L1_Virtual_machines_must_limit_access_through_the_dvfilter_network_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.20_L1_Virtual_machines_must_deactivate_virtual_disk_shrinking_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.21_L1_Virtual_machines_must_deactivate_virtual_disk_wiping_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.22_L1_Virtual_machines_must_restrict_sharing_of_memory_pages_with_other_VMs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.23_L1_Virtual_machines_must_not_be_able_to_obtain_host_information_from_the_hypervisor" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.24_L1_Virtual_machines_must_enable_diagnostic_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.25_L1_Virtual_machines_must_limit_the_number_of_retained_diagnostic_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.26_L1_Virtual_machines_must_limit_the_size_of_diagnostic_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.27_L1_Virtual_machines_must_limit_informational_messages_from_the_virtual_machine_to_the_VMX_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_L1_VMware_Tools_must_be_a_version_that_has_not_reached_End_of_General_Support_status" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2_L1_VMware_Tools_must_have_all_software_updates_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3_L1_VMware_Tools_should_configure_automatic_upgrades_as_appropriate_for_the_environment" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4_L1_VMware_Tools_on_deployed_virtual_machines_must_prevent_being_recustomized" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.5_L1_VMware_Tools_must_limit_the_automatic_addition_of_features" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6_L1_VMware_Tools_must_limit_the_automatic_removal_of_features" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7_L1_VMware_Tools_must_deactivate_GlobalConf_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.8_L1_VMware_Tools_must_deactivate_ContainerInfo_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.9_L1_VMware_Tools_must_deactivate_Appinfo_information_gathering_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.10_L1_VMware_Tools_must_deactivate_Guest_Store_Upgrade_operations_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.11_L1_VMware_Tools_must_deactivate_Service_Discovery_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.12_L1_VMware_Tools_must_limit_the_use_of_MSI_transforms_when_reconfiguring_VMware_Tools" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.13_L1_VMware_Tools_must_enable_VMware_Tools_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.14_L1_VMware_Tools_must_send_VMware_Tools_logs_to_the_system_log_service" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_L2_-_High_SecuritySensitive_Data_Environment_limited_functionality">
      <xccdf:title xml:lang="en">Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1 (L1)" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is more critical than manageability and usability;</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology; and</xhtml:li>
            <xhtml:li>limit the ability of remote management/access.</xhtml:li>
         </xhtml:ul>
         <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 Implementation of Level 2 requires that         <xhtml:strong>both</xhtml:strong>
 Level 1 and Level 2 settings are applied.      </xhtml:p>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Host_hardware_must_have_auditable_authentic_and_up_to_date_system__device_firmware" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Host_hardware_must_enable_UEFI_Secure_Boot" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Host_hardware_must_enable_Intel_TXT_if_available" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Host_hardware_must_enable_and_configure_a_TPM_2.0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Host_integrated_hardware_management_controller_must_be_secure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Host_integrated_hardware_management_controller_must_enable_time_synchronization" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Host_integrated_hardware_management_controller_must_enable_remote_logging_of_events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.8_L1_Host_integrated_hardware_management_controller_must_secure_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9_L2_Host_hardware_must_enable_AMD_SEV-ES_if_available" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.10_L2_Host_hardware_must_enable_Intel_SGX_if_available" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.11_L2_Host_hardware_must_secure_unused_external_hardware_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.12_L2_Host_integrated_hardware_management_controller_must_deactivate_internal_networking" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Host_must_run_software_that_has_not_reached_End_of_General_Support_status" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Host_must_have_all_software_updates_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Host_must_enable_Secure_Boot_enforcement" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Host_image_profile_acceptance_level_must_be_PartnerSupported_or_higher" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Host_must_only_run_binaries_delivered_via_signed_VIB" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Host_must_have_reliable_time_synchronization_sources" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Host_must_have_time_synchronization_services_enabled_and_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Host_must_require_TPM-based_configuration_encryption" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Host_must_not_suppress_warnings_about_unmitigated_hyperthreading_vulnerabilities" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_L1_Host_must_restrict_inter-VM_transparent_page_sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_L1_Host_must_use_sufficient_entropy_for_cryptographic_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_L2_Host_must_enable_volatile_key_destruction" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Host_should_deactivate_SSH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Host_must_deactivate_the_ESXi_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Host_must_deactivate_the_ESXi_Managed_Object_Browser_MOB" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Host_must_deactivate_SLP" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_L1_Host_must_deactivate_CIM" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_L1_Host_should_deactivate_SNMP" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Host_must_automatically_terminate_idle_DCUI_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_L1_Host_must_automatically_terminate_idle_shells" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Host_must_automatically_deactivate_shell_services" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Host_must_not_suppress_warnings_that_the_shell_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_L1_Host_must_enforce_password_complexity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.12_L1_Host_must_lock_an_account_after_a_specified_number_of_failed_login_attempts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.13_L1_Host_must_unlock_accounts_after_a_specified_timeout_period" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.14_L1_Host_must_configure_the_password_history_setting_to_restrict_the_reuse_of_passwords" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.15_L1_Host_must_be_configured_with_an_appropriate_maximum_password_age" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.16_L1_Host_must_configure_a_session_timeout_for_the_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.17_L1_Host_must_automatically_terminate_idle_host_client_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.18_L1_Host_must_have_an_accurate_DCUI.Access_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.19_L1_Host_must_have_an_accurate_Exception_Users_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.20_L1_Host_must_enable_normal_lockdown_mode" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.21_L2_Host_should_enable_strict_lockdown_mode" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.22_L1_Host_must_deny_shell_access_for_the_dcui_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.23_L2_Host_must_deny_shell_access_for_the_vpxuser_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.24_L1_Host_must_display_a_login_banner_for_the_DCUI_and_Host_Client" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.25_L1_Host_must_display_a_login_banner_for_SSH_connections" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.26_L1_Host_must_enable_the_highest_version_of_TLS_supported" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_system_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Host_must_transmit_system_logs_to_a_remote_log_collector" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Host_must_log_sufficient_information_for_events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Host_must_set_the_logging_informational_level_to_info" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Host_must_deactivate_log_filtering" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Host_must_enable_audit_record_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_audit_records" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Host_must_store_one_week_of_audit_records" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Host_must_transmit_audit_records_to_a_remote_log_collector" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Host_must_verify_certificates_for_TLS_remote_logging_endpoints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Host_must_use_strict_x509_verification_for_TLS-enabled_remote_logging_endpoints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Host_firewall_must_only_allow_traffic_from_authorized_networks" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Host_must_block_network_traffic_by_default" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Host_must_restrict_use_of_the_dvFilter_network_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Host_must_filter_Bridge_Protocol_Data_Unit_BPDU_packets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_L2_Host_should_deactivate_virtual_hardware_management_network_interfaces" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Host_should_reject_forged_transmits_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_L1_Host_should_reject_MAC_address_changes_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Host_should_reject_promiscuous_mode_requests_on_standard_virtual_switches_and_port_groups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Host_must_restrict_access_to_a_default_or_native_VLAN_on_standard_virtual_switches" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Host_must_restrict_the_use_of_Virtual_Guest_Tagging_VGT_on_standard_virtual_switches" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_L1_Host_must_isolate_management_communications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_L1_Host_CIM_services_if_enabled_must_limit_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2.1_L1_Host_must_isolate_storage_communications" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2.2_L1_Host_must_ensure_all_datastores_have_unique_names" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3.1_L1_Host_iSCSI_client_if_enabled_must_employ_bidirectionalmutual_CHAP_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3.2_L1_Host_iSCSI_client_if_enabled_must_employ_unique_CHAP_authentication_secrets" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4.1_L1_Host_SNMP_services_if_enabled_must_limit_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.1_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.2_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_cryptographic_modules" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.3_L1_Host_SSH_daemon_if_enabled_must_not_allow_use_of_gateway_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.4_L1_Host_SSH_daemon_if_enabled_must_not_allow_host-based_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.5_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_count_on_idle_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.6_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_interval_on_idle_sessions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.7_L1_Host_SSH_daemon_if_enabled_must_display_the_system_login_banner_before_granting_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.8_L1_Host_SSH_daemon_if_enabled_must_ignore_.rhosts_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.9_L1_Host_SSH_daemon_if_enabled_must_disable_stream_local_forwarding" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.10_L1_Host_SSH_daemon_if_enabled_must_disable_TCP_forwarding" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.11_L1_Host_SSH_daemon_if_enabled_must_not_permit_tunnels" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5.12_L1_Host_SSH_daemon_if_enabled_must_not_permit_user_environment_settings" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Virtual_machines_must_enable_Secure_Boot" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Virtual_machines_must_require_encryption_for_vMotion" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Virtual_machines_must_require_encryption_for_Fault_Tolerance" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Virtual_machines_should_deactivate_3D_graphics_features_when_not_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Virtual_machines_must_be_configured_to_lock_when_the_last_console_connection_is_closed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Virtual_machines_must_limit_console_sharing." selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Virtual_machines_must_limit_PCIPCIe_device_passthrough_functionality" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Virtual_machines_must_prevent_unauthorized_modification_of_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Virtual_machines_must_remove_unnecessary_audio_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Virtual_machines_must_remove_unnecessary_AHCI_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Virtual_machines_must_remove_unnecessary_USBXHCI_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.12_L1_Virtual_machines_must_remove_unnecessary_serial_port_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.13_L1_Virtual_machines_must_remove_unnecessary_parallel_port_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.14_L2_Virtual_machines_must_remove_unnecessary_CDDVD_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.15_L1_Virtual_machines_must_remove_unnecessary_floppy_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.16_L1_Virtual_machines_must_deactivate_console_drag_and_drop_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.17_L1_Virtual_machines_must_deactivate_console_copy_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.18_L1_Virtual_machines_must_deactivate_console_paste_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.19_L1_Virtual_machines_must_limit_access_through_the_dvfilter_network_API" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.20_L1_Virtual_machines_must_deactivate_virtual_disk_shrinking_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.21_L1_Virtual_machines_must_deactivate_virtual_disk_wiping_operations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.22_L1_Virtual_machines_must_restrict_sharing_of_memory_pages_with_other_VMs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.23_L1_Virtual_machines_must_not_be_able_to_obtain_host_information_from_the_hypervisor" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.24_L1_Virtual_machines_must_enable_diagnostic_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.25_L1_Virtual_machines_must_limit_the_number_of_retained_diagnostic_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.26_L1_Virtual_machines_must_limit_the_size_of_diagnostic_logs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.27_L1_Virtual_machines_must_limit_informational_messages_from_the_virtual_machine_to_the_VMX_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.28_L2_Virtual_machines_should_have_virtual_machine_hardware_version_19_or_newer" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_L1_VMware_Tools_must_be_a_version_that_has_not_reached_End_of_General_Support_status" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2_L1_VMware_Tools_must_have_all_software_updates_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3_L1_VMware_Tools_should_configure_automatic_upgrades_as_appropriate_for_the_environment" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4_L1_VMware_Tools_on_deployed_virtual_machines_must_prevent_being_recustomized" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.5_L1_VMware_Tools_must_limit_the_automatic_addition_of_features" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6_L1_VMware_Tools_must_limit_the_automatic_removal_of_features" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7_L1_VMware_Tools_must_deactivate_GlobalConf_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.8_L1_VMware_Tools_must_deactivate_ContainerInfo_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.9_L1_VMware_Tools_must_deactivate_Appinfo_information_gathering_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.10_L1_VMware_Tools_must_deactivate_Guest_Store_Upgrade_operations_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.11_L1_VMware_Tools_must_deactivate_Service_Discovery_unless_required" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.12_L1_VMware_Tools_must_limit_the_use_of_MSI_transforms_when_reconfiguring_VMware_Tools" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.13_L1_VMware_Tools_must_enable_VMware_Tools_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.14_L1_VMware_Tools_must_send_VMware_Tools_logs_to_the_system_log_service" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.15_L2_VMware_Tools_must_deactivate_Guest_Operations_unless_required" selected="true"/>
   </xccdf:Profile>
   <Value abstract="false" hidden="false" id="xccdf_org.cisecurity.benchmarks_value_esxi.connection" interactive="1" prohibitChanges="false" type="string">
      <title override="0">ESXi connection string</title>
      <description override="0">This value allows for user-supplied connection strings</description>
      <value selector=""/>
      <default>root/password@192.168.41.60</default>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688989_var" operator="pattern match" type="string">
      <title>(L1) Host must have reliable time synchronization sources</title>
      <description>This value is used in Rule: (L1) Host must have reliable time synchronization sources</description>
      <value>.</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688992_var" operator="equals" type="number">
      <title>(L1) Host must restrict inter-VM transparent page sharing</title>
      <description>This value is used in Rule: (L1) Host must restrict inter-VM transparent page sharing</description>
      <value>2</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688993_var" operator="equals" type="boolean">
      <title>(L1) Host must deactivate the ESXi Managed Object Browser (MOB)</title>
      <description>This value is used in Rule: (L1) Host must deactivate the ESXi Managed Object Browser (MOB)</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688995_var" operator="less than or equal" type="number">
      <title>(L1) Host must automatically terminate idle DCUI sessions</title>
      <description>This value is used in Rule: (L1) Host must automatically terminate idle DCUI sessions</description>
      <value>600</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688998_var" operator="less than or equal" type="number">
      <title>(L1) Host must automatically terminate idle shells</title>
      <description>This value is used in Rule: (L1) Host must automatically terminate idle shells</description>
      <value>300</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689001_var" operator="less than or equal" type="number">
      <title>(L1) Host must automatically deactivate shell services</title>
      <description>This value is used in Rule: (L1) Host must automatically deactivate shell services</description>
      <value>3600</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689006_var" operator="equals" type="number">
      <title>(L1) Host must lock an account after a specified number of failed login attempts</title>
      <description>This value is used in Rule: (L1) Host must lock an account after a specified number of failed login attempts</description>
      <value>5</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689008_var" operator="equals" type="number">
      <title>(L1) Host must unlock accounts after a specified timeout period</title>
      <description>This value is used in Rule: (L1) Host must unlock accounts after a specified timeout period</description>
      <value>900</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689011_var" operator="pattern match" type="string">
      <title>(L1) Host must have an accurate DCUI.Access list</title>
      <description>This value is used in Rule: (L1) Host must have an accurate DCUI.Access list</description>
      <value>.*</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688986_var" operator="pattern match" type="string">
      <title>(L1) Host must transmit system logs to a remote log collector</title>
      <description>This value is used in Rule: (L1) Host must transmit system logs to a remote log collector</description>
      <value>.</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689013_var" operator="equals" type="boolean">
      <title>(L1) Host must enable normal lockdown mode</title>
      <description>This value is used in Rule: (L1) Host must enable normal lockdown mode</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689015_var" operator="equals" type="boolean">
      <title>(L2) Host should enable strict lockdown mode</title>
      <description>This value is used in Rule: (L2) Host should enable strict lockdown mode</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689005_var" operator="equals" type="boolean">
      <title>(L1) Host iSCSI client, if enabled, must employ bidirectional/mutual CHAP authentication</title>
      <description>This value is used in Rule: (L1) Host iSCSI client, if enabled, must employ bidirectional/mutual CHAP authentication</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4688996_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines should deactivate 3D graphics features when not required</title>
      <description>This value is used in Rule: (L1) Virtual machines should deactivate 3D graphics features when not required</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689000_var" operator="equals" type="number">
      <title>(L1) Virtual machines must limit console sharing.</title>
      <description>This value is used in Rule: (L1) Virtual machines must limit console sharing.</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689004_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must limit PCI/PCIe device passthrough functionality</title>
      <description>This value is used in Rule: (L1) Virtual machines must limit PCI/PCIe device passthrough functionality</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689007_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must prevent unauthorized modification of devices</title>
      <description>This value is used in Rule: (L1) Virtual machines must prevent unauthorized modification of devices</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689017_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must deactivate console drag and drop operations</title>
      <description>This value is used in Rule: (L1) Virtual machines must deactivate console drag and drop operations</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689018_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must deactivate console copy operations</title>
      <description>This value is used in Rule: (L1) Virtual machines must deactivate console copy operations</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689019_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must deactivate console paste operations</title>
      <description>This value is used in Rule: (L1) Virtual machines must deactivate console paste operations</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689020_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must deactivate virtual disk shrinking operations</title>
      <description>This value is used in Rule: (L1) Virtual machines must deactivate virtual disk shrinking operations</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689021_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must deactivate virtual disk wiping operations</title>
      <description>This value is used in Rule: (L1) Virtual machines must deactivate virtual disk wiping operations</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689022_var" operator="equals" type="boolean">
      <title>(L1) Virtual machines must not be able to obtain host information from the hypervisor</title>
      <description>This value is used in Rule: (L1) Virtual machines must not be able to obtain host information from the hypervisor</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689023_var" operator="less than or equal" type="number">
      <title>(L1) Virtual machines must limit the number of retained diagnostic logs</title>
      <description>This value is used in Rule: (L1) Virtual machines must limit the number of retained diagnostic logs</description>
      <value>10</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689024_var" operator="less than or equal" type="number">
      <title>(L1) Virtual machines must limit the size of diagnostic logs</title>
      <description>This value is used in Rule: (L1) Virtual machines must limit the size of diagnostic logs</description>
      <value>1024000</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_5200077_var" operator="not equal" type="number">
      <title>(L1) Virtual machines must limit the size of diagnostic logs</title>
      <description>This value is used in Rule: (L1) Virtual machines must limit the size of diagnostic logs</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689009_var" operator="equals" type="number">
      <title>(L1) Virtual machines must remove unnecessary USB/XHCI devices</title>
      <description>This value is used in Rule: (L1) Virtual machines must remove unnecessary USB/XHCI devices</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689010_var" operator="equals" type="number">
      <title>(L1) Virtual machines must remove unnecessary serial port devices</title>
      <description>This value is used in Rule: (L1) Virtual machines must remove unnecessary serial port devices</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689012_var" operator="equals" type="number">
      <title>(L1) Virtual machines must remove unnecessary parallel port devices</title>
      <description>This value is used in Rule: (L1) Virtual machines must remove unnecessary parallel port devices</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689014_var" operator="equals" type="number">
      <title>(L2) Virtual machines must remove unnecessary CD/DVD devices</title>
      <description>This value is used in Rule: (L2) Virtual machines must remove unnecessary CD/DVD devices</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4689016_var" operator="equals" type="number">
      <title>(L1) Virtual machines must remove unnecessary floppy devices</title>
      <description>This value is used in Rule: (L1) Virtual machines must remove unnecessary floppy devices</description>
      <value>false</value>
   </Value>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Hardware">
      <xccdf:title xml:lang="en">Hardware</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for configuring server hardware to support the security features present in VMware ESXi.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Host_hardware_must_have_auditable_authentic_and_up_to_date_system__device_firmware" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host hardware must have auditable, authentic, and up to date system &amp; device firmware</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Hardware firmware is not immune to serious issues affecting confidentiality, integrity, or availability. Vulnerable system management controllers &amp; management engines can provide places for attackers to establish persistence, in order to re-infect and re-compromise hosts after reboots and updates.</xhtml:p>
            <xhtml:p>Ensure that the latest firmware updates are applied to all components of your systems and that the firmware is authentic and supplied by your hardware manufacturer.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Use Up-to-Date and Trusted Third-Party Software Components" urn="urn:cisecurity.org:controls:8.0:16:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type/>
                     <controls:security_function/>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>To ensure the integrity, security, and optimal performance of server hardware, it is essential to maintain system and device firmware that is verifiable, genuine, and current.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If you are a vSAN customer please ensure that storage device &amp; controller firmware versions are certified.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Host_hardware_must_enable_UEFI_Secure_Boot" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host hardware must enable UEFI Secure Boot</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>UEFI Secure Boot is a security feature of the Unified Extensible Firmware Interface (UEFI) specification. Its primary purpose is to ensure that only signed and trusted boot loaders and operating system kernels are allowed to execute during the system startup. This helps protect systems from malware and unauthorized software that might try to run before the operating system loads. By verifying the digital signatures of bootable applications and drivers, Secure Boot prevents potentially harmful code from compromising the boot process.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Use Up-to-Date and Trusted Third-Party Software Components" urn="urn:cisecurity.org:controls:8.0:16:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy System Configuration Management Tools" urn="urn:cisecurity.org:controls:7.0:5:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type/>
                     <controls:security_function/>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling UEFI Secure Boot on the ESXi host hardware helps prevent malware and untrusted configurations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Enabling this after installation may render the host unbootable. Refer to the vSphere documentation for more information about enabling Secure Boot.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Host_hardware_must_enable_Intel_TXT_if_available" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host hardware must enable Intel TXT, if available</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Intel Xeon Scalable Processor platforms have Trusted Execution Technology, or TXT, that help harden systems against malware, rootkits, BIOS &amp; firmware attacks, and more. When enabled, ESXi will take advantage of security benefits offered by this technology.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling Intel TXT (Trusted Execution Technology) on host hardware, when available, provides a hardware-based foundation for security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>In early implementations, operations such as firmware updates and abrupt system shutdowns may activate attestation alarms in vCenter Server or cause boot failures. Typically, a cold system restart offers a temporary fix, while a system firmware update provides a permanent solution. Refer to KB 78243.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Host_hardware_must_enable_and_configure_a_TPM_2.0" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host hardware must enable and configure a TPM 2.0</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>ESXi can use Trusted Platform Modules (TPM) 2.0 to enable advanced security features that prevent malware, remove dependencies, and secure hardware lifecycle operations.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy System Configuration Management Tools" urn="urn:cisecurity.org:controls:7.0:5:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling and configuring TPM 2.0 on host hardware ensures enhanced security by providing hardware-level cryptographic operations and secure storage for sensitive data and keys.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Host_integrated_hardware_management_controller_must_be_secure" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host integrated hardware management controller must be secure</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Many servers have integrated hardware management controllers that can be extremely helpful when monitoring and updating hardware, settings, and firmware. These controllers should be checked to ensure that ALL unused functionality is disabled, ALL unused access methods are disabled, passwords and password controls are set, and firewalling and access control is in place so that the only access is from authorized access workstations for the virtualization administration team.</xhtml:p>
            <xhtml:p>All "first boot" configuration options should be disabled, especially ones that reconfigure the system from USB devices that are inserted. Disable or protect USB ports attached to the management controllers. Where possible, USB ports should be set to only permit keyboards.</xhtml:p>
            <xhtml:p>Default passwords for accounts should be changed.</xhtml:p>
            <xhtml:p>External information displays should be secured to prevent information leakage. Power and information buttons should be secured against unauthorized use.</xhtml:p>
            <xhtml:p>Many hardware management controllers provide mechanisms for alerting when hardware faults &amp; configuration changes occur. You should consider those if you are not using another method for hardware monitoring.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy System Configuration Management Tools" urn="urn:cisecurity.org:controls:7.0:5:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disablement of connection methods may mean that future monitoring and management efforts require changes to the hardware management controller configurations across your fleet of servers.</xhtml:p>
                     <xhtml:p>Most hardware management controllers have CLI and API management methods that can be scripted and used from a management workstation, in lieu of additional management software or applications. Learning these techniques saves time, avoids the additional effort of installing and maintaining additional tools, and allows for timely changes to configurations.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Host_integrated_hardware_management_controller_must_enable_time_synchronization" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host integrated hardware management controller must enable time synchronization</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Cryptography, audit logging, cluster operations, and incident response/forensics depend deeply on synchronized time. This recommendation extends to all devices in infrastructure. The recommendation for NTP is to have at least four sources.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy System Configuration Management Tools" urn="urn:cisecurity.org:controls:7.0:5:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring the host integrated hardware management controller enables time synchronization provides a consistent and accurate timestamp for logs and events, which is crucial for auditing, troubleshooting, and identifying security incidents.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Host_integrated_hardware_management_controller_must_enable_remote_logging_of_events" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host integrated hardware management controller must enable remote logging of events</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The host's integrated hardware management controller provides critical out-of-band server oversight. For enhanced security, it is essential to configure this controller to log events remotely. This practice ensures that hardware-related logs are sent to an off-site location, protecting them from potential tampering and offering a centralized record of server health and activities.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling remote logging of events on the integrated hardware management controller ensures that all hardware-level activities are securely recorded off-site, providing traceability, mitigating data tampering risks, and facilitating incident response.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.8_L1_Host_integrated_hardware_management_controller_must_secure_authentication" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host integrated hardware management controller must secure authentication</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Connections to centralized authentication sources, like Active Directory, should be disabled or carefully considered as attack vectors and dependency loops (for authentication, authorization, DNS, DHCP, and time). Consider managing local accounts on these devices through the APIs and CLI interfaces provided. If Active Directory must be used for authentication do authorization locally so that an attacker with access to Active Directory cannot promote themselves through group membership.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>To prevent unauthorized access and potential malicious control of server hardware functions, it's essential to ensure that the integrated hardware management controller utilizes secure authentication mechanisms.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Not connecting hardware management controllers to centralized authentication &amp; authorization sources entails additional management. Most hardware management controllers have CLI toolkits or APIs to automate management of user accounts and/or authorization levels.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.9_L2_Host_hardware_must_enable_AMD_SEV-ES_if_available" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host hardware must enable AMD SEV-ES, if available</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>AMD EPYC platforms support SEV-ES, a technology to encrypt memory and CPU register state, and limit visibility to the hypervisor, in order to increase workload security and decrease exposure to certain types of attacks. When configured properly, vSphere supports the use of SEV-ES inside guest virtual machines and containers under vSphere and vSphere with Tanzu. Enabling SEV-ES in system firmware eases future enablement inside virtual machines, containers, and guest OSes.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling AMD SEV-ES (Secure Encrypted Virtualization-Encrypted State) on host hardware enhances the security of virtual machines by encrypting their memory and CPU state, reducing the risk of unauthorized data access and tampering from compromised hypervisors or malicious actors.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Use of SEV-ES in a particular VM requires the guest OS to support it, and will limit some operational features such as vMotion, snapshots, and so on. Consult the documentation for more information about these tradeoffs.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.10_L2_Host_hardware_must_enable_Intel_SGX_if_available" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host hardware must enable Intel SGX, if available</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Intel Xeon Scalable Processor platforms have Software Guard Extensions, or SGX, a technology that helps applications protect data in system memory. When configured properly, vSphere supports the use of SGX inside guest virtual machines. Enabling SGX in system firmware eases future enablement inside virtual machines and guest OSes.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Intel SGX (Software Guard Extensions) provides hardware-based memory encryption that protects sensitive data from unauthorized access or modification by malicious software running at higher privilege levels, enhancing server security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Use of SGX requires guest OS support, and will limit some operational features inside vSphere, such as vMotion, snapshots, fault tolerance, and suspend/resume.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.11_L2_Host_hardware_must_secure_unused_external_hardware_ports" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host hardware must secure unused external hardware ports</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Unused ports, especially USB, can be used by attackers to attach storage, networking, and keyboards. Take reasonable steps to control access to these ports through disablement, access control, and/or with other means such as solid rack doors, rack side panels, and flooring that makes the ports inaccessible from outside the rack when the rack door is closed. Cables fit easily through many gaps in and around racks and rack doors, and stiff wires can be used to push them into sockets from outside the rack, as well as to dislodge cables to create a service disruption.</xhtml:p>
            <xhtml:p>Where possible, USB ports should also be set to only permit keyboards.</xhtml:p>
            <xhtml:p>When disabling functionality like this please consider that you may need to access the server using a USB keyboard during an outage or as part of lifecycle operations, and plan accordingly.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Port Level Access Control" urn="urn:cisecurity.org:controls:7.0:1:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Unused external hardware ports can be exploited as potential entry points for unauthorized devices and malicious activity, thereby compromising server security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Security involves balancing risks, including ease of recovery from outages. Disabling external ports can hinder emergency use of the ESXi console. Servers can often toggle USB port access; ensure your choice aligns with organizational needs and is tested prior to incidents.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.12_L2_Host_integrated_hardware_management_controller_must_deactivate_internal_networking" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host integrated hardware management controller must deactivate internal networking</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Many servers have integrated hardware management controllers with the ability to present virtual network interfaces to ESXi as a management interface. These approaches create potential backdoors for access and are used by adversaries to circumvent network-based/perimeter firewalls, in either direction, and avoid observation by IDS/IPS/threat analysis tools. In many cases this functionality is not strictly necessary to manage hosts.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Manage Network Infrastructure Through a Dedicated Network" urn="urn:cisecurity.org:controls:7.0:11:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Using integrated hardware management controllers to present virtual network interfaces to ESXi can inadvertently create backdoors, allowing adversaries to bypass firewalls and evade detection by security tools; often, this functionality isn't essential for host management.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disablement of internal networking may limit vendor management tool effectiveness.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Base">
      <xccdf:title xml:lang="en">Base</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for base ESXi install.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Host_must_run_software_that_has_not_reached_End_of_General_Support_status" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must run software that has not reached End of General Support status</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The "End of General Support" (EOGS) status indicates that the software version has exceeded its primary support lifecycle, during which VMware provides new security patches, bug fixes, and technical assistance. When a product reaches this status, VMware no longer releases security updates for that version for customers outside of an extended support contract. Thus, systems still running software past its EOGS are potentially exposed to unpatched vulnerabilities and other security risks.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Running software beyond its EOGS can compromise the integrity, availability, and confidentiality of virtual environments. Keeping VMware ESXi software versions within the support period ensures that organizations have access to the latest security patches, critical updates, and vendor support.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Failing to update and maintain software versions within the support period can lead to potential security breaches, data losses, and reduced operational efficiency, as the software might become incompatible with newer technologies and lack support for emerging security threats.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Host_must_have_all_software_updates_installed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must have all software updates installed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Applying updates in a timely manner according to the severity of issues contributes greatly to the resilience of an environment. When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESXi. This sequence ensures that the management layer is updated before updating the ESXi hosts.</xhtml:p>
            <xhtml:p>
VMware publishes advisories on security vulnerabilities; for proactive notifications please subscribe to the mailing list at           <xhtml:a href="https://www.vmware.com/security/advisories.html">https://www.vmware.com/security/advisories.html</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Issues in software that impact confidentiality, integrity, and/or availability can only be removed through patching to a version that resolves the issue. Threat actors exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges on an ESXi host.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/8.0/vsphere-lifecycle-manager/GUID-74295A37-E8BB-4EB9-BFBA-47B78F0C570D.html</xccdf:ident>
         <xccdf:ident system="URL">https://kb.vmware.com/s/article/52477</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Use VMware Lifecycle Manager to update and upgrade hosts when ESXi is managed through VMware vCenter. For standalone hosts use esxcli or API-driven methods for applying updates.</xhtml:p>
                  <xhtml:p>Employ a process to keep ESXi hosts up to date with patches in accordance with industry standards and internal guidelines. Leverage the VMware Lifecycle Manager to test and apply patches as they become available.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate brief outages. ESXi hosts that are compatible with Quick Boot may be able to greatly minimize the host restart time.</xhtml:p>
                     <xhtml:p>VMware vSphere Update releases add and change system functionality, whereas Patch releases only resolve issues.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Host_must_enable_Secure_Boot_enforcement" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must enable Secure Boot enforcement</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling Secure Boot enforcement ensures that the host only loads UEFI drivers and applications with valid digital signatures, as part of the UEFI firmware standard. It requires support from the server's BIOS and hypervisor boot loader, and mandates that all ESXi kernel modules, drivers, and VIBs be signed by VMware or a trusted partner subordinate.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Organizations should enable Secure Boot enforcement to enhance the security of their virtual environments. Requiring valid digital signatures for UEFI drivers and apps mitigates the risk of offline attacks, where an attacker could transfer the ESXi install drive to a non-Secure Boot host and boot it without detection. This control establishes a trusted boot process, reducing the risk of unauthorized access and maintaining the integrity of the ESXi host.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Failing to enable Secure Boot enforcement exposes the ESXi host to potential security breaches. Without this control, an attacker could compromise the ESXi host by booting it on a non-Secure Boot host, bypassing ESXi's protections. This could lead to unauthorized access, data breaches, and compromise of the virtual environment's integrity. Enabling Secure Boot enforcement is crucial for maintaining a secure and trusted ESXi host, mitigating potential negative impacts, and safeguarding the virtual infrastructure.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Host_image_profile_acceptance_level_must_be_PartnerSupported_or_higher" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host image profile acceptance level must be PartnerSupported or higher</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The acceptance level on ESXi regulates the type of software that can be installed on the system, with four distinct levels: VMwareCertified, VMwareAccepted, PartnerSupported, and CommunitySupported. It's advised to set the acceptance level to PartnerSupported or higher to ensure that only tested and digitally signed vSphere Installation Bundles (VIBs) are allowed for installation.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The ESXi Image Profile should only allow signed VIBs because an unsigned VIB represents untested code installed on an ESXi host. Also, use of unsigned VIBs will cause hypervisor Secure Boot to fail to configure. Community Supported VIBs do not have digital signatures. To protect the security and integrity of your ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To verify the host image profile acceptance level perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
, then under                 <xhtml:span class="inline_block">System</xhtml:span>
 select                 <xhtml:span class="inline_block">Security Profile</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Under                 <xhtml:span class="inline_block">Host Image Profile Acceptance Level</xhtml:span>
 select                 <xhtml:span class="inline_block">Edit</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
In the dropdown select one of the following -                 <xhtml:span class="inline_block">VMware Certified</xhtml:span>
,                 <xhtml:span class="inline_block">VMware Accepted</xhtml:span>
, or                 <xhtml:span class="inline_block">Partner Supported</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command (in the example code, the level is Partner Supported):</xhtml:p>
                  <xhtml:code class="code_block">
# Set the Software AcceptanceLevel for each host&lt;span&gt;              <br/>
Foreach ($VMHost in Get-VMHost ) {              <br/>
 $ESXCli = Get-EsxCli -VMHost $VMHost              <br/>
 $ESXCli.software.acceptance.Set("PartnerSupported")              <br/>
}
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Restricting the acceptance level to PartnerSupported or higher prevents the installation of CommunitySupported packages, which are unsigned and hence, potentially unreliable or insecure. This restriction, while enhancing security, might limit the range of software that can be installed on the ESXi host.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688987"/>
            </check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688988"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Host_must_only_run_binaries_delivered_via_signed_VIB" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must only run binaries delivered via signed VIB</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The ESXi host is configured to only execute binaries originating from a valid, signed vSphere Installable Bundle (VIB) to enhance the integrity of the system. This measure thwarts attackers' attempts to use prebuilt toolkits on the host. The parameter governing this behavior is VMkernel.Boot.execInstalledOnly with a recommended setting of True.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Respond</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Configure Automatic Anti-Malware Signature Updates" urn="urn:cisecurity.org:controls:8.0:10:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Anti-Malware Software and Signatures are Updated" urn="urn:cisecurity.org:controls:7.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring the execution of only signed binaries significantly mitigates the risk of running malicious or unverified code, thus enhancing the hosts security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This security control may hinder the installation or execution of third-party unsigned software, potentially impacting the flexibility and extensibility of the ESXi host environment.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Host_must_have_reliable_time_synchronization_sources" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must have reliable time synchronization sources</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensuring reliable time synchronization is crucial as various functions like cryptography, audit logging, cluster operations, and incident response/forensics are heavily dependent on synchronized time. Utilizing at least four NTP sources is recommended for achieving reliable time synchronization. Alternatively, PTP can be employed for sub-millisecond time accuracy, with NTP configured as a backup to maintain time synchronization resilience in case of primary server failure.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
                  <xhtml:strong>Notes:</xhtml:strong>
 Verify the NTP firewall ports are open. It is recommended to synchronize the ESXi clock with a time server that is located on the management network rather than directly with a time server on a public network. This time server can then synchronize with a public source through a strictly controlled network connection with a firewall.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Reliable time synchronization supports accurate auditing, cryptographic integrity, cluster operations, and effective incident response/forensics. Having multiple time sources enhances the reliability and accuracy of time synchronization, which is fundamental for secure and efficient system operations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC-A6CECA52F6CC.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To enable and properly configure NTP synchronization, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select a host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Time Configuration</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Edit</xhtml:span>
 next to Network Time Protocol              </xhtml:li>
                     <xhtml:li>
Select the                 <xhtml:span class="inline_block">Enable</xhtml:span>
 box, then fill in the appropriate NTP Servers.              </xhtml:li>
                     <xhtml:li>
in the                 <xhtml:span class="inline_block">NTP Service Startup Policy</xhtml:span>
 drop down select                 <xhtml:span class="inline_block">Start and stop with host</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set the NTP Settings for all hosts              <br/>
# If an internal NTP server is used, replace pool.ntp.org with               <br/>
# the IP address or the Fully Qualified Domain Name (FQDN) of the internal NTP server              <br/>
$NTPServers = "pool.ntp.org", "pool2.ntp.org"              <br/>
Get-VMHost | Add-VmHostNtpServer $NTPServers
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Inadequate time synchronization may lead to erroneous system logs, compromised cryptographic operations, inefficient cluster operations, and hindered incident response efforts. The resilience and accuracy of time synchronization are vital for maintaining operational integrity and security posture.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688989" value-id="xccdf_org.cisecurity.benchmarks_value_4688989_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688989"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Host_must_have_time_synchronization_services_enabled_and_running" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must have time synchronization services enabled and running</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure the host has time synchronization services enabled and operational as many functions such as cryptography, audit logging, cluster operations, and incident response/forensics depend on synchronized time. Services like NTP or PTP should be configured to start with the host and remain running to maintain time synchronization.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Having accurate time synchronization is crucial for the correct operation and auditing of the system. This will assist in incident response, forensics, and ensure that cryptographic functions operate correctly.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Failure to maintain time synchronization can lead to inaccurate logging, which could complicate incident response and forensic analysis. It may also affect the functioning of cluster operations and cryptographic protocols.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Host_must_require_TPM-based_configuration_encryption" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must require TPM-based configuration encryption</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The host should enforce TPM-based configuration encryption to secure its configuration files, notably within the /etc/ directory or other namespaces. From vSphere 7.0 Update 2 onwards, configuration files archived are encrypted, leveraging a Trusted Platform Module (TPM) to "seal" the configuration to the host, thereby enhancing security against offline attacks. This encryption, once enabled, is irreversible and utilizes the physical TPM present during installation or upgrade.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Implementing TPM-based configuration encryption significantly bolsters security by protecting configuration files from unauthorized access and alterations. This measure is crucial for safeguarding the integrity of host configurations and preventing potential offline attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Enabling TPM-based configuration encryption alongside Secure Boot renders traditional root password recovery methods ineffective. It's imperative to ensure continued access to administrator accounts on ESXi to avoid access issues.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Host_must_not_suppress_warnings_about_unmitigated_hyperthreading_vulnerabilities" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must not suppress warnings about unmitigated hyperthreading vulnerabilities</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>It is imperative to retain hyperthreading security warnings as they indicate unmitigated CPU vulnerabilities. The parameter governing this behavior is UserVars.SuppressHyperthreadWarning, with a recommended setting of 0.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Retain Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Retaining these warnings ensures that potential CPU vulnerabilities are not overlooked, promoting a proactive approach towards addressing hardware-related security concerns.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact is associated with this security control, however, ignoring hyperthreading warnings could obscure existing CPU vulnerabilities, potentially jeopardizing system security.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.10_L1_Host_must_restrict_inter-VM_transparent_page_sharing" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must restrict inter-VM transparent page sharing</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Transparent Page Sharing (TPS) aids in optimizing memory usage among virtual machines but under certain circumstances can be exploited to access data on adjacent virtual machines unauthorizedly. By configuring the Mem.ShareForceSalting parameter, inter-VM TPS is restricted, enhancing isolation and security. The parameter governing this behavior is Mem.ShareForceSalting with a recommended setting of 2.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting inter-VM TPS is crucial to prevent potential unauthorized access to data, ensuring an extra layer of isolation and security between virtual machines which is indispensable especially in a multi-tenant environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://kb.vmware.com/s/article/2097593</xccdf:ident>
         <xccdf:ident system="URL">https://blogs.vmware.com/vsphere/2015/01/assess-the-performance-impact-of-the-security-change-in-transparent-page-sharing-behaviour.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>From the vSphere Web Client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select a host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Advanced System settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Edit</xhtml:span>
 then Filter for                 <xhtml:span class="inline_block">Mem.ShareForceSalting</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set the value to                 <xhtml:span class="inline_block">2</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Additionally, the following PowerCLI command can be used:</xhtml:p>
                  <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting | Set-AdvancedSetting -Value 2
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no noted functional impact, indicating that restricting inter-VM TPS does not adversely affect the systems performance or operations while bolstering security against potential data access exploits.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688992" value-id="xccdf_org.cisecurity.benchmarks_value_4688992_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688992"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.11_L1_Host_must_use_sufficient_entropy_for_cryptographic_operations" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must use sufficient entropy for cryptographic operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Starting with vSphere 8.0, ESXi has enhanced its entropy implementation to align with FIPS 140-3 and EAL4 certifications, ensuring a robust foundation for cryptographic operations. Kernel boot options dictate the activation of entropy sources on an ESXi host. The parameter governing this behavior is disableHwrng = FALSE and entropySources = 0.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Employing adequate entropy is crucial for ensuring the strength of cryptographic operations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.12_L2_Host_must_enable_volatile_key_destruction" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host must enable volatile key destruction</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>By default, ESXi ensures that pages allocated for virtual machines (VMs), userspace applications, and kernel threads are zeroed out at the time of allocation, to prevent the exposure of sensitive data like cryptographic keys to other clients. However, these keys can remain in host memory for an extended period if the memory is not reused. The Mem.MemEagerZero parameter can be configured to enforce the zeroing out of userworld and guest memory pages when a userworld process or guest exits, and for kernel threads, memory spaces holding keys are zeroed out as soon as the secret is no longer needed. This practice adheres to the NIAP Virtualization Protection Profile and Server Virtualization Extended Package requirements of zeroing memory that may contain cryptographic keys upon process exit. The parameter governing this behavior is Mem.MemEagerZero with a recommended setting of 1.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling volatile key destruction through the Mem.MemEagerZero parameter enhances the security posture by ensuring that sensitive information such as cryptographic keys are not left residually in the system memory, which could be exploited by malicious entities. This configuration aligns with the guidelines provided by the NIAP Virtualization Protection Profile and Server Virtualization Extended Package, indicating its criticality in maintaining a secure virtualized environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Activating volatile key destruction through the Mem.MemEagerZero parameter results in additional shutdown time required for virtual machines, corresponding to the amount of allocated memory. While this may extend the downtime during reboots or migrations, the trade-off ensures a higher level of security by preventing the potential exposure of sensitive data, fulfilling compliance requirements, and aiding in the effective management of cryptographic materials within the virtualized environment.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Management">
      <xccdf:title xml:lang="en">Management</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations related to ESXi access management.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Host_should_deactivate_SSH" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host should deactivate SSH</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Secure Shell (SSH) provides remote access to the ESXi shell, enabling direct host console access or remote connectivity. Deactivating SSH is a security measure aimed at minimizing remote access channels to the ESXi host, restricting it to essential connections only through vSphere Client, vCLI/PowerCLI, or published APIs. The service status should be set to "Stopped", allowing manual start and stop for troubleshooting or diagnostic activities when necessary.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting remote access by deactivating SSH reduces potential attack vectors, promoting a secure operating environment. Enabling SSH only for diagnostics or troubleshooting ensures controlled access, aligning with security best practices.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769-DA76C2BC9FFE.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disable SSH, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 and select                 <xhtml:span class="inline_block">Services</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">SSH</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit Startup Policy</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set the Startup Policy is set to                 <xhtml:span class="inline_block">Start and Stop Manually</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
While                 <xhtml:span class="inline_block">ESXi Shell</xhtml:span>
 is still selected click                 <xhtml:span class="inline_block">Stop</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set SSH to start manually rather than automatically for all hosts              <br/>
Get-VMHost | Get-VMHostService | Where { $_.key -eq "TSM-SSH" } | Set-VMHostService -Policy Off
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted; however, the measure requires alternative methods for remote management, such as vSphere Client or command-line tools, which may demand additional configurations or toolset proficiency.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688990"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Host_must_deactivate_the_ESXi_shell" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must deactivate the ESXi shell</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The ESXi shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. Activities performed from the ESXi Shell bypass all access controls, but are logged. The recommended setting for the ESXi shell is to be stopped and only started manually when needed, such as when running diagnostics or troubleshooting.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring non-essential services like the ESXi Shell are deactivated enhances the security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D-8F5D-0D5621D65DAE.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D-860F-96C0819570A8.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disable the ESXi shell, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 and select                 <xhtml:span class="inline_block">Services</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ESXi Shell</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit Startup Policy</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set the Startup Policy is set to                 <xhtml:span class="inline_block">Start and Stop Manually</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set the ESXi shell to start manually rather than automatically for all hosts              <br/>
Get-VMHost | Get-VMHostService | Where { $_.key -eq "TSM" } | Set-VMHostService -Policy Off
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact is recorded. However, if ESXi shell functionalities are needed, manual activation is required.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688991"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Host_must_deactivate_the_ESXi_Managed_Object_Browser_MOB" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must deactivate the ESXi Managed Object Browser (MOB)</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Managed Object Browser (MOB) is a web-based server application that lets you examine and change system objects and configurations. It is a prudent security measure to deactivate the MOB unless it's essential for operations. The parameter governing this behavior is Config.HostAgent.plugins.solo.enableMob with a recommended setting of False.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>Some third-party tools use the MOB to gather information. Use the following command to re-enable the MOB temporarily for third-party tool usage:</xhtml:p>
               <xhtml:p>To disabled MOB, perform the following from the vSphere Web Client:</xhtml:p>
               <xhtml:ol>
                  <xhtml:li>Select a host</xhtml:li>
                  <xhtml:li>
Click               <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand               <xhtml:span class="inline_block">System</xhtml:span>
 then select               <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
.            </xhtml:li>
                  <xhtml:li>
Click               <xhtml:span class="inline_block">Edit</xhtml:span>
 then search for               <xhtml:span class="inline_block">Config.HostAgent.plugins.solo.enableMob</xhtml:span>
                  </xhtml:li>
                  <xhtml:li>
Set the value to               <xhtml:span class="inline_block">true</xhtml:span>
.            </xhtml:li>
                  <xhtml:li>
Click               <xhtml:span class="inline_block">OK</xhtml:span>
.            </xhtml:li>
               </xhtml:ol>
               <xhtml:p>
                  <xhtml:strong>Note 2:</xhtml:strong>
 You must enable MOB from the vSphere interface not via the             <xhtml:span class="inline_block">vim-cmd</xhtml:span>
 command.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating non-essential services like MOB adheres to the principle of least functionality, reducing potential attack vectors.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697-04BDC9173EA3.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disabled MOB, perform the following from the vSphere Web Client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select a host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Edit</xhtml:span>
 then search for                 <xhtml:span class="inline_block">Config.HostAgent.plugins.solo.enableMob</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Set the value to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 You cannot disable the MOB while a host is in lockdown mode.            </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note 2:</xhtml:strong>
 You must disable MOB from the vSphere interface not via the               <xhtml:span class="inline_block">vim-cmd</xhtml:span>
 command.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no specified functional impact; however, if MOB functionalities are needed later, manual reactivation is required.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688993" value-id="xccdf_org.cisecurity.benchmarks_value_4688993_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688993"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Host_must_deactivate_SLP" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must deactivate SLP</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Service Location Protocol (SLP) is used for the discovery and selection of network services in local area networks, which simplifies configuration by allowing computers to find necessary services automatically. The practice of deactivating SLP when not in use aligns with the principle of minimizing the attack surface by shutting down non-essential services. The recommended setting is to have the SLP service stopped, with the ability to start and stop it manually as required.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating non-essential services like SLP minimizes potential vectors of attack, thereby enhancing the host's security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted, however, manual intervention is required to start the SLP service when needed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_L1_Host_must_deactivate_CIM" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must deactivate CIM</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Deactivating the Common Information Model (CIM) service, when not in use, aligns with the principle of minimizing the attack surface by disabling non-essential services. This action helps in reducing the potential vectors of attack, thus bolstering the host's security posture.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating non-essential services like CIM mitigates potential security risks associated with these services. This measure adheres to the principle of least functionality, which posits that only necessary services should be active to fulfill operational requirements.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact has been specified. However, the deactivation of CIM might require administrators to manually start or stop the service when needed, potentially affecting operational workflows if CIM is required at a later stage.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_L1_Host_should_deactivate_SNMP" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host should deactivate SNMP</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Simple Network Management Protocol (SNMP) facilitates the management of networked devices. Minimize attack surface by disabling non-essential services. The recommended setting is to have the SNMP service stopped unless required and configured securely.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating SNMP when it's not needed reduces the attack surface, adhering to a minimalistic approach in service operation.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While there isn't a direct functional impact, the absence of SNMP may require alternative methods for network management and monitoring.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Host_must_automatically_terminate_idle_DCUI_sessions" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must automatically terminate idle DCUI sessions</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>By configuring a session timeout, unattended console sessions are automatically terminated, thereby reducing the potential security risks associated with lingering active sessions. The parameter governing this behavior is UserVars.DcuiTimeOut, with a recommended setting of 600 (10 minutes).</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Automated termination of idle DCUI sessions enhances the security posture by minimizing the window of opportunity for unauthorized access through unattended sessions. It enforces a good security hygiene practice by ensuring that inactive sessions do not remain open indefinitely, which is in line with the principle of least privilege.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To correct the DCUI timeout setting, perform the following steps:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
, then under                 <xhtml:span class="inline_block">System</xhtml:span>
 select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Edit</xhtml:span>
 then enter                 <xhtml:span class="inline_block">UserVars.DcuiTimeOut</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>Click in the box for the current value, then set the value to 600 seconds or less.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut | Set-AdvancedSetting -Value 600
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While there's no functional impact specified, setting a timeout value that's too short may inconvenience users by terminating sessions prematurely, possibly interrupting workflow. Conversely, a timeout value that's too long may not adequately mitigate the risks associated with idle sessions. Hence, a balanced approach in configuring the session timeout value, aligned with the organizational security policy and user workflow, is crucial.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688995" value-id="xccdf_org.cisecurity.benchmarks_value_4688995_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688995"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.8_L1_Host_must_automatically_terminate_idle_shells" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must automatically terminate idle shells</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The host should be configured to automatically terminate idle shell sessions to prevent potential unauthorized access due to forgotten logouts. Setting a timeout for idle SSH connections ensures that any unattended sessions are closed, thereby reducing the security risk. The parameter governing this behavior is UserVars.ESXiShellInteractiveTimeOut with a recommended setting of 900.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
It is recommended to set the             <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
 together with             <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Automatically terminating idle shells minimizes the risks associated with unattended sessions. It is a proactive measure to prevent potential unauthorized access to the host.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://kb.vmware.com/kb/2004746</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the timeout to the desired value, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the value for this parameter is set to the appropriate value (                <xhtml:span class="inline_block">300</xhtml:span>
 seconds or less).              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 A value of 0 disables the ESXi ShellInteractiveTimeOut.            </xhtml:p>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts              <br/>
Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellInteractiveTimeOut' | Set-AdvancedSetting -Value "300"
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no identified negative impact associated with enforcing this control as it serves to bolster the host's security posture.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688998" value-id="xccdf_org.cisecurity.benchmarks_value_4688998_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688998"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Host_must_automatically_deactivate_shell_services" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must automatically deactivate shell services</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling the automatic deactivation of shell services minimizes the attack surface on the host. The time window for the ESXi Shell and SSH services' availability is defined by UserVars.ESXiShellTimeOut, after which these services are terminated. The recommended setting for this parameter is 600.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>This value can be set in minutes via the DCUI. When using the vCenter GUI or PowerShell API, the value is set in seconds.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Automatically deactivating shell services after a defined time window helps in reducing the risk associated with potential unauthorized access, ensuring a more secure ESXi host environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42-B40B-71E4C83DEEFB.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68-8096-F009B87ACB33.html</xccdf:ident>
         <xccdf:ident system="URL">http://kb.vmware.com/kb/2004746</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027-0280B9ED1009.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the timeout to the desired value, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the value for this parameter is set to                 <xhtml:span class="inline_block">3600</xhtml:span>
 (1 hour) or less              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 A value of 0 disables the ESXiShellTimeOut.            </xhtml:p>
                  <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set UserVars.ESXiShellTimeOut to 3600 on all hosts              <br/>
Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellTimeOut' | Set-AdvancedSetting -Value "3600"
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There's no negative functional impact identified with this control; it contributes towards enhancing the host's security posture by limiting the availability of shell services.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689001" value-id="xccdf_org.cisecurity.benchmarks_value_4689001_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689001"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Host_must_not_suppress_warnings_that_the_shell_is_enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must not suppress warnings that the shell is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Having warnings for enabled SSH or ESXi Shell provides insight into potential security risks. Disabling such warnings can mask ongoing attacks. The parameter governing this behavior is UserVars.SuppressShellWarning with a recommended value of 0.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Tune Security Event Alerting Thresholds" urn="urn:cisecurity.org:controls:8.0:13:11">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Maintaining visibility of shell service status through warnings is crucial for monitoring and early detection of unauthorized activities, helping in promptly addressing potential security threats.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No negative functional impact is associated with this control; it enhances monitoring and response to potential security threats by ensuring warnings are visible and not suppressed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.11_L1_Host_must_enforce_password_complexity" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must enforce password complexity</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The enforcement of password complexity is managed through the Security.PasswordQualityControl parameter, allowing configuration of password length, character set requirements, and failed logon attempt restrictions. The recommended setting is "retry=3 min=disabled,15,15,15,15 max=64 similar=deny passphrase=3".</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Abiding by NIST 800-63B Section 5.1.1.2 guidelines, not enforcing traditional composition rules facilitates the adoption of longer, more secure passphrases, enhancing overall security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.openwall.com/passwdqc/README.shtml</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73-05ACDAE6BE43.html</xccdf:ident>
         <xccdf:ident system="URL">https://www.cisecurity.org/white-papers/cis-password-policy-guide/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the password complexity requirements, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Login to the ESXi shell as a user with administrator privileges.</xhtml:li>
                     <xhtml:li>
Open                 <xhtml:span class="inline_block">/etc./pam.d/passwd</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Locate the following line:</xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">  password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4
</xhtml:code>
                  <xhtml:ol start="4">
                     <xhtml:li>
Set N0 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set N1 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set N2 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set N3 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set N4 to                 <xhtml:span class="inline_block">14</xhtml:span>
 or greater.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Altering password complexity via Security.PasswordQualityControl may cause installation issues with other products and services within the VMware ecosystem not expecting such changes.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.12_L1_Host_must_lock_an_account_after_a_specified_number_of_failed_login_attempts" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must lock an account after a specified number of failed login attempts</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The security control involves restricting account access following a specified number of failed login attempts, acting as a deterrent against brute-force attacks. This control is applicable for SSH and vSphere Web Services SDK access, though not for the Direct Console Interface (DCUI) and the ESXi Shell. A default setting allows five failed attempts before account lockout, with automatic unlock after 15 minutes. The parameter governing this behavior is Security.AccountLockFailures with a recommended setting of 5.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Process for Revoking Access" urn="urn:cisecurity.org:controls:7.0:16:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Implementing this control bolsters the host's resilience against unauthorized access attempts, safeguarding system integrity. By thwarting brute-force attacks, it significantly elevates the security posture, making unauthorized access more challenging.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://code.vmware.com/apis/196/vsphere#https://vdc-repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029-bc416323cb22/fa0b429a-a695-4c11-b7d2-2cbc284049dc/doc/vim.option.OptionManager.html</xccdf:ident>
         <xccdf:ident system="URL">https://www.cisecurity.org/white-papers/cis-password-policy-guide/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the maximum failed login attempts correctly, perform the following steps:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">Security.AccountLockFailures</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the value for this parameter to                 <xhtml:span class="inline_block">5</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures | Set-AdvancedSetting -Value 5
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>A potential downside is the inadvertent denial-of-service scenario, especially with a low threshold for login failures. This could be exploited maliciously or trigger accidental lockouts, impacting system accessibility and possibly demanding additional administrative effort for account resets.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689006" value-id="xccdf_org.cisecurity.benchmarks_value_4689006_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689006"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.13_L1_Host_must_unlock_accounts_after_a_specified_timeout_period" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must unlock accounts after a specified timeout period</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensuring that user accounts on the ESXi host are automatically unlocked after a specified period contributes to a balance between security and operational usability. This mechanism reactivates idle accounts promptly while mitigating potential unauthorized access risks. It's configured through a specific parameter which, when adjusted, defines the duration of the lockout period. The parameter governing this behavior is Security.AccountUnlockTime with a recommended setting of 900 seconds.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This setting reduces the inconvenience for benign users and the overhead on administrators, while also slowing down brute force credential stuffing attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://code.vmware.com/apis/1067/vsphere</xccdf:ident>
         <xccdf:ident system="URL">https://www.cisecurity.org/white-papers/cis-password-policy-guide/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the account lockout to 15 minutes, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">Security.AccountUnlockTime</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the value for this parameter to                 <xhtml:span class="inline_block">900</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime | Set-AdvancedSetting -Value 900
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact noted. The parameters configuration ensures a security-usability balance, although misconfiguration could either expose the system to unauthorized access or disrupt user operations.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689008" value-id="xccdf_org.cisecurity.benchmarks_value_4689008_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689008"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.14_L1_Host_must_configure_the_password_history_setting_to_restrict_the_reuse_of_passwords" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must configure the password history setting to restrict the reuse of passwords</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The goal is to inhibit the reuse of past passwords, acting as a deterrent against potential security breaches stemming from the exploitation of old, compromised credentials. This is achieved by configuring the Security.PasswordHistory parameter, which specifies the number of unique passwords a user must cycle through before a previous password can be reused. The recommended setting for this parameter is 5.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By enforcing a password history policy, organizations make it harder for malicious actors to gain unauthorized access using old passwords. This in turn elevates the overall security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.cisecurity.org/white-papers/cis-password-policy-guide/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the password history 5, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">Security.PasswordHistory</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the value for this parameter is set to                 <xhtml:span class="inline_block">5</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, the following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting Security.PasswordHistory | Set-AdvancedSetting -Value 5
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The impact of altering the Security.PasswordHistory parameter is dependent on the chosen value. A lower value might diminish security by allowing password reuse sooner, while a higher value increases security but may also increase the likelihood of user frustration.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.15_L1_Host_must_be_configured_with_an_appropriate_maximum_password_age" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must be configured with an appropriate maximum password age</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Implementing a maximum password age, as determined by the Security.PasswordMaxDays parameter, is aligned with modern password policies outlined in NIST 800-63B Section 5.1.1.2, which argue against forced periodic password changes provided that passwords have sufficient complexity. The parameter governing this behavior is Security.PasswordMaxDays with a recommended setting of 99999.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Aligning with modern security standards by configuring an appropriate maximum password age can help in maintaining a balance between security and usability. This setting negates the need for periodic password changes, which have not been shown to significantly enhance security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Adjusting the Security.PasswordMaxDays parameter may affect vSphere UIs, requiring an email address for alert configurations. This necessitates either the provision of an email address or the use of PowerCLI for configuration, with the latter also requiring the configuration of an SMTP server in vCenter Server for email alerts. Various regulatory compliance frameworks have differing opinions of this practice.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.16_L1_Host_must_configure_a_session_timeout_for_the_API" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must configure a session timeout for the API</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A designated timeout ensures that sessions are not left open indefinitely, thereby reducing the exposure window for potential security threats. The parameter governing this behavior is Config.HostAgent.vmacore.soap.sessionTimeout with a recommended setting of 30 seconds.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Use of Secure Network Management and Communication Protocols" urn="urn:cisecurity.org:controls:8.0:12:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Port Level Access Control" urn="urn:cisecurity.org:controls:7.0:1:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A session timeout ensures that potential security threats from unauthorized users or malicious software exploiting open sessions are significantly reduced.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted when configuring this security control, making it a low-risk enhancement towards securing the ESXi environment.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.17_L1_Host_must_automatically_terminate_idle_host_client_sessions" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must automatically terminate idle host client sessions</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configuring the host to automatically terminate idle host client sessions helps mitigate security risks associated with unattended sessions, which could potentially be exploited. The recommended setting for this control is a timeout value of 900. The parameter governing this behavior is UserVars.HostClientSessionTimeout.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Use of Secure Network Management and Communication Protocols" urn="urn:cisecurity.org:controls:8.0:12:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Port Level Access Control" urn="urn:cisecurity.org:controls:7.0:1:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Automatic termination of idle sessions is crucial for preventing potential unauthorized access or exploitation of unattended sessions, thereby enhancing the host's security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact mentioned, but ensuring a balanced timeout value is essential to prevent inadvertent session terminations while maintaining security.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.18_L1_Host_must_have_an_accurate_DCUI.Access_list" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must have an accurate DCUI.Access list</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The DCUI.Access parameter in VMware ESXi is used to specify a list of users who are permitted to access the Direct Console User Interface (DCUI) of the ESXi host, especially when Lockdown Mode is enabled. This parameter helps in controlling and securing access to the ESXi host by allowing only authorized users to override Lockdown Mode and access the DCUI, particularly in scenarios where the host becomes isolated from vCenter. The parameter governing this behavior is DCUI.Access.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Establish and Maintain an Inventory of Accounts" urn="urn:cisecurity.org:controls:8.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Maintain an Inventory of Accounts" urn="urn:cisecurity.org:controls:7.0:16:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
                  <xhtml:strong>Note:</xhtml:strong>
 By default only the "root" user is a member of the DCUI.Access list. It is not recommended to remove root from the DCUI.Access list, as this will revoke the root user's admin privileges on the host.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A properly configured DCUI.Access list ensures that only authorized users can override Lockdown Mode to access DCUI, providing a fail-safe against loss of management capability especially if the host loses connection to vCenter.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116-A8353D19FF56.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set a trusted users list for DCUI, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Enter                 <xhtml:span class="inline_block">DCUI.Access</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the                 <xhtml:span class="inline_block">DCUI.Access</xhtml:span>
 attribute is set to a comma-separated list of the users who are allowed to override lockdown mode.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Misconfiguration could lead to unauthorized access or potential lockout scenarios, making it crucial to validate the list and ensure the host's attachment to vCenter alongside correctly configured access and exception lists prior to Lockdown Mode activation.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689011" value-id="xccdf_org.cisecurity.benchmarks_value_4689011_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689011"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.19_L1_Host_must_have_an_accurate_Exception_Users_list" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must have an accurate Exception Users list</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Establishing an accurate Exception Users list is essential for managing user privileges during lockdown mode. Users on this list retain their privileges, making it imperative to include only those necessary for direct host access like service accounts for third-party solutions. Ensuring a well-maintained list mitigates the risk associated with unauthorized actions, especially during host isolation scenarios in lockdown mode.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Establish and Maintain an Inventory of Accounts" urn="urn:cisecurity.org:controls:8.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Maintain an Inventory of Accounts" urn="urn:cisecurity.org:controls:7.0:16:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The Exception Users list is crucial for preserving necessary operational capabilities while maintaining a secure environment. By carefully managing this list, organizations can balance between security and functionality, ensuring that critical operations continue unhindered during lockdown mode.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6CD8C2E3-7925-4706-8271-F42F2BCFF95D.html?hWord=N4IghgNiBcIQ9gYwNYBN4HcB2ACAtvKgKYgC+QA</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
To correct the membership of the               <xhtml:span class="inline_block">Exception Users</xhtml:span>
 list, perform the following in the vSphere Web Client:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select the host.</xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 and select                 <xhtml:span class="inline_block">Security Profile</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Edit</xhtml:span>
 next to                 <xhtml:span class="inline_block">Lockdown Mode</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Exception Users</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Add or delete users as appropriate.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>An improperly managed Exception Users list could potentially undermine the security posture by allowing unauthorized access, increasing the risk of malicious actions. It's vital to review and update this list regularly to align with the current operational and security requirements.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.20_L1_Host_must_enable_normal_lockdown_mode" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must enable normal lockdown mode</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Implementing normal lockdown mode restricts direct access to ESXi hosts, mandating management via vCenter Server to uphold defined roles and access controls, mitigating risks associated with unauthorized or insufficiently audited activities. Exception Users list serves as an override mechanism, permitting specified users direct access even in lockdown mode. This mode offers a balanced approach between security and operational flexibility compared to the stricter lockdown mode which, if connectivity to vCenter Server is lost, necessitates host rebuilding.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling normal lockdown mode enforces centralized management through vCenter Server, ensuring adherence to organizational access controls and auditing policies. This measure significantly lowers the risk of unauthorized activities by restricting direct host access, promoting a more controlled and auditable operational environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838-225F5FF480FF.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To enable lockdown mode, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 and select                 <xhtml:span class="inline_block">Security Profile</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Across from                 <xhtml:span class="inline_block">Lockdown Mode</xhtml:span>
 click on                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click the radio button for                 <xhtml:span class="inline_block">Normal</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Enable lockdown mode for each host              <br/>
Get-VMHost | Foreach { $_.EnterLockdownMode() }
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The activation of lockdown mode may impede direct host access for certain operations like backup and troubleshooting. Although temporary deactivation is an option, ensuring proper reactivation post-operation is crucial to maintain the intended security posture.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689013" value-id="xccdf_org.cisecurity.benchmarks_value_4689013_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689013"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.21_L2_Host_should_enable_strict_lockdown_mode" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Host should enable strict lockdown mode</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling lockdown mode disables direct local access to an ESXi host, requiring the host be managed remotely from vCenter Server.</xhtml:p>
            <xhtml:p>There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, lockdown mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.</xhtml:p>
            <xhtml:p>Note: Lockdown mode does not apply to users who log in using authorized keys. Also, users in the DCUI.Access list for each host are allowed to override lockdown mode and log in to the DCUI. By default, the "root" user is the only user listed in the DCUI.Access list.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Lockdown mode limits ESXi host access to the vCenter server to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.  Additionally strict lockdown move will disabled DCUI - Disabling DCUI prevents all local activity, and thus forces actions to be performed in vCenter Server, where they can be centrally audited and monitored.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838-225F5FF480FF.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To enable lockdown mode, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 and select                 <xhtml:span class="inline_block">Security Profile</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Across from                 <xhtml:span class="inline_block">Lockdown Mode</xhtml:span>
 click on                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click the radio button for                 <xhtml:span class="inline_block">Strict</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Enable lockdown mode for each host              <br/>
Get-VMHost | Foreach { $_.EnterLockdownMode() }
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>With lockdown mode enabled the host will only be accessible through vCenter preventing 'local' access.  Disabling the DCUI can create a potential "lockout" situation, should the host become isolated from vCenter Server. Recovering from a "lockout" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689015" value-id="xccdf_org.cisecurity.benchmarks_value_4689015_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689015"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.22_L1_Host_must_deny_shell_access_for_the_dcui_account" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must deny shell access for the dcui account</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The dcui account, utilized for process isolation for the Direct Console User Interface (DCUI), possesses shell access which, when deactivated, minimizes the attack surface. This action is a proactive measure to enhance system security.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Allowlist Authorized Scripts" urn="urn:cisecurity.org:controls:8.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Application Whitelisting" urn="urn:cisecurity.org:controls:7.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Implement Application Whitelisting of Libraries" urn="urn:cisecurity.org:controls:7.0:2:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Implement Application Whitelisting of Scripts" urn="urn:cisecurity.org:controls:7.0:2:9">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating shell access for the dcui account reduces the avenues of exploitation available to potential attackers. It is a prudent step towards a hardened security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted from denying shell access for the dcui account, making it a low-risk yet effective security control.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.23_L2_Host_must_deny_shell_access_for_the_vpxuser_account" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host must deny shell access for the vpxuser account</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Deactivating shell access for the vpxuser account enhances security by enforcing an "API only" stance for predefined non-root ESXi users such as vpxuser and dcui.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Allowlist Authorized Scripts" urn="urn:cisecurity.org:controls:8.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Application Whitelisting" urn="urn:cisecurity.org:controls:7.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Implement Application Whitelisting of Libraries" urn="urn:cisecurity.org:controls:7.0:2:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Implement Application Whitelisting of Scripts" urn="urn:cisecurity.org:controls:7.0:2:9">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This control reduces the attack surface by limiting the avenues through which system configurations can be altered, aligning with modern least privilege principles and ensuring that privileged authentication through vCenter Server remains tightly controlled.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Deactivating shell access prevents users from granting shell access to others or changing passwords of users who have shell access, necessitating host-by-host reconfiguration through an authorized account if changes are required. This could potentially impact third-party workflows and necessitates the retention of at least one fully privileged user for necessary configurations.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.24_L1_Host_must_display_a_login_banner_for_the_DCUI_and_Host_Client" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must display a login banner for the DCUI and Host Client</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling a login banner on the Direct Console User Interface (DCUI) and the Host Client interfaces provides a mechanism to display legal notices or organizational announcements at login. The parameter governing this behavior is Annotations.WelcomeMessage, with the recommended value being a text string aligned with organizational or legal advisories.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A login banner serves as a first line of legal defense against unauthorized access and misuse, stating the terms and conditions of system use. It also aids in reinforcing organizational security policies among authorized users.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Implementation masks the "F2/F12" options and IP address information on the DCUI, potentially requiring additional documentation or training to ensure users are aware of these changes.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.25_L1_Host_must_display_a_login_banner_for_SSH_connections" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must display a login banner for SSH connections</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>ESXi facilitates the display of a login message, primarily aimed to deter unauthorized access and inform legitimate users regarding system usage obligations, particularly during SSH connections. The text for this display is defined by a specific parameter, which is advisable to be configured, especially when SSH is active, albeit it's recommended to keep SSH in a stopped state barring troubleshooting scenarios. The parameter governing this behavior is Config.Etc.Issue.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Displaying a login banner serves as a preliminary deterrent to unauthorized users while reinforcing legal and policy compliances for authorized users. It encapsulates a proactive security measure, alongside aligning with several compliance mandates that necessitate the use of login banners.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact associated with this security control; however, the absence of a login banner might pose a risk in terms of legal protection and compliance adherence, especially during SSH connections where potential misuse could occur. It's prudent to consult with legal advisors to craft a banner text that aligns with organizational and legal requisites.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.26_L1_Host_must_enable_the_highest_version_of_TLS_supported" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must enable the highest version of TLS supported</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The host should be configured to operate using the highest version of TLS supported to ensure secure communications. ESXi 8, by default, comes with TLS 1.2 enabled, although re-enabling other protocols is possible if required. Employing the highest version of TLS aids in protecting against known vulnerabilities present in older versions. The parameter governing this behavior is UserVars.ESXiVPsDisabledProtocols with the recommended setting of "sslv3,tlsv1,tlsv1.1".</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Employing the highest version of TLS supported enhances the security posture by ensuring that communications are protected with modern encryption standards. This mitigates risks associated with known vulnerabilities in outdated TLS versions.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Failure to enable the highest version of TLS supported may expose the host to vulnerabilities present in older versions, potentially compromising the confidentiality and integrity of communications.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Logging">
      <xccdf:title xml:lang="en">Logging</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations related to ESXi's logging capabilities.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_system_logs" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must configure a persistent log location for all locally stored system logs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configure the Syslog.global.logDir parameter to specify a persistent directory for system logs, ensuring they are retained across reboots. This can be set to a directory on mounted NFS or VMFS volumes, other than the default which is an in-memory filesystem that retains only a single day's worth of logs.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
                  <xhtml:strong>Note:</xhtml:strong>
                  <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 must be set for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Storing logs persistently is crucial for auditing, monitoring events, and diagnosing issues. Without persistent logging, critical indicators of compromise and user activity logs are lost at each reboot, which can hinder incident response and forensic investigations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html</xccdf:ident>
         <xccdf:ident system="URL">http://kb.vmware.com/kb/1033696</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure persistent logging properly, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select the host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Edit</xhtml:span>
 then enter                 <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set                 <xhtml:span class="inline_block">Syslog.global.logDir</xhtml:span>
 to a persistent location specified as [datastorename] path_to_file where the path is relative to the datastore. For example, [datastore1] /systemlogs.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternatively, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set Syslog.global.logDir for each host              <br/>
Get-VMHost | Foreach { Set-AdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value "&lt;NewLocation&gt;" }
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no specified functional impact, however, consideration should be given to storage capacity as increased log retention will require more storage space. If the only local, non-vSAN storage is unreliable SD or USB media, configuring a remote logging host is advised.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Host_must_transmit_system_logs_to_a_remote_log_collector" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must transmit system logs to a remote log collector</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Transmitting system logs to a remote log collector ensures that ESXi logs are stored in a secure and centralized manner. This centralization not only allows for the streamlined monitoring of all hosts through a single tool but also facilitates aggregate analysis and searching capabilities.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Central Log Management" urn="urn:cisecurity.org:controls:7.0:6:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Centralizing log storage on a remote log collector greatly enhances the ability to monitor, search, and analyze logs across multiple hosts. This central repository ensures that logs are protected from potential tampering, while also providing a robust long-term audit trail. By analyzing these logs, coordinated attacks or anomalies that might go unnoticed on individual hosts can be detected.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure remote logging properly, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select the host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Edit</xhtml:span>
 then enter                 <xhtml:span class="inline_block">Syslog.global.logHost</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set the                 <xhtml:span class="inline_block">Syslog.global.logHost</xhtml:span>
 to the hostname or IP address of the central log server.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set Syslog.global.logHost for each host              <br/>
Get-VMHost | Foreach { Set-AdvancedSetting -VMHost $_ -Name Syslog.global.logHost -Value "&lt;NewLocation&gt;" }
            </xhtml:code>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 When setting a remote log host, it is also recommended to set the "Syslog.global.logDirUnique" to true. You must configure the syslog settings for each host.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no immediate functional impact when transmitting logs to a remote log collector. However, it is essential to ensure that the remote log collector is adequately secured and has sufficient storage capacity.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688986" value-id="xccdf_org.cisecurity.benchmarks_value_4688986_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688986"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Host_must_log_sufficient_information_for_events" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must log sufficient information for events</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Set the Syslog.global.logLevel parameter to "info" to ensure that audit logs capture sufficient information for diagnosing issues and investigating security events. This setting strikes a balance between log verbosity and storage utilization. The parameter governing this behavior is Syslog.global.logLevel with a recommended setting of info.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Adequate log data is crucial for identifying indicators of compromise, enabling timely and effective response to cybersecurity incidents. The "info" level provides essential details without excessively consuming storage resources.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>More verbose logging levels will demand additional storage space while potentially burying critical entries under less significant data. Conversely, less verbose levels might miss capturing crucial information, hindering effective diagnostics and incident response.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Host_must_set_the_logging_informational_level_to_info" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must set the logging informational level to info</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Set the logging informational level to "info" via the Config.HostAgent.log.level parameter to ensure audit logs contain adequate data for diagnostics and forensics. This level provides a balanced amount of detail, suitable for routine analysis and investigation. The parameter governing this behavior is Config.HostAgent.log.level with a recommended setting of info.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The "info" level balances the detail in logs, aiding in diagnostics and forensics without overwhelming storage resources.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>A more verbose log level increases data volume, demanding additional storage, while a less verbose level may lack crucial information for effective diagnostics and forensics.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Host_must_deactivate_log_filtering" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must deactivate log filtering</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Log filtering can be employed to diminish the frequency of repetitive log entries and to preclude specific log events entirely. By employing the Syslog.global.logFilters configuration parameter, one can stipulate filtering criteria, which when met, will cause the designated log events to be excluded from the system logs. The control aids in maintaining a clean, informative logging environment by filtering out unwanted or redundant log entries. The parameter governing this behavior is Syslog.global.logFiltersEnable with a recommended setting of FALSE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enforce Detail Logging for Access or Changes to Sensitive Data" urn="urn:cisecurity.org:controls:7.0:14:9">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Comprehensive logging is crucial for understanding and monitoring system behavior. By deactivating log filtering, administrators can capture all log events, regardless of their frequency or perceived importance. This guarantees a complete record of system activity, which can be invaluable for incident response and post-incident analysis.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no direct functional impact from deactivating log filtering. However, it may result in increased storage requirements for log files due to the additional log entries being stored. Organizations should ensure adequate storage space is available for logs and consider adjusting log retention policies if necessary.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Host_must_enable_audit_record_logging" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must enable audit record logging</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling audit record logging on ESXi hosts ensures the local storage of audit records, providing a trail of activities performed on the host. This measure is pivotal for accountability, troubleshooting, and security investigations. The parameter governing this behavior is Syslog.global.auditRecord.storageEnable with a recommended setting of TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling audit record logging is crucial for maintaining a secure and compliant operational environment. It provides visibility into host activities, aiding in identifying and investigating unauthorized or malicious actions.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While beneficial for security and compliance, enabling audit record logging consumes additional storage space on the host, which may necessitate enhanced storage management practices to ensure optimal performance.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Host_must_configure_a_persistent_log_location_for_all_locally_stored_audit_records" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must configure a persistent log location for all locally stored audit records</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configuring a persistent log location for locally stored audit records on ESXi hosts is critical to ensure audit continuity. When the "/scratch" directory is linked to "/tmp/scratch", only a day's worth of records are retained, and they are reinitialized upon each reboot, creating a security risk. A persistent datastore, except a vSAN datastore, should be designated for audit record logging to preserve records across reboots. The parameter governing this behavior is Syslog.global.auditRecord.storageDirectory.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Central Log Management" urn="urn:cisecurity.org:controls:7.0:6:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A persistent log location safeguards audit records, enhancing the auditability and diagnosability of system events. This setup helps in adhering to compliance requirements and facilitating future audits.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Implementing this control will consume additional storage space for logs, necessitating a balanced approach to storage management, especially when local non-vSAN storage options are limited.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Host_must_store_one_week_of_audit_records" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must store one week of audit records</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensuring a local storage capacity for a week's worth of audit records is imperative, especially when a remote audit record storage facility is used. This provision is critical during anticipated interruptions in record delivery to the remote facility, preventing loss or overwriting of audit records. The parameter governing this behavior is Syslog.global.auditRecord.storageCapacity with a recommended setting of 100.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Central Log Management" urn="urn:cisecurity.org:controls:7.0:6:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Storing a week of audit records locally safeguards against data loss during interruptions with remote storage facilities, maintaining compliance and audit trail continuity.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This security control entails additional storage space consumption for logs, requiring possible adjustments in storage management.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Host_must_transmit_audit_records_to_a_remote_log_collector" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must transmit audit records to a remote log collector</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This control enables the forwarding of audit records from the ESXi host to a designated log collector, aiding in real-time monitoring and analysis. The parameter governing this behavior is Syslog.global.auditRecord.remoteEnable with a recommended setting of TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Central Log Management" urn="urn:cisecurity.org:controls:7.0:6:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Centralized logging facilitates a consolidated view of activities across ESXi hosts, enhancing the monitoring and rapid detection of unauthorized or anomalous activities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no noted functional impact from enabling this control; however, proper configuration is crucial to ensure reliable log transmission and to maintain the integrity and availability of audit records.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Host_must_verify_certificates_for_TLS_remote_logging_endpoints" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must verify certificates for TLS remote logging endpoints</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>When engaging in remote logging activities, it is of utmost importance to ensure that the logging endpoint is genuine and secure. To achieve this, hosts should verify the TLS certificates of these endpoints. This verification provides assurance that the endpoint is both authentic and trustworthy, mitigating the risk of transmitting logs to potentially malicious or untrusted entities. The parameter governing this behavior is Syslog.global.certificate.checkSSLCerts with a recommended setting of TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Manage Access Control for Remote Assets" urn="urn:cisecurity.org:controls:8.0:13:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Client Certificates to Authenticate Hardware Assets" urn="urn:cisecurity.org:controls:7.0:1:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring the authenticity and trustworthiness of remote logging endpoints is crucial for maintaining the security and integrity of the transmitted log data. By verifying the TLS certificates of these endpoints, the potential risk of man-in-the-middle attacks, data breaches, or unintended exposure of sensitive log information is significantly reduced.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no direct functional impact when verifying certificates for TLS remote logging endpoints. However, it is essential to ensure that the certificates used by the logging endpoints are valid and up-to-date. If not, there might be interruptions in log transmissions or potential trust issues, necessitating certificate management and regular updates.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Host_must_use_strict_x509_verification_for_TLS-enabled_remote_logging_endpoints" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must use strict x509 verification for TLS-enabled remote logging endpoints</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>When employing remote logging with TLS-enabled endpoints, it is essential to ensure the utmost integrity and authenticity of the certificates in use. The "x509-strict" option provides a higher level of security by performing additional validity checks on CA root certificates during the verification process. This increased scrutiny ensures that only genuinely authenticated and trusted certificates are accepted, minimizing potential vulnerabilities. The parameter governing this behavior is Syslog.global.certificate.strictX509Compliance with a recommended setting of TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Manage Access Control for Remote Assets" urn="urn:cisecurity.org:controls:8.0:13:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Client Certificates to Authenticate Hardware Assets" urn="urn:cisecurity.org:controls:7.0:1:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring stringent verification of CA root certificates provides a higher level of trust and security in the remote logging process. Adopting the "x509-strict" option minimizes the risk of accepting compromised or malicious certificates, thereby reducing the potential for data breaches, man-in-the-middle attacks, or other security compromises.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no immediate functional impact from using strict x509 verification for TLS-enabled remote logging endpoints. However, organizations must ensure that their CA root certificates meet the strict criteria set by this option. If certificates do not meet these criteria, there may be disruptions in log transmissions, necessitating adjustments or updates to the certificates in use.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Network">
      <xccdf:title xml:lang="en">Network</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations related to configuring vNetwork.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Host_firewall_must_only_allow_traffic_from_authorized_networks" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host firewall must only allow traffic from authorized networks</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The host's firewall is designed to block all incoming and outgoing network traffic by default, unless exceptions are explicitly made, thus minimizing the attack surface and barring unauthorized access. The firewall settings, while simplistic, are akin to router ACLs, and might require reflexive rules to be configured for certain network scenarios. Through the VMware Host Client, restrictions can be placed on a per-IP basis to only allow traffic from authorized networks, aligning with the security control's recommended value of permitting connections solely from authorized infrastructure and administration workstations.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Implementing a policy where only traffic from authorized networks is allowed, significantly enhances the hosts security posture. It not only minimizes the attack surface but also helps in maintaining a clean network traffic flow, which is crucial for organizational security and operational efficiency.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299-9B10-5F3AEA52C605.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To properly restrict access to services running on an ESXi host, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select a host</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
 then select                 <xhtml:span class="inline_block">Firewall</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Edit</xhtml:span>
 to view services which are enabled (indicated by a check).              </xhtml:li>
                     <xhtml:li>For each enabled service, (e.g., ssh, vSphere Web Access, http client) provide a list of allowed IP addresses.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While this security control is instrumental in preventing unauthorized access, its simplistic firewall may necessitate additional configuration like reflexive rules, depending on the network setup. This could potentially require more administrative effort for correct configuration and management, ensuring that necessary communications are not inadvertently blocked.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Host_must_block_network_traffic_by_default" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must block network traffic by default</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>By default, the host is configured to block all incoming and outgoing network traffic, except for the traffic pertaining to services enabled in the host security profile. This configuration is pivotal in reducing the attack surface and averting unauthorized access to the host. Even though there isn't a specific configuration parameter provided, the firewall settings are manageable through the VMware Host Client, wherein rules can be specified to allow or deny traffic for each service on a per-IP basis, ensuring only authorized networks have access.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Allowlist Authorized Scripts" urn="urn:cisecurity.org:controls:8.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Utilize Application Whitelisting" urn="urn:cisecurity.org:controls:7.0:2:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Implement Application Whitelisting of Scripts" urn="urn:cisecurity.org:controls:7.0:2:9">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Adhering to a policy of blocking network traffic by default significantly minimizes the risk of unauthorized access and potential external attacks. This posture promotes a principle of least privilege on the network level, ensuring only explicitly allowed traffic can communicate with the host, thereby enhancing the security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact mentioned for this security control. However, overly restrictive configurations might impede necessary communications if not properly managed, potentially affecting service availability and operational efficiency. Therefore, careful consideration and testing are advised when adjusting firewall settings to ensure essential traffic is not inadvertently blocked.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Host_must_restrict_use_of_the_dvFilter_network_API" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must restrict use of the dvFilter network API</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Net.DVFilterBindIpAddress parameter controls the use of the dvFilter network API, allowing network information to be sent to a specified IP address. If enabled with a compromised IP address, unauthorized network access to other virtual machines on the host could occur. It's essential to keep this parameter unconfigured, unless required by a product like VMware NSX. The parameter governing this behavior is Net.DVFilterBindIpAddress with a recommended setting of "".</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting the use of the dvFilter network API by keeping the Net.DVFilterBindIpAddress parameter unconfigured helps in reducing potential security risks. This restriction aids in maintaining secure network communication and minimizes the attack surface.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To remove the configuration for the dvfilter network API, perform the following from the vSphere web client:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
From the vSphere web client, select the host and click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">System</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Advanced System Settings</xhtml:span>
 then                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Search for                 <xhtml:span class="inline_block">Net.DVFilterBindIpAddress</xhtml:span>
 in the filter.              </xhtml:li>
                     <xhtml:li>
Set                 <xhtml:span class="inline_block">Net.DVFilterBindIpAddress</xhtml:span>
 has an empty value.              </xhtml:li>
                     <xhtml:li>If an appliance is being used, make sure the value of this parameter is set to the proper IP address.</xhtml:li>
                     <xhtml:li>Enter the proper IP address.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Set Net.DVFilterBindIpAddress to null on all hosts              <br/>
Get-VMHost HOST1 | Foreach { Set-AdvancedSetting -VMHost $_ -Name Net.DVFilterBindIpAddress -IPValue "" }
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact is identified when restricting the dvFilter network API. However, incorrect configuration can lead to insecure network communication, posing a risk to the network security of virtual machines on the host.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Host_must_filter_Bridge_Protocol_Data_Unit_BPDU_packets" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must filter Bridge Protocol Data Unit (BPDU) packets</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>To prevent cascading lockout of uplink interfaces from the ESXi host, the Net.BlockGuestBPDU parameter can be set to 1, enabling BPDU Filter to drop BPDU packets sent from virtual machines to the physical switch. This is crucial as ESXi's Standard and Distributed Virtual Switches do not support STP, making them prone to network loops if BPDUs are unfiltered. The parameter governing this behavior is Net.BlockGuestBPDU with a recommended setting of 1.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:8.0:9:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:7.0:7:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Configuring Net.BlockGuestBPDU aids in maintaining network stability by preventing potential disruptions caused by BPDU packets. This configuration is vital for avoiding unintended network lockouts and ensuring robust network communications.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While beneficial for network stability, enabling BPDU filtering could block legitimate BPDU packets from network-oriented workloads. Ensure no legitimate BPDU packets are generated by virtual machines on the ESXi host before enabling this control.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_L2_Host_should_deactivate_virtual_hardware_management_network_interfaces" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Host should deactivate virtual hardware management network interfaces</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Hardware management controllers may present virtual or USB NICs to the host, potentially serving as backdoors if left active. It's recommended to deactivate these interfaces both in the hardware configuration and within ESXi to prevent unauthorized access. The parameter governing this behavior is Net.BMCNetworkEnable with a recommended value of 0.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating virtual hardware management network interfaces minimizes the attack surface, thereby enhancing the security posture of the host.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While this control enhances security, it may impact third-party managed solutions that require these interfaces, necessitating alternative configurations or additional management considerations.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Host_should_reject_forged_transmits_on_standard_virtual_switches_and_port_groups" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host should reject forged transmits on standard virtual switches and port groups</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Setting the "Forged transmits" option to "Reject" helps prevent MAC impersonation by comparing the source MAC address from the guest operating system with the effective MAC address of its virtual machine adapter. If there's a mismatch, the packet is dropped, preventing potential malicious activities through impersonated MAC addresses.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Rejecting forged transmits enhances network security by preventing unauthorized network access and malicious activities stemming from MAC impersonation. This setting upholds network integrity by ensuring only authorized communications occur within the network.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the policy to reject forged transmissions, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">Networking</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Virtual switches</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Security</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set                 <xhtml:span class="inline_block">Forged transmits</xhtml:span>
 to                 <xhtml:span class="inline_block">Reject</xhtml:span>
 in the dropdown.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, the following ESXi shell command may be used:</xhtml:p>
                  <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -f false
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This setting may affect workloads like clustered applications and network devices/functions that rely on MAC address modifications. Creating a separate port group for authorized virtual machines that require such behavior is recommended to balance operational needs with network security.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688994"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_L1_Host_should_reject_MAC_address_changes_on_standard_virtual_switches_and_port_groups" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host should reject MAC address changes on standard virtual switches and port groups</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enforcing MAC address stability on standard virtual switches and port groups prevents MAC impersonation by disallowing changes to the MAC address by virtual machines. This mitigates the risk of malicious activities initiated by impersonating authorized network adapters.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Preventing MAC address changes hinders unauthorized network access and potential malicious acts, contributing to a more secure network environment. This control aids in maintaining network integrity by ensuring only authorized network communications occur.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the policy to reject, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">Networking</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Virtual switches</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Security</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set                 <xhtml:span class="inline_block">MAC address changes</xhtml:span>
 to                 <xhtml:span class="inline_block">Reject</xhtml:span>
 in the dropdown.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, perform the following using the ESXi shell:</xhtml:p>
                  <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -m false
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Certain workloads and operations reliant on MAC address modifications could be affected. Creating a separate port group for authorized virtual machines that require MAC address changes is recommended to balance operational and security needs.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688997"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Host_should_reject_promiscuous_mode_requests_on_standard_virtual_switches_and_port_groups" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host should reject promiscuous mode requests on standard virtual switches and port groups</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling promiscuous mode allows all virtual machines in a port group to read all packets transmitted across it, regardless of the intended recipient. Rejecting promiscuous mode requests on standard virtual switches and port groups prevents unauthorized packet inspection, enhancing network isolation and data privacy.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Rejecting promiscuous mode requests helps maintain network isolation and data privacy by ensuring packets reach only their intended recipients. This control minimizes the risk of data interception or unauthorized packet inspection.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set the policy to reject, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">Networking</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Virtual switches</xhtml:span>
 then click                 <xhtml:span class="inline_block">Edit</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">Security</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Set                 <xhtml:span class="inline_block">Promiscuous mode</xhtml:span>
 to                 <xhtml:span class="inline_block">Reject</xhtml:span>
 in the dropdown.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternately, perform the following via the ESXi shell:</xhtml:p>
                  <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -p false
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Some workloads like DHCP servers or security monitoring may require promiscuous mode. In such cases, a separate port group allowing this behavior, with only authorized virtual machines connected, is advisable to balance operational needs with security controls.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688999"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Host_must_restrict_access_to_a_default_or_native_VLAN_on_standard_virtual_switches" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must restrict access to a default or native VLAN on standard virtual switches</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>ESXi does not use the concept of native VLAN, so do not configure port groups to use the native VLAN ID. If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Frames with VLAN specified in the port group will have a tag, but frames without a VLAN specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a 1; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a 1 instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81-9D2E-A2F9F2D01180.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To stop using the native VLAN ID for port groups, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">Networking</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Virtual switches</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Expand the Standard vSwitch.</xhtml:li>
                     <xhtml:li>View the topology diagram of the switch, which shows the various port groups associated with that switch.</xhtml:li>
                     <xhtml:li>For each port group on the vSwitch, verify and record the VLAN IDs used.</xhtml:li>
                     <xhtml:li>If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch.</xhtml:li>
                     <xhtml:li>
Click the                 <xhtml:span class="inline_block">Edit settings</xhtml:span>
 option.              </xhtml:li>
                     <xhtml:li>
In the Properties section, enter an appropriate name in the                 <xhtml:span class="inline_block">Network label</xhtml:span>
 field.              </xhtml:li>
                     <xhtml:li>
In the                 <xhtml:span class="inline_block">VLAN ID</xhtml:span>
 dropdown select or type a new VLAN.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689002"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Host_must_restrict_the_use_of_Virtual_Guest_Tagging_VGT_on_standard_virtual_switches" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Host must restrict the use of Virtual Guest Tagging (VGT) on standard virtual switches</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>When a port group is set to VLAN 4095 on standard virtual switches, it enables Virtual Guest Tagging (VGT), letting all network frames pass to the attached virtual machines (VMs) without altering the VLAN tags. This requires VMs to process VLAN information themselves via an 802.1Q driver. Only authorized and capable VMs should be allowed to use VGT to prevent potential network issues like denial of service or unauthorized VLAN traffic interaction.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting VGT use helps maintain network security by ensuring controlled VLAN tag management. It mitigates risks associated with denial of service or unauthorized VLAN interactions, contributing to a stable network environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12-2/20ew/configuration/guide/config/vlans.html#wp1038758</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set port groups to values other than 4095 and 0 unless VGT is required, perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                 <xhtml:span class="inline_block">Networking</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Select                 <xhtml:span class="inline_block">Virtual switches</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Expand the Standard vSwitch.</xhtml:li>
                     <xhtml:li>View the topology diagram of the switch, which shows the various port groups associated with that switch.</xhtml:li>
                     <xhtml:li>For each port group on the vSwitch, verify and record the VLAN IDs used.</xhtml:li>
                     <xhtml:li>If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch.</xhtml:li>
                     <xhtml:li>
Click the                 <xhtml:span class="inline_block">Edit settings</xhtml:span>
 option.              </xhtml:li>
                     <xhtml:li>
In the Properties section, enter an appropriate name in the                 <xhtml:span class="inline_block">Network label</xhtml:span>
 field.              </xhtml:li>
                     <xhtml:li>
In the                 <xhtml:span class="inline_block">VLAN ID</xhtml:span>
 dropdown select or type a new VLAN.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Incorrect VGT configuration can lead to denial of service or unauthorized VLAN traffic interaction. Restricting VGT may require alternative configurations for VMs needing independent VLAN tag management, potentially affecting network operation.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689003"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_L1_Host_must_isolate_management_communications" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Host must isolate management communications</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure that only vmk interfaces designated for management purposes have management services enabled to uphold network isolation and security. Incorrect configuration may undermine security efforts by breaching network isolation principles.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain Dedicated Computing Resources for All Administrative Work" urn="urn:cisecurity.org:controls:8.0:12:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Use of Dedicated Machines For All Administrative Tasks" urn="urn:cisecurity.org:controls:7.0:4:6">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting management services to designated vmk interfaces minimizes the attack surface and ensures that management communications are isolated from other traffic, adhering to network segmentation best practices.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This control may affect third-party managed solutions requiring specific configurations. Configurations may need to be tailored based on the particular environment and third-party solutions in use.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Features">
      <xccdf:title xml:lang="en">Features</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.1_CIM">
         <xccdf:title xml:lang="en">CIM</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.1_L1_Host_CIM_services_if_enabled_must_limit_access" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host CIM services, if enabled, must limit access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The Common Information Model (CIM) system allows for hardware-level management from remote applications through standard APIs. Ensuring only minimal access necessary to these applications is imperative to prevent potential security compromises. A dedicated service account, specific to each CIM application, should be created to limit access and privileges.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Restricting access to CIM services is essential to prevent unauthorized or over-privileged access, which could lead to potential security vulnerabilities. This practice adheres to the principle of least privilege, promoting a more secure environment.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7-BE77-224EF963D145.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To limit CIM access, perform the following:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Create a limited-privileged service account for CIM and other third-party applications.</xhtml:li>
                        <xhtml:li>This account should access the system via vCenter.</xhtml:li>
                        <xhtml:li>
Give the account the                   <xhtml:span class="inline_block">CIM Interaction</xhtml:span>
 privilege only. This will enable the account to obtain a CIM ticket, which can then be used to perform both read and write CIM operations on the target host. If an account must connect to the host directly, this account must be granted the full "Administrator" role on the host. This is not recommended unless required by the monitoring software being used.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                     <xhtml:code class="code_block">
# Create a new host user account -Host Local connection required-                <br/>
New-VMHostAccount -ID ServiceUser -Password &lt;password&gt; -UserAccount
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If improper access is granted to CIM-based hardware monitoring tools or other third-party applications, they may not function as expected or could be exploited to compromise the host's security.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.2_Core_Storage">
         <xccdf:title xml:lang="en">Core Storage</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2.1_L1_Host_must_isolate_storage_communications" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host must isolate storage communications</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Isolating storage communications through zoning and Logical Unit Number (LUN) masking is instrumental in segregating Storage Area Network (SAN) activity. Zoning defines the connections between host bus adapters (HBAs) and targets, ensuring devices outside a zone remain invisible to the devices within, thus facilitating the independent management of zones such as testing and production. On the other hand, LUN masking controls the visibility and accessibility of LUNs to different hosts, further enhancing the granularity of access control within the storage network. By implementing these measures, the attack surface of the SAN is reduced, non-ESXi systems are prevented from accessing the SAN, and separation of environments like test and production is achieved.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Enable Firewall Filtering Between VLANs" urn="urn:cisecurity.org:controls:7.0:14:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Employing zoning and LUN masking to isolate storage communications is vital to reduce the risk of unauthorized access and potential cross-contamination between different operational environments. It allows for a more structured and secure management of storage resources, ensuring that unauthorized or incompatible systems are prevented from interacting with or accessing the SAN, thus contributing to the overall security and operational integrity of the environment.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0-16ABB3CA0FE3.html</xccdf:ident>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A-ED8F9D8FDACE.html</xccdf:ident>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF-FAB1528C070D.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>The remediation procedures to properly segregate SAN activity are SAN vendor or product-specific.</xhtml:p>
                     <xhtml:p>In general, with ESXi hosts, use a single-initiator zoning or a single-initiator-single-target zoning. The latter is a preferred zoning practice. Using the more restrictive zoning prevents problems and misconfigurations that can occur on the SAN.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Failing to isolate storage communications can lead to an increased risk of unauthorized access to storage resources, potential data leakage, or interference between different operational zones. The lack of segregation might also pose challenges in managing and troubleshooting storage network activities, leading to operational inefficiencies and potential security risks.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2.2_L1_Host_must_ensure_all_datastores_have_unique_names" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host must ensure all datastores have unique names</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Ensuring unique naming for datastores is crucial to avoid potential errors that could affect the integrity and availability of data. A descriptive and unique name for each datastore facilitates better identification and management. Although there's no specific parameter to enforce this, manual or automated naming conventions should be adhered to.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Enforce Access Control to Data through Automated Tools" urn="urn:cisecurity.org:controls:7.0:14:7">
                        <controls:implementation_groups ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Unique and descriptive naming for datastores minimizes the risk of errors, improves manageability, and aids in quicker identification, especially in environments with numerous datastores. It's a proactive measure to maintain order and avoid issues that arise from the default names given to VMFS and vSAN datastores.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Not adhering to a unique naming convention can lead to confusion, misconfiguration, or incorrect data access. While renaming datastores could have downstream effects on systems like automation, monitoring, and backup, the benefits of unique naming conventions outweigh the potential negatives.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.3_iSCSI">
         <xccdf:title xml:lang="en">iSCSI</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3.1_L1_Host_iSCSI_client_if_enabled_must_employ_bidirectionalmutual_CHAP_authentication" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">(L1) Host iSCSI client, if enabled, must employ bidirectional/mutual CHAP authentication</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Implementing bidirectional CHAP authentication for iSCSI connections elevates security by necessitating mutual verification between the initiator (client) and target (server), ensuring data integrity during transmission. Configuration involves setting the iSCSI storage adapter authentication to "Use bidirectional CHAP" and providing the requisite credentials. This setup ensures that all communication between the client and server remains secure and unaltered, significantly reducing the risk of data interception by unauthorized entities. The parameter governing this behavior is set iSCSI storage adapter authentication to "Use bidirectional CHAP" with a recommended setting of Enabled.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Encrypt Transmittal of Username and Authentication Credentials" urn="urn:cisecurity.org:controls:7.0:16:5">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Prerequisites</xhtml:strong>
- Before setting up CHAP parameters for software or dependent hardware iSCSI, determine whether to configure unidirectional or bidirectional CHAP. Independent hardware iSCSI adapters do not support bidirectional CHAP.            </xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>Verify CHAP parameters configured on the storage side. Parameters that you configure must match the ones on the storage side.</xhtml:li>
                     <xhtml:li>
Required privilege:                 <xhtml:span class="inline_block">Host.Configuration.Storage Partition Configuration</xhtml:span>
                     </xhtml:li>
                  </xhtml:ul>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Employing bidirectional CHAP authentication significantly minimizes risks associated with data interception or alteration by unauthorized entities during transmissions between the initiator and target. This additional layer of security is crucial in maintaining data integrity and confidentiality in iSCSI connections.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD-49B433E2F266.html</xccdf:ident>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083-8E65FE380899.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To enable bidirectional CHAP authentication for iSCSI traffic, perform the following:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                   <xhtml:span class="inline_block">Storage</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">Storage Adapters</xhtml:span>
 then select the iSCSI Adapter.                </xhtml:li>
                        <xhtml:li>
Under                   <xhtml:span class="inline_block">Properties</xhtml:span>
 click on                   <xhtml:span class="inline_block">Edit</xhtml:span>
 next to                   <xhtml:span class="inline_block">Authentication</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Next to                   <xhtml:span class="inline_block">Authentication Method</xhtml:span>
 select                   <xhtml:span class="inline_block">Use bidirectional CHAP</xhtml:span>
 from the dropdown.                </xhtml:li>
                        <xhtml:li>Specify the outgoing CHAP name.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:ul>
                        <xhtml:li>
Make sure that the name you specify matches the name configured on the storage side.
                  <xhtml:ul>
                              <xhtml:li>To set the CHAP name to the iSCSI adapter name, select "Use initiator name".</xhtml:li>
                              <xhtml:li>To set the CHAP name to anything other than the iSCSI initiator name, deselect "Use initiator name" and type a name in the Name text box.</xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:ol start="8">
                        <xhtml:li>Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret.</xhtml:li>
                        <xhtml:li>Specify incoming CHAP credentials. Make sure your outgoing and incoming secrets do not match.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">OK</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Click the second to last symbol labeled                   <xhtml:span class="inline_block">Rescan Adapter</xhtml:span>
.                </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
                     <xhtml:code class="code_block">
# Set the Chap settings for the Iscsi Adapter                <br/>
Get-VMHost | Get-VMHostHba | Where {$_.Type -eq "Iscsi"} | Set-VMHostHba # Use desired parameters here
              </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>No functional impact is anticipated upon the implementation of this control. However, it's imperative to ensure correct configuration to avoid potential communication disruptions between the iSCSI client and server.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689005" value-id="xccdf_org.cisecurity.benchmarks_value_4689005_var"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
                  <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689005"/>
               </check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3.2_L1_Host_iSCSI_client_if_enabled_must_employ_unique_CHAP_authentication_secrets" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host iSCSI client, if enabled, must employ unique CHAP authentication secrets</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Challenge-Handshake Authentication Protocol (CHAP) requires both client and host to know a secret to establish a connection. It is essential to employ unique CHAP authentication secrets for each iSCSI session to ensure secure communications. The parameter governing this behavior is outlined in the iSCSI or iSER storage adapter configuration under CHAP settings.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Users</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
               <notes:notes xml:lang="en">
                  <xhtml:p>If you change the CHAP parameters, they are used for new iSCSI sessions. For existing sessions, new settings are not used until you log out and log in again.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Utilizing unique CHAP authentication secrets for each iSCSI session promotes secure data transmission and mitigates the risk of unauthorized access.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD-49B433E2F266.html</xccdf:ident>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083-8E65FE380899.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To change the values of CHAP secrets so they are unique, perform the following:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">Configure</xhtml:span>
 then expand                   <xhtml:span class="inline_block">Storage</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Select                   <xhtml:span class="inline_block">Storage Adapters</xhtml:span>
 then select the iSCSI Adapter.                </xhtml:li>
                        <xhtml:li>
Under                   <xhtml:span class="inline_block">Properties</xhtml:span>
 click on                   <xhtml:span class="inline_block">Edit</xhtml:span>
 next to                   <xhtml:span class="inline_block">Authentication</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Next to                   <xhtml:span class="inline_block">Authentication Method</xhtml:span>
 specify the authentication method from the dropdown.
                  <xhtml:ul>
                              <xhtml:li>None</xhtml:li>
                              <xhtml:li>Use unidirectional CHAP if required by target</xhtml:li>
                              <xhtml:li>Use unidirectional CHAP unless prohibited by target</xhtml:li>
                              <xhtml:li>Use unidirectional CHAP</xhtml:li>
                              <xhtml:li>Use bidirectional CHAP</xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                        <xhtml:li>Specify the outgoing CHAP name.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:ul>
                        <xhtml:li>
Make sure that the name you specify matches the name configured on the storage side.
                  <xhtml:ul>
                              <xhtml:li>To set the CHAP name to the iSCSI adapter name, select "Use initiator name".</xhtml:li>
                              <xhtml:li>To set the CHAP name to anything other than the iSCSI initiator name, deselect "Use initiator name" and type a name in the Name text box.</xhtml:li>
                           </xhtml:ul>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:ol start="8">
                        <xhtml:li>Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret.</xhtml:li>
                        <xhtml:li>If configuring with bidirectional CHAP, specify incoming CHAP credentials.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:ul>
                        <xhtml:li>Make sure your outgoing and incoming secrets do not match.</xhtml:li>
                     </xhtml:ul>
                     <xhtml:ol start="10">
                        <xhtml:li>If configuring with bidirectional CHAP, specify incoming CHAP credentials.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:ul>
                        <xhtml:li>Make sure your outgoing and incoming secrets do not match.</xhtml:li>
                     </xhtml:ul>
                     <xhtml:ol start="11">
                        <xhtml:li>
Click                   <xhtml:span class="inline_block">OK</xhtml:span>
.                </xhtml:li>
                        <xhtml:li>
Click the second to last symbol labeled                   <xhtml:span class="inline_block">Rescan Adapter</xhtml:span>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>While enhancing security, misconfiguration or sharing of CHAP secrets across sessions could potentially lead to connectivity issues or unauthorized access.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.4_SNMP">
         <xccdf:title xml:lang="en">SNMP</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4.1_L1_Host_SNMP_services_if_enabled_must_limit_access" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SNMP services, if enabled, must limit access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>To manage hosts securely, if SNMP is enabled, access must be restricted. Preferably, SNMPv3 should be employed as it offers superior security through key authentication and encryption compared to SNMPv1 or SNMPv2. Configuring the destination for SNMP traps is essential for ensuring monitoring data is directed to a legitimate and secure host.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Proper SNMP configuration is crucial to reduce the risk of misuse or compromise, especially if other management means are in place. SNMPv3s enhanced security features are pivotal for secure management and monitoring.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74-B1AA-4A9D18AB6250.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To correct the SNMP configuration, perform the following from the ESXi Shell or vCLI:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>If SNMP is not needed, disable it by running:</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">esxcli system snmp set --enable false
</xhtml:code>
                     <xhtml:ol start="2">
                        <xhtml:li>If SNMP is needed, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure it.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Additionally, the following PowerCLI command may be used to implement the configuration:</xhtml:p>
                     <xhtml:code class="code_block">
# Update the host SNMP Configuration (single host connection required)                <br/>
Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '&lt;secret&gt;'
              </xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Notes:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>SNMP must be configured on each ESXi host</xhtml:li>
                        <xhtml:li>SNMP settings can be configured using Host Profiles</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Improper SNMP configuration can redirect sensitive monitoring data to malicious hosts, risking exploitation and compromising host security.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.5_SSH">
         <xccdf:title xml:lang="en">SSH</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.1_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_ciphers" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must use FIPS 140-2/140-3 validated ciphers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>For enhanced security, if the SSH daemon is enabled on the host, it must utilize FIPS 140-2/140-3 validated ciphers. This requirement ensures the encryption standards are robust and compliant with regulatory mandates.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Install the Latest Stable Version of Any Security-related Updates on All Network Devices" urn="urn:cisecurity.org:controls:7.0:11:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Employing FIPS validated ciphers is vital for maintaining a high level of security and integrity in communications. It aligns with industry best practices and regulatory compliance requirements, ensuring secure SSH connections.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There is no functional impact noted for this control; however, it significantly improves the security posture by enforcing the use of strong, validated encryption ciphers for SSH communications.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.2_L1_Host_SSH_daemon_if_enabled_must_use_FIPS_140-2140-3_validated_cryptographic_modules" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must use FIPS 140-2/140-3 validated cryptographic modules</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>When enabled, the SSH daemon on the host should employ FIPS 140-2/140-3 validated cryptographic modules provided by OpenSSH. Although these modules are enabled by default, they can be deactivated for backward compatibility, thus auditing and ensuring the correct setting is crucial for maintaining security standards.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Install the Latest Stable Version of Any Security-related Updates on All Network Devices" urn="urn:cisecurity.org:controls:7.0:11:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Data</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Utilizing FIPS validated cryptographic modules ensures adherence to recognized security standards, which is essential for protecting data during SSH sessions. This aligns with industry best practices and compliance requirements, promoting a secure operating environment.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There's no functional impact associated with this control. It significantly enhances the security posture by enforcing the use of validated cryptographic modules, minimizing the risks associated with SSH communications.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.3_L1_Host_SSH_daemon_if_enabled_must_not_allow_use_of_gateway_ports" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must not allow use of gateway ports</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>When enabled, the SSH daemon on the host should have the gateway ports feature disabled to prevent remote hosts from forwarding connections. This is a hardening measure to ensure that the SSH service is securely configured against potential forwarding misuses.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                        <controls:implementation_groups ig2="true" ig3="true"/>
                        <controls:asset_type>Devices</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                     <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling gateway ports is a preventative measure to avoid unauthorized forwarding by remote hosts, thus enhancing the security posture of the system. It is a prudent step in minimizing the attack surface associated with SSH service.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There are no noted functional impacts associated with this control. It is a proactive security measure designed to prevent potential misuse of SSH service forwarding capabilities, without affecting the normal operation of the host.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.4_L1_Host_SSH_daemon_if_enabled_must_not_allow_host-based_authentication" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must not allow host-based authentication</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Ensuring the SSH daemon on the host disallows host-based authentication is a crucial step towards hardening system services. This prevents a host from authenticating on behalf of the users, thereby enforcing individual accountability and minimizing the risk of unauthorized access.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disallowing host-based authentication enforces a more secure user authentication mechanism, promoting individual accountability. It minimizes the risk associated with trust relationships among hosts, thereby enhancing the overall security of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>No functional impact is associated with this control. It solely acts to enhance security by enforcing stricter authentication practices, without hindering system operations.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.5_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_count_on_idle_sessions" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must set a timeout count on idle sessions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Setting a timeout count on idle SSH sessions ensures that inactive sessions are automatically disconnected after a specified period. This period is calculated by multiplying the timeout count with the idle timeout interval. Automatic disconnection of idle sessions reduces the window of opportunity for unauthorized access.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Implementing a timeout count on idle sessions promotes better security hygiene by minimizing the exposure of open SSH sessions. It adds a layer of protection against potential unauthorized access arising from forgotten or unattended sessions.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There's no functional impact reported with this control. It's a preventive measure aimed at enhancing the security posture by mitigating the risks associated with lingering idle sessions.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.6_L1_Host_SSH_daemon_if_enabled_must_set_a_timeout_interval_on_idle_sessions" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must set a timeout interval on idle sessions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Implementing a timeout interval on idle SSH sessions ensures that any inactive session gets disconnected after a certain period, improving the security posture. The total timeout duration is calculated by multiplying the timeout count by the idle timeout interval.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Enforcing a timeout interval on idle SSH sessions minimizes the risk of unauthorized access through forgotten or unattended sessions, thereby hardening the system services as per security best practices.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>No functional impact is reported with this control. The measure is preventive, aiming to mitigate risks associated with open, idle SSH sessions.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.7_L1_Host_SSH_daemon_if_enabled_must_display_the_system_login_banner_before_granting_access" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must display the system login banner before granting access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Implementing a system login banner before granting SSH access ensures that crucial information or notices are conveyed to users attempting to login. The banner text is set through the host's Config.Etc.Issue advanced parameter.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Displaying a system login banner helps in providing legal notices or other critical information to users, ensuring they are informed before gaining access, which is a step towards hardening and securing system services.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There is no functional impact reported with the enforcement of this control. It primarily serves to inform users or provide legal disclaimers, aiding in legal and regulatory compliance.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.8_L1_Host_SSH_daemon_if_enabled_must_ignore_.rhosts_files" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must ignore .rhosts files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Ignoring .rhosts files is crucial in hardening the SSH daemon on the host, ensuring that trust relationships are explicitly defined and not implicitly accepted, thereby reducing the attack surface.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Ignoring .rhosts files removes potential security risks associated with outdated or overly permissive trust relationships, which is a step towards a hardened and more secure system service configuration.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There are no reported functional impacts associated with ignoring .rhosts files; however, this practice enhances the security posture by mitigating risks associated with unauthorized access.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.9_L1_Host_SSH_daemon_if_enabled_must_disable_stream_local_forwarding" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must disable stream local forwarding</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Disabling stream local forwarding on the SSH daemon ensures that no Unix domain sockets are forwarded, thus enforcing a security boundary. This measure aids in maintaining the integrity and confidentiality of the system.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling stream local forwarding helps in preventing potential misuse of Unix domain sockets which can be a vector for certain types of attacks or data leaks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There is no functional impact reported, indicating that disabling stream local forwarding is a safe measure towards enhancing system security without affecting operations.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.10_L1_Host_SSH_daemon_if_enabled_must_disable_TCP_forwarding" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must disable TCP forwarding</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Disabling TCP forwarding in the SSH daemon is a measure to prevent potential unauthorized tunneling and forwarding activities that could lead to data leaks or unauthorized data access. This measure adds a layer of security to the SSH service when enabled, making the system more resilient against certain types of network attacks.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Preventing TCP forwarding aids in ensuring that the SSH daemon is not misused for unauthorized tunneling. This measure assists in maintaining a more secure and controlled network environment.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>No functional impact has been reported. This indicates that disabling TCP forwarding is a precautionary measure that does not interfere with the normal operation of the host.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.11_L1_Host_SSH_daemon_if_enabled_must_not_permit_tunnels" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must not permit tunnels</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Preventing tunnel creation in the SSH daemon is a security measure aimed at thwarting unauthorized network tunneling through the host. This control, when enforced, helps mitigate the risks associated with potential data exfiltration or unauthorized network access that could occur via SSH tunnels.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>By disallowing tunnel creation, organizations can ensure that the SSH daemon is not exploited for unauthorized tunneling activities, thus contributing to a more secure network posture.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There is no reported functional impact associated with this security control, indicating that the prevention of SSH tunneling does not adversely affect the host's normal operational behavior.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5.12_L1_Host_SSH_daemon_if_enabled_must_not_permit_user_environment_settings" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">(L1) Host SSH daemon, if enabled, must not permit user environment settings</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Preventing user environment settings in the SSH daemon ensures a consistent and controlled environment, reducing the attack surface by limiting the customization of the SSH environment by users.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                  <controls:framework urn="urn:cisecurity.org:controls:8.0">
                     <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Network</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
                  <controls:framework urn="urn:cisecurity.org:controls:7.0">
                     <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                        <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                        <controls:asset_type>Applications</controls:asset_type>
                        <controls:security_function>Protect</controls:security_function>
                     </controls:safeguard>
                  </controls:framework>
               </controls:cis_controls>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disallowing user environment settings within the SSH daemon reduces the potential for malicious or inadvertent misconfiguration, thus enhancing the security posture.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There is no functional impact noted, indicating that restricting user environment settings does not adversely affect the operational aspects of the host.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Virtual_Machine">
      <xccdf:title xml:lang="en">Virtual Machine</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for settings related to guest virtual machines.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Virtual_machines_must_enable_Secure_Boot" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must enable Secure Boot</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enable Secure Boot on virtual machines to ensure that only authenticated code runs from the firmware up through the operating system, thus providing a fundamental security measure against boot-time malware and unauthorized code execution. Supported by all modern guest operating systems, Secure Boot employs public key cryptography to validate the firmware, boot loader, drivers, and OS kernel at boot time.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By enforcing Secure Boot, organizations can mitigate the risk of boot-time malware and unauthorized code execution, which is crucial for maintaining the integrity and trustworthiness of the system from the first instruction.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">
$VMobj = (Get-VM -Name $VM)              <br/>
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec              <br/>
$bootOptions = New-Object VMware.Vim.VirtualMachineBootOptions              <br/>
$bootOptions.EfiSecureBootEnabled = $true              <br/>
$ConfigSpec.BootOptions = $bootOptions              <br/>
$task = $VMobj.ExtensionData.ReconfigVM_Task($ConfigSpec)
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Activation of Secure Boot post guest OS installation may entail more than merely enabling a setting; consult the respective guest OS documentation for detailed instructions. This may introduce additional steps in the setup process, potentially extending the deployment time.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Virtual_machines_must_require_encryption_for_vMotion" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must require encryption for vMotion</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Requiring encryption for vMotion ensures the secure transfer of data among virtual machines. While the default 'opportunistic' encryption setting generally provides encryption due to prevalent AES-NI support, enforcing 'required' encryption eradicates the possibility of unencrypted transfers. The parameter governing this behavior is VM Configuration with the recommended setting being required.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enforcing encryption for vMotion is crucial to prevent potential data leakage or unauthorized data access during data transfer processes, thereby bolstering the overall security infrastructure.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">
$VMview = Get-VM -Name $VM | Get-View               <br/>
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec              <br/>
$ConfigSpec.MigrateEncryption = New-Object VMware.Vim.VirtualMachineConfigSpecEncryptedVMotionModes              <br/>
$ConfigSpec.MigrateEncryption = "required"              <br/>
$VMview.ReconfigVM_Task($ConfigSpec)
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Virtual_machines_must_require_encryption_for_Fault_Tolerance" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must require encryption for Fault Tolerance</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Requiring encryption for Fault Tolerance in virtual machines is critical for ensuring secure data transmission between primary and secondary VMs, especially in environments where sensitive data is processed. While the default setting 'opportunistic' may result in encryption due to widespread AES-NI support in vSphere-compatible hardware, enforcing the 'required' setting for encryption guarantees that no unencrypted operations occur. The parameter governing this behavior is VM Configuration with a recommended setting of ftEncryptionRequired.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By enforcing encryption for Fault Tolerance, organizations bolster the security posture of their virtual environments against potential data interception or leakage during transmission. This requirement is vital for maintaining data integrity and confidentiality.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">
$VMview = Get-VM -Name $VM | Get-View               <br/>
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec              <br/>
$ConfigSpec.FtEncryptionMode = New-object VMware.Vim.VirtualMachineConfigSpecEncryptedFtModes              <br/>
$ConfigSpec.FtEncryptionMode = "ftEncryptionRequired"               <br/>
$VMview.ReconfigVM_Task($ConfigSpec)
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There are no identified negative impacts associated with enforcing encryption for Fault Tolerance, and it's instrumental in enhancing the security of data transmission within virtual environments.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Virtual_machines_should_deactivate_3D_graphics_features_when_not_required" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines should deactivate 3D graphics features when not required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Due to performance reasons, modern graphic rendering is done within a dedicated graphic processing unit (GPU). Virtual machines can use the host-based GPU for such operations as well. Such dedicated hardware is typically accessed by using complex APIs like OpenGL and DirectX. This hardware-based 3D acceleration should be disabled if it is not needed.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Security flaws within APIs can lead to serious security breaches like memory corruption, denial of service, and remote code execution.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d | Set-AdvancedSetting -Value FALSE
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>GPU and Virtual Desktops may require this functionality.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4688996" value-id="xccdf_org.cisecurity.benchmarks_value_4688996_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4688996"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Virtual_machines_must_be_configured_to_lock_when_the_last_console_connection_is_closed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must be configured to lock when the last console connection is closed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configuring virtual machines to lock upon closing the last console connection enhances security by mitigating the risk of unauthorized access via open console sessions. This configuration is particularly useful in environments where multiple users have access to the console. The parameter governing this behavior is tools.guest.desktop.autolock with the recommended setting being TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Use of Secure Network Management and Communication Protocols" urn="urn:cisecurity.org:controls:8.0:12:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Port Level Access Control" urn="urn:cisecurity.org:controls:7.0:1:7">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Implementing this control provides an additional layer of security by ensuring that open console sessions do not remain accessible after the last connection is closed, thus reducing the potential for unauthorized access.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command may be used:</xhtml:p>
                  <xhtml:code class="code_block">Get-VM -Name $VM | Remove-AdvancedSetting -Name tools.guest.desktop.autolock
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No functional impact is associated with this control; it serves as a proactive measure to prevent unauthorized access through open console sessions.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Virtual_machines_must_limit_console_sharing." role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit console sharing.</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>By default, remote console sessions can be connected to by more than one user at a time. Permit only one remote console connection to a VM at a time. Other attempts will be rejected until the first connection disconnects.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enforce Access Control to Data through Automated Tools" urn="urn:cisecurity.org:controls:7.0:14:7">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM can connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a VM. For example, if a jump box is being used for an open console session, and the admin loses a connection to that box, the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide-policies-and-profile</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-27A340F5-DE98-41A8-AC73-01ED4949EEF2.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360-AAC6-B70F9A9AEB84.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">RemoteDisplay.maxConnections</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternatively, run the following PowerCLI command for VMs that do not specify the setting:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "RemoteDisplay.maxConnections" -value 1
            </xhtml:code>
                  <xhtml:p>Run the following PowerCLI command for VMs that specify the setting but have the wrong value for it:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "RemoteDisplay.maxConnections" -value 1 -Force
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689000" value-id="xccdf_org.cisecurity.benchmarks_value_4689000_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689000"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Virtual_machines_must_limit_PCIPCIe_device_passthrough_functionality" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit PCI/PCIe device passthrough functionality</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>DirectPath I/O features provide virtual machines the ability to directly access system hardware, which while advantageous for performance, can impact risk mitigation tools like vMotion, DRS, and High Availability. It also opens up a potential attack vector for privileged hardware access. It is crucial to ensure that only necessary VMs have this privilege and that compensatory measures are taken within the guest OS to enhance security.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting PCI/PCIe device passthrough functionality is essential for minimizing potential attack vectors and ensuring that risk mitigation tools function as intended. Moreover, audit and documentation of the business need for these VMs are critical for maintaining a secure and compliant environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-E5CFB1FB-9216-4C1D-B49A-81AAAC414025.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following PowerCLI command can be used:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "pciPassthru*.present" -value ""
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Passthrough devices, like GPUs, may be adversely affected if disconnected. It's imperative to audit and document the business rationale for VMs requiring this functionality to understand the associated risks and ensure adequate compensatory controls are in place.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689004" value-id="xccdf_org.cisecurity.benchmarks_value_4689004_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689004"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Virtual_machines_must_prevent_unauthorized_modification_of_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must prevent unauthorized modification of devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>In a virtual machine, users and processes without root or administrator privileges can connect devices, such as network adapters and CD-ROM drives. This should be prevented.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling unauthorized connection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168-C62D9306DBD6.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To prevent unauthorized device connections, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "isolation.device.connectable.disable" -value $true
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689007" value-id="xccdf_org.cisecurity.benchmarks_value_4689007_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689007"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Virtual_machines_must_remove_unnecessary_audio_devices" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary audio devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Virtual_machines_must_remove_unnecessary_AHCI_devices" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary AHCI devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Virtual_machines_must_remove_unnecessary_USBXHCI_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary USB/XHCI devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360-AAC6-B70F9A9AEB84.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disconnect all USB devices from VMs, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Remove all USB Devices attached to VMs              <br/>
Get-VM | Get-USBDevice | Remove-USBDevice
            </xhtml:code>
                  <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689009" value-id="xccdf_org.cisecurity.benchmarks_value_4689009_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689009"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.12_L1_Virtual_machines_must_remove_unnecessary_serial_port_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary serial port devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in-powercli.html</xccdf:ident>
         <xccdf:ident system="URL">https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in-powercli.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disconnect all serial ports from VMs, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html              <br/>
# Remove all Serial Ports attached to VMs              <br/>
Get-VM | Get-SerialPort | Remove-SerialPort
            </xhtml:code>
                  <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689010" value-id="xccdf_org.cisecurity.benchmarks_value_4689010_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689010"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.13_L1_Virtual_machines_must_remove_unnecessary_parallel_port_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary parallel port devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in-powercli.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96-B273-A30F256B29D4.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disconnect all parallel ports from VMs, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html              <br/>
# Remove all Parallel Ports attached to VMs              <br/>
Get-VM | Get-ParallelPort | Remove-ParallelPort
            </xhtml:code>
                  <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689012" value-id="xccdf_org.cisecurity.benchmarks_value_4689012_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689012"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.14_L2_Virtual_machines_must_remove_unnecessary_CDDVD_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Virtual machines must remove unnecessary CD/DVD devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96-B273-A30F256B29D4.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disconnect all CD/DVD drives from VMs, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Remove all CD/DVD Drives attached to VMs              <br/>
Get-VM | Get-CDDrive | Remove-CDDrive
            </xhtml:code>
                  <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689014" value-id="xccdf_org.cisecurity.benchmarks_value_4689014_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689014"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.15_L1_Virtual_machines_must_remove_unnecessary_floppy_devices" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must remove unnecessary floppy devices</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96-B273-A30F256B29D4.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disconnect all floppy drives from VMs, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Remove all Floppy drives attached to VMs              <br/>
Get-VM | Get-FloppyDrive | Remove-FloppyDrive
            </xhtml:code>
                  <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689016" value-id="xccdf_org.cisecurity.benchmarks_value_4689016_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689016"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.16_L1_Virtual_machines_must_deactivate_console_drag_and_drop_operations" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must deactivate console drag and drop operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>VM console drag and drop operations should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>VM console drag and drop operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">isolation.tools.dnd.disable</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">TRUE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To explicitly disable VM console drag and drop operations, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM -Name $VM | Remove-AdvancedSetting -Name isolation.tools.dnd.disable
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689017" value-id="xccdf_org.cisecurity.benchmarks_value_4689017_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689017"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.17_L1_Virtual_machines_must_deactivate_console_copy_operations" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must deactivate console copy operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Deactivating console copy operations is critical for preventing data transfer between the virtual machine and the local client, irrespective of the access method, whether via Web Console, VMRC, or others. The parameter governing this behavior is isolation.tools.copy.disable with a recommended setting of TRUE or Undefined.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating console copy operations minimizes the risk of unauthorized data access or leakage, enforcing a higher level of data security and integrity across the virtual environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">isolation.tools.copy.disable</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">TRUE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To explicitly disable VM console copy operations, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.copy.disable" -value $true
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no identified functional impact; however, this restriction enhances data security by minimizing unauthorized data transfer channels.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689018" value-id="xccdf_org.cisecurity.benchmarks_value_4689018_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689018"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.18_L1_Virtual_machines_must_deactivate_console_paste_operations" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must deactivate console paste operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Disabling console paste operations on virtual machines obstructs data transfer from the local client to the VM, irrespective of the access method - be it Web Console, VMRC, or another console. This security measure aims to curtail potential avenues for unauthorized data transfer into the virtual environment. The parameter governing this behavior is isolation.tools.paste.disable with a recommended setting of TRUE or Undefined.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By disabling console paste operations, organizations add a layer of security that helps in preventing unauthorized data introduction into the VM, which could potentially lead to various security risks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">isolation.tools.paste.disable</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">TRUE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To explicitly disable VM console paste operations, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.paste.disable" -value $true
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact identified. The control simply enhances the security posture by reducing possible data transfer channels into the VM.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689019" value-id="xccdf_org.cisecurity.benchmarks_value_4689019_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689019"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.19_L1_Virtual_machines_must_limit_access_through_the_dvfilter_network_API" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit access through the "dvfilter" network API</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The dvFilter interface facilitates network traffic filtering and inspection, predominantly via tools like NSX. It's vital to allow only authorized tools to access this interface to uphold network security. Unauthorized access could lead to illicit network traffic inspection or misuse. The parameter governing this behavior is ethernet*.filter*.name with a recommended setting of Not Present.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting access through the "dvfilter" network API to authorized tools is essential for preserving network integrity and security. This restriction curtails the risk of unauthorized data inspection and potential network vulnerabilities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://kb.vmware.com/kb/1714</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Remove the value from                 <xhtml:span class="inline_block">ethernet0.filter1.name = dv-filter</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:ul>
                     <xhtml:li>Parameters are removed when no value is present</xhtml:li>
                  </xhtml:ul>
                  <xhtml:ol start="5">
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>You may also configure a VM to allow dvfilter access via the following method in the VMX file:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Configure the following in the VMX file:                 <xhtml:span class="inline_block">ethernet0.filter1.name = dv-filter1</xhtml:span>
 where                 <xhtml:span class="inline_block">ethernet0</xhtml:span>
 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and                 <xhtml:span class="inline_block">dv-filter1</xhtml:span>
 is the name of the particular data path kernel module that is protecting the VM.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:ul>
                     <xhtml:li>
If                 <xhtml:span class="inline_block">dvfilter</xhtml:span>
 access should not be permitted:  Remove the following from its VMX file:                 <xhtml:span class="inline_block">ethernet0.filter1.name = dv-filter1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ul>
                  <xhtml:ol start="2">
                     <xhtml:li>Set the name of the data path kernel correctly.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While enhancing security by restricting access to the dvFilter interface, this control may hinder the functionality of legitimate network tools like NSX, which necessitate access to the "dvfilter" network API for proper operation.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.20_L1_Virtual_machines_must_deactivate_virtual_disk_shrinking_operations" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must deactivate virtual disk shrinking operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Disabling virtual disk shrinking on virtual machines prevents potential disk unavailability issues. This operation is usually restricted for non-administrative users within the guest environment. The parameter governing this behavior is isolation.tools.diskShrink.disable with a recommended setting of TRUE or Undefined.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processesthat is, users and processes without root or administrator privilegeswithin virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">isolation.tools.diskShrink.disable</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">TRUE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.diskShrink.disable" -value $true
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact noted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689020" value-id="xccdf_org.cisecurity.benchmarks_value_4689020_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689020"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.21_L1_Virtual_machines_must_deactivate_virtual_disk_wiping_operations" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must deactivate virtual disk wiping operations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Wiping a virtual disk reclaims all unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. If virtual disk wiping is done repeatedly, it can cause the virtual disk to become unavailable while wiping occurs. In most datacenter environments, disk wiping is not needed, but normal users and processes--without administrative privileges--can issue disk wipes unless the feature is disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating virtual disk wiping operations contributes to maintaining disk availability, which is vital for continuous system operations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">isolation.tools.diskWiper.disable</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">TRUE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To disable virtual disk wiping, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.diskWiper.disable" -value $true
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There isn't a functional impact noted</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689021" value-id="xccdf_org.cisecurity.benchmarks_value_4689021_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689021"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.22_L1_Virtual_machines_must_restrict_sharing_of_memory_pages_with_other_VMs" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must restrict sharing of memory pages with other VMs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configuring virtual machines with the sched.mem.pshare.salt option restricts Transparent Page Sharing (TPS) among different VMs, mitigating the risk of unauthorized data access under certain conditions. By doing so, each VM operates with a distinct memory sharing pool, thereby enhancing isolation and security. The parameter governing this behavior is sched.mem.pshare.salt.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting memory page sharing among VMs minimizes the potential for unauthorized data access, thus aligning with best practices of data isolation and security. This configuration is a proactive measure to mitigate vulnerabilities associated with memory sharing.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no functional impact associated with this security control as it serves to bolster the security posture of the VMs without affecting their operational performance or functionality.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.23_L1_Virtual_machines_must_not_be_able_to_obtain_host_information_from_the_hypervisor" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must not be able to obtain host information from the hypervisor</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Configure VMware Tools to disable host information from being sent to guests unless a particular VM requires this information for performance monitoring purposes.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Monitor and Block Unauthorized Network Traffic" urn="urn:cisecurity.org:controls:7.0:13:3">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB-A16A11951A2D.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">tools.guestlib.enableHostInfo</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">FALSE</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To prevent host information from being sent to guests, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "tools.guestlib.enableHostInfo" -value $false
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689022" value-id="xccdf_org.cisecurity.benchmarks_value_4689022_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689022"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.24_L1_Virtual_machines_must_enable_diagnostic_logging" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must enable diagnostic logging</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enabling diagnostic logging on virtual machines facilitates forensic analysis and troubleshooting by collecting necessary operational data. The parameter governing this behavior is Enable Logging with a recommended setting of TRUE.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Diagnostic logging is crucial for identifying and analyzing issues that may arise within a virtual machine environment. It supports timely resolution of problems, thus maintaining system integrity and operational efficiency.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no negative functional impact identified for enabling diagnostic logging. This control significantly aids in issue resolution, enhancing overall system reliability and performance.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.25_L1_Virtual_machines_must_limit_the_number_of_retained_diagnostic_logs" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit the number of retained diagnostic logs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limiting the number of retained diagnostic logs in virtual machines helps in managing datastore space effectively without hampering diagnostic capabilities. The parameter governing this behavior is log.keepOld with a recommended setting of 10 or Undefined.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Maintaining a sensible limit on the number of diagnostic logs retained helps in avoiding potential issues related to datastore space exhaustion, while still retaining a useful set of recent logs for troubleshooting purposes.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">log.keepOld</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">10</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
To set the number of log files to be used to               <xhtml:span class="inline_block">10</xhtml:span>
, run the following PowerCLI command:            </xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "log.keepOld" -value "10"
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no negative functional impact.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689023" value-id="xccdf_org.cisecurity.benchmarks_value_4689023_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689023"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.26_L1_Virtual_machines_must_limit_the_size_of_diagnostic_logs" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit the size of diagnostic logs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limiting the size of diagnostic logs on virtual machines ensures efficient utilization of datastore space, particularly beneficial for long-running VMs. This control assists in maintaining an optimal balance between diagnostic capabilities and storage resources. The parameter governing this behavior is log.rotateSize.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Setting a limit on the size of diagnostic logs helps in preventing excessive space consumption, thus ensuring that ample storage remains available for other essential operations.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://kb.vmware.com/kb/8182749</xccdf:ident>
         <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5-8F5B-145EBD26BBA1.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To set this configuration utilize the vSphere interface as follows:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Select the VM then select                 <xhtml:span class="inline_block">Actions</xhtml:span>
 followed by                 <xhtml:span class="inline_block">Edit Settings</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on the                 <xhtml:span class="inline_block">VM Options</xhtml:span>
 tab then expand                 <xhtml:span class="inline_block">Advanced</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">EDIT CONFIGURATION</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:span class="inline_block">ADD CONFIGURATION PARAMS</xhtml:span>
 then input                 <xhtml:span class="inline_block">log.rotateSize</xhtml:span>
 with a value of                 <xhtml:span class="inline_block">1024000</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Click                 <xhtml:span class="inline_block">OK</xhtml:span>
, then                 <xhtml:span class="inline_block">OK</xhtml:span>
 again.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To properly limit the maximum log file size, run the following PowerCLI command:</xhtml:p>
                  <xhtml:code class="code_block">
# Add the setting to all VMs              <br/>
Get-VM | New-AdvancedSetting -Name "log.rotateSize" -value "1024000"
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no negative functional impact identified by limiting the size of diagnostic logs. This control facilitates proficient management of storage resources, ensuring other vital functions are not compromised due to space exhaustion.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:4689024" value-id="xccdf_org.cisecurity.benchmarks_value_4689024_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:4689024"/>
            </check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:var:5200077" value-id="xccdf_org.cisecurity.benchmarks_value_5200077_var"/>
               <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
               <check-content-ref href="CIS_VMware_ESXi_8.0_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_7.0.0_1:def:5200077"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.27_L1_Virtual_machines_must_limit_informational_messages_from_the_virtual_machine_to_the_VMX_file" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Virtual machines must limit informational messages from the virtual machine to the VMX file</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limit the number of informational messages from the virtual machine to the VMX file to prevent the file from exceeding its default size of 1MB, thereby avoiding potential denial of service situations due to a full datastore. The parameter governing this behavior is tools.setInfo.sizeLimit with a recommended setting of 1048576 or Undefined.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This control helps in maintaining a clutter-free VMX file, ensuring the datastore operates optimally without being overwhelmed by excessive informational messages, which in turn supports system reliability and performance.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>No negative functional impact identified.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.28_L2_Virtual_machines_should_have_virtual_machine_hardware_version_19_or_newer" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Virtual machines should have virtual machine hardware version 19 or newer</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Upgrade to hardware version 19 or newer to access enhanced features and better performance. Test the upgrades and ensure compatibility across all operational landscapes.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Verify That Acquired Software is Still Supported" urn="urn:cisecurity.org:controls:7.0:18:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type/>
                     <controls:security_function/>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Upgrading facilitates improved performance and feature access, aligning with ESXi and vSphere updates, while ensuring service continuity across various environments.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Changes in device versions within the guest may occur, requiring thorough testing to prevent service disruptions. Snapshots can aid in testing, allowing you to revert the hardware version if needed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8_VMware_Tools">
      <xccdf:title xml:lang="en">VMware Tools</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1_L1_VMware_Tools_must_be_a_version_that_has_not_reached_End_of_General_Support_status" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must be a version that has not reached End of General Support status</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensuring VMware Tools is running a version that has not reached its End of General Support (EOGS) status is imperative for maintaining a secure and supported environment. A version within its support period guarantees regular updates, security patches, and vendor support. It's advisable to have a procedure in place for regular checking and updating of VMware Tools to a supported version.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Running a supported version of VMware Tools ensures that the environment benefits from the latest security patches and updates, thereby reducing the risk of vulnerabilities. It also ensures that the organization can receive necessary support from the vendor when needed.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Using a version of VMware Tools that has reached its EOGS can expose the environment to security risks due to lack of updates and patches. It also may lead to compliance issues and lack of vendor support which could result in operational inefficiencies.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2_L1_VMware_Tools_must_have_all_software_updates_installed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must have all software updates installed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensuring that all software updates are installed on VMware Tools is crucial for maintaining a healthy and secure virtual environment. These updates provide essential drivers, enable effective management of guest operating systems, and offer features necessary for VM deployment and customization. It's vital to run a supported version compatible with the guest OS, be it Linux or Microsoft Windows, and keep it updated to benefit from the latest enhancements and security patches.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Install the Latest Stable Version of Any Security-related Updates on All Network Devices" urn="urn:cisecurity.org:controls:7.0:11:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Keeping VMware Tools updated ensures that the virtual machines are running efficiently with the latest drivers and features, which in turn supports operational effectiveness. Additionally, updated software mitigates potential security risks, ensuring a more secure environment.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Neglecting to update VMware Tools could result in outdated drivers, lack of new features, and potential security vulnerabilities, which may hinder the performance and security of the virtual environment.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3_L1_VMware_Tools_should_configure_automatic_upgrades_as_appropriate_for_the_environment" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools should configure automatic upgrades as appropriate for the environment</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Automatic upgrades of VMware Tools can be managed via vSphere, ensuring VMware Tools versions remain current. This functionality is advisable unless alternative management and update mechanisms are in place. It is recommended to have automatic updates enabled to minimize administrative overhead and maintain up-to-date features and security patches. The parameter governing this behavior is autoupgrade allow-upgrade with a recommended setting of true.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling automatic upgrades via vSphere ensures a streamlined process for keeping VMware Tools updated, reducing the administrative burden. It also ensures that VMs are running the latest versions with necessary security patches and updated features.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disabling automatic upgrades necessitates alternative methods for updating and reconfiguring VMware Tools, which could increase administrative overhead and potentially leave VMs with outdated versions, posing security risks and operational inefficiencies.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4_L1_VMware_Tools_on_deployed_virtual_machines_must_prevent_being_recustomized" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools on deployed virtual machines must prevent being recustomized</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Preventing re-customization of deployed virtual machines is essential to mitigate the risk of adversarial access through cloning and subsequent customization. Once a VM is deployed, it should be safeguarded against further customization to maintain the integrity of its configurations and data. The parameter governing this behavior is deployPkg enable-customization with a recommended setting of false.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This control mitigates the risk of unauthorized access and potential data exposure that may arise from cloning and re-customizing a VM. By adhering to this control, organizations uphold the integrity and security of deployed virtual machines.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disabling re-customization on deployed VMs may affect disaster recovery processes that necessitate IP address modifications. Such processes, facilitated by VMware Site Recovery Manager or VMware Cloud Disaster Recovery, will require alternative strategies for IP address management in recovery scenarios.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.5_L1_VMware_Tools_must_limit_the_automatic_addition_of_features" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must limit the automatic addition of features</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limit the automatic addition of features during VMware Tools upgrade processes to maintain the desired security profile of the guest operating system from vSphere. This control can be managed by setting the configuration parameter to a specified value. The parameter governing this behavior is autoupgrade allow-add-feature with a recommended setting of false.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting the automatic addition of features through VMware Tools upgrade processes helps in preserving the security configurations and minimizes the potential introduction of vulnerabilities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>With this control enforced, administrators will need to employ alternative methods to update and reconfigure VMware Tools as required, which might necessitate additional administrative effort and oversight.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.6_L1_VMware_Tools_must_limit_the_automatic_removal_of_features" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must limit the automatic removal of features</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limiting the automatic removal of features by VMware Tools during upgrade processes is crucial to maintain the intended security profile of the guest OS from vSphere. The automatic upgrade could potentially remove essential features, impacting the security posture inadvertently. The parameter governing this behavior is autoupgrade allow-remove-feature with a recommended setting of false.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting automatic removal of features ensures that the security configurations and other essential features remain intact during upgrades, thus maintaining a consistent security posture.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>With this control, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might necessitate additional administrative effort.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.7_L1_VMware_Tools_must_deactivate_GlobalConf_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must deactivate GlobalConf unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The GlobalConf feature within VMware Tools facilitates the delivery of tools.conf configurations to virtual machines, simplifying configuration management. However, if not necessary, it's advisable to deactivate this feature to reduce potential security risks. The parameter governing this behavior is globalconf enabled with a recommended setting of false.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Deactivating GlobalConf minimizes the attack surface by reducing the number of channels through which configurations can be pushed to virtual machines, hence enhancing security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>With GlobalConf deactivated, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might require additional steps or tools.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.8_L1_VMware_Tools_must_deactivate_ContainerInfo_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must deactivate ContainerInfo unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Deactivating the ContainerInfo plugin within VMware Tools is advised unless its functionality is required. This plugin collects data on running containers within a Linux guest operating system. The parameter governing this behavior is containerinfo poll-interval with a recommended setting of 0.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting unnecessary data collection is a prudent practice to minimize potential security risks, and to comply with least privilege principles.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disabling ContainerInfo could affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating other configurations or methods to obtain the required container information.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.9_L1_VMware_Tools_must_deactivate_Appinfo_information_gathering_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must deactivate Appinfo information gathering unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Deactivating the Appinfo module, unless necessary, through VMware Tools is a prudent measure to minimize the attack surface. This module is designed for application discovery, but if not in use, it should be disabled. The parameter governing this behavior is appinfo disabled with a recommended setting of true.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By deactivating the Appinfo module when not in use, potential vectors for unauthorized access or data leakage can be reduced.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disabling Appinfo may affect products and services within the VMware ecosystem that depend on this functionality, necessitating alternative configurations or solutions to retain those capabilities.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.10_L1_VMware_Tools_must_deactivate_Guest_Store_Upgrade_operations_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must deactivate Guest Store Upgrade operations unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The GuestStore feature facilitates the distribution of specific content to multiple guests. If not required, it is advisable to disable this plugin to minimize potential attack vectors. The parameter governing this behavior is gueststoreupgrade policy with a recommended setting of off.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Minimizing the attack surface by disabling unnecessary features is a prudent security measure. This control aids in reducing potential exposure points in the system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Deactivating Guest Store Upgrade operations may affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating alternative configurations or methods to maintain required operational capabilities.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.11_L1_VMware_Tools_must_deactivate_Service_Discovery_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must deactivate Service Discovery unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The VMware Tools Service Discovery plugin is designed to connect to Aria Operations, furnishing it with additional data concerning guests and workloads. Disabling this plugin, when not in use, is a prudent step to diminish the attack surface. The parameter governing this behavior is servicediscovery disabled with a recommended setting of true.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Reducing the attack surface by disabling non-essential features is a fundamental security best practice. This control assists in minimizing potential exposure points, especially when the Service Discovery feature is not in use.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Disabling Service Discovery may affect certain products and services within the VMware ecosystem dependent on this functionality, necessitating alternative configurations or methods to retain required operational capabilities.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.12_L1_VMware_Tools_must_limit_the_use_of_MSI_transforms_when_reconfiguring_VMware_Tools" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must limit the use of MSI transforms when reconfiguring VMware Tools</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Limiting the use of MSI transforms during VMware Tools reconfiguration is crucial to prevent unintended alterations to the installation database on Microsoft Windows guest operating systems from vSphere. This control is managed through a specific configuration parameter. The parameter governing this behavior is autoupgrade allow-msi-transforms with a recommended setting of false.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By restricting the use of MSI transforms, organizations can maintain a consistent security profile of the guest OS and minimize risks associated with unintended configuration changes during VMware Tools reconfiguration.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Implementing this control will necessitate administrators to leverage alternative methods for updating and reconfiguring VMware Tools as required, which may demand additional administrative effort and oversight.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.13_L1_VMware_Tools_must_enable_VMware_Tools_logging" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must enable VMware Tools logging</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Enable logging within VMware Tools to ensure the collection of pertinent information, facilitating diagnostic or forensic activities. Logging within VMware Tools is highly customizable, allowing for tailored logging setups. The parameter governing this behavior is logging log with a recommended setting of true.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Logging is crucial for diagnosing issues and understanding system interactions. It provides a clear trail of events, aiding in the identification and rectification of potential problems.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>There is no known negative functional impact from enabling VMware Tools logging. This control solely promotes the capture of essential data for diagnostics and analysis.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.14_L1_VMware_Tools_must_send_VMware_Tools_logs_to_the_system_log_service" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) VMware Tools must send VMware Tools logs to the system log service</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Adjusting the logging destination in VMware Tools from the default file on disk to system log services streamlines log management. It redirects logs to syslog on Linux guests and the Windows Event Service on Microsoft Windows guests for centralized monitoring, management, and archiving. The parameter governing this behavior is logging vmsvc.handler with a recommended setting of syslog.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Central Log Management" urn="urn:cisecurity.org:controls:7.0:6:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Centralizing log management through system log services enhances monitoring and archival processes. It also fosters a more structured approach to analyzing log data which is crucial for troubleshooting and compliance purposes.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Processes dependent on log files in the default location may require modifications to function correctly with the new logging setup, necessitating updates to ensure proper operation and log data retrieval.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.15_L2_VMware_Tools_must_deactivate_Guest_Operations_unless_required" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) VMware Tools must deactivate Guest Operations unless required</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Guest Operations are a set of functions that underpin most host-to-guest interaction. Deactivating them reduces attack surface but also drastically reduces functionality. Ensure that your environment does not require these functions. Do not do this on template VMs. For a list of functions see:</xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://vdc-download.vmware.com/vmwb-repository/dcr-public/fe08899f-1eec-4d8d-b3bc-a6664c168c2c/7fdf97a1-4c0d-4be0-9d43-2ceebbc174d9/doc/vim.vm.guest.GuestOperationsManager.html">https://vdc-download.vmware.com/vmwb-repository/dcr-public/fe08899f-1eec-4d8d-b3bc-a6664c168c2c/7fdf97a1-4c0d-4be0-9d43-2ceebbc174d9/doc/vim.vm.guest.GuestOperationsManager.html</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Reducing the attack surface by deactivating unnecessary functions is a standard security measure. This control is crucial for mitigating risks associated with host-to-guest interactions.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Deactivation of Guest Operations can hinder the functionality of certain products and services within the VMware ecosystem, requiring alternative configurations or methods to maintain required functionalities. This includes guest customization.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
<ds:DigestValue>KFl/hW3sRRfW/OBczbJabPrwISWC/cf3j4EKf3v41XQ=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
xAu17cVCmVIeM+d+iRG1TDLlC8AUj0Qxy5mMKDgG3falEEnwdd3Bvctg3CUw2MaAZdWWJ4208b4D
vLNg3GqfIzCEuJDAkyStRt2ZKwcywOGoANdVCDD3vconRphm4EP5YRg1h//YRVgI2f11+vk1MfNZ
FYMBpJfMYvN2z50J7KurF14qH9cO3WRA1qWQg3m9CR5R3DYBWSPpLzR0j+HAadZNV0cc0W8HKMYC
tzEQKUI0iSzjyoWyZqjhpC7DPZpnExFaGZ/FhbTbQDN5gnQw/mclKPL2GgNLoDqYTLg1Kr4AzDKp
DcZiXs0cQf0nqElNWaRnckcAa/oQLHA3+iJhfkPR+/JieYgKt919heij3vGpxguwDUzqUz81vIFt
NHtI+urr0k9pQZqzy8GwZsSF964BmoboCM2lZk2lrH9Q42XvktzT8M/4pcL3zgjXXtEsxZa2sORZ
iPiD1FbUKx7ZsA57KTotiWKnxoruGhrz4H729GUOyfiA7d34Ix/lmYRx
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>