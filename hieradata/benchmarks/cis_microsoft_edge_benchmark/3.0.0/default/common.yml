---

inspec_rules:
  "1.2.1":
    title: '1.2.1 | L1 Ensure Enable Google Cast is set to Disabled'
    section: 'Cast'
    description: |
        This policy setting determines whether Google Cast is available to users.
        The recommended state for this setting is              Disabled
        .           Note
         When this setting is set to              Disabled
         the              Show the cast icon in the toolbar
         setting is ignored as the icon is removed.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Cast\Enable Google Cast
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will not be able to utilize Google Cast and the icon will not be displayed in Microsoft
        Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.2.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EnableMediaRouter"'
            - name: 'EnableMediaRouter'
              rule: "should have_property_value('EnableMediaRouter', :dword, '0')"

  "1.3.1":
    title: '1.3.1 | L2 Ensure Allow read access via the File System API on these sites is set to Disabled'
    section: 'Content Settings'
    description: |
        This policy setting allows organizations to list the URL patterns that specify which sites can ask users to grant them
        read access to files or directories in the host operating systems file system via the File System API.
        The recommended state for this setting is              Disabled
        .           Note
         Leaving this policy not configured allows the DefaultFileSystemReadGuardSetting Control use of the File System API for
        reading to apply for all sites. This setting is configured in the Level 2 profile              Ensure Control use of the
        File System API for reading is set to Enabled Dont allow any site to request read access to files and directories
        .           Note 2
         URL patterns cant conflict with FileSystemReadBlockedForUrls Block read access via the File System API on these sites.
        Neither policy takes precedence if a URL matches with both.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Allow read
        access via the File System API on these sites
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users with creative roles that require read access to files and directories via the File System
        API may need additional permissions granted for said roles.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should_not have_property "FileSystemReadAskForUrls"'

  "1.3.2":
    title: '1.3.2 | L1 Ensure Control use of insecure content exceptions is set to Enabled Do not allow any site to load mixed content'
    section: 'Content Settings'
    description: |
        This policy setting allows for the configuration for users to add exceptions to allow mixed content for specific sites.
        The recommended state for this setting is              Enabled Do not allow any site to load mixed content
                        Note
         This policy can be overridden for specific URL patterns using the              insecurecontentAllowedForUrls Allow
        insecure content on specified sites
         and              insecurecontentBlockedForUrls Block insecure content on specified sites policies
        .
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                  Enabled: Do
        not allow any site to load mixed content
        :               Computer Configuration\Polices\Administrative Templates\Microsoft Edge\Content Settings\Control use of
        insecure content exceptions
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will not be able to add exceptions for mixed content webpages.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.2', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultinsecurecontentSetting"'
            - name: 'DefaultinsecurecontentSetting'
              rule: "should have_property_value('DefaultinsecurecontentSetting', :dword, '2')"

  "1.3.3":
    title: '1.3.3 | L2 Ensure Control use of JavaScript JIT is set to Enabled Do not allow any site to run JavaScript JIT'
    section: 'Content Settings'
    description: |
        This policy setting specifies whether Microsoft Edge will run the v8 JavaScript engine with JIT Just In Time compiler.
        JIT is a complex pipeline of processes used to optimize JavaScript code for performance. Note
         This policy can be overridden for specific URL patterns using the              JavaScriptJitAllowedForSites Allow
        JavaScript to use JIT on these sites
         and              JavaScriptJitBlockedForSites Block JavaScript from using JIT on these sites
         policies.
        The recommended state for this setting is              Enabled Do not allow any site to run JavaScript JIT
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Do not allow
        any site to run JavaScript JIT
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content Settings\Control use of
        JavaScript JIT
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Disabling the JavaScript JIT will mean that Microsoft Edge may render web content more slowly,
        and may also disable parts of JavaScript including WebAssembly. Users may experience slower rendering of web content.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.3', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultJavaScriptJitSetting"'
            - name: 'DefaultJavaScriptJitSetting'
              rule: "should have_property_value('DefaultJavaScriptJitSetting', :dword, '2')"

  "1.3.4":
    title: '1.3.4 | L2 Ensure Control use of the File System API for reading is set to Enabled Dont allow any site to request read access to files and directories via the File System API'
    section: 'Content Settings'
    description: |
        This policy setting determines whether websites can ask for read access to the host operating systems file system using
        the File System API.
        The recommended state for this setting is              Enabled Dont allow any site to request read access to files and
        directories via the File System API
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Don't allow
        any site to request read access to files and directories via the File System API
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Control use of
        the File System API for reading
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users with creative roles that require the File System API access permission to read files for
        photo, video, and text editors or for creating integrated development environments will need additional permissions
        granted based on their role.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.4', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultFileSystemReadGuardSetting"'
            - name: 'DefaultFileSystemReadGuardSetting'
              rule: "should have_property_value('DefaultFileSystemReadGuardSetting', :dword, '2')"

  "1.3.5":
    title: '1.3.5 | L1 Ensure Control use of the File System API for writing is set to Enabled Dont allow any site to request write access to files and directories'
    section: 'Content Settings'
    description: |
        This policy setting specifies whether websites can ask for write access to the host operating systems filesystem using
        the File System API. By default, websites can ask for access. Users can change this setting. By setting this policy to
        2, access is denied.
        The recommended state for this setting is              Enabled Dont allow any site to request write access to files and
        directories
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Don't allow
        any site to request write access to files and directories
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Control use of
        the File System API for writing
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users with creative roles that require the File System API access permission to write files for
        photo, video, and text editors or for creating integrated development environments will need additional permissions
        granted based on their role.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.5', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultFileSystemWriteGuardSetting"'
            - name: 'DefaultFileSystemWriteGuardSetting'
              rule: "should have_property_value('DefaultFileSystemWriteGuardSetting', :dword, '2')"

  "1.3.6":
    title: '1.3.6 | L2 Ensure Control use of the Web Bluetooth API is set to Enabled Do not allow any site to request access to Bluetooth devices via the Web Bluetooth API'
    section: 'Content Settings'
    description: |
        This policy setting controls whether websites can access connected Bluetooth devices.
        The recommended state for this setting is              Enabled Do not allow any site to request access to Bluetooth
        devices via the Web Bluetooth API
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Do not allow
        any site to request access to Bluetooth devices via the Web Bluetooth API
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Control use of
        the Web Bluetooth API
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Websites will be unable to utilize connected Bluetooth devices via the API, this includes web
        cameras, microphones, and other USB devices.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.6', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultWebBluetoothGuardSetting"'
            - name: 'DefaultWebBluetoothGuardSetting'
              rule: "should have_property_value('DefaultWebBluetoothGuardSetting', :dword, '2')"

  "1.3.7":
    title: '1.3.7 | L2 Ensure Control use of the WebHID API is set to Enabled Do not allow any site to request access to HID devices via the WebHID API'
    section: 'Content Settings'
    description: |
        This policy setting determines whether a website is able to ask for access to use the WebHID API. The WebHID API allows
        websites to access alternative auxiliary keyboards and exotic gamepads.
        The recommended state for this setting is              Enabled Do not allow any site to request access to HID devices
        via the WebHID API
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Do not allow
        any site to request access to HID devices via the WebHID API
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Control use of
        the WebHID API
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: WebHID describes a wide array of devices that could be supported through HID, including virtual
        reality controls, flight simulators, medical equipment, and more. Disabling WebHID would require additional drivers or
        modification to enable support for approved devices.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.7', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultWebHidGuardSetting"'
            - name: 'DefaultWebHidGuardSetting'
              rule: "should have_property_value('DefaultWebHidGuardSetting', :dword, '2')"

  "1.3.8":
    title: '1.3.8 | L1 Ensure Default automatic downloads setting is set to Enabled Dont allow any website to perform automatic downloads'
    section: 'Content Settings'
    description: |
        This policy setting controls whether websites can perform multiple downloads successively without user interaction.
        The recommended state for this setting is              Enabled Dont allow any website to perform automatic downloads
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Don´t allow
        any website to perform automatic downloads
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Default
        automatic downloads setting
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Websites will not be able to perform automatic downloads.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.8', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultAutomaticDownloadsSetting"'
            - name: 'DefaultAutomaticDownloadsSetting'
              rule: "should have_property_value('DefaultAutomaticDownloadsSetting', :dword, '2')"

  "1.3.9":
    title: '1.3.9 | L1 Ensure Default geolocation setting is set to Enabled Dont allow any site to track users physical location'
    section: 'Content Settings'
    description: |
        This policy setting controls whether a users physical location can be tracked by websites.
        The recommended state for this setting is              Enabled Dont allow any site to track users physical location
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Don't allow
        any site to track users' physical location
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Content settings\Default
        geolocation setting
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Location information will not be shared with websites in Microsoft Edge.  This could have an
        effect on websites that utilize this information for customized content.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.9', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultGeolocationSetting"'
            - name: 'DefaultGeolocationSetting'
              rule: "should have_property_value('DefaultGeolocationSetting', :dword, '2')"

  "1.3.10":
    title: '1.3.10 | L2 Ensure Default setting for third-party storage partitioning is set to Enabled Block third-party storage partitioning from being enabled.'
    section: 'Content Settings'
    description: |
        This policy setting configures the use of thirdparty storage partitioning. When using storage partitioning, a site
        cannot join data across different sites to track the user across the web.
        The recommended state for this setting is              Enabled Block thirdparty storage partitioning from being enabled.
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Block third-
        party storage partitioning from being enabled.
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Cast\Default setting for third-
        party storage partitioning
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: This setting may cause users to experience issues with sites they regularly visit that already
        grant access to third-parties.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.10', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultThirdPartyStoragePartitioningSetting"'
            - name: 'DefaultThirdPartyStoragePartitioningSetting'
              rule: "should have_property_value('DefaultThirdPartyStoragePartitioningSetting', :dword, '2')"

  "1.5.1":
    title: '1.5.1 | L1 Ensure Configure Edge Website Typo Protection is set to Enabled'
    section: 'Edge Website Typo Protection settings'
    description: |
        This policy setting configures whether to turn on Edge TyposquattingChecker. The Edge TyposquattingChecker provides
        warning messages to help protect users from potential typo squatting sites. Typo squatting is a type of social
        engineering attack which targets internet users who incorrectly type a URL into their web browser rather than using a
        search engine. Typically, it involves tricking users into visiting malicious websites with URLs that are common
        misspellings of legitimate websites.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Edge Website Typo Protection
        settings\Configure Edge Website Typo Protection
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will receive a warning message if they attempt to access a site deemed (by Microsoft) a
        typosquatting site.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TyposquattingCheckerEnabled"'
            - name: 'TyposquattingCheckerEnabled'
              rule: "should have_property_value('TyposquattingCheckerEnabled', :dword, '1')"

  "1.7.1":
    title: '1.7.1 | L1 Ensure Configure users ability to override feature flags is set to Enabled Prevent users from overriding feature flags'
    section: 'Experimentation'
    description: |
        This policy setting configures users ability to override state of feature flags. Feature flags are settings a team can
        define that indicate whether a given set of features is visible in the user experience and/or invoked within the
        functionality.
        The recommended state for this setting is              Enabled Prevent users from overriding feature flags
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Prevent users
        from overriding feature flags
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Experimentation\Configure users
        ability to override feature flags
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: It can be risky for experimental features to be allowed in an enterprise managed environment
        because this can introduce bugs and security holes into systems, making it easier for an attacker to gain access. It is
        generally preferred to only use production-ready features.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "FeatureFlagOverridesControl"'
            - name: 'FeatureFlagOverridesControl'
              rule: "should have_property_value('FeatureFlagOverridesControl', :dword, '0')"

  "1.8.1":
    title: '1.8.1 | L1 Ensure Blocks external extensions from being installed is set to Enabled'
    section: 'Extensions'
    description: |
        This policy setting determines whether external extensions an extension that is not installed from the Chrome Web Store
        can be installed.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                  Enabled
        :               Computer Configuration\Polices\Administrative Templates\Microsoft Edge\Extensions\Blocks external
        extensions from being installed
         Impact: User will only be allowed to install extension for the Chrome web store.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.8.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BlockExternalExtensions"'
            - name: 'BlockExternalExtensions'
              rule: "should have_property_value('BlockExternalExtensions', :dword, '1')"

  "1.8.2":
    title: '1.8.2 | L2 Ensure Configure extension management settings is set to Enabled '
    section: 'Extensions'
    description: |
        This policy setting controls extension management settings for Microsoft Edge, including any controlled by existing
        extensionrelated policies. This policy supersedes any legacy policies that might be set.
        The recommended state for this setting is              Enabled
        .           NOTE
         This policy maps an extension ID or an update URL to its specific setting only. A default configuration can be set for
        the special ID , which applies to all extensions without a custom configuration in this policy. With an update URL,
        configuration applies to extensions with the exact update URL stated in the extension manifest. If the
        overrideupdateurl
         flag is set to true, the extension is installed and updated using the update URL specified in the
        ExtensionInstallForcelist Control which extensions are installed silently
         policy or in              updateurl
         field in this policy. The flag              overrideupdateurl
         is ignored if the              updateurl
         is the Edge Addons website update URL.           Note 2
         For more granular control the              ExtensionInstallForcelist
         and              ExtensionInstallAllowlist Allow specific extensions to be installed
         to allow or force install of specific extensions even if the store is blocked using the JSON in the example.
        updateurlhttps//clients2.google.com/service/update2/crxinstallationmodeblocked
        For more details, check out the detailed guide to              ExtensionSettings
         policy available from Microsoft at              Detailed guide to the ExtensionSettings policy  Microsoft Learn
        .
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                  Enabled: *
        :               Computer Configuration\Polices\Administrative Templates\Microsoft Edge\Extensions\Configure extension
        management settings
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Any installed extension will be removed unless it is specified on the extension allowlist, if an
        organization is using any approved password managers ensure that the extension is added to the allowlist.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.8.2', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ExtensionSettings"'
            - name: 'ExtensionSettings'
              rule: "should have_property_value('ExtensionSettings', :string, '*')"

  "1.9.1":
    title: '1.9.1 | Ensure Enable Gamer Mode is set to Disabled'
    section: 'Games settings'
    description: |
        Microsoft Edge Gamer Mode allows the personalize of browsers with gaming themes and gives the option of enabling
        Efficiency Mode for PC gaming, the Gaming feed on new tabs, sidebar apps for gamers, and more.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Games settings\Enable gamer mode
        in Microsoft Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                  Download Edge for Business
        .               Impact: The gamer mode feature in Microsoft Edge will not function.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.9.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "GamerModeEnabled"'
            - name: 'GamerModeEnabled'
              rule: "should have_property_value('GamerModeEnabled', :dword, '0')"

  "1.10.1":
    title: '1.10.1 | L1 Ensure Allow Basic authentication for HTTP is set to Disabled'
    section: 'HTTP authentication'
    description: |
        This policy setting determines if Basic authentication receives challenges over nonsecure HTTP. Basic authentication is
        a nonsecure authentication method that relies on sending the username and password to the server in plaintext.
        The recommended state for this setting is              Disabled
        .           Note
         This policy setting is ignored and Basic is always forbidden if the              AuthSchemes Supported authentication
        schemes
         policy is set and does not include Basic.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\HTTP authentication\Allow Basic
        authentication for HTTP
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Non-secure HTTP requests from the Basic authentication scheme are blocked, and only secure HTTPS
        is allowed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.10.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BasicAuthOverHttpEnabled"'
            - name: 'BasicAuthOverHttpEnabled'
              rule: "should have_property_value('BasicAuthOverHttpEnabled', :dword, '0')"

  "1.10.2":
    title: '1.10.2 | L1 Ensure Allow cross-origin HTTP Authentication prompts is set to Disabled'
    section: 'HTTP authentication'
    description: |
        This policy setting controls whether thirdparty subcontent can open a HTTP Basic Auth dialog and is typically disabled.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\HTTP authentication\Allow cross-
        origin HTTP Authentication prompts
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Disabling this setting should have minimal impact to the user as it is typically disabled by
        default and third-party sub-content can't open a HTTP Basic Auth dialog box.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.10.2', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AllowCrossOriginAuthPrompt"'
            - name: 'AllowCrossOriginAuthPrompt'
              rule: "should have_property_value('AllowCrossOriginAuthPrompt', :dword, '0')"

  "1.10.3":
    title: '1.10.3 | L2 Ensure Supported authentication schemes is set to Enabled ntlm negotiate'
    section: 'HTTP authentication'
    description: |
        This setting specifies what HTTP authentication methods are supported by Microsoft Edge.
        The recommended setting is              Enabled ntlm, negotiate
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: ntlm,
        negotiate
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\HTTP authentication\Supported
        authentication schemes
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Any sites that utilize Basic or Digest Authentication will be impacted. Sites will need to be
        reconfigured to support a more secure form of authentication.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.10.3', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AuthSchemes"'
            - name: 'AuthSchemes'
              rule: "should have_property_value('AuthSchemes', :string, 'ntlm, negotiate')"

  "1.11.1":
    title: '1.11.1 | L1 Ensure Enable the linked account feature is set to Disabled'
    section: 'Identity and sign-in'
    description: |
        This policy setting determines if Microsoft Edge can guide a user to the account management page where they can link a
        Microsoft Account MSA to an Azure Active Directory Azure AD account.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Identity and sign-in\Enable the
        linked account feature
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Linked account information will not be shown on a flyout and when the Azure AD profile doesn´t
        have a linked account it will not show the "Add account" button.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.11.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "LinkedAccountEnabled"'
            - name: 'LinkedAccountEnabled'
              rule: "should have_property_value('LinkedAccountEnabled', :dword, '0')"

  "1.11.2":
    title: '1.11.2 | L1 Ensure Guided Switch Enabled is set to Disabled'
    section: 'Identity and sign-in'
    description: |
        This policy setting allows Microsoft Edge to prompt the user to switch to the appropriate profile when Microsoft Edge
        detects that a link is a personal or work link.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Identity and sign-in\Guided
        Switch Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users won't be prompted to switch to another account when there´s a profile and link mismatch.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.11.2', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "GuidedSwitchEnabled"'
            - name: 'GuidedSwitchEnabled'
              rule: "should have_property_value('GuidedSwitchEnabled', :dword, '0')"

  "1.17.1":
    title: '1.17.1 | L1 Ensure Enable saving passwords to the password manager is set to Disabled'
    section: 'Password manager and protection'
    description: |
        This policy setting enables or disables the ability for users to save their passwords in Microsoft Edge.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Password manager and
        protection\Enable saving passwords to the password manager
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will be unable to utilize the Microsoft Edge built-in password manager.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.17.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "PasswordManagerEnabled"'
            - name: 'PasswordManagerEnabled'
              rule: "should have_property_value('PasswordManagerEnabled', :dword, '0')"

  "1.18.1":
    title: '1.18.1 | L1 Ensure Enable startup boost is set to Disabled'
    section: 'Performance'
    description: |
        This policy setting allows Microsoft Edge processes to start at OS signin and restart in background after the last
        browser window is closed.
        If Microsoft Edge is running in background mode, the browser might not close when the last window is closed, and the
        browser wont be restarted in background when the window closes. See the              BackgroundModeEnabled Continue
        running background apps after Microsoft Edge closes
         policy for information about what happens after configuring Microsoft Edge background mode behavior.
        The recommended state for this setting is              Disabled
        .           Note
         The startup boost policy may initially be configured off or on by the user the user can configure its behavior in
        edge//settings/system.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Performance\Enable startup boost
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will experience normal browser start-up times which may seem slow in comparison to Startup
        boost.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.18.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "StartupBoostEnabled"'
            - name: 'StartupBoostEnabled'
              rule: "should have_property_value('StartupBoostEnabled', :dword, '0')"

  "1.21.1":
    title: '1.21.1 | L1 Ensure Specifies whether to allow websites to make requests to more-private network endpoints is set to Disabled'
    section: 'Private Network Request Settings'
    description: |
        This policy setting controls whether insecure websites are allowed to make requests to more private network endpoints. A
        network endpoint is more private than another if Its IP address is localhost and the other is not. Its IP address is
        private and the other is public. In the future, depending on spec evolution, this policy might apply to all crossorigin
        requests directed at private IPs or localhost.
        A website is deemed secure if it meets the definition of a secure context in
        https//developer.mozilla.org/enUS/docs/Web/Security/SecureContexts
        . Otherwise, it will be treated as an insecure context.
        The recommended state for this setting is              Disabled
        .           Note
         This policy relates to the Private Network Access specification. See
        https//wicg.github.io/privatenetworkaccess/
         for more details.           Note 2
         If this policy is not configured or set to              Disabled
        , the default behavior for requests from insecure contexts to moreprivate network endpoints will depend on the users
        personal configuration for the              BlockInsecurePrivateNetworkRequests
         feature, which may be set by a field trial or on the command line.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Private Network Request
        Settings\Specifies whether to allow websites to make requests to more-private network endpoints
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Users will be unable to allow non-secure public contexts to request resources from private
        addresses.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.21.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InsecurePrivateNetworkRequestsAllowed"'
            - name: 'InsecurePrivateNetworkRequestsAllowed'
              rule: "should have_property_value('InsecurePrivateNetworkRequestsAllowed', :dword, '0')"

  "1.25.1":
    title: '1.25.1 | L1 Ensure Configure Microsoft Defender SmartScreen is set to Enabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting allows configuration of Microsoft Defender SmartScreen. Microsoft Defender SmartScreen helps to
        identify phishing and malware websites and to make informed decisions about downloads.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Configure
        Microsoft Defender SmartScreen
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SmartScreenEnabled"'
            - name: 'SmartScreenEnabled'
              rule: "should have_property_value('SmartScreenEnabled', :dword, '1')"

  "1.25.2":
    title: '1.25.2 | L1 Ensure Configure Microsoft Defender SmartScreen to block potentially unwanted apps is set to Enabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting allows configuration of Microsoft Defender SmartScreen and whether potentially unwanted apps are
        blocked.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Configure
        Microsoft Defender SmartScreen to block potentially unwanted apps
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: Microsoft Defender SmartScreen will block potentially dangerous apps. This could stop the user
        from installing an app that could be potentially harmful to the system.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.2', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SmartScreenPuaEnabled"'
            - name: 'SmartScreenPuaEnabled'
              rule: "should have_property_value('SmartScreenPuaEnabled', :dword, '1')"

  "1.25.3":
    title: '1.25.3 | L1 Ensure Enable Microsoft Defender SmartScreen DNS requests is set to Disabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting configures DNS requests made by Microsoft Defender SmartScreen.
        The recommended state for this setting is              Disabled
        .           Note
         This policy is available only on Windows instances that are joined to a Microsoft Active Directory domain, Windows 10
        Pro or Enterprise instances that enrolled for device management, or macOS instances that are that are managed via MDM or
        joined to a domain via MCX.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Enable
        Microsoft Defender SmartScreen DNS requests
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: DNS server might not resolve queries sent to external websites or the website may have no
        information stored on its local server or cache. Warning:
         Disabling DNS requests will prevent Microsoft Defender SmartScreen from getting IP addresses, and potentially impact
        the IP-based protections provided.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.3', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SmartScreenDnsRequestsEnabled"'
            - name: 'SmartScreenDnsRequestsEnabled'
              rule: "should have_property_value('SmartScreenDnsRequestsEnabled', :dword, '0')"

  "1.25.4":
    title: '1.25.4 | L1 Ensure Force Microsoft Defender SmartScreen checks on downloads from trusted sources is set to Enabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting controls whether Microsoft Defender SmartScreen can check if downloads have been retrieved from a
        trusted source.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Force
        Microsoft Defender SmartScreen checks on downloads from trusted sources
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.4', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SmartScreenForTrustedDownloadsEnabled"'
            - name: 'SmartScreenForTrustedDownloadsEnabled'
              rule: "should have_property_value('SmartScreenForTrustedDownloadsEnabled', :dword, '1')"

  "1.25.5":
    title: '1.25.5 | L1 Ensure Prevent bypassing Microsoft Defender SmartScreen prompts for sites is set to Enabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting controls whether users may bypass the SmartScreen warning if a site is deemed unsafe.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Prevent
        bypassing Microsoft Defender SmartScreen prompts for sites
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: SmartScreen will not allow a user to bypass the warning message.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.5', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "PreventSmartScreenPromptOverride"'
            - name: 'PreventSmartScreenPromptOverride'
              rule: "should have_property_value('PreventSmartScreenPromptOverride', :dword, '1')"

  "1.25.6":
    title: '1.25.6 | L1 Ensure Prevent bypassing of Microsoft Defender SmartScreen warnings about downloads is set to Enabled'
    section: 'SmartScreen settings'
    description: |
        This policy setting controls whether users may override Microsoft Defender SmartScreen warnings regarding downloads that
        are unverified.
        The recommended state for this setting is              Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\SmartScreen settings\Prevent
        bypassing of Microsoft Defender SmartScreen warnings about downloads
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: User will not be able to download software that has not been verified by SmartScreen.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.25.6', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "PreventSmartScreenPromptOverrideForFiles"'
            - name: 'PreventSmartScreenPromptOverrideForFiles'
              rule: "should have_property_value('PreventSmartScreenPromptOverrideForFiles', :dword, '1')"

  "1.26.1":
    title: '1.26.1 | L1 Ensure Disable Bing chat entry-points on Microsoft Edge Enterprise new tab page is set to Enabled'
    section: 'Startup, home page and new tab page'
    description: |
        By default, there are two Bing Chat entrypoints on the new tab page. One is inside the new tab page search box, and one
        is in the Bing Autosuggest drawer onclick.
        The recommended state for this setting is              Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Disabled
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Startup, home page and new tab
        page in Microsoft Edge.
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                  Download Edge for Business
        .               Impact: The Bing chat entry-points will not appear on the new tab page.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.26.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "NewTabPageBingChatEnabled"'
            - name: 'NewTabPageBingChatEnabled'
              rule: "should have_property_value('NewTabPageBingChatEnabled', :dword, '0')"

  "1.27":
    title: '1.27 | L1 Ensure Ads setting for sites with intrusive ads is set to Enabled Block ads on sites with intrusive ads.'
    section: 'Microsoft Edge'
    description: |
        This setting controls whether ads are blocked on sites with intrusive ads. Intrusive ads are typically ads that push
        invasive, unwelcomed, and irrelevant ads in front of consumers. These ads can pop up unexpectedly, block the host page,
        open new pages and windows, or play video and audio at inopportune times.
        The recommended state for this setting is            Enabled Block ads on sites with intrusive ads.
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Block ads on
        sites with intrusive ads.
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Ads setting for sites with
        intrusive ads
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Ads that may be non-intrusive could be blocked.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.27', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AdsSettingForIntrusiveAdsSites"'
            - name: 'AdsSettingForIntrusiveAdsSites'
              rule: "should have_property_value('AdsSettingForIntrusiveAdsSites', :dword, '2')"

  "1.28":
    title: '1.28 | L1 Ensure Allow download restrictions is set to Enabled  Block malicious downloads'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge blocks certain types of downloads, and prevents users from bypassing
        security warnings, depending on the classification of Safe Browsing.
        The recommended state for this setting is            Enabled Block malicious downloads
        .         Note
         These restrictions only apply to downloads from web page content, as well as the download link... context menu option.
        These restrictions dont apply to saving or downloading the currently displayed page, or to the Save as PDF option from
        the printing options. For more information on Microsoft Defender SmartScreen, please visit            Microsoft Defender
        SmartScreen Frequently Asked Questions
        .         Note 2
         Microsoft Edge relies on Internet Explorer zones Local Machine, Local Intranet, Trusted, Internet, Restricted to
        determine which sites may bypass this policy setting. Please see            Security Zones in Edge  text/plain
         for more information.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Block malicious
        downloads
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow download restrictions
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be prevented from downloading certain types of files and will not be able to bypass
        security warnings.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.28', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DownloadRestrictions"'
            - name: 'DownloadRestrictions'
              rule: "should have_property_value('DownloadRestrictions', :dword, '4')"

  "1.29":
    title: '1.29 | L2 Ensure Allow features to download assets from the Asset Delivery Service is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures the Microsoft Edge Asset Delivery Service. The Edge Asset Delivery Service is a general
        pipeline used to deliver assets to the Microsoft Edge Clients. These assets can be configuration files or Machine
        Learning models that power the features that use this service.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow features to download assets
        from the Asset Delivery Service
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Microsoft Edge features will not be able to download assets needed for them to run correctly.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.29', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EdgeAssetDeliveryServiceEnabled"'
            - name: 'EdgeAssetDeliveryServiceEnabled'
              rule: "should have_property_value('EdgeAssetDeliveryServiceEnabled', :dword, '0')"

  "1.30":
    title: '1.30 | L2 Ensure Allow file selection dialogs is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows access to local files by allowing file selection dialogs in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow file selection dialogs
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will no longer be prompted when performing actions which would trigger a file selection
        dialog. Instead, the file selection dialog box assumes the user clicked "Cancel". Being as this is not the default
        behavior, impact to the user will be noticeable, and the user will not be able to upload and download files.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.30', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AllowFileSelectionDialogs"'
            - name: 'AllowFileSelectionDialogs'
              rule: "should have_property_value('AllowFileSelectionDialogs', :dword, '0')"

  "1.31":
    title: '1.31 | L1 Ensure Allow Google Cast to connect to Cast devices on all IP addresses is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Google Cast is able to connect to all IP Addresses or only private IP Addresses as
        defined in RFC1918 IPv4 and RFC4193 IPv6.
        The recommended state for this setting is            Disabled
        .         Note
         If the            EnabledMediaRouter
         policy is set to            Disabled
         there is no positive or negative effect for this setting.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow Google Cast to connect to
        Cast devices on all IP addresses
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.31', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "MediaRouterCastAllowAllIPs"'
            - name: 'MediaRouterCastAllowAllIPs'
              rule: "should have_property_value('MediaRouterCastAllowAllIPs', :dword, '0')"

  "1.32":
    title: '1.32 | L1 Ensure Allow import of data from other browsers on each Microsoft Edge launch is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls if users will get a prompt following each Microsoft Edge launch to import their data from
        other browsers. Microsoft Edge will import data such as passwords, bookmarks, cookies, browsing history, and payment
        information depending on which browser this data is being imported from. At this time, Microsoft Edge can only import
        data from Google Chrome, Mozilla Firefox, Internet Explorer, and some thirdparty Password Managers.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow import of data from other
        browsers on each Microsoft Edge launch
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Users will not get a prompt to import their data from other browsers after each Microsoft Edge
        launch.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.32', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportOnEachLaunch"'
            - name: 'ImportOnEachLaunch'
              rule: "should have_property_value('ImportOnEachLaunch', :dword, '0')"

  "1.33":
    title: '1.33 | L1 Ensure Allow importing of autofill form data is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls the users ability to import autofill data from other browsers into Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of autofill form
        data
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to perform an import of autofill data during Microsoft Edge first run. This
        will also prevent users from importing data after Microsoft Edge has been set up.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.33', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportAutofillFormData"'
            - name: 'ImportAutofillFormData'
              rule: "should have_property_value('ImportAutofillFormData', :dword, '0')"

  "1.34":
    title: '1.34 | L1 Ensure Allow importing of browser settings is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to import settings from another browser into Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of browser
        settings
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to perform an import of other browser settings into Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.34', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportBrowserSettings"'
            - name: 'ImportBrowserSettings'
              rule: "should have_property_value('ImportBrowserSettings', :dword, '0')"

  "1.35":
    title: '1.35 | L1 Ensure Allow importing of home page settings is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to import homepage settings from another browser into Microsoft Edge
        as well as whether homepage settings are imported on first use.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of home page
        settings
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to import homepage settings from other browsers into Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.35', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportHomepage"'
            - name: 'ImportHomepage'
              rule: "should have_property_value('ImportHomepage', :dword, '0')"

  "1.36":
    title: '1.36 | L1 Ensure Allow importing of payment info is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to import payment information from another browser into Microsoft
        Edge as well as whether payment information is imported on first use.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of payment info
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to perform a payment information import from other browsers into Microsoft
        Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.36', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportPaymentInfo"'
            - name: 'ImportPaymentInfo'
              rule: "should have_property_value('ImportPaymentInfo', :dword, '0')"

  "1.37":
    title: '1.37 | L1 Ensure Allow importing of saved passwords is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to import saved passwords from another browser into Microsoft Edge
        as well as whether passwords are imported on first use.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of saved passwords
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to import saved passwords from other browsers into Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.37', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportSavedPasswords"'
            - name: 'ImportSavedPasswords'
              rule: "should have_property_value('ImportSavedPasswords', :dword, '0')"

  "1.38":
    title: '1.38 | L1 Ensure Allow importing of search engine settings is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to import search engine settings from another browser into Microsoft
        Edge as well as whether said setting is imported on first use.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow importing of search engine
        settings
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to perform an import of their search engine settings from other browsers into
        Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.38', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ImportSearchEngine"'
            - name: 'ImportSearchEngine'
              rule: "should have_property_value('ImportSearchEngine', :dword, '0')"

  "1.39":
    title: '1.39 | L1 Ensure Allow managed extensions to use the Enterprise Hardware Platform API is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows extensions installed by enterprise policies to be allowed to use the Enterprise Hardware
        Platform API. This API handles requests from extensions for the manufacturer and model of the hardware platform where
        the browser is running.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
                           Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow managed extensions to
        use the Enterprise Hardware Platform API
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.39', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EnterpriseHardwarePlatformAPIEnabled"'
            - name: 'EnterpriseHardwarePlatformAPIEnabled'
              rule: "should have_property_value('EnterpriseHardwarePlatformAPIEnabled', :dword, '0')"

  "1.40":
    title: '1.40 | L2 Ensure Allow or block audio capture is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows you to set whether the enduser is prompted for access to audio capture devices.
        The recommended state for this setting is            Disabled
        .         Note
         The            AudioCaptureAllowedUrls
         setting will need to be configured along with this setting if this feature is needed for specific websites.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
                           Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow or block audio capture
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact:
        Users will not be prompted for audio devices when using websites which may need this access, for example a web-based
        conferencing system. If there are sites which access will be allowed, this will need to be configured in the
        AudioCaptureAllowedUrls
         setting.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.40', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AudioCaptureAllowed"'
            - name: 'AudioCaptureAllowed'
              rule: "should have_property_value('AudioCaptureAllowed', :dword, '0')"

  "1.41":
    title: '1.41 | L2 Ensure Allow or block video capture is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows you to set whether the enduser is prompted for access to audio capture devices.
        The recommended state for this setting is            Disabled
        .         Note
         The            VideoCaptureAllowedUrls
         setting will need to be configured along with this setting if this feature is needed for specific websites.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow or block video capture
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact:
        If you disable this setting users will not be prompted for audio devices when using websites which may need this access,
        for example a web-based conferencing system. If there are sites which access will be allowed, configuration of the
        VideoCaptureAllowedUrls
         setting will be necessary.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.41', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "VideoCaptureAllowed"'
            - name: 'VideoCaptureAllowed'
              rule: "should have_property_value('VideoCaptureAllowed', :dword, '0')"

  "1.42":
    title: '1.42 | L2 Ensure Allow or deny screen capture is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge can use screenshare APIs including webbased online meetings, video,
        or screen sharing.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow or deny screen capture
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to utilize APIs which support web-based meetings, video, and screen
        capture. This could potentially disrupt users who may have utilized these abilities in the past.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.42', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ScreenCaptureAllowed"'
            - name: 'ScreenCaptureAllowed'
              rule: "should have_property_value('ScreenCaptureAllowed', :dword, '0')"

  "1.43":
    title: '1.43 | L1 Ensure Allow personalization of ads Microsoft Edge search news and other Microsoft services by sending browsing history favorites and collections usage and other browsing data to Microsoft is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft is able to collect a users browsing history and searches in Microsoft
        Edge for the purpose of personalizing searches, news, and other Microsoft services.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow personalization of ads,
        Microsoft Edge, search, news and other Microsoft services by sending browsing history, favorites and collections, usage
        and other browsing data to Microsoft
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users' data will not be shared with Microsoft and the personalization of searches, news, etc. will
        not be available.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.43', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "PersonalizationReportingEnabled"'
            - name: 'PersonalizationReportingEnabled'
              rule: "should have_property_value('PersonalizationReportingEnabled', :dword, '0')"

  "1.44":
    title: '1.44 | L1 Ensure Allow queries to a Browser Network Time service is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge can send queries to a network time service for accurate timestamps.
        This check helps in validation of certificates.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow queries to a Browser Network
        Time service
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.44', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BrowserNetworkTimeQueriesEnabled"'
            - name: 'BrowserNetworkTimeQueriesEnabled'
              rule: "should have_property_value('BrowserNetworkTimeQueriesEnabled', :dword, '1')"

  "1.45":
    title: '1.45 | L1 Ensure Allow remote debugging is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users may use remote debugging. This feature allows remote debugging of live
        content on a Windows 10 or later device from a Windows or macOS computer.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow remote debugging
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able access the remote debugging feature in Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.45', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "RemoteDebuggingAllowed"'
            - name: 'RemoteDebuggingAllowed'
              rule: "should have_property_value('RemoteDebuggingAllowed', :dword, '0')"

  "1.46":
    title: '1.46 | L1 Ensure Allow the audio sandbox to run is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether audio processes in Microsoft Edge run in a sandbox.
        The recommended state for this setting is            Enabled
        .         Note
         Security software setups within your environment might interfere with the sandbox.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow the audio sandbox to run
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The audio process will not run in the sandbox and the WebRTC audio-processing module will run in
        the renderer process.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.46', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AudioSandboxEnabled"'
            - name: 'AudioSandboxEnabled'
              rule: "should have_property_value('AudioSandboxEnabled', :dword, '1')"

  "1.47":
    title: '1.47 | L2 Ensure Allow unconfigured sites to be reloaded in Internet Explorer mode is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to reload unconfigured sites that are not configured in the Enterprise mode Site List
        in Internet Explorer mode when browsing in Microsoft Edge for a site that requires Internet Explorer for compatibility.
        After a site has been reloaded in Internet Explorer mode, inpage navigations will stay in Internet Explorer mode for
        example, a link, script, or form on the page, or a serverside redirect from another inpage navigation. Users can choose
        to exit from Internet Explorer mode, or Microsoft Edge will automatically exit from Internet Explorer mode when a
        navigation that isnt inpage occurs for example, using the address bar, the back button, or a favorite link. Users can
        also optionally tell Microsoft Edge to use Internet Explorer mode for the site in the future.
        The recommended state for this setting is            Disabled
        .         Note
         Enabling this setting takes precedence over how the            InternetExplorerIntegrationTestingAllowed Allow internet
        Explorer mode testing
         policy is configured, and that policy will be disabled.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow unconfigured sites to be
        reloaded in Internet Explorer mode
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact:
        If this setting is                  Disabled
         users will not be able to reload unconfigured sites in Internet Explorer mode for compatibility. When users try to
        launch shortcuts or file associations that use Internet Explorer, they will be redirected to open the same file/URL in
        Microsoft Edge. When users try to launch Internet Explorer by directly invoking the                  iexplore.exe
         binary, Microsoft Edge will launch instead.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.47', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerIntegrationReloadInIEModeAllowed"'
            - name: 'InternetExplorerIntegrationReloadInIEModeAllowed'
              rule: "should have_property_value('InternetExplorerIntegrationReloadInIEModeAllowed', :dword, '0')"

  "1.48":
    title: '1.48 | L1 Ensure Allow user feedback is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users are able to utilize the Edge Feedback feature to send feedback, suggestions
        and surveys to Microsoft as well as issue reports.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow user feedback
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to send feedback to Microsoft.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.48', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "UserFeedbackAllowed"'
            - name: 'UserFeedbackAllowed'
              rule: "should have_property_value('UserFeedbackAllowed', :dword, '0')"

  "1.49":
    title: '1.49 | L2 Ensure Allow users to open files using the ClickOnce protocol is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to use the ClickOnce protocol for opening files via applications inside of Microsoft
        Edge instead of downloading them to their device. The ClickOnce protocol allows websites to request that the browser
        open files from a specific URL using the ClickOnce file handler on the users computer or device.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow users to open files using
        the ClickOnce protocol
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will have to download files to their system and will be unable to open them directly in
        Microsoft Edge.  Disabling ClickOnce will also prevent ClickOnce applications (.application files) from working
        properly.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.49', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ClickOnceEnabled"'
            - name: 'ClickOnceEnabled'
              rule: "should have_property_value('ClickOnceEnabled', :dword, '0')"

  "1.50":
    title: '1.50 | L2 Ensure Allow users to open files using the DirectInvoke protocol is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to utilize the DirectInvoke protocol for opening files via applications inside of
        Microsoft Edge instead of downloading them to their device.
        The recommended state for this setting is             Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow users to open files using
        the DirectInvoke protocol
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will have to download files to their device and will be unable to open them directly in
        Microsoft Edge.  Disabling DirectInvoke could also prevent some SharePoint functions from working properly.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.50', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DirectInvokeEnabled"'
            - name: 'DirectInvokeEnabled'
              rule: "should have_property_value('DirectInvokeEnabled', :dword, '0')"

  "1.51":
    title: '1.51 | L2 Ensure Allow users to proceed from the HTTPS warning page is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether a user is able to proceed to a webpage when an invalid SSL certificate warning has
        occurred.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow users to proceed from the
        HTTPS warning page
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to click past the invalid certificate error to view the website.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.51', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SSLErrorOverrideAllowed"'
            - name: 'SSLErrorOverrideAllowed'
              rule: "should have_property_value('SSLErrorOverrideAllowed', :dword, '0')"

  "1.52":
    title: '1.52 | L1 Ensure Allow websites to query for available payment methods is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows you to set whether a website can check to see if the user has payment methods saved.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Allow websites to query for
        available payment methods
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Websites will be unable to query whether payment information within Microsoft Edge is available.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.52', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "PaymentMethodQueryEnabled"'
            - name: 'PaymentMethodQueryEnabled'
              rule: "should have_property_value('PaymentMethodQueryEnabled', :dword, '0')"

  "1.53":
    title: '1.53 | L2 Ensure AutoLaunch Protocols Component Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls the AutoLaunch Protocols Component. This Component allows Microsoft to provide a list
        similar to the            AutoLaunchProtocolsFromOrigins Define a list of Protocols that can launch an external
        application from listed origins without prompting the user
         policy, which allows certain external Protocols to launch without prompt or blocking certain Protocols on specified
        origins.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Administrative Templates\Microsoft Edge\AutoLaunch Protocols Component Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Disabling this setting will prompt users whether to allow or deny Microsoft Edge to open certain
        links in their associated application, no protocols can launch without prompt.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.53', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AutoLaunchProtocolsComponentEnabled"'
            - name: 'AutoLaunchProtocolsComponentEnabled'
              rule: "should have_property_value('AutoLaunchProtocolsComponentEnabled', :dword, '0')"

  "1.54":
    title: '1.54 | L1 Ensure Automatically import another browsers data and settings at first run is set to Enabled Disables automatic import and the import section of the first-run experience is skipped'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether settings are imported from another browser into Microsoft Edge.
        The recommended state for this setting is            Enabled Disables automatic import, and the import section of the
        firstrun experience is skipped
        .         Note
         The browser data from Microsoft Edge Legacy will always be silently migrated at the first run, irrespective of the
        value of this policy.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Disables
        automatic import, and the import section of the first-run experience is skipped
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Automatically import another
        browser's data and settings at first run
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.54', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge\'
        - checks:
            - rule: 'should have_property "AutoImportAtFirstRun"'
            - name: 'AutoImportAtFirstRun'
              rule: "should have_property_value('AutoImportAtFirstRun', :dword, '4')"

  "1.55":
    title: '1.55 | L1 Ensure Automatically open downloaded MHT or MHTML files from the web in Internet Explorer mode is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether MHT or MHTML files that are downloaded from the web are automatically opened in
        Internet Explorer mode. MHTML files are archives of HTML code and companion files such as images and audio.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Automatically open downloaded MHT
        or MHTML files from the web in Internet Explorer mode
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: MHT or MHTML files will not open in Internet Explorer mode.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.55', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerIntegrationZoneIdentifierMhtFileAllowed"'
            - name: 'InternetExplorerIntegrationZoneIdentifierMhtFileAllowed'
              rule: "should have_property_value('InternetExplorerIntegrationZoneIdentifierMhtFileAllowed', :dword, '0')"

  "1.56":
    title: '1.56 | L2 Ensure Block third party cookies is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether web page elements from a domain other than that in the address bar can set cookies.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Block third party cookies
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Disabling third-party cookies could cause some websites to not function as expected (e.g.,
        Microsoft 365 or Salesforce).
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.56', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BlockThirdPartyCookies"'
            - name: 'BlockThirdPartyCookies'
              rule: "should have_property_value('BlockThirdPartyCookies', :dword, '1')"

  "1.57":
    title: '1.57 | L1 Ensure Block tracking of users web-browsing activity is set to Enabled Balanced Blocks harmful trackers and trackers from sites user has not visited content and ads will be less personalized or higher'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether websites may track users webbrowsing activity.
        The recommended state for this setting is            Enabled Balanced Blocks harmful trackers and trackers from sites
        user has not visited content and ads will be less personalized
        .
        Configuring this setting to            Enabled Strict blocks harmful trackers and majority of trackers from all sites
        content and ads will have minimal personalization. Some parts of sites might not work
         also conforms to the benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Balanced (Blocks
        harmful trackers and trackers from sites user has not visited; content and ads will be less personalized)
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Block tracking of users' web-
        browsing activity
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Content and ads will have minimal personalization and the website may not function properly.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.57', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TrackingPrevention"'
            - name: 'TrackingPrevention'
              rule: "should have_property_value('TrackingPrevention', :dword, '3')"

  "1.58":
    title: '1.58 | L2 Ensure Browser sign-in settings is set to Enabled Disable browser sign-in'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether a user can sign into Microsoft Edge with an account to use services such as sync
        and single sign on.
        The recommended state for this setting is            Disabled Disable browser signin
        .         Note
         To control the availability of sync, use the            SyncDisabled
         Disable synchronization of data using Microsoft sync services policy.         Note 2
         This setting works in conjunction with the            NonRemovableProfileEnabled
         setting which will need to be set to            Disabled
         because the setting            NonRemovableProfileEnabled
         disables the creation of an automatically signed in browser profile.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled: Disable browser
        sign-in
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Browser sign-in settings
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to sign into the Microsoft Edge browser.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.58', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BrowserSignin"'
            - name: 'BrowserSignin'
              rule: "should have_property_value('BrowserSignin', :dword, '0')"

  "1.59":
    title: '1.59 | L1 Ensure Clear browsing data when Microsoft Edge closes is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether web browser data, such as forms, passwords and visited sites is deleted each time Microsoft
        Edge is closed.
        The Recommended state for this setting is            Disabled
        .         Note
         If this policy is enabled, the            AllowDeletingBrowserHistory
         policy, will take precedence over the            ClearBrowsingDataOnExit
         policy and all data will be deleted when Microsoft Edge closes, regardless of how
        AllowDeletingBrowserHistory
         is configured. The            AllowDeletingBrowserHistory
         policy is  set to            Disabled
         as a safeguard incase this policy is changed.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Clear browsing data when Microsoft
        Edge closes
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Browsing data will not be deleted on closing and the user will not be able to change this setting.
        Note:
         This setting will preserve browsing history that could contain a user's personal browsing history. Ensure this setting
        is in compliance with organizational policies.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.59', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ClearBrowsingDataOnExit"'
            - name: 'ClearBrowsingDataOnExit'
              rule: "should have_property_value('ClearBrowsingDataOnExit', :dword, '0')"

  "1.60":
    title: '1.60 | L1 Ensure Clear cached images and files when Microsoft Edge closes is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether cached images and files are deleted each time Microsoft Edge closes.
        The recommended state for this setting is            Disabled
        .         Note
         If this policy is disabled, do not enable the            ClearBrowsingDataOnExit
         policy, because it will take precedence over the            ClearCachedImagesAndFilesOnExit
         policy and will delete all browsing data when Microsoft Edge closes, regardless of how the
        ClearCachedImagesAndFilesOnExit
         policy is configured.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Clear cached images and files when
        Microsoft Edge closes
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Cached images and files will not be deleted on closing and the user will be unable to change this
        setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.60', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge\'
        - checks:
            - rule: 'should have_property "ClearCachedImagesAndFilesOnExit"'
            - name: 'ClearCachedImagesAndFilesOnExit'
              rule: "should have_property_value('ClearCachedImagesAndFilesOnExit', :dword, '0')"

  "1.61":
    title: '1.61 | L1 Ensure Clear history for IE and IE mode every time you exit is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls if history will be cleared for Internet Explorer IE and IE mode every time a user exits the
        browser.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Clear history for IE and IE mode
        every time you exit
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: History will not be cleared for IE and IE mode every time a user exits the browser.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.61', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerModeclearDataOnExitEnabled"'
            - name: 'InternetExplorerModeclearDataOnExitEnabled'
              rule: "should have_property_value('InternetExplorerModeclearDataOnExitEnabled', :dword, '0')"

  "1.62":
    title: '1.62 | L1 Ensure Compose is enabled for writing on the web is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows the configuration of Compose in Microsoft Edge. Compose provides help for writing with
        AIgenerated text, which lets the user get ideas for writing. This includes elaborating on text, rewriting, changing
        tone, formatting the text, and more.
        The recommended state for this setting is            Disabled
        .         Note
         Even with this setting            Disabled
        , compose will still be available for promptbased text generation through the sidebar and must be managed with either
        EdgeDiscoverEnabled Discover feature In Microsoft Edge policy or HubsSidebarEnabled Show Hubs Sidebar policy. The
        HubsSidebarEnabled is disabled with recommendation            L1 Ensure Standalone Sidebar Enabled is set to Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Compose is enabled for writing on
        the web
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Compose in Microsoft Edge will not function.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.62', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ComposeInlineEnabled"'
            - name: 'ComposeInlineEnabled'
              rule: "should have_property_value('ComposeInlineEnabled', :dword, '0')"

  "1.63":
    title: '1.63 | L1 Ensure Configure browser process code integrity guard setting is set to Enabled Enable code integrity guard enforcement in the browser process.'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls the use of code integrity guard in the browser process, which only allows Microsoft signed
        binaries to load.
        The recommended state for this setting is            Enabled Enable code integrity guard enforcement in the browser
        process.
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Enable code
        integrity guard enforcement in the browser process.
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure browser process code
        integrity guard setting
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Binaries without Microsoft's digital signature are blocked from being loaded into a process.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.63', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "browserCodeIntegritySetting"'
            - name: 'browserCodeIntegritySetting'
              rule: "should have_property_value('browserCodeIntegritySetting', :dword, '2')"

  "1.64":
    title: '1.64 | L1 Ensure Configure InPrivate mode availability is set to Enabled InPrivate mode disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Edge InPrivate mode is available or even forced for the user.
        The recommended state for this setting is            Enabled InPrivate mode disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: InPrivate mode
        disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure InPrivate mode
        availability
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to initiate the InPrivate browsing mode for Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.64', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InPrivateModeAvailability"'
            - name: 'InPrivateModeAvailability'
              rule: "should have_property_value('InPrivateModeAvailability', :dword, '1')"

  "1.65":
    title: '1.65 | L2 Ensure Configure Online Text To Speech is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting determines whether Online Text to Speech voice fonts which is part of Azure Cognitive Services, are
        available to users. These voice fonts are higher quality than the preinstalled system voice fonts.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure Online Text To Speech
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to utilize Online Text to Speech. Note:
         This setting will prevent the Online Text to Speech feature which can be used by users with visual or learning
        disabilities to read the text of documents out loud. Please make sure this feature is not needed within the environment
        before disabling this feature.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.65', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ConfigureOnlineTextToSpeech"'
            - name: 'ConfigureOnlineTextToSpeech'
              rule: "should have_property_value('ConfigureOnlineTextToSpeech', :dword, '0')"

  "1.66":
    title: '1.66 | L1 Ensure Configure Related Matches in Find on Page is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting specifies how the user receives Related Matches in Find on Page, which provides spellcheck,
        synonyms, and QampA results in Microsoft Edge.
        The recommended setting for this policy is            Disabled
        .         Note
         Disabling this setting still allows users to receive related matches in Find on Page on            limited sites
        . The results are processed on the users device instead of a cloud service.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure Related Matches in Find
        on Page
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not see all suggestions for better matches found on page, only from limited sites.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.66', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "RelatedMatchesCloudServiceEnabled"'
            - name: 'RelatedMatchesCloudServiceEnabled'
              rule: "should have_property_value('RelatedMatchesCloudServiceEnabled', :dword, '0')"

  "1.67":
    title: '1.67 | L2 Ensure Configure Speech Recognition is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting specifies whether websites can use the W3C Web speech API to recognize speech from the user. The
        Microsoft Edge implementation of the Web speech API uses Azure Cognitive Services, so voice data will leave the machine.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure Speech Recognition
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to use speech recognition for voice typing. Users that use speech recognition
        for accessibility will need other tools implemented for voice typing. Note:
         An exception to this recommendation might be needed as this is an accessibility feature that is legitimately needed by
        some users. Take this into consideration when applying this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.67', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SpeechRecognitionEnabled"'
            - name: 'SpeechRecognitionEnabled'
              rule: "should have_property_value('SpeechRecognitionEnabled', :dword, '0')"

  "1.68":
    title: '1.68 | L1 Ensure Configure the list of names that will bypass the HSTS policy check is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows a list of names to be specified that will be exempt from HTTP Strict Transport Security HSTS
        policy checks then potentially upgraded from http// to https//.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        .             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure the list of names that
        will bypass the HSTS policy check
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: There should be no adverse effect to users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.68', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should_not have_property "HSTSPolicyBypassList"'

  "1.69":
    title: '1.69 | L1 Ensure Configure the list of types that are excluded from synchronization is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows you to specify data types that will be limited/excluded from uploading data to the Microsoft
        Edge synchronization service.
        The recommended state for this setting is            Enabled
         with the following CASE SENSITIVE datatype            passwords
        .         Note
         In a High Security/Sensitive Data Environment L2, this setting should also include the following options
        settings
        ,            favorites
        ,            addressesAndMore
        ,            extensions
         and            collections
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
         with the following CASE SENSITIVE datatype                passwords
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure the list of types that
        are excluded from synchronization
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Password data will not be synchronized with the Azure AD Tenant.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.69', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge\SyncTypesListDisabled'
        - checks:
            - rule: 'should have_property "1"'
            - name: '1'
              rule: "should have_property_value('1', :string, 'passwords')"

  "1.70":
    title: '1.70 | L1 Ensure Configure the Share experience is set to Enabled Dont allow using the Share experience'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to be able to access the Share experience from the            Settings and More
         menu in Microsoft Edge, which can allow information to be shared with other apps on the system.
        The recommended state for this setting is            Enabled Dont allow using the Share experience
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Don't allow
        using the Share experience
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure the Share experience
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft                here
        .             Impact: Users will not be able to view or use the Share button in the toolbar as it will be hidden.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.70', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ConfigureShare"'
            - name: 'ConfigureShare'
              rule: "should have_property_value('ConfigureShare', :dword, '1')"

  "1.71":
    title: '1.71 | L1 Ensure Configure whether form data and HTTP headers will be sent when entering or exiting Internet Explorer mode is set to Enabled Do not send form data or headers'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures navigations that switch between Internet Explorer mode and Microsoft Edge will include
        form data. IE Mode in Microsoft Edge allows organizations that still need Internet Explorer 11, which is not supported
        for backward compatibility with existing websites.
        The recommended state for this setting is            Enabled Do not send form data or headers
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Do not send form
        data or headers
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Configure whether form data and
        HTTP headers will be sent when entering or exiting Internet Explorer mode
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: When entering or exiting IE mode, form data and headers will not be shared between Internet
        Explorer mode and Microsoft Edge and vice versa.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.71', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerIntegrationComplexNavDataTypes"'
            - name: 'InternetExplorerIntegrationComplexNavDataTypes'
              rule: "should have_property_value('InternetExplorerIntegrationComplexNavDataTypes', :dword, '0')"

  "1.72":
    title: '1.72 | L1 Ensure Continue running background apps after Microsoft Edge closes is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting determines whether processes from Microsoft Edge may start at Operating System signin and continue
        running once an Edge browser window is closed. This allows background apps and the current browsing session to remain
        active, including any session cookies. An open background process displays an icon in the system tray and can always be
        closed from there.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Continue running background apps
        after Microsoft Edge closes
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The browser will close its processes and will not continue running as a background process.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.72', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BackgroundModeEnabled"'
            - name: 'BackgroundModeEnabled'
              rule: "should have_property_value('BackgroundModeEnabled', :dword, '0')"

  "1.73":
    title: '1.73 | L1 Ensure Control communication with the Experimentation and Configuration Service is set to Enabled Disable communication with the Experimentation and Configuration Service'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge uses the Experimentation and Configuration Service to deploy the
        Experimentation and Configuration payload which consists of a list of early in development features that Microsoft is
        enabling for testing and feedback.
        The recommended state for this setting is            Enabled Disable communication with the Experimentation and
        Configuration Service
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Disable
        communication with the Experimentation and Configuration Service
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Control communication with the
        Experimentation and Configuration Service
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Data will not be sent back to a third-party and payloads will not be delivered.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.73', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ExperimentationAndConfigurationServiceControl"'
            - name: 'ExperimentationAndConfigurationServiceControl'
              rule: "should have_property_value('ExperimentationAndConfigurationServiceControl', :dword, '0')"

  "1.74":
    title: '1.74 | L2 Ensure Control use of the Headless Mode is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users can launch Microsoft Edge in headless mode. A headless browser is a browser
        that is not configured with a Graphical User Interface GUI and is executed via commandline or using network
        communication.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Control use of the Headless Mode
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to access headless mode in Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.74', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "HeadlessModeEnabled"'
            - name: 'HeadlessModeEnabled'
              rule: "should have_property_value('HeadlessModeEnabled', :dword, '0')"

  "1.75":
    title: '1.75 | L2 Ensure Control use of the Serial API is set to Enable Do not allow any site to request access to serial ports via the Serial API'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures whether websites can access the systems serial ports.
        The recommended state for this setting is            Enable Do not allow any site to request access to serial ports via
        the Serial API
        .         Note
         If more granular control is needed per website then this setting can be used in combination with the
        SerialAllowAllPortsForUrls
         Allow the Serial API on specific sites,            SerialAskForUrls
         and            SerialBlockedForUrls
         Block the Serial API on specific sites settings. For example, SerialAllowAllPortsForUrls can be used to allow serial
        port access to specific sites. Please see the references below for more information.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enable: Do not allow any
        site to request access to serial ports via the Serial API
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Control use of the Serial API
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Legitimate websites that need access to the Serial API will be denied access.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.75', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultSerialGuardSetting"'
            - name: 'DefaultSerialGuardSetting'
              rule: "should have_property_value('DefaultSerialGuardSetting', :dword, '2')"

  "1.76":
    title: '1.76 | L2 Ensure Control where security restrictions on insecure origins apply is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows for a specified list of origins URLs or hostname patterns like .contoso.com for which
        security restrictions on insecure origins dont apply.
        Allowed origins for legacy applications that cant deploy TLS or set up a staging server for internal web development so
        that developers can test features requiring secure contexts without having to deploy TLS on the staging server. This
        policy also prevents the origin from being labeled            Not Secure
         in the omnibox.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Control where security
        restrictions on insecure origins apply
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.76', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should_not have_property "OverrideSecurityRestrictionsOnInsecureOriginDesc"'

  "1.77":
    title: '1.77 | L2 Ensure Default sensor setting is set to Enabled Do not allow any site to access sensors'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures whether websites can access and use sensors such as motion and light.
        The recommended state for this setting is            Enabled Do not allow any site to access sensors
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Do not allow any
        site to access sensors
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Default sensors setting
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Access to sensors, such as motion and light, will not be accessible by websites.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.77', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DefaultSensorsSetting"'
            - name: 'DefaultSensorsSetting'
              rule: "should have_property_value('DefaultSensorsSetting', :dword, '2')"

  "1.78":
    title: '1.78 | L1 Ensure Delete old browser data on migration is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether web browser data is deleted after migration to Microsoft Edge, this data includes forms,
        passwords, and visited sites.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Delete old browser data on
        migration
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Browsing data will not be deleted during migration.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.78', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DeleteDataOnMigration"'
            - name: 'DeleteDataOnMigration'
              rule: "should have_property_value('DeleteDataOnMigration', :dword, '0')"

  "1.79":
    title: '1.79 | L1 Ensure Disable saving browser history is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether browser history is saved and prevents users from changing the policy.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Disable saving browser history
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior. Note:
         This setting will preserve browsing history that could contain a user's personal browsing history. Ensure this setting
        is in compliance with organizational policies.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.79', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SavingBrowserHistoryDisabled"'
            - name: 'SavingBrowserHistoryDisabled'
              rule: "should have_property_value('SavingBrowserHistoryDisabled', :dword, '0')"

  "1.80":
    title: '1.80 | L1 Ensure Disable synchronization of data using Microsoft sync services is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether data synchronization with Microsoft sync services is allowed as well as whether the
        sync consent prompt appears to users. Examples of synced data include, but are not limited to, history and favorites.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Disable synchronization of data
        using Microsoft sync services
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to sync data with Microsoft, the prompt for sync consent will also be hidden
        from the user.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.80', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SyncDisabled"'
            - name: 'SyncDisabled'
              rule: "should have_property_value('SyncDisabled', :dword, '1')"

  "1.81":
    title: '1.81 | L1 Ensure DNS interception checks enabled is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting determines whether a local switch is configured for DNS interception checks. These checks attempt to
        discover if the browser is behind a proxy that redirects unknown host names.
        The recommended state for this setting is            Enabled
        .         Note
         This detection might not be necessary in an enterprise environment where the network configuration is known. It can be
        disabled to avoid additional DNS and HTTP traffic on startup and each DNS configuration change.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\DNS interception checks enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.81', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DNSInterceptionChecksEnabled"'
            - name: 'DNSInterceptionChecksEnabled'
              rule: "should have_property_value('DNSInterceptionChecksEnabled', :dword, '1')"

  "1.82":
    title: '1.82 | L1 Ensure Edge 3P SERP Telemetry Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls Edge3P Telemetry in Microsoft Edge. Edge3P Telemetry captures the searches a user does on
        thirdparty search providers without identifying the person or the device.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Edge 3P SERP Telemetry Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Data will not be sent to a third-party.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.82', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "Edge3PSerpTelemetryEnabled"'
            - name: 'Edge3PSerpTelemetryEnabled'
              rule: "should have_property_value('Edge3PSerpTelemetryEnabled', :dword, '0')"

  "1.83":
    title: '1.83 | L1 Ensure Edge Wallet E-Tree Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy settings configures the use of the Wallet ETree feature in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Edge Wallet E-Tree Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: The Edge Wallet E-Tree feature will not be available to users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.83', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EdgeWalletEtreeEnabled"'
            - name: 'EdgeWalletEtreeEnabled'
              rule: "should have_property_value('EdgeWalletEtreeEnabled', :dword, '0')"

  "1.84":
    title: '1.84 | L1 Ensure Enable AutoFill for addresses is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether the AutoFill feature of Microsoft Edge is enabled for the autocomplete feature for
        addresses and other information in web forms.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable AutoFill for addresses
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to store autofill address information in Microsoft Edge and they will also
        not be prompted to use such information on webforms. Disabling this setting also stops any past activity of autofill.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.84', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AutofillAddressEnabled"'
            - name: 'AutofillAddressEnabled'
              rule: "should have_property_value('AutofillAddressEnabled', :dword, '0')"

  "1.85":
    title: '1.85 | L1 Ensure Enable AutoFill for payment instructions is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users can utilize payment information, such as credit or debit cards in web forms
        using previously stored information.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable AutoFill for payment
        instructions
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Note #2:
         In older Microsoft Windows Administrative Templates, this setting was initially named                AutoFill for
        credit cards
        , but it was renamed to                Enable AutoFill for payment instructions
        .             Impact: Users will be unable to use and store AutoFill data for credit and debit card information in
        Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.85', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AutofillCreditCardEnabled"'
            - name: 'AutofillCreditCardEnabled'
              rule: "should have_property_value('AutofillCreditCardEnabled', :dword, '0')"

  "1.86":
    title: '1.86 | L1 Ensure Enable browser legacy extension point blocking is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting sets the            ProcessExtensionPointDisablePolicy
         on Microsoft Edges browser process to block code injection from legacy third party applications.
        The recommended state for this setting is            Enabled
        .         Note
         Per Microsoft, only turn off the policy if there are compatibility issues with thirdparty software that must run inside
        Microsoft Edges browser process.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable browser legacy extension
        point blocking
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Compatibility issues with third-party software can occur.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.86', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BrowserLegacyExtensionPointsBlockingEnabled"'
            - name: 'BrowserLegacyExtensionPointsBlockingEnabled'
              rule: "should have_property_value('BrowserLegacyExtensionPointsBlockingEnabled', :dword, '1')"

  "1.87":
    title: '1.87 | L1 Ensure Enable component updates in Microsoft Edge is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy determines whether updates for Microsoft Edge components are enabled in Microsoft Edge.
        The recommendation state for this setting is            Enabled
        .         Note
         Updates that are deemed critical for security are still applied even if you disable this policy as well as any
        component that doesnt contain executable code, that doesnt significantly alter the behavior of the browser.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable component updates in
        Microsoft Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft                here
        .             Impact: Updates will be automatically downloaded.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.87', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ComponentUpdatesEnabled"'
            - name: 'ComponentUpdatesEnabled'
              rule: "should have_property_value('ComponentUpdatesEnabled', :dword, '1')"

  "1.88":
    title: '1.88 | L1 Ensure Enable CryptoWallet feature is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        The CryptoWallet feature allows users to securely store, manage, and transact digital assets such as Bitcoin, Ethereum,
        and other cryptocurrencies.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable CryptoWallet feature
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: The CryptoWallet feature will not be accessible to users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.88', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "CryptoWalletEnabled"'
            - name: 'CryptoWalletEnabled'
              rule: "should have_property_value('CryptoWalletEnabled', :dword, '0')"

  "1.89":
    title: '1.89 | L1 Ensure Enable deleting browser and download history is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy controls whether users can delete browser and download history for Microsoft Edge.
        The recommended state for this setting is            Disabled
        .         Note
         Even when this policy is            Disabled
        , the browsing and download history isnt guaranteed to be retained. Users can edit or delete the history database files
        directly, and the browser itself may remove based on expiration period or archive any or all history items at any time.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable deleting browser and
        download history
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Browser data deletion by users will be prohibited. Note:
         This setting will preserve browsing history that could contain a user's personal browsing history. Ensure this setting
        is in compliance with organizational policies.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.89', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AllowDeletingBrowserHistory"'
            - name: 'AllowDeletingBrowserHistory'
              rule: "should have_property_value('AllowDeletingBrowserHistory', :dword, '0')"

  "1.90":
    title: '1.90 | L1 Ensure Enable Discover access to page contents for AAD profiles is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls discover access to page contents for AAD profiles. Discover is an extension that hosts Bing
        Chat and in order to summarize pages and interact with text selections, it needs to be able to access the page contents.
        When enabled, page contents will be sent to Bing.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable Discover access to page
        contents for AAD profiles
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Discover will not be able to access page contents and therefore Bing Chat will not be able to
        summarize pages and interact with text selections.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.90', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DiscoverPageContextenabled"'
            - name: 'DiscoverPageContextenabled'
              rule: "should have_property_value('DiscoverPageContextenabled', :dword, '0')"

  "1.91":
    title: '1.91 | L2 Ensure Enable Drop feature in Microsoft Edge is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures the drop feature in Microsoft Edge. The drop feature lets users send messages or files to
        themselves.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable Drop feature in Microsoft
        Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Users can't use the drop feature in Microsoft Edge to share files and messages between phones and
        desktop devices.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.91', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EdgeEdropenabled"'
            - name: 'EdgeEdropenabled'
              rule: "should have_property_value('EdgeEdropenabled', :dword, '0')"

  "1.92":
    title: '1.92 | L1 Ensure Enable Follow service in Microsoft Edge is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows the Microsoft Edge browser to enable the follow service which allows users to follow an
        influencer, site, or topic in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable Follow service in Microsoft
        Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to follow an influencer, site, or topic in Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.92', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EdgeFollowEnabled"'
            - name: 'EdgeFollowEnabled'
              rule: "should have_property_value('EdgeFollowEnabled', :dword, '0')"

  "1.93":
    title: '1.93 | L1 Ensure Enable globally scoped HTTP auth cache is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether HTTP auth credentials may be automatically used in the context of another web site
        visited in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .         Note
         This policy is intended to give enterprises depending on the legacy behavior a chance to update their login procedures
        and will be removed in the future.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable globally scoped HTTP auth
        cache
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.93', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "GloballyScopeHTTPAuthCacheEnabled"'
            - name: 'GloballyScopeHTTPAuthCacheEnabled'
              rule: "should have_property_value('GloballyScopeHTTPAuthCacheEnabled', :dword, '0')"

  "1.94":
    title: '1.94 | L2 Ensure Enable guest mode is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether a user may utilize guest profiles in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable guest mode
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to initiate Guest mode for Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.94', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BrowserGuestModeEnabled"'
            - name: 'BrowserGuestModeEnabled'
              rule: "should have_property_value('BrowserGuestModeEnabled', :dword, '0')"

  "1.95":
    title: '1.95 | L1 Ensure Enable network prediction is set to Enabled Dont predict network actions on any network connection'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls the network prediction feature which controls DNS prefetching, TCP and SSL preconnection
        and prerendering of web pages.
        The recommended state for this setting is            Enabled Dont predict network actions on any network connection
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Don't predict
        network actions on any network connection
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable network prediction
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior, apart from users being able to change the default.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.95', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "NetworkPredictionOptions"'
            - name: 'NetworkPredictionOptions'
              rule: "should have_property_value('NetworkPredictionOptions', :dword, '2')"

  "1.96":
    title: '1.96 | L1 Ensure Enable profile creation from the Identity flyout menu or the Settings page is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether user profiles can create new profiles in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable profile creation from the
        Identity flyout menu or the Settings page
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact:
        Users will be unable to utilize the                  Add profile
         option in Microsoft Edge.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.96', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "BrowserAddProfileEnabled"'
            - name: 'BrowserAddProfileEnabled'
              rule: "should have_property_value('BrowserAddProfileEnabled', :dword, '0')"

  "1.97":
    title: '1.97 | L1 Ensure Enable resolution of navigation errors using a web service is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge can issue a dataless connection to a web service to probe networks,
        ex Hotel and Airport WiFi for connectivity issues.
        The recommended state for this setting is            Disabled
        .         Note
         Except on Windows 8 and later versions of Windows, Microsoft Edge            always
         uses native APIs to resolve connectivity issues.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable resolution of navigation
        errors using a web service
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Microsoft Edge will use native APIs for potential resolution of network connectivity and
        navigation issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.97', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ResolveNavigationErrorsUseWebService"'
            - name: 'ResolveNavigationErrorsUseWebService'
              rule: "should have_property_value('ResolveNavigationErrorsUseWebService', :dword, '0')"

  "1.98":
    title: '1.98 | L2 Ensure Enable Search suggestions is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting determines whether web search suggestions are used in Microsoft Edge Address bar and AutoSuggest
        lists.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable search suggestions
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not get customized web suggestions for search results, instead they will still receive
        local suggestions.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.98', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SearchSuggestEnabled"'
            - name: 'SearchSuggestEnabled'
              rule: "should have_property_value('SearchSuggestEnabled', :dword, '0')"

  "1.99":
    title: '1.99 | L1 Ensure Enable security warnings for command-line flags is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting prevents Microsoft Edge from showing security warnings that potentially dangerous commandline flags
        are in use at its launch.
        The recommended state of this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable security warnings for
        command-line flags
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.99', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "CommandLineFlagSecurityWarningsEnabled"'
            - name: 'CommandLineFlagSecurityWarningsEnabled'
              rule: "should have_property_value('CommandLineFlagSecurityWarningsEnabled', :dword, '1')"

  "1.100":
    title: '1.100 | L1 Ensure Enable site isolation for every site is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting ensures that each website runs in its own process so that a site will not be able to utilize or take
        data from another running site.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable site isolation for every
        site
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.100', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SitePerProcess"'
            - name: 'SitePerProcess'
              rule: "should have_property_value('SitePerProcess', :dword, '1')"

  "1.101":
    title: '1.101 | L1 Ensure Enable tab organization suggestions is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge can use its tab organization service to help name or suggest tab
        groups.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable tab organization
        suggestions
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Suggestions for tab groups will not be available to users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.101', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TabServicesEnabled"'
            - name: 'TabServicesEnabled'
              rule: "should have_property_value('TabServicesEnabled', :dword, '0')"

  "1.102":
    title: '1.102 | L1 Ensure Enable the Search bar is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures the use of the search bar. The search bar is used to search the web from a users desktop
        or from an application. The search bar provides a search box, powered by Edge default search engine, that shows web
        suggestions and opens all web searches in Microsoft Edge. The search bar can be launched from the More tools menu or
        jump list in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .         Note
         The option to enable the search bar at startup will be toggled on if the SearchbarIsEnabledOnStartup Allow the Search
        bar at Windows startup policy is            Enabled
        . If the SearchbarIsEnabledOnStartup is            Disabled
         or            not configured
        , the option to enable the search bar at startup will be toggled off.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable the Search bar
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: User's will not be able to use the search featured powered by Edge default search engine from a
        desktop or an application.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.102', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SearchbarAllowed"'
            - name: 'SearchbarAllowed'
              rule: "should have_property_value('SearchbarAllowed', :dword, '0')"

  "1.103":
    title: '1.103 | L2 Ensure Enable Translate is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting enables Microsoft translation services on Microsoft Edge. Microsoft Edge offers translation
        functionality to the user by showing an integrated translate flyout when appropriate, and a translate option on the
        rightclick context menu.
        The recommended setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable Translate
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The translate feature will not be available for users.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.103', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TranslateEnabled"'
            - name: 'TranslateEnabled'
              rule: "should have_property_value('TranslateEnabled', :dword, '0')"

  "1.104":
    title: '1.104 | L1 Ensure Enable upload files from mobile in Microsoft Edge desktop is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy settings allows the configuration of the Edge Upload from mobile feature. The Upload from mobile feature
        allows users to select files from a mobile device and upload to a via a webpage in Microsoft Edge.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable upload files from mobile in
        Microsoft Edge desktop
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: The file upload from mobile feature in Microsoft Edge will not function.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.104', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "UploadFromPhoneEnabled"'
            - name: 'UploadFromPhoneEnabled'
              rule: "should have_property_value('UploadFromPhoneEnabled', :dword, '0')"

  "1.105":
    title: '1.105 | L1 Ensure Enable use of ephemeral profiles is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether user profiles are switched to ephemeral mode. In ephemeral mode, profile data is
        saved on disk for the length of the session and then the data is deleted after the session is over. Therefore, no data
        is saved to the device.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable use of ephemeral profiles
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.105', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ForceEphemeralProfiles"'
            - name: 'ForceEphemeralProfiles'
              rule: "should have_property_value('ForceEphemeralProfiles', :dword, '0')"

  "1.106":
    title: '1.106 | L1 Ensure Enable warnings for insecure forms is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls the handling of insecure forms forms submitted over HTTP embedded in secure HTTPS sites in
        the browser. When enabled, a fullpage warning will be shown, and autofill will be disabled for those forms. When
        disabled, warnings will not be shown for insecure forms, and autofill will work normally.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable warnings for insecure forms
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.106', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InsecureFormsWarningsEnabled"'
            - name: 'InsecureFormsWarningsEnabled'
              rule: "should have_property_value('InsecureFormsWarningsEnabled', :dword, '1')"

  "1.107":
    title: '1.107 | L1 Ensure Enables DALL-E themes generation is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures the use of generated browser themes using DALLE and apply them to Microsoft Edge. DALLE
        is an open Artificial Intelligence AI system that creates realistic images and art from text descriptions prompts.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enables DALL-E themes generation
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to generate browser themes using DALL-E.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.107', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AIGenThemesEnabled"'
            - name: 'AIGenThemesEnabled'
              rule: "should have_property_value('AIGenThemesEnabled', :dword, '0')"

  "1.108":
    title: '1.108 | L2 Ensure Enforce Bing SafeSearch is set to Enabled Configure moderate search restrictions in Bing'
    section: 'Microsoft Edge'
    description: |
        This policy setting ensures that web search results with Bing are presented with the SafeSearch settings that can be
        specified in this setting.
        The recommended state for this setting is            Enabled Configure moderate search restrictions in Bing
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Configure
        moderate search restrictions in Bing
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enforce Bing SafeSearch
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users search results will be filtered and content such as adult text, videos and images will not
        be shown.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.108', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ForceBingSafeSearch"'
            - name: 'ForceBingSafeSearch'
              rule: "should have_property_value('ForceBingSafeSearch', :dword, '1')"

  "1.109":
    title: '1.109 | L2 Ensure Enforce Google SafeSearch is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting ensures that web search results with Google are performed with SafeSearch set to active.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enforce Google SafeSearch
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users search results will be filtered and content such as adult text, videos and images will not
        be shown.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.109', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ForceGoogleSafeSearch"'
            - name: 'ForceGoogleSafeSearch'
              rule: "should have_property_value('ForceGoogleSafeSearch', :dword, '1')"

  "1.110":
    title: '1.110 | L1 Ensure Enhance the security state in Microsoft Edge is set to Enabled Balanced mode or higher'
    section: 'Microsoft Edge'
    description: |
        This policy setting configures enhance the security state in Microsoft Edge. Enhanced security in Microsoft Edge helps
        safeguard against memoryrelated vulnerabilities by disabling justintime JIT JavaScript compilation and enabling
        additional operating system protections for the browser. These protections include Hardwareenforced Stack Protection and
        Arbitrary Code Guard ACG. Enhanced security provides two levels of browsing security Balanced and Strict. Balanced mode
        is an adaptive mode that builds on a users behavior on a particular device. Strict mode applies added security
        protections for all the sites a user visits. Users may report some challenges accomplishing their usual tasks when in
        strict mode.
        The recommended state for this setting is            Enabled Balanced mode
        . Configuring this setting to            Enabled Strict mode
         also conforms to the benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Balanced mode
         or                Enabled: Strict mode
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enhance the security state in
        Microsoft Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will no longer be able to bypass protection for previously visited unfamiliar sites. Edge
        will apply added security protections to sites that are not visited often or are unknown. Websites that are browsed
        frequently will be left out. Note:
         Most sites will work as expected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.110', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EnhanceSecurityMode"'
            - name: 'EnhanceSecurityMode'
              rule: "should have_property_value('EnhanceSecurityMode', :dword, '3')"

  "1.111":
    title: '1.111 | L2 Ensure Enhanced Security Mode configuration for Intranet zone sites is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge will apply enhanced security mode on Intranet zone sites. Enhanced
        security mode in Microsoft Edge mitigates memoryrelated vulnerabilities by disabling justintime JIT JavaScript
        compilation and enabling additional operating system protections for the browser.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enhanced Security Mode
        configuration for Intranet zone sites
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Disabling this setting could lead to Intranet zone sites acting in an unexpected manner.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.111', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EnhanceSecurityModeBypassIntranet"'
            - name: 'EnhanceSecurityModeBypassIntranet'
              rule: "should have_property_value('EnhanceSecurityModeBypassIntranet', :dword, '0')"

  "1.112":
    title: '1.112 | L1 Ensure Hide the First-run experience and splash screen is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether the Firstrun experience and splash screen is presented to the user the first time
        Microsoft Edge is opened. Some of the options presented to the user include the ability to import data from other web
        browsers on the system.
        The recommended state for this setting is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Hide the First-run experience and
        splash screen
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be prompted with the First-run experience screens.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.112', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "HideFirstRunExperience"'
            - name: 'HideFirstRunExperience'
              rule: "should have_property_value('HideFirstRunExperience', :dword, '1')"

  "1.113":
    title: '1.113 | L1 Ensure In-app support Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to contact inapp Microsoft support agents directly from the Microsoft Edge browser.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\In-app support Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to use or turn on the in-app support feature in the Microsoft Edge browser.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.113', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InAppSupportEnabled"'
            - name: 'InAppSupportEnabled'
              rule: "should have_property_value('InAppSupportEnabled', :dword, '0')"

  "1.114":
    title: '1.114 | L2 Ensure Let users snip a Math problem and get the solution with a step-by-step explanation in Microsoft Edge is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting manages whether users can use the Math Solver tool in Microsoft Edge. Math Solver tool allows users
        to take a picture of a math problem  be it handwritten or printed  and then provides an instant solution with stepbystep
        instructions.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Let users snip a Math problem and
        get the solution with a step-by-step explanation in Microsoft Edge
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will be unable to solve math problems in Microsoft Edge browsers.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.114', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "MathSolverEnabled"'
            - name: 'MathSolverEnabled'
              rule: "should have_property_value('MathSolverEnabled', :dword, '0')"

  "1.115":
    title: '1.115 | L2 Ensure Live captions allowed is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to turn live captions on or off. Live captions are an accessibility feature that
        converts speech from the audio that plays in Microsoft Edge to text and shows this text in a separate window.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Live captions allowed
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Users won't be able to turn live captions on. In addition, if speech recognition files have been
        downloaded previously, they will be deleted from the device in 30 days. Note:
         An exception to this recommendation might be needed as this is an accessibility feature that is legitimately needed by
        some users. Take this into consideration when applying this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.115', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "LiveCaptionsAllowed"'
            - name: 'LiveCaptionsAllowed'
              rule: "should have_property_value('LiveCaptionsAllowed', :dword, '0')"

  "1.116":
    title: '1.116 | L1 Ensure Manage exposure of local IP addresses by WebRTC is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting specifies a list of URLs or patterns which local IP address will be exposed by WebRTC.
        The recommended state for this setting is            Disabled
        .         Note
         If this policy is enabled, disabled, or not configured, and            edge//flags/enablewebrtchidelocalipswithmdns
         is Disabled, WebRTC will expose local IP addresses.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Manage exposure of local IP
        addressess by WebRTC
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.116', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge\WebRtcLocalIpsAllowedUrls'
        - checks:
            - rule: 'should_not have_property "Default"'

  "1.117":
    title: '1.117 | L1 Ensure Notify a user that a browser restart is recommended or required for pending updates is set to Enabled Required - Show a recurring prompt to the user indicating that a restart is required'
    section: 'Microsoft Edge'
    description: |
        This setting determines whether a notification to restart Microsoft Edge due to an update is recommended or required.
        The recommended state for this setting is            Enabled Required  Show a recurring prompt to the user indicating
        that a restart is required
        .         Note
         If this setting is set to            Enabled Required  Show a recurring prompt to the user indicating that a restart is
        required
         the browser will be automatically restarted based on the            RelaunchNotificationPeriod
         setting which is recommended to be 24 hours.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Required - Show
        a recurring prompt to the user indicating that a restart is required
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Notify a user that a browser
        restart is recommended or required for pending updates
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: When updates are applied by an organization the end-user will receive a notification after 24
        hours that they must restart the browser for updates to complete, after 24 hours the browser will be automatically
        restarted.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.117', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "RelaunchNotification"'
            - name: 'RelaunchNotification'
              rule: "should have_property_value('RelaunchNotification', :dword, '2')"

  "1.118":
    title: '1.118 | L1 Ensure Restrict exposure of local IP address by WebRTC is set to Enabled Allow public interface over http default route. This doesnt expose the local IP address'
    section: 'Microsoft Edge'
    description: |
        This policy setting specifies whether the local IP address will be exposed by WebRTC.
        The recommended state for this setting is            Enabled Allow public interface over http default route. This doesnt
        expose the local IP address
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: Allow public
        interface over http default route. This doesn't expose the local IP address
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Restrict exposure of local IP
        address by WebRTC
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The local IP address will not be exposed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.118', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "WebRtcLocalhostIpHandling"'
            - name: 'WebRtcLocalhostIpHandling'
              rule: "should have_property_value('WebRtcLocalhostIpHandling', :string, 'default_public_interface_only')"

  "1.119":
    title: '1.119 | L1 Ensure Set disk cache size in bytes is set to Enabled 250609664'
    section: 'Microsoft Edge'
    description: |
        This setting controls the size of the cache, in bytes, used to store files on the disk.
        The recommended state for this setting is            Enabled 250609664
        .         Note
         The value specified in this policy isnt a hard boundary but rather a suggestion to the caching system any value below a
        few megabytes is too small and will be rounded up to a reasonable minimum.         Note 2
         The recommended disk size for cache is 50  250MB, according to Microsoft.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: 250609664
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Set disk cache size, in bytes
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Browser cache will take up to 250MB in disk space.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.119', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "DiskCacheSize"'
            - name: 'DiskCacheSize'
              rule: "should have_property_value('DiskCacheSize', :dword, '250609664')"

  "1.120":
    title: '1.120 | L1 Ensure Set the time period for update notifications is set to Enabled 86400000'
    section: 'Microsoft Edge'
    description: |
        This setting does not determine if updates are applied, the policy setting allows setting a time period in which users
        are notified that Microsoft Edge has been updated and must be closed and reopened.
        The recommended state for this setting is            Enabled 86400000
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled: 86400000
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Set the time period for update
        notifications
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: When updates are applied by an organization the end-user will receive a notification after 24
        hours that they must restart the browser for updates to complete.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.120', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "RelaunchNotificationPeriod"'
            - name: 'RelaunchNotificationPeriod'
              rule: "should have_property_value('RelaunchNotificationPeriod', :dword, '86400000')"

  "1.121":
    title: '1.121 | L1 Ensure Shopping in Microsoft Edge Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows users to compare the prices of products, get coupons or rebates from the website, autoapply
        coupons, and help checkout faster using autofill data. Coupons for the current retailer and prices from other retailers
        will be fetched from a server.
        The recommended state for this setting is            Disabled
        .         Note
         Starting in Microsoft Edge version 90.0.818.56, the behavior of the messaging letting users know that there is a
        coupon, rebate, price comparison or price history available on shopping domains is also done through a horizontal banner
        below the address bar.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Shopping in Microsoft Edge Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users with roles that require this feature will have to perform price comparisons on their own
        unless exempted from this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.121', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "EdgeShoppingAssistantEnabled"'
            - name: 'EdgeShoppingAssistantEnabled'
              rule: "should have_property_value('EdgeShoppingAssistantEnabled', :dword, '0')"

  "1.122":
    title: '1.122 | L2 Ensure Show an Always open checkbox in external protocol dialog is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls if the user is prompted with an Always open check box when an external protocol prompt is
        shown.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Show an "Always open" checkbox in
        external protocol dialog
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The end user will be prompted each time they click a link that opens an external protocol, even if
        they have utilized it before.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.122', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ExternalProtocolDialogShowAlwaysOpenCheckbox"'
            - name: 'ExternalProtocolDialogShowAlwaysOpenCheckbox'
              rule: "should have_property_value('ExternalProtocolDialogShowAlwaysOpenCheckbox', :dword, '0')"

  "1.123":
    title: '1.123 | L1 Ensure Show Microsoft Rewards experiences is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether the Microsoft Reward experience is available to users and if notifications are
        received. The Microsoft Rewards experience is a free program that allows the user to earn points when searching on
        Bing.com. With these points, the users can buy merchandise from the Microsoft Store online and in Windows 10.
        The recommended state for this setting is            Disabled
        .         Note
         The Bing Rewards experience was merged with the Microsoft Reward experience in 2016.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Show Microsoft Rewards experiences
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The Microsoft Rewards experience will not show in the Microsoft Edge user profile.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.123', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "ShowMicrosoftRewards"'
            - name: 'ShowMicrosoftRewards'
              rule: "should have_property_value('ShowMicrosoftRewards', :dword, '0')"

  "1.124":
    title: '1.124 | L1 Ensure Show the Reload in Internet Explorer mode button in the toolbar is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting shows the Reload in Internet Explorer mode button in the toolbar. IE Mode in Microsoft Edge allows
        organizations that still need Internet Explorer 11, which is not supported for backward compatibility with existing
        websites.
        The recommended state for this setting is            Disabled
        .         Note
         The button will only be shown on the toolbar when the            Allow unconfigured sites to be reloaded in Internet
        Explorer mode
         policy is Enabled which is set to            Disabled
         in the benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Show the Reload in Internet
        Explorer mode button in the toolbar
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will not be able to see or use the Internet Explorer Mode toolbar.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.124', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerModeToolbarButtonEnabled"'
            - name: 'InternetExplorerModeToolbarButtonEnabled'
              rule: "should have_property_value('InternetExplorerModeToolbarButtonEnabled', :dword, '0')"

  "1.125":
    title: '1.125 | L1 Ensure Specifies whether SharedArrayBuffers can be used in a non cross-origin-isolated context is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting specifies whether SharedArrayBuffers can be used in a noncrossoriginisolated context. A
        SharedArrayBuffer is a binary data buffer that can be used to create views on shared memory. SharedArrayBuffers have a
        memory access vulnerability in several popular CPUs.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Specifies whether
        SharedArrayBuffers can be used in a non cross-origin-isolated context
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users may experience slightly slower loading of webpages.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.125', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SharedArrayBufferUnrestrictedAccessAllowed"'
            - name: 'SharedArrayBufferUnrestrictedAccessAllowed'
              rule: "should have_property_value('SharedArrayBufferUnrestrictedAccessAllowed', :dword, '0')"

  "1.126":
    title: '1.126 | L2 Ensure Specify if online OCSPCRL checks are required for local trust anchors is set to Enabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether online certificate revocation checks OCSP/CRL are required and if a check online is
        not possible the certificate will be treated as though it is revoked.
        The recommended state for this is            Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Enabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Specify if online OCSP/CRL checks
        are required for local trust anchors
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: If Microsoft Edge is not able to obtain a revocation status, the certificate will be treated as
        though it is revoked, therefore the website will not be loaded.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.126', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "RequireOnlineRevocationChecksForLocalAnchors"'
            - name: 'RequireOnlineRevocationChecksForLocalAnchors'
              rule: "should have_property_value('RequireOnlineRevocationChecksForLocalAnchors', :dword, '1')"

  "1.127":
    title: '1.127 | L2 Ensure Spell checking provided by Microsoft Editor is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether the Microsoft Editor service provides enhanced spell and grammar checking for
        eligible text fields.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Spell checking provided by
        Microsoft Editor
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: Spell check can only be provided by local engines that use platform or Hunspell services. The
        results from these engines might be less informative than the results Microsoft Editor can provide. Note:
         If the                  spellcheckEnabled
         (Enable spellcheck) policy is set to                  Disabled
        , or the user disables spell checking in the settings page, this policy will have no effect.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.127', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "MicrosoftEditorProofingEnabled"'
            - name: 'MicrosoftEditorProofingEnabled'
              rule: "should have_property_value('MicrosoftEditorProofingEnabled', :dword, '0')"

  "1.128":
    title: '1.128 | L1 Ensure Standalone Sidebar Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether users will have the ability to activate the standalone sidebar. The standalone
        sidebar is an optional mode for the sidebar in Microsoft Edge and uses Bing AI. When this mode is activated by a user,
        the sidebar appears in a fixed position on the Microsoft Windows desktop and is hidden from the browser application
        frame.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Standalone Sidebar Enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact:
        Users will not be able to access the                  HubsSidebarEnabled
         (Show Hubs Sidebar) and it will also prevent them from accessing standalone sidebar and using the Bing AI feature.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.128', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "StandaloneHubsSidebarEnabled"'
            - name: 'StandaloneHubsSidebarEnabled'
              rule: "should have_property_value('StandaloneHubsSidebarEnabled', :dword, '0')"

  "1.129":
    title: '1.129 | L1 Ensure Suggest similar pages when a webpage cant be found is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether Microsoft Edge may connect to a web service to generate URLs and search suggestions
        for website connectivity issues. If disabled standard errors will be issued, if enabled errors will be customized with
        URL suggestions.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Suggest similar pages when a
        webpage can’t be found
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Users will still be presented with an error if a website cannot be reached however, the message
        may be more generic than the user would get in the instance of this service being enabled.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.129', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "AlternateErrorPagesEnabled"'
            - name: 'AlternateErrorPagesEnabled'
              rule: "should have_property_value('AlternateErrorPagesEnabled', :dword, '0')"

  "1.130":
    title: '1.130 | L1 Ensure Suppress the unsupported OS warning is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting suppresses the warning that appears when Microsoft Edge is running on a computer or operating system
        that is no longer supported. If this policy is disabled or unset, the warnings will appear on such unsupported computers
        or operating systems.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                Disabled
        :             Computer Configuration\Polices\Administrative Templates\Microsoft Edge\Suppress the unsupported OS warning
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.130', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "SuppressUnsupportedOSWarning"'
            - name: 'SuppressUnsupportedOSWarning'
              rule: "should have_property_value('SuppressUnsupportedOSWarning', :dword, '0')"

  "1.131":
    title: '1.131 | L2 Ensure Tab Services enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting allows the Microsoft Edge browser to suggest tab and tab group functionality based on the current
        tab content.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Tab Services enabled
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: The Microsoft Edge browser will not be able to help users with tab organization.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.131', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TabservicesEnabled"'
            - name: 'TabservicesEnabled'
              rule: "should have_property_value('TabservicesEnabled', :dword, '0')"

  "1.132":
    title: '1.132 | L2 Ensure Text prediction enabled by default is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting controls whether text predictions will be provided for eligible text fields. The Microsoft Turing
        service uses natural language processing to generate predictions for longform editable text fields on web pages.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Text prediction enabled by default
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: Text predictions will not be provided in eligible text fields. Sites may still provide their own
        text predictions.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.132', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "TextPredictionEnabled"'
            - name: 'TextPredictionEnabled'
              rule: "should have_property_value('TextPredictionEnabled', :dword, '0')"

  "1.133":
    title: '1.133 | L1 Ensure Wait for Internet Explorer mode tabs to completely unload before ending the browser session is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        This policy setting causes Microsoft Edge to continue running until all Internet Explorer tabs have completely finished
        unloading. This allows Internet Explorer plugins like ActiveX controls to perform additional critical work even after
        the browser has been closed.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Wait for Internet Explorer mode
        tabs to completely unload before ending the browser session
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                Download Microsoft Edge for Business - Microsoft
        .             Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.133', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "InternetExplorerIntegrationAlwayswaitForUnload"'
            - name: 'InternetExplorerIntegrationAlwayswaitForUnload'
              rule: "should have_property_value('InternetExplorerIntegrationAlwayswaitForUnload', :dword, '0')"

  "1.134":
    title: '1.134 | L1 Ensure Wallet Donation Enabled is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        The Wallet Donation feature in Microsoft Edge allows users to view their donation summary, explore Nonprofit
        organizations NPOs, donate to an NPO, manage their monthly donations, and view their donation history.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable wallet donation in
        Microsoft Edge.
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: The wallet donation feature in Microsoft Edge will not function.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.134', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "WalletDonationEnabled"'
            - name: 'WalletDonationEnabled'
              rule: "should have_property_value('WalletDonationEnabled', :dword, '0')"

  "1.135":
    title: '1.135 | L2 Ensure Enable QR Code Generator is set to Disabled'
    section: 'Microsoft Edge'
    description: |
        The QR Code Generator feature in Microsoft Edge allows users the ability to generate QR codes to internal and external
        sites.
        The recommended state for this setting is            Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                Disabled
        :             Computer Configuration\Policies\Administrative Templates\Microsoft Edge\Enable QR Code Generator
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from Microsoft from                Download Edge for Business
        .             Impact: The QR code generator feature in Microsoft Edge will not function.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.135', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge'
        - checks:
            - rule: 'should have_property "QRCodeGeneratorEnabled"'
            - name: 'QRCodeGeneratorEnabled'
              rule: "should have_property_value('QRCodeGeneratorEnabled', :dword, '0')"

  "3.1.1":
    title: '3.1.1 | L1 Ensure Update policy override default is set to Enabled Always allow updates recommended'
    section: 'Applications'
    description: |
        This policy settings sets the default behavior for all channels concerning the way Microsoft Edge Update handles
        available updates for Microsoft Edge.
        The recommended state for this setting is              Enabled Always allow updates recommended
        .           Note
         This setting can be overridden for individual channels by specifying the              Update policy override
         policy for those specific channels.           Note 2
         This policy is available only on Windows instances that are joined to a Microsoft Active Directory domain.
    remediation: |
        To establish the recommended configuration via Group Policy, set the following UI path to                  Enabled:
        Always allow updates (recommended)
         or                  Enabled: Automatic silent updates only
        :               Computer Configuration\Polices\Administrative Templates\Microsoft Edge Update\Applications\Update policy
        override default
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: The latest Microsoft Edge updates are automatically installed. Enterprises that use other means
        of patching systems will need to exclude this recommendation from the benchmark.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.1.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EdgeUpdate'
        - checks:
            - rule: 'should have_property "UpdateDefault"'
            - name: 'UpdateDefault'
              rule: "should have_property_value('UpdateDefault', :dword, '1')"

  "3.3.1":
    title: '3.3.1 | L1 Ensure Auto-update check period override is set to any value except 0'
    section: 'Preferences'
    description: |
        This policy setting configures the minimum number of minutes between automatic update checks.
        The recommended state for this setting is any value              except
                           0
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to any value                  except
                                 0
        :               Computer Configuration\Policies\Administrative Templates\Microsoft Edge Update\Preferences\Auto-update
        check period override
         Note:
         This Group Policy path may not exist by default. It is provided by the Group Policy template
        MSEdge.admx/adml
         that can be downloaded from:                  Download Microsoft Edge for Business - Microsoft
        .               Impact: If using a third-party for patching, an exception to this recommendation will be needed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.1', 'cis_microsoft_edge_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EdgeUpdate'
        - checks:
            - rule: 'should have_property "AutoUpdateCheckPeriodMinutes"'
            - name: 'AutoUpdateCheckPeriodMinutes'
              rule: "should have_property_value('AutoUpdateCheckPeriodMinutes', :dword, '0')"
