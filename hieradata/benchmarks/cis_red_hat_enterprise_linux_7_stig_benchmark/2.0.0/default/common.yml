---

inspec_rules:
  "1.1.2":
    title: '1.1.2 | Ensure tmp is configured'
    section: 'Filesystem Configuration'
    description: |
        The              /tmp
         directory is a worldwritable directory used for temporary storage by all users and some applications.
    remediation: |
        Create or update an entry for                  /tmp
         in either                  /etc/fstab
                         OR
         in a systemd                  tmp.mount
         file:               If /etc/fstab
         is used: configure                  /etc/fstab
          as appropriate.               _ Example:_ tmpfs	/tmp	tmpfs     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                  /tmp
                       # mount -o remount,noexec,nodev,nosuid /tmp
         OR
         if systemd                  tmp.mount
         file is used: run the following command to create the file                  /etc/systemd/system/tmp.mount
         if it doesn't exist:               # [ ! -f /etc/systemd/system/tmp.mount ] && cp -v /usr/lib/systemd/system/tmp.mount
        /etc/systemd/system/

        Edit the file                  /etc/systemd/system/tmp.mount
        :
        [Mount]
        What=tmpfs
        Where=/tmp
        Type=tmpfs
        Options=mode=1777,strictatime,noexec,nodev,nosuid
                       Run the following command to reload the systemd daemon: # systemctl daemon-reload

        Run the following command to unmask and start                  tmp.mount
        :               # systemctl --now unmask tmp.mount
         Impact:
        Since the                    /tmp
         directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate
        partition.
        Running out of /tmp space is a problem regardless of what kind of filesystem lies under it, but in a default
        installation a disk-based                    /tmp
         will essentially have the whole disk available, as it only creates a single                    /
         partition. On the other hand, a RAM-based                    /tmp
         as with                    tmpfs
         will almost certainly be much smaller, which can lead to applications filling up the filesystem much more easily.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.7":
    title: '1.1.7 | Ensure noexec option set on devshm partition'
    section: 'Filesystem Configuration'
    description: |
        The              noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        Edit the                  /etc/fstab
         file and add                  noexec
         to the fourth field (mounting options) for the                  /dev/shm
          partition. See the                  fstab(5)
         manual page for more information.
        Run the following command to remount                  /dev/shm
        :               # mount -o remount,noexec,nodev,nosuid /dev/shm
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.8":
    title: '1.1.8 | Ensure nodev option set on devshm partition'
    section: 'Filesystem Configuration'
    description: |
        The              nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        Edit the                  /etc/fstab
         file and add                  nodev
         to the fourth field (mounting options) for the                  /dev/shm
          partition. See the                  fstab(5)
         manual page for more information.
        Run the following command to remount                  /dev/shm
        :               # mount -o remount,noexec,nodev,nosuid /dev/shm
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.9":
    title: '1.1.9 | Ensure nosuid option set on devshm partition'
    section: 'Filesystem Configuration'
    description: |
        The              nosuid
         mount option specifies that the filesystem cannot contain              setuid
          files.
    remediation: |
        Edit the                  /etc/fstab
         file and add                  nosuid
         to the fourth field (mounting options) for the                  /dev/shm
          partition. See the                  fstab(5)
         manual page for more information.
        Run the following command to remount                  /dev/shm
        :               # mount -o remount,noexec,nodev,nosuid /dev/shm
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.10":
    title: '1.1.10 | Ensure separate partition exists for var'
    section: 'Filesystem Configuration'
    description: |
        The              /var
          directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by
        these processes may be worldwritable.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var

        For systems that were previously installed, create a new partition and configure                  /etc/fstab
          as appropriate.               Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.16":
    title: '1.1.16 | Ensure separate partition exists for varlogaudit'
    section: 'Filesystem Configuration'
    description: |
        The auditing daemon,              auditd
         , stores log data in the              /var/log/audit
         directory.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var/log/audit
         .
        For systems that were previously installed, create a new partition and configure                  /etc/fstab
          as appropriate.               Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.16', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.19":
    title: '1.1.19 | Ensure nosuid is set on users home directories.'
    section: 'Filesystem Configuration'
    description: |
        The operating system must be configured so that file systems containing user home directories are mounted to prevent
        files with the              setuid
         and              setgid
         bit set from being executed.
    remediation: |
        Configure the                  /etc/fstab
         to use the                  nosuid
         option on file systems that contain user home directories.
        Example:                  vim /etc/fstab

        Update any of the file systems listed without the                  nosuid
         option"               UUID=a411dc99-f2a1-4c87-9e05-184977be8539 /home ext4 rw,relatime,discard,data=ordered,nosuid 0 2
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.19', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.22":
    title: '1.1.22 | Ensure nosuid option set on removable media partitions - manual'
    section: 'Filesystem Configuration'
    description: |
        The              nosuid
         mount option specifies that the filesystem cannot contain              setuid
          files.
    remediation: |
        Edit the                  /etc/fstab
         file and add                  nosuid
          to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that
        contain words such as floppy or cdrom. See the                  fstab(5)
         manual page for more information.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.22', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == nosuid'

  "1.1.23":
    title: '1.1.23 | Ensure noexec option is configured for NFS.'
    section: 'Filesystem Configuration'
    description: |
        The operating system must prevent binary files from being executed on file systems that are being imported via Network
        File System NFS.
    remediation: |
        Configure the                  /etc/fstab
         to use the                  noexec
         option on file systems that are being imported via NFS.
        Example:                  vim /etc/fstab

        Add, or update any NFS file systems found in the Audit to include the                  noexec
         option:               UUID=e06097bb-cfcd-437b-9e4d-a691f5662a7d /store nfs rw,nosuid,noexec 0 0
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.23', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.24":
    title: '1.1.24 | Ensure nosuid option is set for NFS'
    section: 'Filesystem Configuration'
    description: |
        The operating system must prevent files with the setuid and setgid bit set from being executed on file systems that are
        being imported via Network File System NFS.
    remediation: |
        Configure the                  /etc/fstab
         to use the                  nosuid
         option on file systems that are being imported via NFS.
        Example:                  vim /etc/fstab
                       Add, uncomment or update the NFS file systems identified in the Audit: UUID=e06097bb-
        cfcd-437b-9e4d-a691f5662a7d /store nfs rw,nosuid 0 0
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.24', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.1.26":
    title: '1.1.26 | Ensure all world-writable directories are group-owned. - manual'
    section: 'Filesystem Configuration'
    description: |
        The operating system must be configured so that all worldwritable directories are groupowned by root, sys, bin, or an
        application group.
    remediation: |
        Referring to the list obatined in in the Audit above, change the group of the world-writable directories to
        root
         with the following command:               # chgrp root <directory>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.26', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.1.27":
    title: '1.1.27 | Disable Automounting'
    section: 'Filesystem Configuration'
    description: |
        autofs
         allows automatic mounting of devices, typically including CD/DVDs and USB drives.
    remediation: |
        Run the following command to mask                  autofs
        :               # systemctl --now mask autofs
         OR
         run the following command to remove                  autofs
                       # yum remove autofs
         Impact: The use of portable hard drives is very common for workstation users. If your organization allows the use of
        portable storage or media on workstations and physical access controls to workstations is considered adequate there is
        little value add in turning off automounting.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.27', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == masked'
            - name: Undefined
              rule: 'should cmp == disabled'

  "1.1.28":
    title: '1.1.28 | Disable USB Storage'
    section: 'Filesystem Configuration'
    description: |
        USB storage provides a means to transfer and store files insuring persistence and availability of the files independent
        of network connection status.  Its popularity and utility has led to USBbased malware being a simple and common means
        for network infiltration and a first step to establishing a persistent threat within a networked environment.
    remediation: |
        Edit or create a file in the /etc/modprobe.d/ directory ending in                  .conf

        Example:                    vim /etc/modprobe.d/usb_storage.conf
                         Add the following line: install usb-storage /bin/true
         Run the following command to unload the usb-storage module: rmmod usb-storage
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.1.28', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.2.3":
    title: '1.2.3 | Ensure gpgcheck is globally activated'
    section: 'Configure Software Updates'
    description: |
        The              gpgcheck
         option, found in the main section of the              /etc/yum.conf
          and individual              /etc/yum/repos.d/.repo
          files determines if an RPM packages signature is checked prior to its installation.
    remediation: |
        Edit                  /etc/yum.conf
         and set '                 gpgcheck=1
        ' in the                  [main]
         section.
        Edit any failing files in                  /etc/yum.repos.d/*.repo
         and set all instances of                  gpgcheck
         to                  1
        .
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.2.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.2.6":
    title: '1.2.6 | Ensure software packages have been digitally signed by a Certificate Authority CA'
    section: 'Configure Software Updates'
    description: |
        The operating system must prevent the installation of software, patches, service packs, device drivers, or operating
        system components of local packages without verification they have been digitally signed using a certificate that is
        issued by a Certificate Authority CA that is recognized and approved by the organization.
    remediation: |
        Configure the operating system to verify the signature of local packages prior to install by setting the following
        option in the                  /etc/yum.conf
         file:
        Example:                  vim /etc/yum.conf
                       and add the following line: localpkg_gpgcheck=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.2.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.2.7":
    title: '1.2.7 | Ensure removal of software components after update'
    section: 'Configure Software Updates'
    description: |
        The operating system must remove all software components after updated versions have been installed.
    remediation: |
        Configure the operating system to remove all software components after updated versions have been installed.
        Set the                  clean_requirements_on_remove
         option to                  1
         in the                  /etc/yum.conf
         file:
        Example:                  vim /etc/yum.conf
                       Add, uncomment or update the following line: clean_requirements_on_remove=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.2.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.2.8":
    title: '1.2.8 | Ensure the version of the operating system is an active vendor supported release - manual'
    section: 'Configure Software Updates'
    description: |
        The operating system must be a vendor supported release
    remediation: |
        Upgrade to a supported version of the operating system.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.2.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.3.1":
    title: '1.3.1 | Ensure AIDE is installed'
    section: 'Filesystem Integrity Checking'
    description: |
        AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be
        used to compare against the current state of the filesystem to detect modifications to the system.
        Note The prelinking feature can interfere with AIDE because it alters binaries to speed up their start up times. Run
        prelink ua
         to restore the binaries to their prelinked state, thus avoiding false positives from AIDE.
    remediation: |
        Run the following command to install AIDE: # yum install aide
         Configure AIDE as appropriate for your environment. Consult the AIDE documentation for options. Initialize AIDE: Run
        the following commands:
        # aide --init

        # mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.3.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.3.2":
    title: '1.3.2 | Ensure filesystem integrity is regularly checked'
    section: 'Filesystem Integrity Checking'
    description: |
        Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.
    remediation: |
        If cron will be used to schedule and run aide check Run the following command: # crontab -u root -e
         Add the following line to the crontab: 0 5 * * * /usr/sbin/aide --check
         OR if aidecheck.service and aidecheck.timer will be used to schedule and run aide check:
        Create or edit the file                  /etc/systemd/system/aidecheck.service
         and add the following lines:
        [Unit]
        Description=Aide Check

        [Service]
        Type=simple
        ExecStart=/usr/sbin/aide --check

        [Install]
        WantedBy=multi-user.target
                       Create or edit the file /etc/systemd/system/aidecheck.timer and add the following lines:
        [Unit]
        Description=Aide check every day at 5AM

        [Timer]
        OnCalendar=*-*-* 05:00:00
        Unit=aidecheck.service

        [Install]
        WantedBy=multi-user.target
                       Run the following commands:
        # chown root:root /etc/systemd/system/aidecheck.*
        # chmod 0644 /etc/systemd/system/aidecheck.*

        # systemctl daemon-reload

        # systemctl enable aidecheck.service
        # systemctl --now enable aidecheck.timer
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.3.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == aidecheck.service'

  "1.3.3":
    title: '1.3.3 | Ensure AIDE is configured to verify ACLs - manual'
    section: 'Filesystem Integrity Checking'
    description: |
        The operating system must be configured so that the file integrity tool is configured to verify Access Control Lists
        ACLs.
    remediation: |
        Configure the file integrity tool to check file and directory ACLs.
        If AIDE is installed, ensure the                  acl
         rule is present on all uncommented file and directory selection lists.
        Example:                  vim /etc/aide.conf

        add a rule that includes the                  acl
         example:
        All= p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux
        /bin All # apply the custom rule to the files in bin
        /sbin All # apply the same custom rule to the files in sbin
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.3.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.3.4":
    title: '1.3.4 | Ensure AIDE is configured to verify XATTRS - manual'
    section: 'Filesystem Integrity Checking'
    description: |
        The operating system must be configured so that the file integrity tool is configured to verify extended attributes.
    remediation: |
        Configure the file integrity tool to check file and directory extended attributes.
        If AIDE is installed, ensure the                  xattrs
         rule is present on all uncommented file and directory selection lists.
        Example:                  vim /etc/aide.conf

        add rule that includes the                  xattrs
         example:
        All= p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux
        /bin All # apply the custom rule to the files in bin
        /sbin All # apply the same custom rule to the files in sbin
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.3.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.3.5":
    title: '1.3.5 | Ensure AIDE is configured to use FIPS 140-2 - manual'
    section: 'Filesystem Integrity Checking'
    description: |
        The operating system must use a file integrity tool that is configured to use FIPS 1402 approved cryptographic hashes
        for validating file contents and directories.
    remediation: |
        Configure the file integrity tool to use FIPS 140-2 cryptographic hashes for validating file and directory contents.
        If AIDE is installed, ensure the                  sha512
         rule is present on all uncommented file and directory selection lists.
        Example:                  vim /etc/aide.conf

        add a rule that includes the                  sha512
         example:
        All=p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux
        /bin All # apply the custom rule to the files in bin
        /sbin All # apply the same custom rule to the files in sbin
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.3.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.4.1":
    title: '1.4.1 | Ensure bootloader password is set - manual'
    section: 'Secure Boot Settings'
    description: |
        Setting the boot loader password will require that anyone rebooting the system must enter a password before being able
        to set command line boot parameters
    remediation: |
        For                  newer
                         grub2
         based systems (Release 7.2 and newer), create an encrypted password with                  grub2-setpassword
         :
        # grub2-setpassword

        Enter password: <password>
        Confirm password: <password>

        Run the following command to script the                  grub2
         configuration:
        #!/usr/bin/env bash

        GFCU()
        {
           grubfile=$(find /boot -type f \( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \) -exec grep -Pl
        '^\h*(kernelopts=|linux|kernel)' {} \;)
           grubdir=$(dirname "$grubfile")
           grub2-mkconfig -o "$grubdir/grub.cfg"
        }
        GFCU
                       OR
         for                  older
                         grub2
         based systems, create an encrypted password with                  grub2-mkpasswd-pbkdf2
        :
        # grub2-mkpasswd-pbkdf2

        Enter password: <password>
        Reenter password: <password>

        Your PBKDF2 is <encrypted-password>

        Add the following into                  /etc/grub.d/01_users
          or a custom                  /etc/grub.d
         configuration file:
        cat <<EOF
        set superusers="<username>"
        password_pbkdf2 <username> <encrypted-password>
        EOF
                       Note: If placing the information in a custom file, do not include the "cat << EOF" and "EOF" lines as the
        content is automatically added from these files
        The                      superuser/user
         information and password should not be contained in the                      /etc/grub.d/00_header
         file. The information can be placed in any                      /etc/grub.d
         file as long as that file is incorporated into                      grub.cfg
        . It is preferable to enter this data into a custom file, such as                      /etc/grub.d/40_custom
        , so it is not overwritten should the Grub package be updated
        Run the following command to script the                  grub2
         configuration:
        #!/usr/bin/env bash

        GFCU()
        {
           grubfile=$(find /boot -type f \( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \) -exec grep -Pl
        '^\h*(kernelopts=|linux|kernel)' {} \;)
           grubdir=$(dirname "$grubfile")
           grub2-mkconfig -o "$grubdir/grub.cfg"
        }
        GFCU
                       Impact: If password protection is enabled, only the designated superuser can edit a Grub 2 menu item by
        pressing "e" or access the GRUB 2 command line by pressing "c" If GRUB 2 is set up to boot automatically to a password-
        protected menu entry the user has no option to back out of the password prompt to select another menu entry. Holding the
        SHIFT key will not display the menu in this case. The user must enter the correct username and password. If unable, the
        configuration files will have to be edited via the LiveCD or other means to fix the problem You can add --unrestricted
        to the menu entries to allow the system to boot without entering a password. Password will still be required to edit
        menu items.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.4.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.4.3":
    title: '1.4.3 | Ensure authentication required for single user mode'
    section: 'Secure Boot Settings'
    description: |
        Single user mode rescue mode is used for recovery when the system detects an issue during boot or by manual selection
        from the bootloader.
        Note The systemctl option                fail
         is synonymous with                jobmodefail
        .  Using either is acceptable.
    remediation: |
        Edit                  /usr/lib/systemd/system/rescue.service
          and                  /usr/lib/systemd/system/emergency.service
          and set ExecStart to use                  /sbin/sulogin
         or                  /usr/sbin/sulogin
        :               ExecStart=-/bin/sh -c "/sbin/sulogin; /usr/bin/systemctl --fail --no-block default"
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.4.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.4.4":
    title: '1.4.4 | Ensure boot loader does not allow removable media'
    section: 'Secure Boot Settings'
    description: |
        The operating system must not allow removable media to be used as the boot loader unless approved.
    remediation: |
        Remove alternate methods of booting the system from removable media or document the configuration to boot from removable
        media with the Authorizing Official.
        Example:                  vim /etc/default/grub
                       Add this in the first menu entry set root=(hd0,1)

        Any changes made to                  /etc/default/grub
         require you to run                  grub2-mkconfig
         to re-generate the                  /boot/grub2/grub.cfg
         file.               Example: # grub2-mkconfig â€“o /boot/grub2/grub.cfg
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.4.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.4.5":
    title: '1.4.5 | Ensure version 7.2 or newer booted with a BIOS have a unique name for the grub superusers account - manual'
    section: 'Secure Boot Settings'
    description: |
        The Linux operating systems version 7.2 or newer booted with a BIOS must have a unique name for the grub superusers
        account when booting into singleuser and maintenance modes.
    remediation: |
        Configure the system to have a unique name for the grub superusers account. Edit the /boot/grub2/grub.cfg file and add
        or modify the following lines in the "### BEGIN /etc/grub.d/01_users ###" section:
        set superusers="[someuniquestringhere]"
        export superusers
        password_pbkdf2 [someuniquestringhere] ${GRUB2_PASSWORD}
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.4.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.4.6":
    title: '1.4.6 | Ensure version 7.2 or newer booted with UEFI have a unique name for the grub superusers account - manual'
    section: 'Secure Boot Settings'
    description: |
        The Linux operating systems version 7.2 or newer booted with United Extensible Firmware Interface UEFI must have a
        unique name for the grub superusers account when booting into singleuser mode and maintenance.
    remediation: |
        Configure the system to have a unique name for the grub superusers account. Edit the /boot/efi/EFI/redhat/grub.cfg file
        and add or modify the following lines in the "### BEGIN /etc/grub.d/01_users ###" section:
        set superusers="[someuniquestringhere]"
        export superusers
        password_pbkdf2 [someuniquestringhere] ${GRUB2_PASSWORD}
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.4.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.5.3":
    title: '1.5.3 | Ensure address space layout randomization ASLR is enabled'
    section: 'Additional Process Hardening'
    description: |
        Address space layout randomization ASLR is an exploit mitigation technique which randomly arranges the address space of
        key data areas of a process.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:               kernel.randomize_va_space = 2
         Run the following command to set the active kernel parameter: # sysctl -w kernel.randomize_va_space=2
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == 2'

  "1.5.5":
    title: '1.5.5 | Ensure number of concurrent sessions is limited'
    section: 'Additional Process Hardening'
    description: |
        The operating system must limit the number of concurrent sessions to 10 for all accounts and/or account types.
    remediation: |
        Configure the operating system to limit the number of concurrent sessions to                  10
         for all accounts and/or account types.
        Example:                  vim /etc/security/limits.conf

        Add the following line to the top of the                  /etc/security/limits.conf
        :               * hard maxlogins 10
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.5.6":
    title: '1.5.6 | Ensure the Ctrl-Alt-Delete key sequence is disabled.'
    section: 'Additional Process Hardening'
    description: |
        The operating system must be configured so that the user will be prompted when CtrlAltDelete key sequence is entered.
    remediation: |
        Configure the system to disable the                  Ctrl-Alt_Delete
         sequence for the command line with the following command:               # systemctl mask ctrl-alt-del.target
         If GNOME is active on the system, create a database to contain the system-wide setting (if it does not already exist)
        with the following command: # touch /etc/dconf/db/local.d/00-disable-CAD

        Add the setting to disable the                  Ctrl-Alt_Delete
         sequence for GNOME:
        [org/gnome/settings-daemon/plugins/media-keys]
        logout=''
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == masked'
            - name: Undefined
              rule: 'should cmp == inactive'
            - name: Undefined
              rule: 'should cmp == bad'
            - name: Undefined
              rule: 'should cmp == masked'

  "1.5.7":
    title: '1.5.7 | Ensure kernel core dumps are disabled.'
    section: 'Additional Process Hardening'
    description: |
        The operating system must disable Kernel core dumps unless needed.
    remediation: |
        If kernel core dumps are not required, disable the                  kdump
         service with the following command:               # systemctl disable kdump.service
         If kernel core dumps are required, document the need with the Authorizing Official.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "1.5.8":
    title: '1.5.8 | Ensure DNS is servers are configured'
    section: 'Additional Process Hardening'
    description: |
        The operating systems that are using DNS resolution, must have at least two name servers configured.
    remediation: |
        Configure the operating system to use two or more name servers for DNS resolution.
        Edit the                  /etc/resolv.conf
         file to uncomment or add the two or more                  nameserver
         option lines with the IP address of local authoritative name servers. If local host resolution is being performed, the
        /etc/resolv.conf
         file must be empty. An empty                  /etc/resolv.conf
         file can be created as follows:               # echo -n > /etc/resolv.conf
         And then make the file immutable with the following command: # chattr +i /etc/resolv.conf

        If the                  /etc/resolv.conf
         file must be mutable, the required configuration must be documented with the Authorizing Official and the file must be
        verified by the system file integrity tool.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.5.9":
    title: '1.5.9 | Ensure NIST FIPS-validated cryptography is configured'
    section: 'Additional Process Hardening'
    description: |
        The operating system must implement NIST FIPSvalidated cryptography for the following provision digital signatures
        generate cryptographic hashes protect data requiring dataatrest protections in accordance with applicable federal laws,
        Executive Orders, directives, policies, regulations, and standards.
    remediation: |
        Configure the operating system to implement DoD-approved encryption by installing the                  dracut-fips
         package.
        To enable strict FIPS compliance, the                  fips=1
         kernel option needs to be added to the kernel command line during system installation so key generation is done with
        FIPS- approved algorithms and continuous monitoring tests in place.               Configure the operating system to
        implement DoD-approved encryption by following the steps below:
        The                  fips=1
         kernel option needs to be added to the kernel command line during system installation so that key generation is done
        with FIPS-approved algorithms and continuous monitoring tests in place. Users should also ensure that the system has
        plenty of entropy during the installation process by moving the mouse around, or if no mouse is available, ensuring that
        many keystrokes are typed. The recommended amount of keystrokes is                  256
         and more. Less than                  256
         keystrokes may generate a non-unique key.
        Install the                  dracut-fips
         package with the following command:               # yum install dracut-fips

        Recreate the                  initramfs
         file with the following command:
        Note: This command will overwrite the existing                  initramfs
         file.               # dracut -f

        Modify the kernel command line of the current kernel in the                  grub.cfg
         file by adding the following option to the                  GRUB_CMDLINE_LINUX
         key in the                  /etc/default/grub
         file and then rebuild the                  grub.cfg
         file:               fips=1

        Changes to                  /etc/default/grub
         require rebuilding the                  grub.cfg
         file as follows:               On BIOS-based machines, use the following command: # grub2-mkconfig -o
        /boot/grub2/grub.cfg
         On UEFI-based machines, use the following command: # grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg

        If                  /boot
         or                  /boot/efi
         reside on separate partitions, the kernel parameter                  boot=<partition of /boot or /boot/efi>
         must be added to the kernel command line. You can identify a partition by running the                  df /boot
         or                  df /boot/efi
         command:
        # df /boot
        Filesystem 1K-blocks Used Available Use% Mounted on
        /dev/sda1 495844 53780 416464 12% /boot

        To ensure the                  boot=
         configuration option will work even if device naming changes occur between boots, identify the universally unique
        identifier (UUID) of the partition with the following command:
        # blkid /dev/sda1
        /dev/sda1: UUID="05c000f1-a213-759e-c7a2-f11b7424c797" TYPE="ext4"
                       For the example above, append the following string to the kernel command line:
        boot=UUID=05c000f1-a213-759e-c7a2-f11b7424c797
         Reboot the system for the changes to take effect.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.5.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == fips=1'

  "1.6.1.3":
    title: '1.6.1.3 | Ensure SELinux policy is configured'
    section: 'Configure SELinux'
    description: |
        Configure SELinux to meet or exceed the default targeted policy, which constrains daemons and system software only.
        Note If your organization requires stricter policies, ensure that they are set in the
        /etc/selinux/config
         file.
    remediation: |
        Edit the                    /etc/selinux/config
         file to set the SELINUXTYPE parameter:                 SELINUXTYPE=targeted
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.6.1.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^Loaded\s+policy\s+name:\s+(targeted|mls)\s*$'

  "1.6.1.5":
    title: '1.6.1.5 | Ensure the SELinux mode is enforcing'
    section: 'Configure SELinux'
    description: |
        SELinux can run in one of three modes disabled, permissive, or enforcing Enforcing  Is the default, and recommended,
        mode of operation in enforcing mode SELinux operates normally, enforcing the loaded security policy on the entire
        system. Permissive  The system acts as if SELinux is enforcing the loaded security policy, including labeling objects
        and emitting access denial entries in the logs, but it does not actually deny any operations. While not recommended for
        production systems, permissive mode can be helpful for SELinux policy development. Disabled  Is strongly discouraged not
        only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files,
        making it difficult to enable SELinux in the future Note you can set individual domains to permissive mode while the
        system runs in enforcing mode. For example, to make the httpdt domain permissive  semanage permissive a httpdt
    remediation: |
        Run the following command to set SELinux's running mode: # setenforce 1

        Edit the                    /etc/selinux/config
         file to set the SELINUX parameter:                 For Enforcing mode: SELINUX=enforcing
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.6.1.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^Current mode:\s+enforcing$'
            - name: Undefined
              rule: 'should cmp == ^Mode from config file:\s+enforcing$'

  "1.6.1.9":
    title: '1.6.1.9 | Ensure non-privileged users are prevented from executing privileged functions - manual'
    section: 'Configure SELinux'
    description: |
        The operating system must prevent nonprivileged users from executing privileged functions to include disabling,
        circumventing, or altering implemented security safeguards/countermeasures.
    remediation: |
        Configure the operating system to prevent non-privileged users from executing privileged functions to include disabling,
        circumventing, or altering implemented security safeguards/countermeasures. Utilizing the list of users gathered in the
        Audit section run the applicable command for that user below.
        Use the following command to map a new user to the                    sysdam_u
         role:                 # semanage login -a -s sysadm_u <username>

        Use the following command to map an existing user to the                    sysdam_u
         role:                 # semanage login -m -s sysadm_u <username>

        Use the following command to map a new user to the                    staff_u
         role:                 # semanage login -a -s staff_u <username>

        Use the following command to map an existing user to the                    staff_u
         role:                 # semanage login -m -s staff_u <username>

        Use the following command to map a new user to the                    user_u
         role:                 # semanage login -a -s user_u <username>

        Use the following command to map an existing user to the                    user_u
         role:                 # semanage login -m -s user_u <username>
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.6.1.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.6.1.10":
    title: '1.6.1.10 | Ensure system device files are labeled. - manual'
    section: 'Configure SELinux'
    description: |
        The operating system must be configured so that all system device files are correctly labeled to prevent unauthorized
        modification.
    remediation: |
        Run the following command to determine which package owns the device file: # rpm -qf <filename>

        The package can be reinstalled from a                    yum
         repository using the command:                 # sudo yum reinstall <packagename>
         Alternatively, the package can be reinstalled from trusted media using the command: # sudo rpm -Uvh <packagename>
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.6.1.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.7.3":
    title: '1.7.3 | Ensure the Standard Mandatory DoD Notice and Consent Banner are configured'
    section: 'Command Line Warning Banners'
    description: |
        The Red Hat Enterprise Linux operating system must display the Standard Mandatory DoD Notice and Consent Banner before
        granting local or remote access to the system via a command line user logon.
    remediation: |
        Edit                  /etc/issue
         and replace the text with:
        "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

        By using this IS (which includes any device attached to this IS), you consent to the following conditions:

        -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to,
        penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE),
        and counterintelligence (CI) investigations.

        -At any time, the USG may inspect and seize data stored on this IS.

        -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and
        search, and may be disclosed or used for any USG-authorized purpose.

        -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your
        personal benefit or privacy.

        -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or
        monitoring of the content of privileged communications, or work product, related to personal representation or services
        by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and
        confidential. See User Agreement for details."
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.7.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.8":
    title: '1.7.8 | Ensure the Standard Mandatory DoD Notice and Consent Banner are configured'
    section: 'Command Line Warning Banners'
    description: |
        The operating system must display the Standard Mandatory DoD Notice and Consent Banner immediately prior to, or as part
        of, remote access logon prompts.
    remediation: |
        Configure the operating system to display the Standard Mandatory DoD Notice and Consent Banner before granting access to
        the system via the ssh.
        Edit the                  /etc/ssh/sshd_config
         file to uncomment the banner keyword and configure it to point to a file that will contain the logon banner (this file
        may be named differently or be in a different location if using a version of SSH that is provided by a third-party
        vendor).
        Example:                  vim /etc/sshd_config
                       An example configuration line is: banner /etc/issue
         Either create the file containing the banner or replace the text in the file with the Standard Mandatory DoD Notice and
        Consent Banner.
        Example:                  vim /etc/issue
                       The DoD required text is:
        "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By
        using this IS (which includes any device attached to this IS), you consent to the following conditions:

        -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to,
        penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE),
        and counterintelligence (CI) investigations.

        -At any time, the USG may inspect and seize data stored on this IS.

        -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and
        search, and may be disclosed or used for any USG-authorized purpose.

        -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your
        personal benefit or privacy.

        -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or
        monitoring of the content of privileged communications, or work product, related to personal representation or services
        by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and
        confidential. See User Agreement for details."
                       The SSH service must be restarted for changes to take effect. Examples:
        Type the following command:
        # /etc/init.d/sshd restart

        or use the service command:
        # service sshd restart

        or with systemd enter:
        $ sudo systemctl restart sshd
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.7.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.2":
    title: '1.8.2 | Ensure GDM login banner is configured'
    section: 'GNOME Display Manager'
    description: |
        GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.
    remediation: |
        Edit or create the file                  /etc/dconf/profile/local
         and add the following:
        user-db:user
        system-db:local
        file-db:/usr/share/local/greeter-dconf-defaults

        Edit or create the file                  /etc/dconf/db/local.d/
         and add the following:
        (This is typically                    /etc/dconf/db/local.d/01-banner-message
        )

        [org/gnome/login-screen]
        banner-message-enable=true
        banner-message-text='<banner message>'
                       Example Banner Text:
         'Authorized users only. All activity may be monitored and reported.'               Run the following command to update
        the system databases: # dconf update
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.5":
    title: '1.8.5 | Ensure Standard Mandatory DoD Notice and Consent Banner displayed via a graphical user logon - manual'
    section: 'GNOME Display Manager'
    description: |
        The operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting local access to
        the system via a graphical user logon.
    remediation: |
        Configure the operating system to display the approved Standard Mandatory DoD Notice and Consent Banner before granting
        access to the system. Note: If the system does not have a Graphical User Interface installed, this requirement is Not
        Applicable. Create a database to contain the system-wide graphical user logon settings (if it does not already exist)
        with the following command: # touch /etc/dconf/db/local.d/01-banner-message
         Add the following line to the [org/gnome/login-screen] section of the "/etc/dconf/db/local.d/01-banner-message":
        [org/gnome/login-screen]

        banner-message-enable=true

        banner-message-text='You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-
        authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following
        conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not
        limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law
        enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored
        on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring,
        interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security
        measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or
        privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching
        or monitoring of the content of privileged communications, or work product, related to personal representation or
        services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are
        private and confidential. See User Agreement for details. '
                       Note:
         The "\n " characters are for formatting only. They will not be displayed on the Graphical User Interface.
        Run the following command to update the database: # dconf update
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.8.6":
    title: '1.8.6 | Ensure GDM session lock is enabled'
    section: 'GNOME Display Manager'
    description: |
        The Red Hat Enterprise Linux operating system must enable a user session lock until that user reestablishes access using
        established identification and authentication procedures.
    remediation: |
        Edit or create the file /etc/dconf/profile/gdm and add the following:
        user-db:user
        system-db:gdm
        file-db:/usr/share/gdm/greeter-dconf-defaults

        Edit or create a file in                  /etc/dconf/db/gdm.d/
         and add the following: _(This is typically                  /etc/dconf/db/gdm.d/00-screensaver
        )
        [org/gnome/desktop/screensaver]
        # Set this to true to lock the screen when the screensaver activates
        lock-enabled=true
                       Run the following command to update the system databases: # dconf update
         Note: Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.7":
    title: '1.8.7 | Ensure the graphical user Ctrl-Alt-Delete key sequence is disabled'
    section: 'GNOME Display Manager'
    description: |
        The operating system must be configured so that the x86 CtrlAltDelete key sequence is disabled in the Graphical User
        Interface.
    remediation: |
        Configure the system to disable the Ctrl-Alt-Delete sequence for the graphical user interface with the following
        command: # touch /etc/dconf/db/local.d/00-disable-CAD
         Add the setting to disable the Ctrl-Alt-Delete sequence for the graphical user interface:
        [org/gnome/settings-daemon/plugins/media-keys]
        logout=''
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.8":
    title: '1.8.8 | Ensure users must authenticate users using MFA via a graphical user logon'
    section: 'GNOME Display Manager'
    description: |
        The operating system must uniquely identify and must authenticate users using multifactor authentication via a graphical
        user logon.
    remediation: |
        Configure the operating system to uniquely identify and authenticate users using multifactor authentication via a
        graphical user logon. Note:
         If the system does not have GNOME installed, this requirement is Not Applicable.               Create a database to
        contain the system-wide screensaver settings (if it does not already exist) with the following command: Note:
         The example is using the database local for the system, so if the system is using another database in
        "/etc/dconf/profile/user", the file should be created under the appropriate subdirectory.               # touch
        /etc/dconf/db/local.d/00-defaults
         Edit "[org/gnome/login-screen]" and add or update the following line: enable-smartcard-authentication=true
         Update the system databases: # dconf update
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.9":
    title: '1.8.9 | Ensure GNOME Screensaver period of inactivity is configured'
    section: 'GNOME Display Manager'
    description: |
        The operating system must initiate a screensaver after a 15minute period of inactivity for graphical user interfaces.
    remediation: |
        Configure the operating system to initiate a screensaver after a 15-minute period of inactivity for graphical user
        interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the
        following command: # touch /etc/dconf/db/local.d/00-screensaver

        Edit                  /etc/dconf/db/local.d/00-screensaver
         and add or update the following lines:
        Set the lock time out to                  900
         seconds before the session is considered idle
        You must include the                  uint32
         along with the integer key values as shown.
        [org/gnome/desktop/session]

        idle-delay=uint32 900
                       Update the system databases: # dconf update
         Impact: Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.10":
    title: '1.8.10 | Ensure screensaver lock-enabled is set'
    section: 'GNOME Display Manager'
    description: |
        The operating system must prevent a user from overriding the screensaver lockenabled setting for the graphical user
        interface.
    remediation: |
        Configure the operating system to prevent a user from overriding a screensaver lock after a 15-minute period of
        inactivity for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does
        not already exist) with the following command:
        Note: The example below is using the database                  local
         for the system, so if the system is using another database in                  /etc/dconf/profile/user
        , the file should be created under the appropriate subdirectory.               # touch
        /etc/dconf/db/local.d/locks/session
         Add the setting to lock the screensaver lock-enabled setting: /org/gnome/desktop/screensaver/lock-enabled
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.11":
    title: '1.8.11 | Ensure overriding the screensaver lock-delay setting is prevented'
    section: 'GNOME Display Manager'
    description: |
        The operating system must prevent a user from overriding the screensaver lockdelay setting for the graphical user
        interface.
    remediation: |
        Configure the operating system to prevent a user from overriding a screensaver lock after a 15-minute period of
        inactivity for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does
        not already exist) with the following command:
        Note: The example below is using the database                  local
         for the system, so if the system is using another database in                  /etc/dconf/profile/user
        , the file should be created under the appropriate subdirectory.               # touch
        /etc/dconf/db/local.d/locks/session
         Add the setting to lock the screensaver lock delay: /org/gnome/desktop/screensaver/lock-delay
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.12":
    title: '1.8.12 | Ensure session idle-delay settings is enforced'
    section: 'GNOME Display Manager'
    description: |
        The operating system must prevent a user from overriding the session idledelay setting for the graphical user interface.
    remediation: |
        Configure the operating system to prevent a user from overriding a session lock after a 15-minute period of inactivity
        for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does not already
        exist) with the following command:
        Note: The example below is using the database                  local
         for the system, so if the system is using another database in                  /etc/dconf/profile/user
        , the file should be created under the appropriate subdirectory.               # touch
        /etc/dconf/db/local.d/locks/session
         Add the setting to lock the session idle delay: /org/gnome/desktop/session/idle-delay
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.13":
    title: '1.8.13 | Ensure GNOME Idle activation is set'
    section: 'GNOME Display Manager'
    description: |
        The operating system must initiate a session lock for the screensaver after a period of inactivity for graphical user
        interfaces.  As part of this configuration idle activation has to be configured.
    remediation: |
        Configure the operating system to initiate a session lock after a 15-minute period of inactivity for graphical user
        interfaces. Create a database to contain the system-wide screensaver settings (if it does not already exist) with the
        following command: # touch /etc/dconf/db/local.d/00-screensaver
         Add the setting to enable screensaver locking after 15 minutes of inactivity:
        [org/gnome/desktop/screensaver]

        idle-activation-enabled=true
                       Update the system databases: # dconf update
         Impact: Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.13', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.14":
    title: '1.8.14 | Ensure the screensaver idle-activation-enabled setting'
    section: 'GNOME Display Manager'
    description: |
        The operating system must prevent a user from overriding the screensaver idleactivationenabled setting for the graphical
        user interface.
    remediation: |
        Configure the operating system to prevent a user from overriding a screensaver lock after a 15-minute period of
        inactivity for graphical user interfaces. Create a database to contain the system-wide screensaver settings (if it does
        not already exist) with the following command:
        Note: The example below is using the database                  local
         for the system, so if the system is using another database in                  /etc/dconf/profile/user
        , the file should be created under the appropriate subdirectory.               # touch
        /etc/dconf/db/local.d/locks/session
         Add the setting to lock the screensaver idle-activation-enabled setting: /org/gnome/desktop/screensaver/idle-
        activation-enabled
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.14', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.15":
    title: '1.8.15 | Ensure GNOME Lock Delay is configured'
    section: 'GNOME Display Manager'
    description: |
        The operating system must initiate a session lock for graphical user interfaces when the screensaver is activated.
        Please ensure the screensaver contains the lock delay system wide setting.
    remediation: |
        Configure the operating system to initiate a session lock for graphical user interfaces when a screensaver is activated.
        Create a database to contain the system-wide screensaver settings (if it does not already exist) with the following
        command: # touch /etc/dconf/db/local.d/00-screensaver
         Add the setting to enable session locking when a screensaver is activated:
        The                  uint32
         must be included along with the integer key values as shown.
        [org/gnome/desktop/screensaver]

        lock-delay=uint32 5
                       Update the system databases: # dconf update
         Impact: Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.15', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.16":
    title: '1.8.16 | Ensure automatic logon via GUI is not allowed'
    section: 'GNOME Display Manager'
    description: |
        The operating system must not allow an unattended or automatic logon to the system via a graphical user interface.
    remediation: |
        Configure the operating system to not allow an unattended or automatic logon to the system via a graphical user
        interface.
        Add or edit the line for the                  AutomaticLoginEnable
         parameter in the [daemon] section of the                  /etc/gdm/custom.conf
         file to                  false
        :
        Example:                  vim /etc/gdm/custom.conf

        [daemon]
        AutomaticLoginEnable=false
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.16', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.17":
    title: '1.8.17 | Ensure unrestricted logon is not allowed'
    section: 'GNOME Display Manager'
    description: |
        The operating system must not allow an unrestricted logon to the system.
    remediation: |
        Configure the operating system to not allow an unrestricted account to log on to the system via a graphical user
        interface.
        Add or edit the line for the                  TimedLoginEnable
         parameter in the [daemon] section of the                  /etc/gdm/custom.conf
         file to                  false
        :
        Example:                  vim /etc/gdm/custom.conf

        [daemon]
        TimedLoginEnable=false
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.17', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.8.18":
    title: '1.8.18 | Ensure graphical user interface automounter is disabled'
    section: 'GNOME Display Manager'
    description: |
        The Linux operating system must disable the graphical user interface automounter unless required.
    remediation: |
        Configure the graphical user interface to disable the ability to automount devices. Note:
         The example below is using the database "local" for the system, so the path is "/etc/dconf/db/local.d". This path must
        be modified if a database other than "local" is being used.               Create or edit the
        /etc/dconf/db/local.d/00-No-Automount file and add the following:
        [org/gnome/desktop/media-handling]

        automount=false

        automount-open=false

        autorun-never=true
                       Create or edit the /etc/dconf/db/local.d/locks/00-No-Automount file and add the following:
        /org/gnome/desktop/media-handling/automount

        /org/gnome/desktop/media-handling/automount-open

        /org/gnome/desktop/media-handling/autorun-never
                       Run the following command to update the database: # dconf update
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.8.18', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.9":
    title: '1.9 | Ensure updates patches and additional security software are installed - manual'
    section: 'Initial Setup'
    description: |
        Periodically patches are released for included software either due to security flaws or to include additional
        functionality. Note Site policy may mandate a testing period before install onto production systems for available
        updates.
    remediation: |
        Use your package manager to update all packages on the system according to site policy. The following command will
        install all available packages # yum update
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.10":
    title: '1.10 | Ensure required packages for multifactor authentication are installed'
    section: 'Initial Setup'
    description: |
        The operating system must have the required packages for multifactor authentication installed.
    remediation: |
        To configure the operating system to implement multifactor authentication by installing the required packages.
        Install the                esc
         and                pam_pkcs11
         packages on the system with the following command:             # yum install esc pam_pkcs11
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.11":
    title: '1.11 | Ensure anti-virus is installed and running - manual'
    section: 'Initial Setup'
    description: |
        The operating system must have virus scanning software installed.
    remediation: |
        Install an antivirus solution on the system. Document which solution is installed on the system with the ISSO.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.12":
    title: '1.12 | Ensure host-based intrusion detection tool is used - manual'
    section: 'Initial Setup'
    description: |
        The operating system must have a hostbased intrusion detection tool installed.
    remediation: |
        Install and enable the latest                McAfee HIPS
         package, available from USCYBERCOM.             Note: If the system does not support the McAfee HIPS package, install
        and enable a supported intrusion detection system application and document its use with the Authorizing Official.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_1.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.2.1.4":
    title: '2.2.1.4 | Ensure internal information system clocks are synchronizing'
    section: 'Time Synchronization'
    description: |
        The Linux operating system must, for networked systems, synchronize clocks with a server that is synchronized to one of
        the redundant United States Naval Observatory USNO time servers, a time server designated for the appropriate DoD
        network NIPRNet/SIPRNet, and/or the Global Positioning System GPS
    remediation: |
        Edit the "/etc/ntp.conf" or "/etc/chrony.conf" file and add or update an entry to define "maxpoll" to "10" as follows:
        server 0.rhel.pool.ntp.org iburst maxpoll 10
         If NTP was running and "maxpoll" was updated, the NTP service must be restarted: # systemctl restart ntpd
         If NTP was not running, it must be started: # systemctl start ntpd
         If "chronyd" was running and "maxpoll" was updated, the service must be restarted: # systemctl restart chronyd.service
         If "chronyd" was not running, it must be started: # systemctl start chronyd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.1.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.2":
    title: '2.2.2 | Ensure X11 Server components are not installed'
    section: 'Special Purpose Services'
    description: |
        The X Window System provides a Graphical User Interface GUI where users can have multiple windows in which to run
        programs and various add on. The X Windows system is typically used on workstations where users login, but not on
        servers where users typically do not login.
    remediation: |
        Run the following command to remove the X Windows Server packages: # yum remove xorg-x11-server*
         Impact: Many Linux systems run applications which require a Java runtime.  Some Linux Java packages have a dependency
        on specific X Windows xorg-x11-fonts.  One workaround to avoid this dependency is to use the "headless" Java packages
        for your specific Java runtime.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.8":
    title: '2.2.8 | Ensure FTP Server is not installed'
    section: 'Special Purpose Services'
    description: |
        FTP File Transfer Protocol is a traditional and widely used standard tool for transferring files between a server and
        clients over a network, especially where no authentication is necessary permits anonymous users to connect to a server.
    remediation: |
        Run the following command to remove                  vsftpd
        :               # yum remove vsftpd
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.14":
    title: '2.2.14 | Ensure NIS server is not installed'
    section: 'Special Purpose Services'
    description: |
        The              ypserv
         package provides the Network Information Service NIS.  This service, formally known as Yellow Pages, is a clientserver
        directory service protocol for distributing system configuration files. The NIS server is a collection of programs that
        allow for the distribution of configuration files.
    remediation: |
        Run the following command to remove                  ypserv
        :               # yum remove ypserv
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.14', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.20":
    title: '2.2.20 | Ensure the rsh package has been removed'
    section: 'Special Purpose Services'
    description: |
        The operating system must not have the rshserver package installed.
    remediation: |
        Configure the operating system to disable non-essential capabilities by removing the                  rsh-server
         package from the system with the following command:               # yum remove rsh-server
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.20', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.21":
    title: '2.2.21 | Ensure the TFTP server has not been installed'
    section: 'Special Purpose Services'
    description: |
        The operating system must not have the Trivial File Transfer Protocol TFTP server package installed if not required for
        operational support.
    remediation: |
        Remove the TFTP package from the system with the following command: # yum remove tftp-server
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.21', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.22":
    title: '2.2.22 | Ensure TFTP daemon is configured to operate in secure mode'
    section: 'Special Purpose Services'
    description: |
        The operating system must be configured so that if the Trivial File Transfer Protocol TFTP server is required, the TFTP
        daemon is configured to operate in secure mode.
    remediation: |
        Configure the TFTP daemon to operate in secure mode by adding the following line to                  /etc/xinetd.d/tftp
         (or modify the line to have the required value):               Example: vim /etc/xinetd.d/tftp Add this line.
        server_args = -s /var/lib/tftpboot
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.22', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.23":
    title: '2.2.23 | Ensure default SNMP community strings dont exist'
    section: 'Special Purpose Services'
    description: |
        SNMP community strings must be changed from the default values.
    remediation: |
        If the                  /etc/snmp/snmpd.conf
         file exists, modify any lines that contain a community string value of                  public
         or                  private
         to another string value.               Example: vim /etc/snmp/snmpd.conf
        Example of changing the                  public
         and                  private
         string value:               snmp-server community nEV8rM1ndthi$ RO
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.23', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.24":
    title: '2.2.24 | Ensure NFS is configured to use RPCSEC GSS'
    section: 'Special Purpose Services'
    description: |
        The operating system must be configured so that the Network File System NFS is configured to use RPCSECGSS.
    remediation: |
        Update the                  /etc/fstab
         file so the option                  sec
         is defined for each NFS mounted file system and the                  sec
         option does not have the                  sys
         setting.
        Example:                  vim /etc/fstab

        Ensure the                  sec
         option is defined as                  krb5:krb5i:krb5p
        .               192.168.21.5:/mnt/export /data1 nfs4 rw,sync ,soft,sec=krb5:krb5i:krb5p
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.24', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.25":
    title: '2.2.25 | Ensure unrestricted mail relaying is prevented'
    section: 'Special Purpose Services'
    description: |
        The operating system must be configured to prevent unrestricted mail relaying.
    remediation: |
        If                  postfix
         is installed, modify the                  /etc/postfix/main.cf
         file to restrict client connections to the local network with the following command:               Example: vim
        /etc/postfix/main.cf Add this line: # postconf -e 'smtpd_client_restrictions = permit_mynetworks,reject'
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.25', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.26":
    title: '2.2.26 | Ensure ldap tls cacert is set for LDAP.'
    section: 'Special Purpose Services'
    description: |
        The operating system must implement cryptography to protect the integrity of Lightweight Directory Access Protocol LDAP
        communications is set for ldaptlscacert.
    remediation: |
        Configure the operating system to implement cryptography to protect the integrity of LDAP remote access sessions.
        Add or modify the following line in                  /etc/sssd/sssd.conf
        :
        Example:                  vim /etc/sssd/sssd.conf
                       Add, uncomment or update the following line: ldap_tls_cacert = /etc/pki/tls/certs/ca-bundle.crt
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.26', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.27":
    title: '2.2.27 | Ensure ldap id use start tls is set for LDAP.'
    section: 'Special Purpose Services'
    description: |
        The operating system must implement cryptography to protect the integrity of Lightweight Directory Access Protocol LDAP
        authentication communications setting ldapidusestarttls.
    remediation: |
        Configure the operating system to implement cryptography to protect the integrity of LDAP authentication sessions.
        Add or modify the following line in                  /etc/sssd/sssd.conf
        :
        Example:                  vim /etc/sssd/sssd.conf
                       Add, uncomment or update the following line: ldap_id_use_start_tls = true
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.27', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "2.2.28":
    title: '2.2.28 | Ensure ldap tls reqcert is set for LDAP'
    section: 'Special Purpose Services'
    description: |
        The operating system must implement cryptography to protect the integrity of Lightweight Directory Access Protocol LDAP
        communications by setting ldaptlsreqcert.
    remediation: |
        Configure the operating system to implement cryptography to protect the integrity of LDAP remote access sessions.
        Add or modify the following line in                  /etc/sssd/sssd.conf
        :
        Example:                  vim /etc/sssd/sssd.conf
                       Add, uncomment or update the following line: ldap_tls_reqcert = demand
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.2.28', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "2.3.4":
    title: '2.3.4 | Ensure telnet client is not installed'
    section: 'Service Clients'
    description: |
        The              telnet
         package contains the              telnet
         client, which allows users to start connections to other systems via the telnet protocol.
    remediation: |
        Run the following command to remove the                  telnet
         package:               # yum remove telnet
         Impact: Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them
        can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to
        prevent accidental or intentional misuse.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_2.3.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "3.1.2":
    title: '3.1.2 | Ensure wireless interfaces are disabled - manual'
    section: 'Disable unused network protocols and devices'
    description: |
        Wireless networking is used when wired networks are unavailable.
    remediation: |
        Run the following script to disable any wireless interfaces:
        #!/bin/bash

        if command -v nmcli >/dev/null 2>&1 ; then
           nmcli radio all off
        else
           if [ -n "$(find /sys/class/net/*/ -type d -name wireless)" ]; then
              mname=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename
        "$(readlink -f "$driverdir"/device/driver/module)";done | sort -u)
              for dm in $mname; do
                 echo "install $dm /bin/true" >> /etc/modprobe.d/disable_wireless.conf
              done
           fi
        fi
                       Impact: Many if not all laptop workstations and some desktop workstations will connect via wireless
        requiring these interfaces be enabled.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.1.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "3.2.1":
    title: '3.2.1 | Ensure IP forwarding is disabled'
    section: 'Network Parameters (Host Only)'
    description: |
        The              net.ipv4.ipforward
         and              net.ipv6.conf.all.forwarding
         flags are used to tell the system whether it can forward packets or not.
    remediation: |
        Run the following commands to restore the default parameters and set the active kernel parameters: # grep -Els
        "^\s*net\.ipv4\.ip_forward\s*=\s*1" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf
        | while read filename; do sed -ri "s/^\s*(net\.ipv4\.ip_forward\s*)(=)(\s*\S+\b).*$/# *REMOVED* \1/" $filename; done;
        sysctl -w net.ipv4.ip_forward=0; sysctl -w net.ipv4.route.flush=1
         # grep -Els "^\s*net\.ipv6\.conf\.all\.forwarding\s*=\s*1" /etc/sysctl.conf /etc/sysctl.d/*.conf
        /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf | while read filename; do sed -ri
        "s/^\s*(net\.ipv6\.conf\.all\.forwarding\s*)(=)(\s*\S+\b).*$/# *REMOVED* \1/" $filename; done; sysctl -w
        net.ipv6.conf.all.forwarding=0; sysctl -w net.ipv6.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.2.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*net.ipv4.ip_forward\s*=\s*0\s*$'
            - name: Undefined
              rule: 'should cmp == ^\s*\bnet\.ipv6\.conf\.all\.forwarding\s*=\s*0\s*$'

  "3.2.2":
    title: '3.2.2 | Ensure packet redirect sending is disabled - manual'
    section: 'Network Parameters (Host Only)'
    description: |
        ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router in a host
        only configuration, there is no need to send redirects.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv4.conf.all.send_redirects = 0
        net.ipv4.conf.default.send_redirects = 0
                       Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv4.conf.all.send_redirects=0
        # sysctl -w net.ipv4.conf.default.send_redirects=0
        # sysctl -w net.ipv4.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.2.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.send_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.send_redirects=0'

  "3.3.1":
    title: '3.3.1 | Ensure source routed packets are not accepted - manual'
    section: 'Network Parameters (Host and Router)'
    description: |
        In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In
        contrast, nonsource routed packets travel a path determined by routers in the network. In some cases, systems may not be
        routable or reachable from some locations e.g. private addresses vs. Internet routable, and so source routed packets
        would need to be used.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv4.conf.all.accept_source_route = 0
        net.ipv4.conf.default.accept_source_route = 0
                       Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv4.conf.all.accept_source_route=0
        # sysctl -w net.ipv4.conf.default.accept_source_route=0
        # sysctl -w net.ipv4.route.flush=1
                       IF IPv6 is not disabled:
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv6.conf.all.accept_source_route = 0
        net.ipv6.conf.default.accept_source_route = 0
                       Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv6.conf.all.accept_source_route=0
        # sysctl -w net.ipv6.conf.default.accept_source_route=0
        # sysctl -w net.ipv6.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.3.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.default.accept_source_route=0'

  "3.3.2":
    title: '3.3.2 | Ensure ICMP redirects are not accepted - manual'
    section: 'Network Parameters (Host and Router)'
    description: |
        ICMP redirect messages are packets that convey routing information and tell your host acting as a router to send packets
        via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By
        setting              net.ipv4.conf.all.acceptredirects
         and              net.ipv6.conf.all.acceptredirects
         to 0, the system will not accept any ICMP redirect messages, and therefore, wont allow outsiders to update the systems
        routing tables.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv4.conf.all.accept_redirects = 0
        net.ipv4.conf.default.accept_redirects = 0
                       Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv4.conf.all.accept_redirects=0
        # sysctl -w net.ipv4.conf.default.accept_redirects=0
        # sysctl -w net.ipv4.route.flush=1
                       IF IPv6 is not disabled
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv6.conf.all.accept_redirects = 0
        net.ipv6.conf.default.accept_redirects = 0
                       Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv6.conf.all.accept_redirects=0
        # sysctl -w net.ipv6.conf.default.accept_redirects=0
        # sysctl -w net.ipv6.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.3.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.default.accept_redirects=0'

  "3.3.3":
    title: '3.3.3 | Ensure network interfaces are not in promiscuous mode - manual'
    section: 'Network Parameters (Host and Router)'
    description: |
        Network interfaces configured on the operating system must not be in promiscuous mode.
    remediation: |
        Configure network interfaces to turn off promiscuous mode unless approved and documented. Set the promiscuous mode of an
        interface to off with the following command: # ip link set dev <devicename> multicast off promisc off
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.3.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "3.3.6":
    title: '3.3.6 | Ensure broadcast ICMP requests are ignored - manual'
    section: 'Network Parameters (Host and Router)'
    description: |
        Setting              net.ipv4.icmpechoignorebroadcasts
         to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:               net.ipv4.icmp_echo_ignore_broadcasts = 1
         Run the following commands to set the active kernel parameters:
        # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1
        # sysctl -w net.ipv4.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.3.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.icmp_echo_ignore_broadcasts=1'

  "3.3.8":
    title: '3.3.8 | Ensure Reverse Path Filtering is enabled - manual'
    section: 'Network Parameters (Host and Router)'
    description: |
        Setting              net.ipv4.conf.all.rpfilter
         and              net.ipv4.conf.default.rpfilter
         to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was
        valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the
        corresponding source packet came from, the packet is dropped and logged if              logmartians
         is set.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a                  /etc/sysctl.d/*
         file:
        net.ipv4.conf.all.rp_filter = 1
        net.ipv4.conf.default.rp_filter = 1
                       Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.rp_filter=1
         # sysctl -w net.ipv4.conf.default.rp_filter=1
         # sysctl -w net.ipv4.route.flush=1
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.3.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.rp_filter=1'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.rp_filter=1'

  "3.4.1":
    title: '3.4.1 | Ensure DCCP is disabled'
    section: 'Uncommon Network Protocols'
    description: |
        The Datagram Congestion Control Protocol DCCP is a transport layer protocol that supports streaming media and telephony.
        DCCP provides a way to gain access to congestion control, without having to do it at the application layer, but does not
        provide insequence delivery.
    remediation: |
        Edit or create a file in the                  /etc/modprobe.d/
         directory ending in .conf
        Example:                    vim /etc/modprobe.d/dccp.conf
                         Add the following line: install dccp /bin/true
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.4.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "3.5.1.4":
    title: '3.5.1.4 | Ensure firewalld service enabled and running'
    section: 'Configure firewalld'
    description: |
        firewalld.service
         enables the enforcement of firewall rules configured through                firewalld
    remediation: |
        Run the following command to unmask                    firewalld
                         # systemctl unmask firewalld

        Run the following command to enable and start                    firewalld
                         # systemctl --now enable firewalld
         Impact: Changing firewall settings while connected over network can result in being locked out of the system.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.5.1.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "3.5.1.5":
    title: '3.5.1.5 | Ensure firewalld default zone is set'
    section: 'Configure firewalld'
    description: |
        A firewall zone defines the trust level for a connection, interface or source address binding. This is a one to many
        relation, which means that a connection, interface or source can only be part of one zone, but a zone can be used for
        many network connections, interfaces and sources. The default zone is the zone that is used for everything that is not
        explicitly bound/assigned to another zone. If no zone assigned to a connection, interface or source, only the default
        zone is used. The default zone is not always listed as being used for an interface or source as it will be used for it
        either way. This depends on the manager of the interfaces. Connections handled by NetworkManager are listed as
        NetworkManager requests to add the zone binding for the interface used by the connection. Also interfaces under control
        of the network service are listed also because the service requests it. Note A firewalld zone configuration file
        contains the information for a zone. These are the zone description, services, ports, protocols, icmpblocks, masquerade,
        forwardports and rich language rules in an XML file format.
        The file name has to be                        zonename.xml
         where length of                        zonename
         is currently limited to 17 chars.                     NetworkManager binds interfaces to zones automatically
    remediation: |
        Run the following command to set the default zone: # firewall-cmd --set-default-zone=<NAME_OF_ZONE>
         Example: # firewall-cmd --set-default-zone=public
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.5.1.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "3.5.3.2.3":
    title: '3.5.3.2.3 | Ensure iptables rules exist for all open ports - manual'
    section: 'Configure IPv4 iptables'
    description: |
        Any ports that have been opened on nonloopback addresses need firewall rules to govern traffic.
    remediation: |
        For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound
        connections: # iptables -A INPUT -p <protocol> --dport <port> -m state --state NEW -j ACCEPT
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.5.3.2.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "3.5.4":
    title: '3.5.4 | Ensure IP tunnels are not configured'
    section: 'Firewall Configuration'
    description: |
        The operating system must not have unauthorized IP tunnels configured.
    remediation: |
        Remove all unapproved tunnels from the system, or document them with the Authorizing Official.
        To remove them edit the                  /etc/ipsec.conf
         and                  /etc/ipsec.d/*.conf
         files removing any lines indicating a                  conn
         parameter is configured.
        Example:                  vim /etc/ipsec.conf
                       Remove and lines with a "conn" parameter set.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_3.5.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.1.2":
    title: '4.1.1.2 | Ensure auditd service is enabled and running'
    section: 'Ensure auditing is enabled'
    description: |
        Turn on the                auditd
         daemon to record system events.
    remediation: |
        Run the following command to enable and start                    auditd
         :                 # systemctl --now enable auditd
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.1.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "4.1.2.3":
    title: '4.1.2.3 | Ensure audit system is set to single when the disk is full.'
    section: 'Configure Data Retention'
    description: |
        The operating system must be configured so that the audit system takes appropriate action when the audit storage volume
        is full.
    remediation: |
        Configure the action the operating system takes if the disk the audit records are written to becomes full.
        Uncomment or edit the                    disk_full_action
         option in                    /etc/audisp/audisp-remote.conf
        .
        Example:                    vim /etc/audisp/audisp-remote.conf

        Set it to                    syslog
        ,                    single
        , or                    halt
        , such as the following example:                 disk_full_action = single
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.4":
    title: '4.1.2.4 | Ensure system notification is sent out when volume is 75 full - manual'
    section: 'Configure Data Retention'
    description: |
        The operating system must initiate an action to notify the Authorizing Official, at a minimum, when allocated audit
        record storage volume reaches 75 of the repository maximum audit record storage capacity.
    remediation: |
        Configure the operating system to initiate an action to notify the Authorizing Official (at a minimum) when allocated
        audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity. Check the system
        configuration to determine the partition the audit records are being written to: # grep -iw log_file
        /etc/audit/auditd.conf

        Determine the size of the partition that audit records are written to (with the example being
        /var/log/audit/
        ):                 # df -h /var/log/audit/

        Set the value of the                    space_left
         keyword in                    /etc/audit/auditd.conf
         to 75 percent of the partition size.
        Example:                    vim /etc/audit/auditd.conf

        Add the line with space_left set to                    75%
         or the partition size.                 Example: space_left = 225
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.2.5":
    title: '4.1.2.5 | Ensure system is disabled when audit logs are full'
    section: 'Configure Data Retention'
    description: |
        The                auditd
         daemon can be configured to halt the system when the audit logs are full.
    remediation: |
        Set the following parameters in                    /etc/audit/auditd.conf:

        space_left_action = email
        action_mail_acct = root
        admin_space_left_action = halt
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.6":
    title: '4.1.2.6 | Ensure audit system action is defined for sending errors'
    section: 'Configure Data Retention'
    description: |
        The operating system must be configured so that the audit system takes appropriate action when there is an error sending
        audit records to a remote system.
    remediation: |
        Configure the action the operating system takes if there is an error sending audit records to a remote system.
        Uncomment the                    network_failure_action
         option in                    /etc/audisp/audisp-remote.conf
         and set it to                    syslog
        ,                    single
        , or                    halt
        .
        Example:                    vim /etc/audisp/audisp-remote.conf
                         Add the line as shown in below network_failure_action = syslog
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.8":
    title: '4.1.2.8 | Ensure audit logs are stored on a different system. - manual'
    section: 'Configure Data Retention'
    description: |
        The operating system must offload audit records onto a different system or media from the system being audited.
    remediation: |
        Configure the operating system to off-load audit records onto a different system or media from the system being audited.
        Set the remote server option in                    /etc/audisp/audisp-remote.conf
         with the IP address of the log aggregation server.
        Example:                    vim /etc/audisp/audisp-remote.conf
                         Add, uncomment or update the following line: Note:
          The ip address listed is just for an example.  Replace it with the IP address or the log aggregation server in your
        environment.                 remote_server = 10.0.21.1
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.2.9":
    title: '4.1.2.9 | Ensure audit logs on separate system are encrypted.'
    section: 'Configure Data Retention'
    description: |
        The operating system must encrypt the transfer of audit records offloaded onto a different system or media from the
        system being audited and encrypted the records.
    remediation: |
        Configure the operating system to encrypt the transfer of off-loaded audit records onto a different system or media from
        the system being audited.
        Add or update the                    /etc/audisp/audisp-remote.conf
         and set it with the following line:
        Example:                    vim /etc/audisp/audisp-remote.conf
                         Add, uncomment or update the following line: enable_krb5 = yes
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.10":
    title: '4.1.2.10 | Ensure the auditing processing failures are handled.'
    section: 'Configure Data Retention'
    description: |
        The operating system must shut down upon audit processing failure, unless availability is an overriding concern. If
        availability is a concern, the system must alert the designated staff in the event of an audit processing failure.
    remediation: |
        Configure the operating system to shut down or notify staff in the event of an audit processing failure. To add or
        correct the option to shut down the operating system use the following command: # auditctl -f 2

        Edit the                    /etc/audit/rules.d/audit.rules
         file and add the following line:
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add this line: -f 2
         If availability has been determined to be more important, and this decision is documented with the Authorizing
        Official, configure the operating system to notify the
        appropriate staff in the event of an audit processing failure with the following command: # auditctl -f 1

        Edit the                    /etc/audit/rules.d/audit.rules
         file and add the following line:
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add this line: -f 1
         The audit daemon must be restarted for changes to take effect: # service auditd restart
         Impact: Kernel log monitoring must also be configured to properly alert designated staff.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.11":
    title: '4.1.2.11 | Enure off-load of audit logs.'
    section: 'Configure Data Retention'
    description: |
        The operating system must configure the auremote plugin to offload audit logs using the audispremote daemon.
    remediation: |
        Edit the                    /etc/audisp/plugins.d/au-remote.conf
         file and add, uncomment or update the following values:
        Example:                    vim /etc/audisp/plugins.d/au-remote.conf
                         Add uncomment or update the following lines:
        direction = out
        path = /sbin/audisp-remote
        type = always
                         The audit daemon must be restarted for changes to take effect: # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.12":
    title: '4.1.2.12 | Ensure action is taken when audisp-remote buffer is full'
    section: 'Configure Data Retention'
    description: |
        The operating system must take appropriate action when the audispremote buffer is full.
    remediation: |
        Edit the                    /etc/audisp/audispd.conf
         file and add or update the                    overflow_action
         option:
        Example:                    vim /etc/audisp/audispd.conf
                         Add, update or uncomment the following line: overflow_action = syslog
         The audit daemon must be restarted for changes to take effect: # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2.13":
    title: '4.1.2.13 | Ensure off-loaded audit logs are labeled.'
    section: 'Configure Data Retention'
    description: |
        The operating system must label all offloaded audit logs before sending them to the central log server.
    remediation: |
        Edit the                    /etc/audisp/audispd.conf
         file and add or update the                    name_format
         option:
        Example:                    vim /etc/audisp/audispd.conf

        Add the name format to include                    hostname
        ,                    fqd
        , or                    numeric
        .                 Example: name_format = hostname
         The audit daemon must be restarted for changes to take effect: # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.2.13', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.3.7":
    title: '4.1.3.7 | Ensure kernel module loading and unloading is collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor the loading and unloading of kernel modules. The programs                insmod
         install a kernel module,                rmmod
         remove a kernel module, and                modprobe
         a more sophisticated program to load and unload modules, as well as some other features control loading and unloading
        of modules. The                initmodule
         load a module and                deletemodule
         delete a module system calls control loading and unloading of modules. Any execution of the loading and unloading
        module programs and system calls will trigger an audit record with an identifier of modules.
        Note Reloading the auditd config to set active settings requires the                  auditd
         service to be restarted, and may require a system reboot.
    remediation: |
        For 32 bit systems Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-modules.rules
                           Add the following lines:
        -w /sbin/insmod -p x -k modules
        -w /sbin/rmmod -p x -k modules
        -w /sbin/modprobe -p x -k modules
        -a always,exit -F arch=b32 -S init_module -S delete_module -k modules

        For 64 bit systems Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-modules.rules
                           Add the following lines:
        -w /sbin/insmod -p x -k modules
        -w /sbin/rmmod -p x -k modules
        -w /sbin/modprobe -p x -k modules
        -a always,exit -F arch=b64 -S init_module -S delete_module -k modules
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/insmod\/?\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/rmmod\/?\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/modprobe\/?\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/insmod\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/rmmod\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/sbin\/modprobe\s+-p\s+x\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(always,exit|exit,always)\s+-F\s+arch=b32\s+(-S\s+init_module\s+-S\s+delete_module|-S\s+delete_module\s+-S\s+init_module)\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?:init_module,delete_module|delete_module,init_module)\s+-F\s+key=\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?:init_module,delete_module|delete_module,init_module)\s+-F\s+key=\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(always,exit|exit,always)\s+-F\s+arch=b64\s+(-S\s+init_module\s+-S\s+delete_module|-S\s+delete_module\s+-S\s+init_module)\s+-k\s+\H+(\h+.*)?$'

  "4.1.3.8":
    title: '4.1.3.8 | Ensure changes to system administration scope sudoers is collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor scope changes for system administrators. If the system has been properly configured to force system
        administrators to log in as themselves first and then use the                sudo
         command to execute privileged commands, it is possible to monitor changes in scope. The file
        /etc/sudoers
         or a file in the                /etc/sudoers.d
         directory will be written to when the file or its attributes have changed.             Note Reloading the auditd config
        to set active settings may require a system reboot.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        _Example:                    vi /etc/audit/rules.d/50-scope.rules
                         Add the following lines:
        -w /etc/sudoers -p wa -k scope
        -w /etc/sudoers.d/ -p wa -k scope
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/sudoers\/?\s+-p\s+wa\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/sudoers\.d\/?\s+-p\s+wa\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/sudoers\/?\s+-p\s+wa\s+-k\s+\H+(\h+.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/sudoers\.d\/?\s+-p\s+wa\s+-k\s+\H+(\h+.*)?$'

  "4.1.3.9":
    title: '4.1.3.9 | Ensure file deletion events by users are collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor the use of system calls associated with the deletion or renaming of files and file attributes. This
        configuration statement sets up monitoring for following system calls and tags them with the identifier delete unlink
          remove a file               unlinkat
          remove a file attribute               rename
          rename a file               renameat
          rename a file attribute               Note
         Systems may have been customized to change the default UIDMIN.  To confirm the UIDMIN for your system, run the
        following command              awk /\sUIDMIN/print 2 /etc/login.defs

        If your systems UIDMIN is not                1000
        , replace                audit1000
         with                auditUIDMIN for your system
         in the Audit and Remediation procedures.             Reloading the auditd config to set active settings may require a
        system reboot.
    remediation: |
        For 32 bit systems edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-deletion.rules
                           Add the following lines: -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F
        auid>=1000 -F auid!=4294967295 -k delete

        For 64 bit systems edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-deletion.rules
                           Add the following lines:
        -a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete
        -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\3|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\2|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\2|\3))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\3|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\2|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\2|\3))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\3|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\2|\4))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)(?!(?:\1|\2|\3))(-S\s+unlink\s+|-S\s+unlinkat\s+|-S\s+rename\s+|-S\s+renameat\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\3|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\2|\4))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])(?!(?:\1|\2|\3))(unlink[,\s]|rename[,\s]|unlinkat[,\s]|renameat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'

  "4.1.3.10":
    title: '4.1.3.10 | Ensure use of privileged commands is collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor privileged programs those that have the setuid and/or setgid bit set on execution to determine if unprivileged
        users are running these commands. Note
         Systems may have been customized to change the default UIDMIN.  To confirm the UIDMIN for your system, run the
        following command              awk /\sUIDMIN/print 2 /etc/login.defs

        If your systems UIDMIN is not                1000
        , replace                audit1000
         with                auditUIDMIN for your system
         in the Audit and Remediation procedures.             Reloading the auditd config to set active settings may require a
        system reboot.
    remediation: |
        To remediate this issue, the system administrator will have to execute a find command to locate all the privileged
        programs and then add an audit line for each one of them. The audit parameters associated with this are as follows: -F
        path=" $1 "
         - will populate each file name found through the find command and processed by awk.                   -F perm=x
         - will write an audit record if the file is executed.                   -F audit>=1000
         - will write a record if the user executing the command is not a privileged user.                   -F auid!=
        4294967295
         - will ignore Daemon events                   All audit records should be tagged with the identifier "privileged".
        Run the following command replacing
         with a list of partitions where programs can be executed from on your system:                 # find <partition> -xdev
        \( -perm -4000 -o -perm -2000 \) -type f | awk '{print "-a always,exit -F path=" $1 " -F perm=x -F auid>='"$(awk
        '/^\s*UID_MIN/{print $2}' /etc/login.defs)"' -F auid!=4294967295 -k privileged" }'

        Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules
         and add all resulting lines to the file.                 Example: # find / -xdev \( -perm -4000 -o -perm -2000 \) -type
        f | awk '{print "-a always,exit -F path=" $1 " -F perm=x -F auid>='"$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)"'
        -F auid!=4294967295 -k privileged" }' >> /etc/audit/rules.d/50-privileged.rules
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.3.11":
    title: '4.1.3.11 | Ensure unsuccessful unauthorized file access attempts are collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor for unsuccessful attempts to access files. The parameters below are associated with system calls that control
        creation                 creat
         , opening                 open
         ,                openat
          and truncation                 truncate
         ,                ftruncate
          of files. An audit log record will only be written if the user is a nonprivileged user auid1000, is not a Daemon event
        auid4294967295 and if the system call returned EACCES permission denied to the file or EPERM some other permanent error
        associated with the specific system call. All audit records will be tagged with the identifier access.             Note
         Systems may have been customized to change the default UIDMIN.  To confirm the UIDMIN for your system, run the
        following command              awk /\sUIDMIN/print 2 /etc/login.defs

        If your systems UIDMIN is not                1000
        , replace                audit1000
         with                auditUIDMIN for your system
         in the Audit and Remediation procedures.             Reloading the auditd config to set active settings may require a
        system reboot.
    remediation: |
        For 32 bit systems Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-access.rules
                           Add the following lines:
        -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F
        auid!=4294967295 -k access
        -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F
        auid!=4294967295 -k access

        For 64 bit systems Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-access.rules
                           Add the following lines:
        -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F
        auid!=4294967295 -k access
        -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F
        auid!=4294967295 -k access
        -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F
        auid!=4294967295 -k access
        -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F
        auid!=4294967295 -k access
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\4))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\4))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\4))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\4))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\4))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\3|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\4|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\5))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)(?!(?:\1|\2|\3|\4))(-S\s+creat\s+|-S\s+open\s+|-S\s+openat\s+|-S\s+truncate\s+|-S\s+ftruncate\s+)-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\4))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\3|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\4|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\5))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])(?!(?:\1|\2|\3|\4))(open[,\s]|creat[,\s]|truncate[,\s]|ftruncate[,\s]|openat[,\s])-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'

  "4.1.3.12":
    title: '4.1.3.12 | Ensure discretionary access control permission modification events are collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for
        system calls that affect file permissions and attributes. The                chmod
         ,                fchmod
         and                fchmodat
          system calls affect the permissions associated with a file. The                chown
         ,                fchown
         ,                fchownat
         and                lchown
          system calls affect owner and group attributes on a file. The                setxattr
         ,                lsetxattr
         ,                fsetxattr
         set extended file attributes and                removexattr
         ,                lremovexattr
         ,                fremovexattr
         remove extended file attributes control extended file attributes. In all cases, an audit record will only be written
        for nonsystem user ids auid 1000 and will ignore Daemon events auid  4294967295. All audit records will be tagged with
        the identifier permmod.             Note
         Systems may have been customized to change the default UIDMIN.  To confirm the UIDMIN for your system, run the
        following command              awk /\sUIDMIN/print 2 /etc/login.defs

        If your systems UIDMIN is not                1000
        , replace                audit1000
         with                auditUIDMIN for your system
         in the Audit and Remediation procedures.             Reloading the auditd config to set active settings may require a
        system reboot.
    remediation: |
        For 32 bit systems edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-perm_mod.rules
                           Add the following lines:
        -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F
        auid>=1000 -F auid!=4294967295 -k perm_mod

        For 64 bit systems Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-perm_mod.rules
                           Add the following lines:
        -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F
        auid>=1000 -F auid!=4294967295 -k perm_mod
        -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F
        auid>=1000 -F auid!=4294967295 -k perm_mod
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)(?!(?:\1|\3))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)(?!(?:\1|\2))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\3|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\2|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\2|\3))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?!(?:\2|\3|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\3|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\4|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\4|\5))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\3|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\4|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\4|\5))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])(?!(?:\1|\3))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])(?!(?:\1|\2))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+-S\s+(?!(?:\2|\3|\4))(lchown[,\s]|fchown[,\s]|chown[,\s]|fchownat[,\s])(?!(?:\1|\3|\4))(lchown[,\s]|fchown[,\s]|chown[,\s]|fchownat[,\s])(?!(?:\1|\2|\4))(lchown[,\s]|fchown[,\s]|chown[,\s]|fchownat[,\s])(?!(?:\1|\2|\3))(lchown[,\s]|fchown[,\s]|chown[,\s]|fchownat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)(?!(?:\1|\3))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)(?!(?:\1|\2))(-S\s+chmod\s+|-S\s+fchmod\s+|-S\s+fchmodat\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\3|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\2|\4))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)(?!(?:\1|\2|\3))(-S\s+chown\s+|-S\s+fchown\s+|-S\s+fchownat\s+|-S\s+lchown\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?!(?:\2|\3|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\3|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\4|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\5|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\4|\6))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)(?!(?:\1|\2|\3|\4|\5))(-S\s+setxattr\s+|-S\s+lsetxattr\s+|-S\s+fsetxattr\s+|-S\s+removexattr\s+|-S\s+lremovexattr\s+|-S\s+fremovexattr\s+)-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3|\4))(chown[,\s]|fchown[,\s]|lchown[,\s]|fchownat[,\s])(?!(?:\1|\3|\4))(chown[,\s]|fchown[,\s]|lchown[,\s]|fchownat[,\s])(?!(?:\1|\2|\4))(chown[,\s]|fchown[,\s]|lchown[,\s]|fchownat[,\s])(?!(?:\1|\2|\3))(chown[,\s]|fchown[,\s]|lchown[,\s]|fchownat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\3|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\4|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\5|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\4|\6))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])(?!(?:\1|\2|\3|\4|\5))(setxattr[,\s]|lsetxattr[,\s]|fsetxattr[,\s]|removexattr[,\s]|lremovexattr[,\s]|fremovexattr[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+-S\s+(?!(?:\2|\3))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])(?!(?:\1|\3))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])(?!(?:\1|\2))(chmod[,\s]|fchmod[,\s]|fchmodat[,\s])-F\s+auid>=1000\s+-F\s+auid!=-1\s+-F\s+key=\S+ *$'

  "4.1.3.13":
    title: '4.1.3.13 | Ensure login and logout events are collected - manual'
    section: 'Configure auditd rules'
    description: |
        Monitor login and logout events. The parameters below track changes to files associated with login/logout events.
        The file                  /var/log/lastlog
         maintain records of the last time a user successfully logged in.
        The                  /var/run/faillock/
         directory maintains records of login failures via the                  pamfaillock
         module.
        Note Reloading the auditd config to set active settings requires the                  auditd
         service to be restarted, and may require a system reboot.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-logins.rules
                           Add the following lines:
        -w /var/log/lastlog -p wa -k logins
        -w /var/run/faillock/ -p wa -k logins
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.13', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/var\/log\/lastlog\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/var\/log\/lastlog\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/var\/run\/faillock\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/var\/run\/faillock\/?\s+-p\s+wa\s+-k\s+\S+'

  "4.1.3.14":
    title: '4.1.3.14 | Ensure events that modify usergroup information are collected - manual'
    section: 'Configure auditd rules'
    description: |
        Record events affecting the                group
         ,                passwd
         user IDs,                shadow
         and                gshadow
         passwords or                /etc/security/opasswd
         old passwords, based on remember parameter in the PAM configuration files. The parameters in this section will watch
        the files to see if they have been opened for write or have had attribute changes e.g. permissions and tag them with the
        identifier identity in the audit log file.
        Note Reloading the                  auditd
         config to set active settings may require a system reboot.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory ending in                    .rules

        Example:                      vi /etc/audit/rules.d/50-identity.rules
                           Add the following lines:
        -w /etc/group -p wa -k identity
        -w /etc/passwd -p wa -k identity
        -w /etc/gshadow -p wa -k identity
        -w /etc/shadow -p wa -k identity
        -w /etc/security/opasswd -p wa -k identity
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.14', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/group\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/passwd\/?\s+-p wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/gshadow\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/shadow\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^\s*-w\s+\/etc\/security\/opasswd\/?\s+-p\s+wa\s+-k\s+\S+'
            - name: Undefined
              rule: 'should cmp == ^-w\s+\/etc\/security\/opasswd\s+-p\s+wa\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^-w\s+\/etc\/group\s+-p\s+wa\s+-k\s+\S+ *$'
            - name: Undefined
              rule: 'should cmp == ^-w \/etc\/passwd -p wa -k \S+ *$'
            - name: Undefined
              rule: 'should cmp == ^-w \/etc\/gshadow -p wa -k \S+ *$'
            - name: Undefined
              rule: 'should cmp == ^-w \/etc\/shadow -p wa -k \S+ *$'

  "4.1.3.15":
    title: '4.1.3.15 | Ensure all uses of the passwd command are audited. - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the passwd command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        passwd
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, update or uncomment this line below -a always,exit -F path=/usr/bin/passwd -F auid>=1000 -F
        auid!=4294967295 -k privileged-passwd
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.15', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/passwd\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.16":
    title: '4.1.3.16 | Ensure auditing of the unix chkpwd command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the unixchkpwd command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        unix_chkpwd
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update this line: -a always,exit -F path=/usr/sbin/unix_chkpwd -F auid>=1000 -F
        auid!=4294967295 -k privileged-passwd
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.16', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/unix_chkpwd\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.17":
    title: '4.1.3.17 | Ensure audit of the gpasswd command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the gpasswd command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        gpasswd
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/gpasswd -F auid>=1000 -F
        auid!=4294967295 -k privileged-passwd
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.17', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/gpasswd\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.18":
    title: '4.1.3.18 | Ensure audit all uses of chage - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the chage command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        chage
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the line: -a always,exit -F path=/usr/bin/chage -F auid>=1000 -F
        auid!=4294967295 -k privileged-passwd
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.18', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/chage\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.19":
    title: '4.1.3.19 | Ensure audit all uses of the chsh command. - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the chsh command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        chsh
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/chsh -F auid>=1000 -F
        auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.19', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/chsh\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.20":
    title: '4.1.3.20 | Ensure audit the umount command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the umount command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        umount
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/umount -F auid>=1000 -F
        auid!=4294967295 -k privileged-mount
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.20', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/umount\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.21":
    title: '4.1.3.21 | Ensure audit of postdrop command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the postdrop command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        postdrop
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/postdrop -F auid>=1000 -F
        auid!=4294967295 -k privileged-postfix
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.21', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/postdrop\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.22":
    title: '4.1.3.22 | Ensure audit of postqueue command. - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the postqueue command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        postqueue
         command occur.                 Add or update the following rule in  /etc/audit/rules.d/audit.rules`:
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/postqueue -F auid>=1000
        -F auid!=4294967295 -k privileged-postfix
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.22', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/postqueue\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+(\h+#.*)?$'

  "4.1.3.23":
    title: '4.1.3.23 | Ensure audit ssh-keysign command. - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the sshkeysign command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        ssh-keysign
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F
        auid>=1000 -F auid!=4294967295 -k privileged-ssh
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.23', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/libexec\/openssh\/ssh-keysign\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.24":
    title: '4.1.3.24 | Ensure audit of crontab command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the crontab command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        crontab
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/crontab -F auid>=1000 -F
        auid!=4294967295 -k privileged-cron
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.24', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/crontab\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.25":
    title: '4.1.3.25 | Ensure audit of kmod command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the kmod command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        kmod
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -w /usr/bin/kmod -p x -F auid!=4294967295 -k module-change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.25', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-w\h+\/usr\/bin\/kmod\h+-p\h+x\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.26":
    title: '4.1.3.26 | Ensure audit of the rmdir syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the rmdir syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        rmdir
         syscall occur.
        Add the following rules in                    /etc/audit/rules.d/audit.rules
        :                 Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines
        appropriate for the system architecture must be configured.
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line that fits your system architecture:
        -a always,exit -F arch=b32 -S rmdir -F auid>=1000 -F auid!=4294967295 -k delete

        -a always,exit -F arch=b64 -S rmdir -F auid>=1000 -F auid!=4294967295 -k delete
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.26', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b32\h+-S\h+rmdir\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b64\h+-S\h+rmdir\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.27":
    title: '4.1.3.27 | Ensure audit of unlink syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the unlink syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        unlink
         syscall occur.
        Add the following rules in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line depending on your system architecture: Note: The rules are
        duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be
        configured.
        -a always,exit -F arch=b32 -S unlink -F auid>=1000 -F auid!=4294967295 -k delete

        -a always,exit -F arch=b64 -S unlink -F auid>=1000 -F auid!=4294967295 -k delete
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.27', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b32\h+-S\h+unlink\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b64\h+-S\h+unlink\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.28":
    title: '4.1.3.28 | Ensure audit unlinkat syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the unlinkat syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        unlinkat
         syscall occur.
        Add the following rules in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment, update the following line for the appropriate system architecture. Note: The rules are
        duplicated to cover both 32-bit and 64-bit architectures. Only the lines appropriate for the system architecture must be
        configured.
        -a always,exit -F arch=b32 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k delete

        -a always,exit -F arch=b64 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k delete
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.28', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b32\h+-S\h+unlinkat\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b64\h+-S\h+unlinkat\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.29":
    title: '4.1.3.29 | Ensure audit pam timestamp check command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the pamtimestampcheck command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        pam_timestamp_check
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/pam_timestamp_check -F
        auid>=1000 -F auid!=4294967295 -k privileged-pam
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.29', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/pam_timestamp_check\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.30":
    title: '4.1.3.30 | Ensure audit of the finit module syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the finitmodule syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        finit_module
         syscall occur.
        Add or update the following rules in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines
        appropriate for the system architecture must be configured. Add, uncomment or update the following line for the
        appropriate architecture:
        -a always,exit -F arch=b32 -S finit_module -k module-change

        -a always,exit -F arch=b64 -S finit_module -k module-change
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.30', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b32\h+-S\h+finit_module\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b64\h+-S\h+finit_module\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.31":
    title: '4.1.3.31 | Ensure audit of the create module syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the createmodule syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        create_module
         syscall occur.
        Add or update the following rules in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines
        appropriate for the system architecture must be configured. Add, uncomment or update the following line appropriate for
        the architecture you are running.
        -a always,exit -F arch=b32 -S create_module -k module-change

        -a always,exit -F arch=b64 -S create_module -k module-change
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.31', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b32\h+-S\h+create_module\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+arch=b64\h+-S\h+create_module\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.32":
    title: '4.1.3.32 | Ensure auditing of all privileged functions - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all executions of privileged functions.
    remediation: |
        Configure the operating system to audit the execution of privileged functions.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines
        appropriate for the system architecture must be configured.
        -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid
        -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid
        -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid
        -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.32', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*^-a\h+(always,exit|exit,always)\h+-F\h+arch=b32\h+(?!(\2|\3))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(?!(\1|\3))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(?!(\1|\2))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(-k\h+\H+|key=\H+)\h*(#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*^-a\h+(always,exit|exit,always)\h+-F\h+arch=b64\h+(?!(\2|\3))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(?!(\1|\3))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(?!(\1|\2))(-S\h+execve|-C\h+(?:uid!=euid|euid!=uid)|-F\h+euid=0)\h+(-k\h+\H+|key=\H+)\h*(#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*^-a\h+(always,exit|exit,always)\h+-F\h+arch=b32\h+(?!(\2|\3))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(?!(\1|\3))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(?!(\1|\2))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(-k\h+\H+|key=\H+)\h*(#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*^-a\h+(always,exit|exit,always)\h+-F\h+arch=b64\h+(?!(\2|\3))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(?!(\1|\3))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(?!(\1|\2))(-S\h+execve|-C\h+(?:gid!=egid|egid!=gid)|-F\h+egid=0)\h+(-k\h+\H+|key=\H+)\h*(#.*)?$'

  "4.1.3.33":
    title: '4.1.3.33 | Ensure audit of semanage command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the semanage command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        semanage
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/semanage -F auid>=1000 -F
        auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.33', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/semanage\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.34":
    title: '4.1.3.34 | Ensure audit of the setsebool command. - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the setsebool command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        setsebool
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/setsebool -F auid>=1000
        -F auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.34', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/setsebool\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.35":
    title: '4.1.3.35 | Ensure audit of the chcon command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the chcon command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        chcon
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/chcon -F auid>=1000 -F
        auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.35', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/chcon\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.36":
    title: '4.1.3.36 | Ensure audit of the userhelper command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the userhelper command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        userhelper
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/userhelper -F auid>=1000
        -F auid!=4294967295 -k privileged-passwd
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.36', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/userhelper\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.37":
    title: '4.1.3.37 | Ensure audit of the mount command and syscall - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the mount command and syscall.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        mount
         command and syscall occur.
        Add or update the following rules in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Note: The rules are duplicated to cover both 32-bit and 64-bit architectures. Only the lines
        appropriate for the system architecture must be configured. Add the following lines appropriate for the architecture:
        -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
        -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
        -a always,exit -F path=/usr/bin/mount -F auid>=1000 -F auid!=4294967295 -k privileged-mount
                         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.37', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+(always,exit|exit,always)\h+-F\h+arch=b32\h+-S\h+mount\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+(always,exit|exit,always)\h+-F\h+arch=b64\h+-S\h+mount\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+(always,exit|exit,always)\h+-F\h+path=\/usr\/bin\/mount\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.38":
    title: '4.1.3.38 | Ensure audit of the su command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the su command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        su
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add the following line: -a always,exit -F path=/usr/bin/su -F auid>=1000 -F auid!=4294967295 -k
        privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.38', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/su\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.39":
    title: '4.1.3.39 | Ensure audit of setfiles command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the setfiles command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        setfiles
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/sbin/setfiles -F auid>=1000 -F
        auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.39', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/sbin\/setfiles\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.3.40":
    title: '4.1.3.40 | Ensure audit all uses of the newgrp command - manual'
    section: 'Configure auditd rules'
    description: |
        The operating system must audit all uses of the newgrp command.
    remediation: |
        Configure the operating system to generate audit records when successful/unsuccessful attempts to use the
        newgrp
         command occur.
        Add or update the following rule in                    /etc/audit/rules.d/audit.rules
        :
        Example:                    vim /etc/audit/rules.d/audit.rules
                         Add, uncomment or update the following line: -a always,exit -F path=/usr/bin/newgrp -F auid>=1000 -F
        auid!=4294967295 -k privileged-priv_change
         The audit daemon must be restarted for the changes to take effect. # service auditd restart
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.3.40', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*-a\h+always,exit\h+-F\h+path=\/usr\/bin\/newgrp\h+-F\h+auid>=1000\h+-F\h+auid!=4294967295\h+-k\h+\H+\h*(\h+#.*)?$'

  "4.1.4.1":
    title: '4.1.4.1 | Ensure Audit logs are are owned by root and mode 0600 or less permissive'
    section: 'Configure auditd file access'
    description: |
        The  Linux operating system must protect audit information from unauthorized read, modification, or deletion.
    remediation: |
        Change the mode of the audit log files with the following command: # chmod 0600 [audit_file]
         Change the owner and group owner of the audit log files with the following command: # chown root:root [audit_file]
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.1.4.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.2.1.4":
    title: '4.2.1.4 | Ensure logging is configured - manual'
    section: 'Configure rsyslog'
    description: |
        The                /etc/rsyslog.conf
         and                /etc/rsyslog.d/.conf
         files specifies rules for logging and which files are to be used to log certain classes of messages.
    remediation: |
        Edit the following lines in the                    /etc/rsyslog.conf
         and                    /etc/rsyslog.d/*.conf
         files as appropriate for your environment:
        *.emerg                                  :omusrmsg:*
        auth,authpriv.*                          /var/log/secure
        mail.*                                  -/var/log/mail
        mail.info                               -/var/log/mail.info
        mail.warning                            -/var/log/mail.warn
        mail.err                                 /var/log/mail.err
        news.crit                               -/var/log/news/news.crit
        news.err                                -/var/log/news/news.err
        news.notice                             -/var/log/news/news.notice
        *.=warning;*.=err                       -/var/log/warn
        *.crit                                   /var/log/warn
        *.*;mail.none;news.none                 -/var/log/messages
        local0,local1.*                         -/var/log/localmessages
        local2,local3.*                         -/var/log/localmessages
        local4,local5.*                         -/var/log/localmessages
        local6,local7.*                         -/var/log/localmessages

        Run the following command to reload the                    rsyslogd
         configuration:                 # systemctl restart rsyslog
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.2.1.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.2.1.5":
    title: '4.2.1.5 | Ensure rsyslog is configured to send logs to a remote log host'
    section: 'Configure rsyslog'
    description: |
        The                rsyslog
         utility supports the ability to send logs it gathers to a remote log host running                syslogd8
         or to receive messages from remote hosts, reducing administrative overhead.             Note
         Ensure that the selection of logfiles being sent follows local site policy
    remediation: |
        Edit the                    /etc/rsyslog.conf
         and                    /etc/rsyslog.d/*.conf
         files and add one of the following lines:                 Newer syntax:
        <files to sent to the remote log server> action(type="omfwd" target="<FQDN or ip of loghost>" port="<port number>"
        protocol="tcp"
        	                                        action.resumeRetryCount="<number of re-tries>"
        	                                        queue.type="LinkedList" queue.size=<number of messages to queue>")
                         Example:
        *.* action(type="omfwd" target="192.168.2.100" port="514" protocol="tcp"
                   action.resumeRetryCount="100"
                   queue.type="LinkedList" queue.size="1000")
                         Older syntax: *.* @@<FQDN or ip of loghost>
         Example: *.* @@192.168.2.100

        Run the following command to reload the                    rsyslog
         configuration:                 # systemctl restart rsyslog
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.2.1.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.2.1.6":
    title: '4.2.1.6 | Ensure remote rsyslog messages are only accepted on designated log hosts. - manual'
    section: 'Configure rsyslog'
    description: |
        By default,                rsyslog
         does not listen for log messages coming in from remote systems. The                ModLoad
         tells                rsyslog
         to load the                imtcp.so
         module so it can listen over a network via TCP. The                InputTCPServerRun
         option instructs                rsyslogd
         to listen on the specified TCP port.
        Note The                  ModLoad imtcp
         line can have the                  .so
         extension added to the end of the module, or use the full path to the module.
    remediation: |
        For hosts that are designated as log hosts, edit the                    /etc/rsyslog.conf
         file and un-comment or add the following lines:
        $ModLoad imtcp

        $InputTCPServerRun 514

        For hosts that are not designated as log hosts, edit the                    /etc/rsyslog.conf
         file and comment or remove the following lines:
        # $ModLoad imtcp

        # $InputTCPServerRun 514

        Run the following command to reload the                    rsyslogd
         configuration:                 # systemctl restart rsyslog
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_4.2.1.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.1.8":
    title: '5.1.8 | Ensure cron is restricted to authorized users'
    section: 'Configure time-based job schedulers'
    description: |
        If              cron
         is installed in the system, configure              /etc/cron.allow
         to allow specific users to use these services. If              /etc/cron.allow
         does not exist, then              /etc/cron.deny
         is checked. Any user not specifically defined in those files is allowed to use cron. By removing the file, only users
        in              /etc/cron.allow
         are allowed to use cron.
        Note Even though a given user is not listed in                cron.allow
        , cron jobs can still be run as that user. The                cron.allow
         file only controls administrative access to the crontab command for scheduling and modifying cron jobs.
    remediation: |
        Run the following command to remove                  /etc/cron.deny
        :               # rm /etc/cron.deny

        Run the following command to create                  /etc/cron.allow
                       # touch /etc/cron.allow

        Run the following commands to set the owner and permissions on                  /etc/cron.allow
        :
        # chown root:root /etc/cron.allow

        # chmod u-x,og-rwx /etc/cron.allow
                       OR
        Run the following command to remove                  cron
                       # yum remove cronie
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.1.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.4":
    title: '5.2.4 | Ensure users must provide password for escalation'
    section: 'Configure sudo'
    description: |
        The operating system must be configured so that users must provide a password for privilege escalation.
    remediation: |
        Configure the operating system to require users to supply a password for privilege escalation.
        Check the configuration of the                  /etc/sudoers
         file with the following command:               # vim /etc/sudoers

        Remove any occurrences of                  NOPASSWD
         tags in the file.
        Check the configuration of the                  /etc/sudoers.d/*
         files with the following command to get the list:               # grep -i nopasswd /etc/sudoers.d/*
         Edit the list of files using this command: # vim /etc/sudoers.d/path_of_file

        Remove any occurrences of                  NOPASSWD
         tags in the file.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.2.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.5":
    title: '5.2.5 | Ensure users must re-authenticate for privilege escalation'
    section: 'Configure sudo'
    description: |
        The operating system must be configured so that users must reauthenticate for privilege escalation.
    remediation: |
        Configure the operating system to require users to reauthenticate for privilege escalation.
        Check the configuration of the                  /etc/sudoers
         file with the following command:               # vim /etc/sudoers

        Remove any occurrences of                  !authenticate
         tags in the file.
        Check the configuration of the                  /etc/sudoers.d/*
         files with the following command:               # grep -i authenticate /etc/sudoers /etc/sudoers.d/*
         Edit the list of files using this command: # vim /etc/sudoers.d/{path_of_file}

        Remove any occurrences of                  !authenticate
         tags in the file(s).
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.2.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.6":
    title: '5.2.6 | Ensure the sudoers file restricts sudo access to authorized personnel'
    section: 'Configure sudo'
    description: |
        The Linux operating system must restrict privilege elevation to authorized personnel.
    remediation: |
        Remove the following entries from the sudoers file:
        ALL ALL=(ALL) ALL
        ALL ALL=(ALL:ALL) ALL
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.2.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.7":
    title: '5.2.7 | Ensure sudo authentication timeout is configured'
    section: 'Configure sudo'
    description: |
        The Linux operating system must require reauthentication when using the sudo command.
    remediation: |
        Configure the "sudo" command to require re-authentication.
        Edit the /etc/sudoers file: # visudo
         Add or modify the following line: Defaults timestamp_timeout=[value]
         Note:
         The "[value]" must be a number that is greater than or equal to "0".
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.2.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.8":
    title: '5.2.8 | Ensure users password required for privilege escalation when using sudo'
    section: 'Configure sudo'
    description: |
        The Linux operating system must use the invoking users password for privilege escalation when using sudo
    remediation: |
        Define the following in the Defaults section of the /etc/sudoers file or a configuration file in the /etc/sudoers.d/
        directory:
        Defaults !targetpw
        Defaults !rootpw
        Defaults !runaspw
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.2.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.1":
    title: '5.3.1 | Ensure SSH is installed'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that all networked systems have SSH installed.
    remediation: |
        Install SSH packages onto the host with the following commands: # yum install openssh-server
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.2":
    title: '5.3.2 | Ensure SSH is running'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that all networked systems use SSH for confidentiality and integrity of
        transmitted and received information as well as information during preparation for transmission.
    remediation: |
        Configure the                  SSH
         service to start and automatically start after reboot with the following command:               # systemctl --now
        enable sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "5.3.4":
    title: '5.3.4 | Ensure permissions on SSH private host key files are configured'
    section: 'Configure SSH Server'
    description: |
        An SSH private key is one of two files used in SSH public key authentication.  In this authentication method, The
        possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to
        authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key
        should be distributed.
    remediation: |
        Run the following commands to set permissions, ownership, and group on the private SSH host key files:
        # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod u-x,g-wx,o-rwx {} \;

        # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:ssh_keys
        	OR
        # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root {} \;
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.5":
    title: '5.3.5 | Ensure permissions on SSH public host key files are configured'
    section: 'Configure SSH Server'
    description: |
        An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key
        is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public
        key that corresponds to a private key will be able to authenticate successfully.
    remediation: |
        Run the following commands to set permissions and ownership on the SSH host public key files
        # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod u-x,go-wx {} \;
        # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \;
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.8":
    title: '5.3.8 | Ensure SSH X11 forwarding is disabled'
    section: 'Configure SSH Server'
    description: |
        The X11Forwarding parameter provides the ability to tunnel X11 traffic through an existing SSH shell session to enable
        remote graphic connections.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the parameter as follows:               X11Forwarding no
         Impact: X11 programs on the server will not be able to be forwarded to a ssh-client display.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^x11forwarding\s*no\b'

  "5.3.10":
    title: '5.3.10 | Ensure SSH IgnoreRhosts is enabled'
    section: 'Configure SSH Server'
    description: |
        The              IgnoreRhosts
         parameter specifies that              .rhosts
         and              .shosts
         files will not be used in              RhostsRSAAuthentication
         or              HostbasedAuthentication
        .
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the parameter as follows:               IgnoreRhosts yes
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^ignorerhosts\s*yes\s*$'

  "5.3.11":
    title: '5.3.11 | Ensure SSH HostbasedAuthentication is disabled'
    section: 'Configure SSH Server'
    description: |
        The              HostbasedAuthentication
         parameter specifies if authentication is allowed through trusted hosts via the user of              .rhosts
        , or              /etc/hosts.equiv
        , along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the parameter as follows:               HostbasedAuthentication no
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^hostbasedauthentication\s+no\s*$'

  "5.3.14":
    title: '5.3.14 | Ensure SSH PermitUserEnvironment is disabled'
    section: 'Configure SSH Server'
    description: |
        The              PermitUserEnvironment
         option allows users to present environment options to the              ssh
         daemon.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the parameter as follows:               PermitUserEnvironment no
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.14', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^permituserenvironment\s+no\s*$'

  "5.3.16":
    title: '5.3.16 | Ensure only FIPS 140-2 ciphers are used for SSH'
    section: 'Configure SSH Server'
    description: |
        The operating system must use a FIPS 1402 approved cryptographic algorithm for SSH communications.
    remediation: |
        Configure SSH to use FIPS 140-2 approved cryptographic algorithms.
        Add the following line (or modify the line to have the required value) to the                  /etc/ssh/sshd_config
         file (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor).
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: Ciphers aes128-ctr,aes192-ctr,aes256-ctr
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
         Impact: The only "strong" ciphers currently FIPS 140-2 compliant are: aes256-ctr,aes192-ctr,aes128-ctr
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.16', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.17":
    title: '5.3.17 | Ensure only strong MAC algorithms are used'
    section: 'Configure SSH Server'
    description: |
        This variable Specifies the available MAC message authentication code algorithms.  The MAC algorithm is used in protocol
        version 2 for data integrity protection.  Multiple algorithms must be commaseparated. Note
         Some organizations may have stricter requirements for approved MACs. Ensure that MACs used are in compliance with site
        policy.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file and add/modify the MACs line to contain a comma separated list of the site approved MACs               Example:
        MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.17', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*macs\s+(\S+,)*(hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1|hmac-sha1-96|umac-64@openssh\.com|hmac-md5-etm@openssh\.com|hmac-md5-96-etm@openssh\.com|hmac-ripemd160-etm@openssh\.com|hmac-sha1-etm@openssh\.com|hmac-sha1-96-etm@openssh\.com|umac-64-etm@openssh\.com|umac-128-etm@openssh\.com)(,\S+)*\s*$'

  "5.3.19":
    title: '5.3.19 | Ensure SSH Idle Timeout Interval is configured'
    section: 'Configure SSH Server'
    description: |
        The two options              ClientAliveInterval
         and              ClientAliveCountMax
         control the timeout of ssh sessions.           ClientAliveInterval
         sets a timeout interval in seconds after which if no data has been received from the client, sshd will send a message
        through the encrypted channel to request a response from the client. The default is 0, indicating that these messages
        will not be sent to the client.             ClientAliveCountMax
         sets the number of client alive messages which may be sent without sshd receiving any messages back from the client. If
        this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating the
        session. The default value is                3
        .
                       The client alive messages are sent through the encrypted channel
        Setting                    ClientAliveCountMax
         to                    0
         disables connection termination

        Example The default value is 3.  If                ClientAliveInterval
         is set to 15, and                ClientAliveCountMax
         is left at the default, unresponsive SSH clients will be disconnected after approximately 45 seconds
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the parameters according to site policy.  This should include                  ClientAliveInterval
         between                  1
         and                  600
         and                  ClientAliveCountMax
         of                  0
        :
        ClientAliveInterval 600

        ClientAliveCountMax 0
                       Impact: In some cases this setting may cause termination of long-running scripts over SSH or remote
        automation tools which rely on SSH. In developing the local site policy, the requirements of such scripts should be
        considered and appropriate ServerAliveInterval and ClientAliveInterval settings should be calculated to insure
        operational continuity.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.19', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^clientaliveinterval\s+(600|[1-5][0-9][0-9]|[1-9][0-9]|[1-9])\b'
            - name: Undefined
              rule: 'should cmp == ^clientalivecountmax\s*0\s*$'

  "5.3.26":
    title: '5.3.26 | Ensure RSA rhosts authentication is not allowed'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon does not allow authentication using RSA rhosts
        authentication.
    remediation: |
        Configure the SSH daemon to not allow authentication using RSA rhosts authentication.
        Add the following line in                  /etc/ssh/sshd_config
        , or uncomment the line and set the value to                  no
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: RhostsRSAAuthentication no
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.26', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.27":
    title: '5.3.27 | Ensure Printlastlog is enabled'
    section: 'Configure SSH Server'
    description: |
        The operating system must display the date and time of the last successful account logon upon an SSH logon.
    remediation: |
        Configure SSH to provide users with feedback on when account accesses last occurred by setting the required
        configuration options in                  /etc/pam.d/sshd
         or in the                  sshd_config
         file used by the system (                 /etc/ssh/sshd_config
         will be used in the example) (this file may be named differently or be in a different location if using a version of
        SSH that is provided by a third-party vendor).
        Modify the                  PrintLastLog
         line in                  /etc/ssh/sshd_config
         to match the following:
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: PrintLastLog yes

        The SSH service must be restarted for changes to                  sshd_config
         to take effect.               # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.27', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.28":
    title: '5.3.28 | Ensure SSH IgnoreUserKnownHosts is enabled'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon does not allow authentication using known hosts
        authentication.
    remediation: |
        Configure the SSH daemon to not allow authentication using known hosts authentication.
        Add the following line in                  /etc/ssh/sshd_config
        , or uncomment the line and set the value to                  yes
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment, or update the following line. IgnoreUserKnownHosts yes
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.28', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.29":
    title: '5.3.29 | Ensure SSH Protocol is set to 2'
    section: 'Configure SSH Server'
    description: |
        The Linux operating system must be configured so that the SSH daemon is configured to only use the SSHv2 protocol.
    remediation: |
        Remove all Protocol lines that reference version "1" in "/etc/ssh/sshd_config" (this file may be named differently or be
        in a different location if using a version of SSH that is provided by a third-party vendor). The "Protocol" line must be
        as follows: Protocol 2
         The SSH service must be restarted for changes to take effect
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.29', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.30":
    title: '5.3.30 | Ensure SSH does not permit GSSAPI'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon does not permit Generic Security Service Application
        Program Interface GSSAPI authentication unless needed.
    remediation: |
        Uncomment the                  GSSAPIAuthentication
         keyword in                  /etc/ssh/sshd_config
         (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor) and set the value to                  no
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: GSSAPIAuthentication no
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
         If GSSAPI authentication is required, it must be documented, to include the location of the configuration file.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.30', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.31":
    title: '5.3.31 | Ensure SSH does not permit Kerberos authentication'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon does not permit Kerberos authentication unless needed.
    remediation: |
        Uncomment the                  KerberosAuthentication
         keyword in                  /etc/ssh/sshd_config
         (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor) and set the value to                  no
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: KerberosAuthentication no
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
         If Kerberos authentication is required, it must be documented, to include the location of the configuration file.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.31', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.32":
    title: '5.3.32 | Ensure SSH performs checks of home directory configuration files'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon performs strict mode checking of home directory
        configuration files.
    remediation: |
        Uncomment the                  StrictModes
         keyword in                  /etc/ssh/sshd_config
         (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor) and set the value to                  yes
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: StrictModes yes
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.32', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.33":
    title: '5.3.33 | Ensure SSH uses privilege separation'
    section: 'Configure SSH Server'
    description: |
        The operating system must be configured so that the SSH daemon uses privilege separation.
    remediation: |
        Uncomment the                  UsePrivilegeSeparation
         keyword in                  /etc/ssh/sshd_config
         (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor) and set the value to                  sandbox
         or                  yes
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: UsePrivilegeSeparation sandbox
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.33', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.34":
    title: '5.3.34 | Ensure SSH compressions setting is delayed'
    section: 'Configure SSH Server'
    description: |
        Teh operating system must be configured so that the SSH daemon does not allow compression or only allows compression
        after successful authentication.
    remediation: |
        Uncomment the                  Compression
         keyword in                  /etc/ssh/sshd_config
         (this file may be named differently or be in a different location if using a version of SSH that is provided by a
        third-party vendor) on the system and set the value to                  delayed
         or                  no
        :
        Example:                  vim /etc/ssh/sshd_config
                       Add, uncomment or update the following line: Compression no
         The SSH service must be restarted for changes to take effect. # systemctl restart sshd.service
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.34', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.35":
    title: '5.3.35 | Ensure SSH X11UseLocalhost is disabled'
    section: 'Configure SSH Server'
    description: |
        The Linux operating system SSH daemon must prevent remote hosts from connecting to the proxy display
    remediation: |
        Configure the SSH daemon to prevent remote hosts from connecting to the proxy display. Edit the "/etc/ssh/sshd_config"
        file to uncomment or add the line for the "X11UseLocalhost" keyword and set its value to "yes" (this file may be named
        differently or be in a different location if using a version of SSH that is provided by a third-party vendor):
        X11UseLocalhost yes
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.35', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.36":
    title: '5.3.36 | Ensure no .shosts files exist on the system - manual'
    section: 'Configure SSH Server'
    description: |
        The operating system must not contain .shosts files.
    remediation: |
        Remove any found                  .shosts
         files from the system.               Refer to the list found in the Audit section and apply the path to the file in the
        example below: # rm /[path]/[to]/[file]/.shosts
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.36', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.3.37":
    title: '5.3.37 | Ensure no shosts.equiv files exist on the system - manual'
    section: 'Configure SSH Server'
    description: |
        The operating system must not contain shosts.equiv files.
    remediation: |
        Remove any found                  shosts.equiv
         files from the system.               Refer to the list found in the Audit section and apply the path to the file in the
        example below: # rm /[path]/[to]/[file]/shosts.equiv
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.3.37', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.1":
    title: '5.4.1 | Ensure password creation requirements are configured'
    section: 'Configure PAM'
    description: |
        The              pampwquality.so
         module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it
        is a certain length, contains a mix of characters e.g. alphabet, numeric, other and more. The following are definitions
        of the              pampwquality.so
         options.
        The following options are set in the              /etc/security/pwquality.conf
         file           Password Length minlen  14
          password must be 14 characters or more             Password complexity minclass  4
          The minimum number of required classes of characters for the new password digits, uppercase, lowercase, others
        OR dcredit  1
          provide at least one digit               ucredit  1
          provide at least one uppercase character               ocredit  1
          provide at least one special character               lcredit  1
          provide at least one lowercase character
        The following is set in the              /etc/pam.d/passwordauth
         and              /etc/pam.d/systemauth
         files           tryfirstpass
          retrieve the password from a previous stacked PAM module. If not available, then prompt the user for a password.
        retry3
          Allow 3 tries before sending back a failure.             The settings shown above are one possible policy. Alter these
        values to conform to your own organizations password policies. Notes
        Settings in                  /etc/security/pwquality.conf
         must use spaces around the
         symbol.
        Additional modules options may be set in the                  /etc/pam.d/passwordauth
         and                  /etc/pam.d/systemauth
         files
    remediation: |
        Edit the file                  /etc/security/pwquality.conf
         and add or modify the following line for password length to conform to site policy               minlen = 14

        Edit the file                  /etc/security/pwquality.conf
         and add or modify the following line for password complexity to conform to site policy               minclass = 4
         OR
        dcredit = -1
        ucredit = -1
        ocredit = -1
        lcredit = -1

        Edit the                  /etc/pam.d/password-auth
         and                  /etc/pam.d/system-auth
         files to include the appropriate options for                  pam_pwquality.so
         and to conform to site policy:               password requisite pam_pwquality.so try_first_pass retry=3
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.3":
    title: '5.4.3 | Ensure password hashing algorithm is SHA-512'
    section: 'Configure PAM'
    description: |
        The commands below change password encryption from              md5
         to              sha512
         a much stronger hashing algorithm. All existing accounts will need to perform a password change to upgrade the stored
        hashes to the new algorithm.           Note These changes only apply to accounts configured on the local system.
        Additional module options may be set, recommendation only covers those listed here.
    remediation: |
        Edit the                  /etc/pam.d/password-auth
         and                  /etc/pam.d/system-auth
         files to include                  sha512
         option and remove the                  md5
         option for                  pam_unix.so
        :               password sufficient pam_unix.so sha512
         Note: Any system accounts that need to be expired should be carefully done separately by the system administrator to
        prevent any potential problems. If it is determined that the password algorithm being used is not SHA-512, once it is
        changed, it is recommended that all user ID's be immediately expired and forced to change their passwords on next login,
        In accordance with local site policies. To accomplish this, the following command can be used.
        This command intentionally does not effect the root account.                           The root account's password will
        also need to be changed.
                               # awk -F: '( $3<'"$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)"' && $1 !~ /^(nfs)?nobody$/ &&
        $1 != "root" ) { print $1 }' /etc/passwd | xargs -n 1 chage -d 0
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.5":
    title: '5.4.5 | Ensure system-auth is used when changing passwords'
    section: 'Configure PAM'
    description: |
        The operating system must be configured so that              /etc/pam.d/passwd
         implements              /etc/pam.d/systemauth
         when changing passwords.
    remediation: |
        Configure                  PAM
         to utilize                  /etc/pam.d/system-auth
         when changing passwords.
        Add the following line to                  /etc/pam.d/passwd
         (or modify the line to have the required value):
        Example:                  vim /etc/pam.d/passwd
                       Add, uncomment or update the following line: password substack system-auth
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.5', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.6":
    title: '5.4.6 | Ensure no accounts are configured with blank or null passwords'
    section: 'Configure PAM'
    description: |
        The operating system must not have accounts configured with              blank
         or              null
         passwords.
    remediation: |
        If an account is configured for password authentication but does not have an assigned password, it may be possible to
        log on to the account without authenticating. Remove any instances of the "nullok" option in "/etc/pam.d/system-auth"
        and "/etc/pam.d/password-auth" to prevent logons with empty passwords. Note:
         Manual changes to the listed files may be overwritten by the "authconfig" program. The "authconfig" program should not
        be used to update the configurations listed in this requirement.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.7":
    title: '5.4.7 | Ensure minimum and maximum requirements are set for password changes'
    section: 'Configure PAM'
    description: |
        The operating system must be configured so that when passwords are changed a minimum of              8
         of the total number of characters must be changed and a minimum of              4
         character classes must be changed.  The operating system must also be configured so that when passwords are changed the
        number of repeating consecutive characters must not be more than              3
         characters and the number of repeating characters of the same character class must not be more than              4
         characters.  The operating system must be configured so that passwords are a minimum of              15
         characters in length.
    remediation: |
        Configure the operating system to require the change of at least                  8
         of the total number of characters when passwords are changed by setting the                  difok
         option and the                  minclass
         option and the                  maxrepeat
         option and the                  maxclassrepeat
         and the                  minlen
         option as defined below.
        Add the following lines to                  /etc/security/pwquality.conf
         (or modify the line to have the required value):
        Example:                  vim /etc/security/pwquality.conf

        difok = 8
        minclass = 4
        maxrepeat = 3
        maxclassrepeat = 4
        minlen = 15
                       Impact: Consult your documentation for the appropriate PAM file and module.
        Additional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to
        14 or more.
        Settings in /etc/security/pwquality.conf must use spaces around the = symbol.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.8":
    title: '5.4.8 | Ensure date and time of last successful logon'
    section: 'Configure PAM'
    description: |
        The operating system must display the              date
         and              time
         of the last successful account logon upon logon.
    remediation: |
        Configure the operating system to provide users with feedback on when account accesses last occurred by setting the
        required configuration options in                  /etc/pam.d/postlogin
        .
        Example:                  vim /etc/pam.d/postlogin
                       Add the following line to the top of the file: session required pam_lastlog.so showfailed
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.9":
    title: '5.4.9 | Ensure multifactor authentication for access to privileged accounts'
    section: 'Configure PAM'
    description: |
        The operating system must implement multifactor authentication for access to privileged accounts via pluggable
        authentication modules              PAM
        .
    remediation: |
        Configure the operating system to implement multifactor authentication for remote access to privileged accounts via
        PAM
        .
        Modify all of the services lines in                  /etc/sssd/sssd.conf
         or in configuration files found under                  /etc/sssd/conf.d
         to include                  pam
        .
        Example:                  vim /etc/sssd/sssd.conf

        Add                  pam
         to the service line as shown here:               services = nss, pam
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.10":
    title: '5.4.10 | Ensure certificate status checking for PKI authentication'
    section: 'Configure PAM'
    description: |
        The operating system must implement certificate status checking for              PKI authentication
        .
    remediation: |
        Configure the operating system to do certificate status checking for                  PKI authentication
        .
        Modify all of the                  cert_policy
         lines in                  /etc/pam_pkcs11/pam_pkcs11.conf
         to include                  ocsp_on
        .
        Note: Make sure there is a minimum of                  3
         cert_policy lines.
        Example:                  vim /etc/pam_pkcs11/pam_pkcs11.conf

        Add, uncomment or update the                  cert_policy
         lines to inlcude                  ocsp_on
        :
        cert_policy = ca, ocsp_on, signature;
        cert_policy = ca, ocsp_on, signature;
        cert_policy = ca, ocsp_on, signature;
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.11":
    title: '5.4.11 | Ensure password prohibited reuse is at a minimum 5'
    section: 'Configure PAM'
    description: |
        The operating system must be configured so that passwords are prohibited from reuse for a minimum of              5
         generations.
    remediation: |
        To configure the operating system to prohibit password reuse for a minimum of                  5
         generations.
        Add the following line in                  /etc/pam.d/system-auth
         and                  /etc/pam.d/password-auth
         (or modify the line to have the required value):
        Example:                  vim /etc/pam.d/system-auth
                       Add, uncomment or update the following line: password requisite pam_pwhistory.so use_authtok remember=5
        retry=3

        Note: Manual changes to the listed files may be overwritten by the                  authconfig
         program. The                  authconfig
         program should not be used to update the configurations listed in this requirement.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.12":
    title: '5.4.12 | Ensure accounts lock for a minimum of 15 minutes after three unsuccessful logon attempts within a 15-minute timeframe'
    section: 'Configure PAM'
    description: |
        The operating system must be configured to lock accounts for a minimum of 15 minutes after three unsuccessful logon
        attempts within a 15minute timeframe.
    remediation: |
        Configure the operating system to lock an account for the maximum period when three unsuccessful logon attempts in 15
        minutes are made. Add/Modify the appropriate sections of the "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth"
        files to match the following lines:
        auth required pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=900
        auth sufficient pam_unix.so try_first_pass
        auth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=900
        account required pam_faillock.so
                       Note:
         Manual changes to the listed files may be overwritten by the "authconfig" program. The "authconfig" program should not
        be used to update the configurations listed in this requirement.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.13":
    title: '5.4.13 | Ensure lockout for unsuccessful root logon attempts'
    section: 'Configure PAM'
    description: |
        The operating system must lock the associated account after three unsuccessful root logon attempts are made within a
        15minute period.
    remediation: |
        To configure the operating system to lock automatically the                  root
         account until the locked account is released by an administrator when                  3
         unsuccessful logon attempts in                  15
         minutes are made.
        Modify the first                  3
         lines of the                  auth
         section and the first line of the                  account
         section of the                  /etc/pam.d/system-auth
         and                  /etc/pam.d/password-auth
         files to match the following lines:
        Example:                  vim /etc/pam.d/system-auth
                       Add, uncomment or update the following lines in each file:
        auth required pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=900
        auth sufficient pam_unix.so try_first_pass
        auth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=900
        account required pam_faillock.so
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.4.13', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.2":
    title: '5.5.1.2 | Ensure minimum days between password changes is configured'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The                PASSMINDAYS
         parameter in                /etc/login.defs
         allows an administrator to prevent users from changing their password until a minimum number of days have passed since
        the last time the user changed their password. It is recommended that                PASSMINDAYS
         parameter be set to 1 or more days.
    remediation: |
        Set the                    PASS_MIN_DAYS
          parameter to 1 in                    /etc/login.defs
         :                 PASS_MIN_DAYS 1
         Modify user parameters for all users with a password set to match: # chage --mindays 1 <user>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.2', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.6":
    title: '5.5.1.6 | Ensure shadow file is configured to use only encrypted representations of passwords'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The operating system must be configured to use the shadow file to store only encrypted representations of passwords.
    remediation: |
        Configure the operating system to store only SHA512 encrypted representations of passwords.
        Add or update the following line in                    /etc/login.defs
        :                 ENCRYPT_METHOD SHA512
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.7":
    title: '5.5.1.7 | Ensure password expiration is 60 Day maximum for new users'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The operating system must be configured so that passwords for new users are restricted to a 60day maximum lifetime.
    remediation: |
        Configure the operating system to enforce a 60-day maximum password lifetime restriction.
        Add the following line in                    /etc/login.defs
         (or modify the line to have the required value):                 PASS_MAX_DAYS 60
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.8":
    title: '5.5.1.8 | Ensure password expiration is 60 Day maximum for existing passwords'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The operating system must be configured so that existing passwords are restricted to a 60day maximum lifetime.
    remediation: |
        Configure non-compliant accounts to enforce a 60-day maximum password lifetime restriction. Using the list or accounts
        collected in the Audit and run this command on the Users: # chage -M 60 [user]
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.9":
    title: '5.5.1.9 | Ensure inactive password lock is 0 days'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The operating system must disable account identifiers individuals, groups, roles, and devices if the password expires.
    remediation: |
        Configure the operating system to disable account identifiers (individuals, groups, roles, and devices) after the
        password expires.
        Add the following line to                    /etc/default/useradd
         (or modify the line to have the required value):
        Example:                    vim /etc/default/useradd
                         Add, uncomment or update the following line: INACTIVE=0
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.1.10":
    title: '5.5.1.10 | Ensure delay between logon prompts on failure'
    section: 'Set Shadow Password Suite Parameters'
    description: |
        The operating system must be configured so that the delay between logon prompts following a failed console logon attempt
        is at least four seconds.
    remediation: |
        Configure the operating system to enforce a delay of at least four seconds between logon prompts following a failed
        console logon attempt.
        Modify the                    /etc/login.defs
         file to set the                    FAIL_DELAY
         parameter to                    4
         or greater:
        Example:                    vim /etc/login.defs
                         Add, uncomment or update the following line: FAIL_DELAY 4
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.1.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.4":
    title: '5.5.4 | Ensure default user shell timeout is configured - manual'
    section: 'User Accounts and Environment'
    description: |
        TMOUT
         is an environmental setting that determines the timeout of a shell in seconds.
        TMOUT               n
          Sets the shell timeout to                n
         seconds.  A setting of                TMOUT0
         disables timeout.             readonly TMOUT Sets the TMOUT environmental variable as readonly, preventing unwanted
        modification during runtime. export TMOUT  exports the TMOUT variable System Wide Shell Configuration Files /etc/profile
          used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in
        the                .bashprofile
        , however this file is used to set an initial PATH or PS1 for all shell users of the system.
        is only executed for interactive                  login
         shells, or shells executed with the login parameter.
                     /etc/profile.d
                         /etc/profile
         will execute the scripts within                /etc/profile.d/.sh
        . It is recommended to place your configuration in a shell script within                /etc/profile.d
         to set your own system wide environmental variables.             /etc/bashrc
          System wide version of                .bashrc
        .  In Fedora derived distributions,                etc/bashrc
         also invokes /etc/profile.d/.sh if                nonlogin
         shell, but redirects output to                /dev/null
         if                noninteractive.

        Is only executed for                  interactive
         shells or if                  BASHENV
         is set to                  /etc/bashrc
        .
    remediation: |
        Review                  /etc/bashrc
        ,                  /etc/profile
        , and all files ending in                  *.sh
         in the                  /etc/profile.d/
         directory and remove or edit all                  TMOUT=_n_
         entries to follow local site policy.                   TMOUT
         should not exceed 900 or be equal to                  0
        .
        Configure                  TMOUT
         in                  one
         of the following files:
        A file in the                    /etc/profile.d/
         directory ending in                    .sh
                         /etc/profile /etc/bashrc TMOUT
         configuration examples:                 As multiple lines:
        TMOUT=900
        readonly TMOUT
        export TMOUT
                       As a single line: readonly TMOUT=900 ; export TMOUT
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.4', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.5.6":
    title: '5.5.6 | Ensure user and group account administration utilities are configured to store only encrypted representations of passwords'
    section: 'User Accounts and Environment'
    description: |
        The operating system must be configured so that user and group account administration utilities are configured to store
        only encrypted representations of passwords.
    remediation: |
        Configure the operating system to store only SHA512 encrypted representations of passwords. Add or update the following
        line in "/etc/libuser.conf" in the [defaults] section: crypt_style = sha512
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.6', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.7":
    title: '5.5.7 | Ensure multi-factor authentication is enable for users'
    section: 'User Accounts and Environment'
    description: |
        The operating system must uniquely identify and must authenticate organizational users or processes acting on behalf of
        organizational users using multifactor authentication.
    remediation: |
        Configure the operating system to require individuals to be authenticated with a multifactor authenticator. Enable
        smartcard logons with the following commands:
        # authconfig --enablesmartcard --smartcardaction=0 --update
        # authconfig --enablerequiresmartcard -update

        Modify the                  /etc/pam_pkcs11/pkcs11_eventmgr.conf
         file to uncomment the following line:
        Example:                  vim /etc/pam_pkcs11/pkcs11_eventmgr.conf
                       Uncomment the following line: /usr/X11R6/bin/xscreensaver-command -lock

        Note:  Modify the                  /etc/pam_pkcs11/pam_pkcs11.conf
         file to use the cackey module if required.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.7', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.8":
    title: '5.5.8 | Ensure Default user umask is 077'
    section: 'User Accounts and Environment'
    description: |
        The operating system must define default permissions for all authenticated users in such a way that the user can only
        read and modify their own files.
    remediation: |
        Configure the operating system to define default permissions for all authenticated users in such a way that the user can
        only read and modify their own files.
        Add or edit the line for the                  UMASK
         parameter in                  /etc/login.defs
         file to                  077
        :
        Example:                  vim /etc/login.defs
                       Add, uncomment or update the following line: UMASK 077
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.8', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.5.9":
    title: '5.5.9 | Ensure local interactive user accounts umask is 077 - manual'
    section: 'User Accounts and Environment'
    description: |
        The operating system must set the umask value to 077 for all local interactive user accounts.
    remediation: |
        Remove the umask statement from all local interactive user's initialization files. Using the list collected in the audit
        run the following command on all the files located with a less restrictive umask: user@server# ~]$ echo 'umask 077' []
        /home/user/path_to_file

        If the account is for an application, the requirement for a umask less restrictive than                  077
         can be documented, but the user agreement for access to the account must specify that the local interactive user must
        log on to their account first and then switch the user to the application account with the correct option to gain the
        account's environment variables.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.5.10":
    title: '5.5.10 | Ensure upon user creation a home directory is assigned.'
    section: 'User Accounts and Environment'
    description: |
        The operating system must be configured so that all local interactive user accounts, upon creation, are assigned a home
        directory.
    remediation: |
        Configure the operating system to assign home directories to all new local interactive users by setting the
        CREATE_HOME
         parameter in                  /etc/login.defs
         to                  yes
         as follows.
        Example:                  vim /etc/login.defs
                       Add, uncomment or update the following line: CREATE_HOME yes
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_5.5.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.1.1":
    title: '6.1.1 | Audit system file permissions - manual'
    section: 'System File Permissions'
    description: |
        The RPM package manager has a number of useful options. One of these, the               V
         option, can be used to verify that system packages are correctly installed. The              V
          option can be used to verify a particular package or to verify all system packages. If no output is returned, the
        package is installed correctly. The following table describes the meaning of output from the verify option
        Code   Meaning
        S      File size differs.
        M      File mode differs includes permissions and file type.
        5      The MD5 checksum differs.
        D      The major and minor version numbers differ on a device file.
        L      A mismatch occurs in a link.
        U      The file ownership differs.
        G      The file group owner differs.
        T      The file time mtime differs.

        The              rpm qf
         command can be used to determine which package a particular file belongs to. For example the following commands
        determines which package the              /etc/ssh/sshdconfig
         file belongs to
         rpm qf /etc/ssh/sshdconfig

        opensshserver7.4p121.el7.x8664

        To verify the settings for the package that controls the              /bin/bash
         file, run the following
         rpm V opensshserver7.4p121.el7.x8664

        S.5....T.  c /etc/ssh/sshdconfig

        Note You can feed the output of the                rpm qf
          command to the                rpm V
          command
          rpm V rpm qf /etc/ssh/sshdconfig

        S.5....T.  c /etc/ssh/sshdconfig
                   Notes Since packages and important files may change with new updates and releases, it is recommended to
        verify everything, not just a finite list of files. This can be a time consuming task and results may depend on site
        policy therefore it is not a scorable benchmark item, but is provided for those interested in additional security
        measures. Some of the recommendations of this benchmark alter the state of files audited by this recommendation. The
        audit command will alert for all changes to a file permissions even if the new state is more secure than the default.
    remediation: |
        Investigate the results to ensure any discrepancies found are understood and support proper secure operation of the
        system.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.1', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.10":
    title: '6.1.10 | Ensure no world writable files exist - manual'
    section: 'System File Permissions'
    description: |
        Unixbased systems support variable settings to control access to files. World writable files are the least secure. See
        the              chmod2
          man page for more information.
    remediation: |
        Removing write access for the "other" category (                  chmod o-w <filename>
         ) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a
        given file.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.10', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.11":
    title: '6.1.11 | Ensure no unowned files or directories exist - manual'
    section: 'System File Permissions'
    description: |
        Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users
        from the system.
    remediation: |
        Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of
        these files to some active user on the system as appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.12":
    title: '6.1.12 | Ensure no ungrouped files or directories exist - manual'
    section: 'System File Permissions'
    description: |
        Sometimes when administrators delete users or groups from the system they neglect to remove all files owned by those
        users or groups.
    remediation: |
        Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of
        these files to some active user on the system as appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.15":
    title: '6.1.15 | Ensure the file permissions ownership and group membership of system files and commands match the vendor values - manual'
    section: 'System File Permissions'
    description: |
        The operating system must be configured so that the file permissions, ownership, and group membership of system files
        and commands match the vendor values
    remediation: |
        Run the following command to determine which package owns the file: # rpm -qf <filename>
         Reset the user and group ownership of files within a package with the following command: # rpm --setugids <packagename>
         Reset the permissions of files within a package with the following command: # rpm --setperms <packagename>
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.15', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.16":
    title: '6.1.16 | Ensure all world-writable directorys are owned by root sys bin or an application User Identifier - manual'
    section: 'System File Permissions'
    description: |
        The Linux operating system must be configured so that all worldwritable directories are owned by root, sys, bin, or an
        application user.
    remediation: |
        All directories in local partitions which are world-writable should be owned by root or another system account. If any
        world-writable directories are not owned by a system account, this should be investigated. Following this, the files
        should be deleted or assigned to an appropriate group.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.1.16', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.3":
    title: '6.2.3 | Ensure all groups in etcpasswd exist in etcgroup - manual'
    section: 'User and Group Settings'
    description: |
        Over time, system administration errors and changes can lead to groups being defined in              /etc/passwd
         but not in              /etc/group
         .
    remediation: |
        Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.3', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.9":
    title: '6.2.9 | Ensure root is the only UID 0 account'
    section: 'User and Group Settings'
    description: |
        Any account with UID 0 has superuser privileges on the system.
    remediation: |
        Remove any users other than                  root
          with UID                  0
          or assign them a new UID if appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.9', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.2.11":
    title: '6.2.11 | Ensure all users home directories exist - manual'
    section: 'User and Group Settings'
    description: |
        Users can be defined in              /etc/passwd
          without a home directory or with a home directory that does not actually exist.
    remediation: |
        If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users
        without an assigned home directory should be removed or assigned a home directory as appropriate. The following script
        will create a home directory for users with an interactive shell whose home directory doesn't exist:
        #!/bin/bash

        awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\/usr)?\/sbin\/nologin(\/)?$/ &&
        $7!~/(\/usr)?\/bin\/false(\/)?$/) { print $1 " " $6 }' /etc/passwd | while read -r user dir; do
           if [ ! -d "$dir" ]; then
              mkdir "$dir"
              chmod g-w,o-wrx "$dir"
              chown "$user" "$dir"
           fi
        done
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.11', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.12":
    title: '6.2.12 | Ensure users own their home directories - manual'
    section: 'User and Group Settings'
    description: |
        The user home directory is space defined for the particular user to set local environment variables and to store
        personal files.
    remediation: |
        Change the ownership of any home directories that are not owned by the defined user to the correct user. The following
        script will create missing home directories, set the owner, and set the permissions for interactive users' home
        directories:
        #!/bin/bash

        awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\/usr)?\/sbin\/nologin(\/)?$/ &&
        $7!~/(\/usr)?\/bin\/false(\/)?$/) { print $1 " " $6 }' /etc/passwd | while read -r user dir; do
           if [ ! -d "$dir" ]; then
              echo "User: \"$user\" home directory: \"$dir\" does not exist, creating home directory"
              mkdir "$dir"
              chmod g-w,o-rwx "$dir"
              chown "$user" "$dir"
           else
              owner=$(stat -L -c "%U" "$dir")
              if [ "$owner" != "$user" ]; then
                 chmod g-w,o-rwx "$dir"
                 chown "$user" "$dir"
              fi
           fi
        done
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.12', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.13":
    title: '6.2.13 | Ensure users home directories permissions are 750 or more restrictive - manual'
    section: 'User and Group Settings'
    description: |
        While the system administrator can establish secure permissions for users home directories, the users can easily
        override these.
    remediation: |
        Making global modifications to user home directories without alerting the user community can result in unexpected
        outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file
        permissions and determine the action to be taken in accordance with site policy.
        The following script can be used to remove permissions is excess of                  750
         from users' home directories:
        #!/bin/bash

        awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\/usr)?\/sbin\/nologin(\/)?$/ &&
        $7!~/(\/usr)?\/bin\/false(\/)?$/) {print $6}' /etc/passwd | while read -r dir; do
           if [ -d "$dir" ]; then
              dirperm=$(stat -L -c "%A" "$dir")
              if [ "$(echo "$dirperm" | cut -c6)" != "-" ] || [ "$(echo "$dirperm" | cut -c8)" != "-" ] || [ "$(echo "$dirperm"
        | cut -c9)" != "-" ] || [ "$(echo "$dirperm" | cut -c10)" != "-" ]; then
                 chmod g-w,o-rwx "$dir"
              fi
           fi
        done
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.13', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.18":
    title: '6.2.18 | Ensure there are no unnecessary accounts - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must not have unnecessary accounts.
    remediation: |
        Configure the system so all accounts on the system are assigned to an active system, application, or user account.
        Remove accounts that do not support approved system activities or that allow for a normal user to perform
        administrative-level actions. To remove the user, the user's home directory and the users mail spool # userdel -r user's
        username
         Document all authorized accounts on the system.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.18', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.19":
    title: '6.2.19 | Ensure all local interactive user home directories are group-owned - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all local interactive user home directories are groupowned by the home
        directory owners primary group.
    remediation: |
        Change the group owner of a local interactive user's home directory to the group found in                  /etc/passwd
        . To change the group owner of a local interactive user's home directory, use the following command:
        Note: The example will be for the user                  smithj
        , who has a home directory of                  /home/smithj
        , and has a primary group of users.               # chgrp users /home/smithj
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.19', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.20":
    title: '6.2.20 | Ensure that all files and directories contained in local interactive user home directories are owned by the user - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all files and directories contained in local interactive user home
        directories are owned by the user of the home directory.
    remediation: |
        Change the owner of a local interactive user's files and directories to that owner. To change the owner of a local
        interactive user's files and directories, use the following command:
        Note: The example will be for the user                  smithj
        , who has a home directory of                  /home/smithj
        .               # chown smithj /home/smithj/<file or directory>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.20', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.21":
    title: '6.2.21 | Ensure local interactive user is a member of the group owner. - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all files and directories contained in local interactive user home
        directories are groupowned by a group of which the home directory owner is a member.
    remediation: |
        Change the group of a local interactive user's files and directories to a group that the interactive user is a member
        of. To change the group owner of a local interactive user's files and directories, use the following command:
        Note: The example will be for the user                  smithj
        , who has a home directory of                  /home/smithj
         and is a member of the users group.               # chgrp users /home/smithj/<file>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.21', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.22":
    title: '6.2.22 | Ensure users files and directories within the home directory permissions are 750 or more restrictive - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all files and directories contained in local interactive user home
        directories have a mode of              0750
         or less permissive.
    remediation: |
        Set the mode on files and directories in the local interactive user home directory with the following command:
        Note: The example will be for the user                  smithj
        , who has a home directory of                  /home/smithj
         and is a member of the users group.               # chmod 0750 /home/smithj/<file>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.22', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.23":
    title: '6.2.23 | Ensure local interactive users dot files for are owned by the user or root. - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all local initialization              dot
         files for interactive users are owned by the home directory user or root.
    remediation: |
        Set the owner of the local initialization files for interactive users to either the                  home directory
        owner
         or                  root
         with the following command:
        Note: The example will be for the                  smithj
         user, who has a home directory of                  /home/smithj
        .               # chown smithj /home/smithj/.*
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.23', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.24":
    title: '6.2.24 | Ensure local interactive users dot files are group-owned by the users group or root. - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all local initialization              dot
         files for local interactive users are groupowned by the              users primary group
         or              root
        .
    remediation: |
        Change the group owner of a local interactive user's files to the group found in                  /etc/passwd
         for the user. To change the group owner of a local interactive user's home directory, use the following command:
        Note: The example will be for the user                  smithj
        , who has a home directory of                  /home/smithj
        , and has a primary group of users.               # chgrp users /home/smithj/<file>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.24', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.25":
    title: '6.2.25 | Ensure users dot files have 0740 or less set. - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all local initialization              dot
         files have mode              0740
         or less permissive.
    remediation: |
        Set the mode of the local initialization files to                  0740
         with the following command:
        Note: The example will be for the                  smithj
         user, who has a home directory of                  /home/smithj
        .               # chmod 0740 /home/smithj/.<INIT_FILE>
    type: Undefined
    impact: '1.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.25', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.26":
    title: '6.2.26 | Ensure local interactive users dot files executable paths resolve to the users home directory. - manual'
    section: 'User and Group Settings'
    description: |
        The operating system must be configured so that all local interactive user initialization              dot
         files executable search paths contain only paths that resolve to the users home directory.
    remediation: |
        Edit the local interactive user initialization files to change any PATH variable statements that reference directories
        other than their home directory.
        Note: The example will be for the                  smithj
         user, which has a home directory of                  /home/smithj
        .               Utilizing the files listed in the Audit run this command to edit them and change the PATH variable
        statement.
        Example:                  vim /home/smithj/.bash_profile
                       Update the PATH accordingly: :PATH=$PATH:$HOME/.local/bin:$HOME/bin
         If a local interactive user requires path variables to reference a directory owned by the application, it must be
        documented with the ISSO.
    type: Undefined
    impact: '0.0'
    tags: ['cis_red_hat_enterprise_linux_7_stig_benchmark', 'rule_6.2.26', 'cis_red_hat_enterprise_linux_7_stig_benchmark']
    enabled: false
    properties:
      match: all
      rules:
