---

inspec_rules:
  "1.1.1.1":
    title: '1.1.1.1 | Ensure cramfs kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                cramfs
         filesystem type is a compressed readonly Linux filesystem embedded in small footprint systems. A                cramfs
         image can be used without having to first decompress the image.
    remediation: |
        Run the following script to disable the                    cramfs
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install cramfs /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist cramfs
         in the                      /etc/modprobe.d/
         directory
        Unload                      cramfs
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist cramfs
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="cramfs" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == cramfs:fs'

  "1.1.1.2":
    title: '1.1.1.2 | Ensure freevxfs kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                freevxfs
         filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HPUX
        operating systems.
    remediation: |
        Run the following script to disable the                    freevxfs
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install freevxfs /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist freevxfs
         in the                      /etc/modprobe.d/
         directory
        Unload                      freevxfs
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist freevxfs
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="freevxfs" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == freevxfs:fs'

  "1.1.1.3":
    title: '1.1.1.3 | Ensure hfs kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                hfs
         filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems.
    remediation: |
        Run the following script to disable the                    hfs
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install hfs /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist hfs
         in the                      /etc/modprobe.d/
         directory
        Unload                      hfs
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist hfs
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="hfs" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == hfs:fs'

  "1.1.1.4":
    title: '1.1.1.4 | Ensure hfsplus kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                hfsplus
         filesystem type is a hierarchical filesystem designed to replace                hfs
         that allows you to mount Mac OS filesystems.
    remediation: |
        Run the following script to disable the                    hfsplus
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install hfsplus /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist hfsplus
         in the                      /etc/modprobe.d/
         directory
        Unload                      hfsplus
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist hfsplus
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="hfsplus" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == hfsplus:fs'

  "1.1.1.5":
    title: '1.1.1.5 | Ensure jffs2 kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                jffs2
         journaling flash filesystem 2 filesystem type is a logstructured filesystem used in flash memory devices.
    remediation: |
        Run the following script to disable the                    jffs2
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install jffs2 /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist jffs2
         in the                      /etc/modprobe.d/
         directory
        Unload                      jffs2
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist jffs2
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="jffs2" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == jffs2:fs'

  "1.1.1.6":
    title: '1.1.1.6 | Ensure squashfs kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                squashfs
         filesystem type is a compressed readonly Linux filesystem embedded in small footprint systems. A
        squashfs
         image can be used without having to first decompress the image.
    remediation: |
        Run the following script to disable the                    squashfs
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install squashfs /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist squashfs
         in the                      /etc/modprobe.d/
         directory
        Unload                      squashfs
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist squashfs
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="squashfs" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
                         Impact:
        As Snap packages utilize                      squashfs
         as a compressed filesystem, disabling                      squashfs
         will cause Snap packages to fail.                   Snap
         application packages of software are self-contained and work across a range of Linux distributions. This is unlike
        traditional Linux package management approaches, like APT or RPM, which require specifically adapted packages per Linux
        distribution on an application update and delay therefore application deployment from developers to their software's
        end-user. Snaps themselves have no dependency on any external store ("App store"), can be obtained from any source and
        can be therefore used for upstream software deployment.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == squashfs:fs'

  "1.1.1.7":
    title: '1.1.1.7 | Ensure udf kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        The                udf
         filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA167 specifications. This is an
        open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support
        writing DVDs and newer optical disc formats.
    remediation: |
        Run the following script to disable the                    udf
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install udf /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist udf
         in the                      /etc/modprobe.d/
         directory
        Unload                      udf
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist udf
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="udf" # set module name
           l_mtype="fs" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
                         Impact:
        Microsoft Azure requires the usage of                      udf
        .                   udf should not
         be disabled on systems run on Microsoft Azure.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == udf:fs'

  "1.1.1.8":
    title: '1.1.1.8 | Ensure usb-storage kernel module is not available - manual'
    section: 'Configure Filesystem Kernel Modules'
    description: |
        USB storage provides a means to transfer and store files ensuring persistence and availability of the files independent
        of network connection status.  Its popularity and utility has led to USBbased malware being a simple and common means
        for network infiltration and a first step to establishing a persistent threat within a networked environment.
    remediation: |
        Run the following script to disable the                    usb-storage
         module:                 -IF-
         the module is available in the running kernel:
        Create a file ending in                      .conf
         with                      install usb-storage /bin/false
         in the                      /etc/modprobe.d/
         directory
        Create a file ending in                      .conf
         with                      blacklist usb-storage
         in the                      /etc/modprobe.d/
         directory
        Unload                      usb-storage
         from the kernel                   -IF-
         available in ANY installed kernel:
        Create a file ending in                      .conf
         with                      blacklist usb-storage
         in the                      /etc/modprobe.d/
         directory                   -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:                 No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="usb-storage" # set module name
           l_mtype="drivers" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
                         Impact:
        Disabling the                      usb-storage
         module will disable any usage of USB storage devices.
        If requirements and local site policy allow the use of such devices, other solutions should be configured accordingly
        instead. One example of a commonly used solution is                      USBGuard
        .
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.1.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == usb-storage:drivers'

  "1.1.2.1.1":
    title: '1.1.2.1.1 | Ensure tmp is a separate partition - manual'
    section: 'Configure /tmp'
    description: |
        The                  /tmp
         directory is a worldwritable directory used for temporary storage by all users and some applications.                IF
         an entry for                  /tmp
         exists in                  /etc/fstab
         it will take precedence over entries in systemd default unit file.               Note
         In an environment where the main system is diskless and connected to iSCSI, entries in                  /etc/fstab
         may not take precedence.               /tmp
         can be configured to use                  tmpfs
        .               tmpfs
         puts everything into the kernel internal caches and grows and shrinks to accommodate the files it contains and is able
        to swap unneeded pages out to swap space. It has maximum size limits which can be adjusted on the fly via
        mount o remount
        .
        Since                  tmpfs
         lives completely in the page cache and on swap, all                  tmpfs
         pages will be shown as Shmem in                  /proc/meminfo
         and Shared in                  free
        . Notice that these counters also include shared memory. The most reliable way to get the count is using
        df
         and                  du
        .               tmpfs
         has three mount options for sizing               size
         The limit of allocated bytes for this                    tmpfs
         instance. The default is half of your physical RAM without swap. If you oversize your                    tmpfs
         instances the machine will deadlock since the OOM handler will not be able to free that memory.
        nrblocks
         The same as size, but in blocks of PAGESIZE.                 nrinodes
         The maximum number of inodes for this instance. The default is half of the number of your physical RAM pages, or on a
        machine with highmem the number of lowmem RAM pages, whichever is the lower.
        These parameters accept a suffix k, m or g and can be changed on remount. The size parameter also accepts a suffix  to
        limit this                  tmpfs
         instance to that percentage of your physical RAM. The default, when neither                  size
         nor                  nrblocks
         is specified, is                  size50
        .
    remediation: |
        First ensure that systemd is correctly configured to ensure that                      /tmp
         will be mounted at boot time.                   # systemctl unmask tmp.mount

        For specific configuration requirements of the                      /tmp
         mount for your environment, modify                      /etc/fstab
        .
        Example of using                      tmpfs
         with specific mount options:                   tmpfs	/tmp	tmpfs     defaults,rw,nosuid,nodev,noexec,relatime,size=2G  0
        0
         Note:
         the                      size=2G
         is an example of setting a specific size for                      tmpfs
        .                   Example of using a volume or disk with specific mount options. The source location of the volume or
        disk will vary depending on your environment: <device> /tmp    <fstype>    defaults,nodev,nosuid,noexec   0 0
         Impact:
        By design files saved to                        /tmp
         should have no expectation of surviving a reboot of the system.                        tmpfs
         is ram based and all files stored to                        tmpfs
         will be lost when the system is rebooted.
        If files need to be persistent through a reboot, they should be saved to                        /var/tmp
         not                        /tmp
        .
        Since the                        /tmp
         directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to
        tmpfs
         or a separate partition.
        Running out of                        /tmp
         space is a problem regardless of what kind of filesystem lies under it, but in a configuration where
        /tmp
         is not a separate file system it will essentially have the whole disk available, as the default installation only
        creates a single                        /
         partition. On the other hand, a RAM-based                        /tmp
         (as with                        tmpfs
        ) will almost certainly be much smaller, which can lead to applications filling up the filesystem much more easily.
        Another alternative is to create a dedicated partition for                        /tmp
         from a separate volume or disk. One of the downsides of a disk-based dedicated partition is that it will be slower than
        tmpfs
         which is RAM-based.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /tmp'

  "1.1.2.1.2":
    title: '1.1.2.1.2 | Ensure nodev option set on tmp partition - manual'
    section: 'Configure /tmp'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /tmp
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /tmp
         partition.                   Example: <device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /tmp
         with the configured options:                   # mount -o remount /tmp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /tmp:nodev'

  "1.1.2.1.3":
    title: '1.1.2.1.3 | Ensure nosuid option set on tmp partition - manual'
    section: 'Configure /tmp'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
         files.
    remediation: |
        - IF -
         a separate partition exists for                      /tmp
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /tmp
         partition.                   Example: <device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /tmp
         with the configured options:                   # mount -o remount /tmp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /tmp:nosuid'

  "1.1.2.1.4":
    title: '1.1.2.1.4 | Ensure noexec option set on tmp partition - manual'
    section: 'Configure /tmp'
    description: |
        The                  noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        - IF -
         a separate partition exists for                      /tmp
        .
        Edit the                      /etc/fstab
         file and add                      noexec
         to the fourth field (mounting options) for the                      /tmp
         partition.                   Example: <device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /tmp
         with the configured options:                   # mount -o remount /tmp
         Impact:
        Setting the                        noexec
         option on                        /tmp
         may prevent installation and/or updating of some 3rd party software.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /tmp:noexec'

  "1.1.2.2.1":
    title: '1.1.2.2.1 | Ensure devshm is a separate partition - manual'
    section: 'Configure /dev/shm'
    description: |
        The                  /dev/shm
         directory is a worldwritable directory that can function as shared memory that facilitates inter process communication
        IPC.
    remediation: |
        For specific configuration requirements of the                      /dev/shm
         mount for your environment, modify                      /etc/fstab
        .                   Example: tmpfs	/dev/shm	tmpfs     defaults,rw,nosuid,nodev,noexec,relatime,size=2G  0 0
         Impact:
        Since the                        /dev/shm
         directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate
        partition.                     /dev/shm
         utilizing                        tmpfs
         can be resized using the                        size={size}
         parameter in the relevant entry in                        /etc/fstab
        .
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /dev/shm'

  "1.1.2.2.2":
    title: '1.1.2.2.2 | Ensure nodev option set on devshm partition - manual'
    section: 'Configure /dev/shm'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /dev/shm
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /dev/shm
          partition. See the                      fstab(5)
         manual page for more information.                   Example: tmpfs /dev/shm    tmpfs
        defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /dev/shm
         with the configured options:                   # mount -o remount /dev/shm
         Note:
         It is recommended to use                      tmpfs
         as the device/filesystem type as                      /dev/shm
         is used as shared memory space by applications.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /dev/shm:nodev'

  "1.1.2.2.3":
    title: '1.1.2.2.3 | Ensure nosuid option set on devshm partition - manual'
    section: 'Configure /dev/shm'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
          files.
    remediation: |
        - IF -
         a separate partition exists for                      /dev/shm
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /dev/shm
          partition. See the                      fstab(5)
         manual page for more information.                   Example: tmpfs /dev/shm    tmpfs
        defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /dev/shm
         with the configured options:                   # mount -o remount /dev/shm
         Note:
         It is recommended to use                      tmpfs
         as the device/filesystem type as                      /dev/shm
         is used as shared memory space by applications.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /dev/shm:nosuid'

  "1.1.2.2.4":
    title: '1.1.2.2.4 | Ensure noexec option set on devshm partition - manual'
    section: 'Configure /dev/shm'
    description: |
        The                  noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        - IF -
         a separate partition exists for                      /dev/shm
        .
        Edit the                      /etc/fstab
         file and add                      noexec
         to the fourth field (mounting options) for the                      /dev/shm
         partition.                   Example: tmpfs /dev/shm    tmpfs     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /dev/shm
         with the configured options:                   # mount -o remount /dev/shm
         Note:
         It is recommended to use                      tmpfs
         as the device/filesystem type as                      /dev/shm
         is used as shared memory space by applications.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /dev/shm:noexec'

  "1.1.2.3.1":
    title: '1.1.2.3.1 | Ensure separate partition exists for home - manual'
    section: 'Configure /home'
    description: |
        The                  /home
         directory is used to support disk storage needs of local users.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /home
        .
        For systems that were previously installed, create a new partition and configure                      /etc/fstab
         as appropriate.                   Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.2.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /home'

  "1.1.2.3.2":
    title: '1.1.2.3.2 | Ensure nodev option set on home partition - manual'
    section: 'Configure /home'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /home
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /home
         partition.                   Example: <device> /home    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /home
         with the configured options:                   # mount -o remount /home
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /home:nodev'

  "1.1.2.3.3":
    title: '1.1.2.3.3 | Ensure nosuid option set on home partition - manual'
    section: 'Configure /home'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
          files.
    remediation: |
        - IF -
         a separate partition exists for                      /home
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /home
         partition.                   Example: <device> /home    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /home
         with the configured options:                   # mount -o remount /home
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /home:nosuid'

  "1.1.2.4.1":
    title: '1.1.2.4.1 | Ensure separate partition exists for var - manual'
    section: 'Configure /var'
    description: |
        The                  /var
         directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by
        these processes may be worldwritable.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var
        .
        For systems that were previously installed, create a new partition and configure                      /etc/fstab
         as appropriate.                   Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.2.4.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var'

  "1.1.2.4.2":
    title: '1.1.2.4.2 | Ensure nodev option set on var partition - manual'
    section: 'Configure /var'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /var
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /var
         partition.                   Example: <device> /var    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var
         with the configured options:                   # mount -o remount /var
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.4.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var:nodev'

  "1.1.2.4.3":
    title: '1.1.2.4.3 | Ensure nosuid option set on var partition - manual'
    section: 'Configure /var'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
         files.
    remediation: |
        - IF -
         a separate partition exists for                      /var
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /var
         partition.                   Example: <device> /var    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var
         with the configured options:                   # mount -o remount /var
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.4.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var:nosuid'

  "1.1.2.5.1":
    title: '1.1.2.5.1 | Ensure separate partition exists for vartmp - manual'
    section: 'Configure /var/tmp'
    description: |
        The                  /var/tmp
         directory is a worldwritable directory used for temporary storage by all users and some applications. Temporary files
        residing in                  /var/tmp
         are to be preserved between reboots.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var/tmp
        .
        For systems that were previously installed, create a new partition and configure                      /etc/fstab
         as appropriate.                   Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.2.5.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/tmp'

  "1.1.2.5.2":
    title: '1.1.2.5.2 | Ensure nodev option set on vartmp partition - manual'
    section: 'Configure /var/tmp'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /var/tmp
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /var/tmp
         partition.                   Example: <device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/tmp
         with the configured options:                   # mount -o remount /var/tmp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.5.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/tmp:nodev'

  "1.1.2.5.3":
    title: '1.1.2.5.3 | Ensure nosuid option set on vartmp partition - manual'
    section: 'Configure /var/tmp'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
         files.
    remediation: |
        - IF -
         a separate partition exists for                      /var/tmp
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /var/tmp
         partition.                   Example: <device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/tmp
         with the configured options:                   # mount -o remount /var/tmp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.5.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/tmp:nosuid'

  "1.1.2.5.4":
    title: '1.1.2.5.4 | Ensure noexec option set on vartmp partition - manual'
    section: 'Configure /var/tmp'
    description: |
        The                  noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        - IF -
         a separate partition exists for                      /var/tmp
        .
        Edit the                      /etc/fstab
         file and add                      noexec
         to the fourth field (mounting options) for the                      /var/tmp
         partition.                   Example: <device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/tmp
         with the configured options:                   # mount -o remount /var/tmp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.5.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/tmp:noexec'

  "1.1.2.6.1":
    title: '1.1.2.6.1 | Ensure separate partition exists for varlog - manual'
    section: 'Configure /var/log'
    description: |
        The                  /var/log
          directory is used by system services to store log data.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var/log
         .
        For systems that were previously installed, create a new partition and configure                      /etc/fstab
          as appropriate.                   Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.2.6.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log'

  "1.1.2.6.2":
    title: '1.1.2.6.2 | Ensure nodev option set on varlog partition - manual'
    section: 'Configure /var/log'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /var/log
         partition.                   Example: <device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/log
         with the configured options:                   # mount -o remount /var/log
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.6.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log:nodev'

  "1.1.2.6.3":
    title: '1.1.2.6.3 | Ensure nosuid option set on varlog partition - manual'
    section: 'Configure /var/log'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
         files.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /var/log
         partition.                   Example: <device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/log
         with the configured options:                   # mount -o remount /var/log
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.6.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log:nosuid'

  "1.1.2.6.4":
    title: '1.1.2.6.4 | Ensure noexec option set on varlog partition - manual'
    section: 'Configure /var/log'
    description: |
        The                  noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log
        .
        Edit the                      /etc/fstab
         file and add                      noexec
         to the fourth field (mounting options) for the                      /var/log
         partition.                   Example: <device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0

        Run the following command to remount                      /var/log
         with the configured options:                   # mount -o remount /var/log
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.6.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log:noexec'

  "1.1.2.7.1":
    title: '1.1.2.7.1 | Ensure separate partition exists for varlogaudit - manual'
    section: 'Configure /var/log/audit'
    description: |
        The auditing daemon,                  auditd
        , stores log data in the                  /var/log/audit
         directory.
    remediation: |
        For new installations, during installation create a custom partition setup and specify a separate partition for
        /var/log/audit
        .
        For systems that were previously installed, create a new partition and configure                      /etc/fstab
         as appropriate.                   Impact: Resizing filesystems is a common activity in cloud-hosted servers. Separate
        filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for
        the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.1.2.7.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log/audit'

  "1.1.2.7.2":
    title: '1.1.2.7.2 | Ensure nodev option set on varlogaudit partition - manual'
    section: 'Configure /var/log/audit'
    description: |
        The                  nodev
         mount option specifies that the filesystem cannot contain special devices.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log/audit
        .
        Edit the                      /etc/fstab
         file and add                      nodev
         to the fourth field (mounting options) for the                      /var/log/audit
         partition.                   Example: <device> /var/log/audit    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime
        0 0

        Run the following command to remount                      /var/log/audit
         with the configured options:                   # mount -o remount /var/log/audit
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.7.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log/audit:nodev'

  "1.1.2.7.3":
    title: '1.1.2.7.3 | Ensure nosuid option set on varlogaudit partition - manual'
    section: 'Configure /var/log/audit'
    description: |
        The                  nosuid
         mount option specifies that the filesystem cannot contain                  setuid
         files.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log/audit
        .
        Edit the                      /etc/fstab
         file and add                      nosuid
         to the fourth field (mounting options) for the                      /var/log/audit
         partition.                   Example: <device> /var/log/audit    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime
        0 0

        Run the following command to remount                      /var/log/audit
         with the configured options:                   # mount -o remount /var/log/audit
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.7.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log/audit:nosuid'

  "1.1.2.7.4":
    title: '1.1.2.7.4 | Ensure noexec option set on varlogaudit partition - manual'
    section: 'Configure /var/log/audit'
    description: |
        The                  noexec
         mount option specifies that the filesystem cannot contain executable binaries.
    remediation: |
        - IF -
         a separate partition exists for                      /var/log/audit
        .
        Edit the                      /etc/fstab
         file and add                      noexec
         to the fourth field (mounting options) for the                      /var/log/audit
         partition.                   Example: <device> /var/log/audit    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime
        0 0

        Run the following command to remount                      /var/log/audit
         with the configured options:                   # mount -o remount /var/log/audit
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.2.7.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /var/log/audit:noexec'

  "1.2.1.1":
    title: '1.2.1.1 | Ensure GPG keys are configured - manual'
    section: 'Configure Package Repositories'
    description: |
        Most package managers implement GPG key signing to verify package integrity during installation.
    remediation: |
        Update your package manager GPG keys in accordance with site policy.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_1.2.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.2.1.2":
    title: '1.2.1.2 | Ensure package manager repositories are configured - manual'
    section: 'Configure Package Repositories'
    description: |
        Systems need to have package manager repositories configured to ensure they receive the latest patches and updates.
    remediation: |
        Configure your package manager repositories according to site policy.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_1.2.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.2.2.1":
    title: '1.2.2.1 | Ensure updates patches and additional security software are installed - manual'
    section: 'Configure Package Updates'
    description: |
        Periodically patches are released for included software either due to security flaws or to include additional
        functionality.
    remediation: |
        Run the following command to update all packages following local site policy guidance on applying updates and patches:
        # apt update

        # apt upgrade
          - OR -
        # apt dist-upgrade
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_1.2.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.3.1.1":
    title: '1.3.1.1 | Ensure AppArmor is installed'
    section: 'Configure AppArmor'
    description: |
        AppArmor provides Mandatory Access Controls.
    remediation: |
        Install AppArmor. # apt install apparmor apparmor-utils
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.3.1.2":
    title: '1.3.1.2 | Ensure AppArmor is enabled in the bootloader configuration'
    section: 'Configure AppArmor'
    description: |
        Configure AppArmor to be enabled at boot time and verify that it has not been overwritten by the bootloader boot
        parameters. Note This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in
        your environment enact equivalent settings.
    remediation: |
        Edit                    /etc/default/grub
         and add the                    apparmor=1
         and                    security=apparmor
         parameters to the                    GRUB_CMDLINE_LINUX=
         line                 GRUB_CMDLINE_LINUX="apparmor=1 security=apparmor"

        Run the following command to update the                    grub2
          configuration:                 # update-grub
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "1.3.1.3":
    title: '1.3.1.3 | Ensure all AppArmor Profiles are in enforce or complain mode - manual'
    section: 'Configure AppArmor'
    description: |
        AppArmor profiles define what resources applications are able to access.
    remediation: |
        Run the following command to set all profiles to enforce mode: # aa-enforce /etc/apparmor.d/*
         OR Run the following command to set all profiles to complain mode: # aa-complain /etc/apparmor.d/*
         Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == complain'

  "1.3.1.4":
    title: '1.3.1.4 | Ensure all AppArmor Profiles are enforcing - manual'
    section: 'Configure AppArmor'
    description: |
        AppArmor profiles define what resources applications are able to access.
    remediation: |
        Run the following command to set all profiles to enforce mode: # aa-enforce /etc/apparmor.d/*
         Note:
         Any unconfined processes may need to have a profile created or activated for them and then be restarted
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.3.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enforce'

  "1.4.1":
    title: '1.4.1 | Ensure bootloader password is set'
    section: 'Configure Bootloader'
    description: |
        Setting the boot loader password will require that anyone rebooting the system must enter a password before being able
        to set command line boot parameters
    remediation: |
        Create an encrypted password with                  grub-mkpasswd-pbkdf2
        :
        # grub-mkpasswd-pbkdf2 --iteration-count=600000 --salt=64

        Enter password: <password>
        Reenter password: <password>
        PBKDF2 hash of your password is <encrypted-password>

        Add the following into a custom                  /etc/grub.d
         configuration file:
        cat <<EOF
        exec tail -n +2 $0
        set superusers="<username>"
        password_pbkdf2 <username> <encrypted-password>
        EOF

        The superuser/user information and password should not be contained in the                  /etc/grub.d/00_header
         file as this file could be overwritten in a package update.
        If there is a requirement to be able to boot/reboot without entering the password, edit
        /etc/grub.d/10_linux
         and add                  --unrestricted
         to the line                  CLASS=
                              Example: CLASS="--class gnu-linux --class gnu --class os --unrestricted"

        Run the following command to update the                  grub2
         configuration:               # update-grub
         Impact: If password protection is enabled, only the designated superuser can edit a GRUB 2 menu item by pressing "e" or
        access the GRUB 2 command line by pressing "c" If GRUB 2 is set up to boot automatically to a password-protected menu
        entry the user has no option to back out of the password prompt to select another menu entry. Holding the SHIFT key will
        not display the menu in this case. The user must enter the correct username and password. If unable to do so, the
        configuration files will have to be edited via a LiveCD or other means to fix the problem
        You can add                    --unrestricted
         to the menu entries to allow the system to boot without entering a password.  A password will still be required to edit
        menu items.
        More Information:                     https://help.ubuntu.com/community/Grub2/Passwords
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.4.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.4.2":
    title: '1.4.2 | Ensure access to bootloader config is configured - manual'
    section: 'Configure Bootloader'
    description: |
        The grub configuration file contains information on boot settings and passwords for unlocking boot options.
    remediation: |
        Run the following commands to set permissions on your grub configuration:
        # chown root:root /boot/grub/grub.cfg
        # chmod u-x,go-rwx /boot/grub/grub.cfg
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.4.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /boot/grub/grub.cfg:0177'
            - name: Undefined
              rule: 'should cmp == /boot/grub/grub.cfg:root'
            - name: Undefined
              rule: 'should cmp == /boot/grub/grub.cfg:root'

  "1.5.1":
    title: '1.5.1 | Ensure address space layout randomization is enabled - manual'
    section: 'Configure Additional Process Hardening'
    description: |
        Address space layout randomization ASLR is an exploit mitigation technique which randomly arranges the address space of
        key data areas of a process.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               kernel.randomize_va_space = 2 Example: # printf "%s\n" "kernel.randomize_va_space = 2" >>
        /etc/sysctl.d/60-kernel_sysctl.conf
         Run the following command to set the active kernel parameter: # sysctl -w kernel.randomize_va_space=2
         Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == kernel.randomize_va_space=2'

  "1.5.2":
    title: '1.5.2 | Ensure ptrace scope is restricted - manual'
    section: 'Configure Additional Process Hardening'
    description: |
        The              ptrace
         system call provides a means by which one process the tracer may observe and control the execution of another process
        the tracee, and examine and change the tracees memory and registers.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               kernel.yama.ptrace_scope = 1 Example: # printf "%s\n" "kernel.yama.ptrace_scope = 1" >>
        /etc/sysctl.d/60-kernel_sysctl.conf
         Run the following command to set the active kernel parameter: # sysctl -w kernel.yama.ptrace_scope=1
         Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == kernel.yama.ptrace_scope=1'

  "1.5.3":
    title: '1.5.3 | Ensure core dumps are restricted'
    section: 'Configure Additional Process Hardening'
    description: |
        A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also
        be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core
        dumps, but this can be overridden by the user.
    remediation: |
        Add the following line to                  /etc/security/limits.conf
         or a                  /etc/security/limits.d/*
         file:               * hard core 0

        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               fs.suid_dumpable = 0 Example: # printf "%s\n" "fs.suid_dumpable = 0" >> /etc/sysctl.d/60-fs_sysctl.conf
         Run the following command to set the active kernel parameter: # sysctl -w fs.suid_dumpable=0
         Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
        -IF-
         systemd-coredump is installed:
        edit                  /etc/systemd/coredump.conf
         and add/modify the following lines:
        Storage=none
        ProcessSizeMax=0
                       Run the command: systemctl daemon-reload
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == fs.suid_dumpable=0'

  "1.5.4":
    title: '1.5.4 | Ensure prelink is not installed'
    section: 'Configure Additional Process Hardening'
    description: |
        prelink
         is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed
        for the dynamic linker to perform relocations at startup significantly decreases.
    remediation: |
        Run the following command to restore binaries to normal: # prelink -ua

        Uninstall                  prelink
          using the appropriate package manager or manual installation:               # apt purge prelink
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.5.5":
    title: '1.5.5 | Ensure Automatic Error Reporting is not enabled'
    section: 'Configure Additional Process Hardening'
    description: |
        The Apport Error Reporting Service automatically generates crash reports for debugging
    remediation: |
        Edit                  /etc/default/apport
         and add or edit the enabled parameter to equal                  0
        :               enabled=0
         Run the following commands to stop and mask the apport service
        # systemctl stop apport.service
        # systemctl mask apport.service
                       - OR - Run the following command to remove the apport package: # apt purge apport
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.5.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "1.6.1":
    title: '1.6.1 | Ensure message of the day is configured properly - manual'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/motd
          file are displayed to users after login and function as a message of the day for authenticated users.
        Unixbased systems have typically displayed information about the OS release and patch level upon logging in to the
        system. This information can be useful to developers who are developing software for a particular OS platform. If
        mingetty8
         supports the following options, they display operating system information              \m
           machine architecture              \r
           operating system release              \s
           operating system name              \v
           operating system version
    remediation: |
        Edit the                  /etc/motd
          file with the appropriate contents according to your site policy, remove any instances of                  \m
         ,                  \r
         ,                  \s
         ,                  \v
         or references to the                  OS platform
                              - OR - - IF -
         the                  motd
         is not used, this file can be removed.
        Run the following command to remove the                  motd
         file:               # rm /etc/motd
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "1.6.2":
    title: '1.6.2 | Ensure local login warning banner is configured properly'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/issue
          file are displayed to users prior to login for local terminals.
        Unixbased systems have typically displayed information about the OS release and patch level upon logging in to the
        system. This information can be useful to developers who are developing software for a particular OS platform. If
        mingetty8
         supports the following options, they display operating system information              \m
           machine architecture              \r
           operating system release              \s
           operating system name              \v
           operating system version  or the operating systems name
    remediation: |
        Edit the                  /etc/issue
          file with the appropriate contents according to your site policy, remove any instances of                  \m
         ,                  \r
         ,                  \s
         ,                  \v
         or references to the                  OS platform
                              Example: # echo "Authorized users only. All activity may be monitored and reported." > /etc/issue
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.6.3":
    title: '1.6.3 | Ensure remote login warning banner is configured properly'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/issue.net
          file are displayed to users prior to login for remote connections from configured services.
        Unixbased systems have typically displayed information about the OS release and patch level upon logging in to the
        system. This information can be useful to developers who are developing software for a particular OS platform. If
        mingetty8
         supports the following options, they display operating system information               \m
           machine architecture              \r
           operating system release              \s
           operating system name              \v
           operating system version
    remediation: |
        Edit the                  /etc/issue.net
          file with the appropriate contents according to your site policy, remove any instances of                  \m
         ,                  \r
         ,                  \s
         ,                  \v
         or references to the                  OS platform
                              Example: # echo "Authorized users only. All activity may be monitored and reported." >
        /etc/issue.net
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.6.4":
    title: '1.6.4 | Ensure access to etcmotd is configured - manual'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/motd
          file are displayed to users after login and function as a message of the day for authenticated users.
    remediation: |
        Run the following commands to set mode, owner, and group on                  /etc/motd
        :
        # chown root:root $(readlink -e /etc/motd)
        # chmod u-x,go-wx $(readlink -e /etc/motd)
                       - OR -
        Run the following command to remove the                  /etc/motd
         file:               # rm /etc/motd
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/motd:0133'
            - name: Undefined
              rule: 'should cmp == /etc/motd/:root'
            - name: Undefined
              rule: 'should cmp == /etc/motd/:root'

  "1.6.5":
    title: '1.6.5 | Ensure access to etcissue is configured - manual'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/issue
          file are displayed to users prior to login for local terminals.
    remediation: |
        Run the following commands to set mode, owner, and group on                  /etc/issue
        :
        # chown root:root $(readlink -e /etc/issue)
        # chmod u-x,go-wx $(readlink -e /etc/issue)
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/issue:0133'
            - name: Undefined
              rule: 'should cmp == /etc/issue/:root'
            - name: Undefined
              rule: 'should cmp == /etc/issue/:root'

  "1.6.6":
    title: '1.6.6 | Ensure access to etcissue.net is configured - manual'
    section: 'Configure Command Line Warning Banners'
    description: |
        The contents of the              /etc/issue.net
          file are displayed to users prior to login for remote connections from configured services.
    remediation: |
        Run the following commands to set mode, owner, and group on                  /etc/issue.net
        :
        # chown root:root $(readlink -e /etc/issue.net)
        # chmod u-x,go-wx $(readlink -e /etc/issue.net)
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.6.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/issue.net:0133'
            - name: Undefined
              rule: 'should cmp == /etc/issue.net/:root'
            - name: Undefined
              rule: 'should cmp == /etc/issue.net/:root'

  "1.7.1":
    title: '1.7.1 | Ensure GDM is removed'
    section: 'Configure GNOME Display Manager'
    description: |
        The GNOME Display Manager GDM is a program that manages graphical display servers and handles graphical user logins.
    remediation: |
        Run the following commands to uninstall                  gdm3
         and remove unused dependencies:
        # apt purge gdm3
        # apt autoremove gdm3
                       Impact: Removing the GNOME Display manager will remove the Graphical User Interface (GUI) from the
        system.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_1.7.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.2":
    title: '1.7.2 | Ensure GDM login banner is configured'
    section: 'Configure GNOME Display Manager'
    description: |
        GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.
    remediation: |
        - IF -
         GDM is installed:               Run the following script to set and enable the text banner message on the login screen:
        #!/usr/bin/env bash

        {
           l_pkgoutput=""
           if command -v dpkg-query &> /dev/null; then
              l_pq="dpkg-query -s"
           elif command -v rpm &> /dev/null; then
              l_pq="rpm -q"
           fi
           l_pcl="gdm gdm3" # Space separated list of packages to check
           for l_pn in $l_pcl; do
              $l_pq "$l_pn" &> /dev/null && l_pkgoutput="$l_pkgoutput\n - Package: \"$l_pn\" exists on the system\n - checking
        configuration"
           done
           if [ -n "$l_pkgoutput" ]; then

              l_gdmprofile="gdm" # Set this to desired profile name IaW Local site policy
              l_bmessage="'Authorized uses only. All activity may be monitored and reported'" # Set to desired banner message
              if [ ! -f "/etc/dconf/profile/$l_gdmprofile" ]; then
                 echo "Creating profile \"$l_gdmprofile\""
                 echo -e "user-db:user\nsystem-db:$l_gdmprofile\nfile-db:/usr/share/$l_gdmprofile/greeter-dconf-defaults" >
        /etc/dconf/profile/$l_gdmprofile
              fi
              if [ ! -d "/etc/dconf/db/$l_gdmprofile.d/" ]; then
                 echo "Creating dconf database directory \"/etc/dconf/db/$l_gdmprofile.d/\""
                 mkdir /etc/dconf/db/$l_gdmprofile.d/
              fi
              if ! grep -Piq '^\h*banner-message-enable\h*=\h*true\b' /etc/dconf/db/$l_gdmprofile.d/*; then
                 echo "creating gdm keyfile for machine-wide settings"
                 if ! grep -Piq -- '^\h*banner-message-enable\h*=\h*' /etc/dconf/db/$l_gdmprofile.d/*; then
                    l_kfile="/etc/dconf/db/$l_gdmprofile.d/01-banner-message"
                    echo -e "\n[org/gnome/login-screen]\nbanner-message-enable=true" >> "$l_kfile"
                 else
                    l_kfile="$(grep -Pil -- '^\h*banner-message-enable\h*=\h*' /etc/dconf/db/$l_gdmprofile.d/*)"
                    ! grep -Pq '^\h*\[org\/gnome\/login-screen\]' "$l_kfile" && sed -ri '/^\s*banner-message-enable/
        i\[org/gnome/login-screen]' "$l_kfile"
                    ! grep -Pq '^\h*banner-message-enable\h*=\h*true\b' "$l_kfile" && sed -ri 's/^\s*(banner-message-
        enable\s*=\s*)(\S+)(\s*.*$)/\1true \3//' "$l_kfile"
         #           sed -ri '/^\s*\[org\/gnome\/login-screen\]/ a\\nbanner-message-enable=true' "$l_kfile"
                 fi
              fi
              if ! grep -Piq "^\h*banner-message-text=[\'\"]+\S+" "$l_kfile"; then
                 sed -ri "/^\s*banner-message-enable/ a\banner-message-text=$l_bmessage" "$l_kfile"
              fi
              dconf update
           else
              echo -e "\n\n - GNOME Desktop Manager isn't installed\n - Recommendation is Not Applicable\n - No remediation
        required\n"
           fi
        }
                       Notes: There is no character limit for the banner message. gnome-shell autodetects longer stretches of
        text and enters two column mode. The banner message cannot be read from an external file.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.3":
    title: '1.7.3 | Ensure GDM disable-user-list option is enabled'
    section: 'Configure GNOME Display Manager'
    description: |
        GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.
        The              disableuserlist
         option controls if a list of users is displayed on the login screen
    remediation: |
        - IF -
         GDM is installed:
        Run the following script to enable the                  disable-user-list
         option:               Note:
         the                  l_gdm_profile
         variable in the script can be changed if a different profile name is desired in accordance with local site policy.
        #!/usr/bin/env bash

        {
           l_gdmprofile="gdm"
           if [ ! -f "/etc/dconf/profile/$l_gdmprofile" ]; then
              echo "Creating profile \"$l_gdmprofile\""
              echo -e "user-db:user\nsystem-db:$l_gdmprofile\nfile-db:/usr/share/$l_gdmprofile/greeter-dconf-defaults" >
        /etc/dconf/profile/$l_gdmprofile
           fi
           if [ ! -d "/etc/dconf/db/$l_gdmprofile.d/" ]; then
              echo "Creating dconf database directory \"/etc/dconf/db/$l_gdmprofile.d/\""
              mkdir /etc/dconf/db/$l_gdmprofile.d/
           fi
           if ! grep -Piq '^\h*disable-user-list\h*=\h*true\b' /etc/dconf/db/$l_gdmprofile.d/*; then
              echo "creating gdm keyfile for machine-wide settings"
              if ! grep -Piq -- '^\h*\[org\/gnome\/login-screen\]' /etc/dconf/db/$l_gdmprofile.d/*; then
                 echo -e "\n[org/gnome/login-screen]\n# Do not show the user list\ndisable-user-list=true" >>
        /etc/dconf/db/$l_gdmprofile.d/00-login-screen
              else
                 sed -ri '/^\s*\[org\/gnome\/login-screen\]/ a\# Do not show the user list\ndisable-user-list=true' $(grep -Pil
        -- '^\h*\[org\/gnome\/login-screen\]' /etc/dconf/db/$l_gdmprofile.d/*)
              fi
           fi
           dconf update
        }
                       Note:
         When the user profile is created or changed, the user will need to log out and log in again before the changes will be
        applied.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.4":
    title: '1.7.4 | Ensure GDM screen locks when the user is idle'
    section: 'Configure GNOME Display Manager'
    description: |
        GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.
    remediation: |
        Run the following commands to enable screen locks when the user is idle: # gsettings set org.gnome.desktop.screensaver
        lock-delay 5
         # gsettings set org.gnome.desktop.session idle-delay 900
         - OR-
        Create or edit the user profile in the                    /etc/dconf/profile/
         and verify it includes the following:
        user-db:user
        system-db:{NAME_OF_DCONF_DATABASE}
                       Note: local
         is the name of a dconf database used in the examples.
        Create the directory                      /etc/dconf/db/local.d/
         if it doesn't already exist:
        Create the key file                      /etc/dconf/db/local.d/00-screensaver
         to provide information for the                      local
         database:                   Example key file:
        # Specify the dconf path
        [org/gnome/desktop/session]

        # Number of seconds of inactivity before the screen goes blank
        # Set to 0 seconds if you want to deactivate the screensaver.
        idle-delay=uint32 180

        # Specify the dconf path
        [org/gnome/desktop/screensaver]

        # Number of seconds after the screen is blank before locking the screen
        lock-delay=uint32 0
                       Note:
         You must include the uint32 along with the integer key values as shown.               Run the following command to
        update the system databases: # dconf update
         Users must log out and back in again before the system-wide settings take effect. Note:
         Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.5":
    title: '1.7.5 | Ensure GDM screen locks cannot be overridden'
    section: 'Configure GNOME Display Manager'
    description: |
        GNOME Desktop Manager can lock down specific settings by using the lockdown mode in dconf to prevent users from changing
        specific settings. To lock down a dconf key or subpath,  create a locks subdirectory in the keyfile directory. The files
        inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of
        files to this directory.
    remediation: |
        To prevent the user from overriding these settings, create the file
        /etc/dconf/db/local.d/locks/screensaver
         with the following content:
        # Lock desktop screensaver settings
        /org/gnome/desktop/session/idle-delay
        /org/gnome/desktop/screensaver/lock-delay
                       Update the system databases: # dconf update
         Note:
         Users must log out and back in again before the system-wide settings take effect.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.6":
    title: '1.7.6 | Ensure GDM automatic mounting of removable media is disabled'
    section: 'Configure GNOME Display Manager'
    description: |
        By default GNOME automatically mounts removable media when inserted as a convenience to the user.
    remediation: |
        - IF -
         GDM is installed:               Run the following script to disable automatic mounting of media for all GNOME users:
        #!/usr/bin/env bash

        {
           l_pkgoutput=""
           l_gpname="local" # Set to desired dconf profile name (default is local)
           # Check if GNOME Desktop Manager is installed.  If package isn't installed, recommendation is Not Applicable\n
           # determine system's package manager
           if command -v dpkg-query > /dev/null 2>&1; then
              l_pq="dpkg-query -s"
           elif command -v rpm > /dev/null 2>&1; then
              l_pq="rpm -q"
           fi
           # Check if GDM is installed
           l_pcl="gdm gdm3" # Space seporated list of packages to check
           for l_pn in $l_pcl; do
              $l_pq "$l_pn" > /dev/null 2>&1 && l_pkgoutput="$l_pkgoutput\n - Package: \"$l_pn\" exists on the system\n -
        checking configuration"
           done
           # Check configuration (If applicable)
           if [ -n "$l_pkgoutput" ]; then
              echo -e "$l_pkgoutput"
              # Look for existing settings and set variables if they exist
              l_kfile="$(grep -Prils -- '^\h*automount\b' /etc/dconf/db/*.d)"
              l_kfile2="$(grep -Prils -- '^\h*automount-open\b' /etc/dconf/db/*.d)"
              # Set profile name based on dconf db directory ({PROFILE_NAME}.d)
              if [ -f "$l_kfile" ]; then
                 l_gpname="$(awk -F\/ '{split($(NF-1),a,".");print a[1]}' <<< "$l_kfile")"
                 echo " - updating dconf profile name to \"$l_gpname\""
              elif [ -f "$l_kfile2" ]; then
                 l_gpname="$(awk -F\/ '{split($(NF-1),a,".");print a[1]}' <<< "$l_kfile2")"
                 echo " - updating dconf profile name to \"$l_gpname\""
              fi
              # check for consistency (Clean up configuration if needed)
              if [ -f "$l_kfile" ] && [ "$(awk -F\/ '{split($(NF-1),a,".");print a[1]}' <<< "$l_kfile")" != "$l_gpname" ]; then
                 sed -ri "/^\s*automount\s*=/s/^/# /" "$l_kfile"
                 l_kfile="/etc/dconf/db/$l_gpname.d/00-media-automount"
              fi
              if [ -f "$l_kfile2" ] && [ "$(awk -F\/ '{split($(NF-1),a,".");print a[1]}' <<< "$l_kfile2")" != "$l_gpname" ];
        then
                 sed -ri "/^\s*automount-open\s*=/s/^/# /" "$l_kfile2"
              fi
              [ -z "$l_kfile" ] && l_kfile="/etc/dconf/db/$l_gpname.d/00-media-automount"
              # Check if profile file exists
              if grep -Pq -- "^\h*system-db:$l_gpname\b" /etc/dconf/profile/*; then
                 echo -e "\n - dconf database profile exists in: \"$(grep -Pl -- "^\h*system-db:$l_gpname\b"
        /etc/dconf/profile/*)\""
              else
                 if [ ! -f "/etc/dconf/profile/user" ]; then
                    l_gpfile="/etc/dconf/profile/user"
                 else
                    l_gpfile="/etc/dconf/profile/user2"
                 fi
                 echo -e " - creating dconf database profile"
                 {
                    echo -e "\nuser-db:user"
                    echo "system-db:$l_gpname"
                 } >> "$l_gpfile"
              fi
              # create dconf directory if it doesn't exists
              l_gpdir="/etc/dconf/db/$l_gpname.d"
              if [ -d "$l_gpdir" ]; then
                 echo " - The dconf database directory \"$l_gpdir\" exists"
              else
                 echo " - creating dconf database directory \"$l_gpdir\""
                 mkdir "$l_gpdir"
              fi
              # check automount-open setting
              if grep -Pqs -- '^\h*automount-open\h*=\h*false\b' "$l_kfile"; then
                 echo " - \"automount-open\" is set to false in: \"$l_kfile\""
              else
                 echo " - creating \"automount-open\" entry in \"$l_kfile\""
                 ! grep -Psq -- '\^\h*\[org\/gnome\/desktop\/media-handling\]\b' "$l_kfile" && echo '[org/gnome/desktop/media-
        handling]' >> "$l_kfile"
                 sed -ri '/^\s*\[org\/gnome\/desktop\/media-handling\]/a \\nautomount-open=false' "$l_kfile"
              fi
              # check automount setting
              if grep -Pqs -- '^\h*automount\h*=\h*false\b' "$l_kfile"; then
                 echo " - \"automount\" is set to false in: \"$l_kfile\""
              else
                 echo " - creating \"automount\" entry in \"$l_kfile\""
                 ! grep -Psq -- '\^\h*\[org\/gnome\/desktop\/media-handling\]\b' "$l_kfile" && echo '[org/gnome/desktop/media-
        handling]' >> "$l_kfile"
                 sed -ri '/^\s*\[org\/gnome\/desktop\/media-handling\]/a \\nautomount=false' "$l_kfile"
              fi
              # update dconf database
              dconf update
           else
              echo -e "\n - GNOME Desktop Manager package is not installed on the system\n  - Recommendation is not applicable"
           fi
        }
                       Impact: The use of portable hard drives is very common for workstation users. If your organization allows
        the use of portable storage or media on workstations and physical access controls to workstations is considered adequate
        there is little value add in turning off automounting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.7":
    title: '1.7.7 | Ensure GDM disabling automatic mounting of removable media is not overridden'
    section: 'Configure GNOME Display Manager'
    description: |
        By default GNOME automatically mounts removable media when inserted as a convenience to the user. By using the lockdown
        mode in dconf, you can prevent users from changing specific settings. To lock down a dconf key or subpath, create a
        locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock.
        Just as with the keyfiles, you may add any number of files to this directory.
    remediation: |
        To prevent the user from overriding these settings, create the file
        /etc/dconf/db/local.d/locks/00-media-automount
         with the following content:
        [org/gnome/desktop/media-handling]
        automount=false
        automount-open=false
                       Update the systems databases: # dconf update
         Impact: The use of portable hard drives is very common for workstation users
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.8":
    title: '1.7.8 | Ensure GDM autorun-never is enabled'
    section: 'Configure GNOME Display Manager'
    description: |
        The              autorunnever
         setting allows the GNOME Desktop Display Manager to disable autorun through GDM.
    remediation: |
        - IF -
         GDM is installed:
        Run the following script to set                  autorun-never
         to                  true
         for GDM users:
        #!/usr/bin/env bash

        {
           l_pkgoutput="" l_output="" l_output2=""
           l_gpname="local" # Set to desired dconf profile name (default is local)
           # Check if GNOME Desktop Manager is installed.  If package isn't installed, recommendation is Not Applicable\n
           # determine system's package manager
           if command -v dpkg-query &> /dev/null; then
              l_pq="dpkg-query -s"
           elif command -v rpm &> /dev/null; then
              l_pq="rpm -q"
           fi
           # Check if GDM is installed
           l_pcl="gdm gdm3" # Space separated list of packages to check
           for l_pn in $l_pcl; do
              $l_pq "$l_pn" &> /dev/null && l_pkgoutput="$l_pkgoutput\n - Package: \"$l_pn\" exists on the system\n - checking
        configuration"
           done
           echo -e "$l_pkgoutput"
           # Check configuration (If applicable)
           if [ -n "$l_pkgoutput" ]; then
              echo -e "$l_pkgoutput"
              # Look for existing settings and set variables if they exist
              l_kfile="$(grep -Prils -- '^\h*autorun-never\b' /etc/dconf/db/*.d)"
              # Set profile name based on dconf db directory ({PROFILE_NAME}.d)
              if [ -f "$l_kfile" ]; then
                 l_gpname="$(awk -F\/ '{split($(NF-1),a,".");print a[1]}' <<< "$l_kfile")"
                 echo " - updating dconf profile name to \"$l_gpname\""
              fi
              [ ! -f "$l_kfile" ] && l_kfile="/etc/dconf/db/$l_gpname.d/00-media-autorun"
              # Check if profile file exists
              if grep -Pq -- "^\h*system-db:$l_gpname\b" /etc/dconf/profile/*; then
                 echo -e "\n - dconf database profile exists in: \"$(grep -Pl -- "^\h*system-db:$l_gpname\b"
        /etc/dconf/profile/*)\""
              else
                 [ ! -f "/etc/dconf/profile/user" ] && l_gpfile="/etc/dconf/profile/user" || l_gpfile="/etc/dconf/profile/user2"
                 echo -e " - creating dconf database profile"
                 {
                    echo -e "\nuser-db:user"
                    echo "system-db:$l_gpname"
                 } >> "$l_gpfile"
              fi
              # create dconf directory if it doesn't exists
              l_gpdir="/etc/dconf/db/$l_gpname.d"
              if [ -d "$l_gpdir" ]; then
                 echo " - The dconf database directory \"$l_gpdir\" exists"
              else
                 echo " - creating dconf database directory \"$l_gpdir\""
                 mkdir "$l_gpdir"
              fi
              # check autorun-never setting
              if grep -Pqs -- '^\h*autorun-never\h*=\h*true\b' "$l_kfile"; then
                 echo " - \"autorun-never\" is set to true in: \"$l_kfile\""
              else
                 echo " - creating or updating \"autorun-never\" entry in \"$l_kfile\""
                 if grep -Psq -- '^\h*autorun-never' "$l_kfile"; then
                    sed -ri 's/(^\s*autorun-never\s*=\s*)(\S+)(\s*.*)$/\1true \3/' "$l_kfile"
                 else
                    ! grep -Psq -- '\^\h*\[org\/gnome\/desktop\/media-handling\]\b' "$l_kfile" && echo
        '[org/gnome/desktop/media-handling]' >> "$l_kfile"
                    sed -ri '/^\s*\[org\/gnome\/desktop\/media-handling\]/a \\nautorun-never=true' "$l_kfile"
                 fi
              fi
           else
              echo -e "\n - GNOME Desktop Manager package is not installed on the system\n  - Recommendation is not applicable"
           fi
           # update dconf database
           dconf update
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.9":
    title: '1.7.9 | Ensure GDM autorun-never is not overridden'
    section: 'Configure GNOME Display Manager'
    description: |
        The autorunnever setting allows the GNOME Desktop Display Manager to disable autorun through GDM. By using the lockdown
        mode in dconf, you can prevent users from changing specific settings. To lock down a dconf key or subpath, create a
        locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock.
        Just as with the keyfiles, you may add any number of files to this directory.
    remediation: |
        To prevent the user from overriding these settings, create the file
        /etc/dconf/db/local.d/locks/00-media-autorun
         with the following content:
        [org/gnome/desktop/media-handling]
        autorun-never=true
                       Update the systems databases: # dconf update
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "1.7.10":
    title: '1.7.10 | Ensure XDCMP is not enabled - manual'
    section: 'Configure GNOME Display Manager'
    description: |
        X Display Manager Control Protocol XDMCP is designed to provide authenticated access to display management services for
        remote displays
    remediation: |
        Edit all files returned by the audit and remove or commend out the                  Enable=true
         line in the                  [xdmcp]
         block:               Example file:
        # GDM configuration storage
        #
        # See /usr/share/gdm/gdm.schemas for a list of available options.

        [daemon]
        # Uncomment the line below to force the login screen to use Xorg
        #WaylandEnable=false

        # Enabling automatic login
        #  AutomaticLoginEnable = true
        #  AutomaticLogin = user1

        # Enabling timed login
        #  TimedLoginEnable = true
        #  TimedLogin = user1
        #  TimedLoginDelay = 10

        [security]

        [xdmcp]
        # Enable=true <- **This line should be removed or commented out**

        [chooser]

        [debug]
        # Uncomment the line below to turn on debugging
        # More verbose logs
        # Additionally lets the X server dump core if it crashes
        #Enable=true
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.7.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.1.1":
    title: '2.1.1 | Ensure autofs services are not in use'
    section: 'Configure Server Services'
    description: |
        autofs
         allows automatic mounting of devices, typically including CD/DVDs and USB drives.
    remediation: |
        Run the following commands to stop                  autofs.service
         and remove the                  autofs
         package:
        # systemctl stop autofs.service
        # apt purge autofs
                       - OR - - IF -
         the                  autofs
         package is required as a dependency:
        Run the following commands to stop and mask                  autofs.service
        :
        # systemctl stop autofs.service
        # systemctl mask autofs.service
                       Impact: The use of portable hard drives is very common for workstation users. If your organization allows
        the use of portable storage or media on workstations and physical access controls to workstations is considered adequate
        there is little value add in turning off automounting.
        There may be packages that are dependent on the                    autofs
         package.  If the                    autofs
         package is removed, these dependent packages will be removed as well. Before removing the                    autofs
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    autofs.service
          leaving the                    autofs
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.2":
    title: '2.1.2 | Ensure avahi daemon services are not in use'
    section: 'Configure Server Services'
    description: |
        Avahi is a free zeroconf implementation, including a system for multicast DNS/DNSSD service discovery. Avahi allows
        programs to publish and discover services and hosts running on a local network with no specific configuration. For
        example, a user can plug a computer into a network and Avahi automatically finds printers to print to, files to look at
        and people to talk to, as well as network services running on the machine.
    remediation: |
        Run the following commands to stop                  avahi-daemon.socket
         and                  avahi-daemon.service
        , and remove the                  avahi-daemon
         package:
        # systemctl stop avahi-daemon.socket avahi-daemon.service
        # apt purge avahi-daemon
                       - OR - - IF -
         the                  avahi-daemon
         package is required as a dependency:
        Run the following commands to stop and mask the                  avahi-daemon.socket
         and                  avahi-daemon.service
        :
        # systemctl stop avahi-daemon.socket avahi-daemon.service
        # systemctl mask avahi-daemon.socket avahi-daemon.service
                       Impact:
        There may be packages that are dependent on the                    avahi
         package.  If the                    avahi
         package is removed, these dependent packages will be removed as well. Before removing the                    avahi
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    avahi-daemon.socket
         and                    avahi-daemon.service
         leaving the                    avahi
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.3":
    title: '2.1.3 | Ensure dhcp server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Dynamic Host Configuration Protocol DHCP is a service that allows machines to be dynamically assigned IP addresses.
        There are two versions of the DHCP protocol              DHCPv4
         and              DHCPv6
        . At startup the server may be started for one or the other via the              4
         or              6
         arguments.
    remediation: |
        Run the following commands to stop                  isc-dhcp-server.service
         and                  isc-dhcp-server6.service
         and remove the                  isc-dhcp-server
         package:
        # systemctl stop isc-dhcp-server.service isc-dhcp-server6.service
        # apt purge isc-dhcp-server
                       - OR - - IF -
         the                  isc-dhcp-server
         package is required as a dependency:
        Run the following commands to stop and mask                  isc-dhcp-server.service
         and                  isc-dhcp-server6.service
        :
        # systemctl stop isc-dhcp-server.service isc-dhcp-server6.service
        # systemctl mask isc-dhcp-server isc-dhcp-server6.service
                       Impact:
        There may be packages that are dependent on the                    isc-dhcp-server
         package.  If the                    isc-dhcp-server
         package is removed, these dependent packages will be removed as well. Before removing the                    isc-dhcp-
        server
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    isc-dhcp-server.service
         and                    isc-dhcp-server6.service
         leaving the                    isc-dhcp-server
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.4":
    title: '2.1.4 | Ensure dns server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Domain Name System DNS is a hierarchical naming system that maps names to IP addresses for computers, services and
        other resources connected to a network.
    remediation: |
        Run the following commands to stop                  bind9.service
         and remove the                  bind9
         package:
        # systemctl stop bind9.service
        # apt purge bind9
                       - OR - - IF -
         the                  bind9
         package is required as a dependency:
        Run the following commands to stop and mask                  bind9.service
        :
        # systemctl stop bind9.service
        # systemctl mask bind9.service
                       Impact:
        There may be packages that are dependent on the                    bind9
         package.  If the                    bind9
         package is removed, these dependent packages will be removed as well. Before removing the                    bind9
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    bind9.service
          leaving the                    bind9
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.5":
    title: '2.1.5 | Ensure dnsmasq services are not in use'
    section: 'Configure Server Services'
    description: |
        dnsmasq
         is a lightweight tool that provides DNS caching, DNS forwarding and DHCP Dynamic Host Configuration Protocol services.
    remediation: |
        Run the following commands to stop                  dnsmasq.service
         and remove                  dnsmasq
         package:
        # systemctl stop dnsmasq.service
        # apt purge dnsmasq
                       - OR - - IF -
         the                  dnsmasq
         package is required as a dependency:
        Run the following commands to stop and mask the                  dnsmasq.service
        :
        # systemctl stop dnsmasq.service
        # systemctl mask dnsmasq.service
                       Impact:
        There may be packages that are dependent on the                    dnsmasq
         package.  If the                    dnsmasq
         package is removed, these dependent packages will be removed as well. Before removing the                    dnsmasq
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    dnsmasq.service
          leaving the                    dnsmasq
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.6":
    title: '2.1.6 | Ensure ftp server services are not in use'
    section: 'Configure Server Services'
    description: |
        The File Transfer Protocol FTP provides networked computers with the ability to transfer files.
    remediation: |
        Run the following commands to stop                  vsftpd.service
         and remove the                  vsftpd
         package:
        # systemctl stop vsftpd.service
        # apt purge vsftpd
                       - OR - - IF -
         the                  vsftpd
         package is required as a dependency:
        Run the following commands to stop and mask the                  vsftpd.service
        :
        # systemctl stop vsftpd.service
        # systemctl mask vsftpd.service
                       Note:
         Other ftp server packages may exist. If not required and authorized by local site policy, they should also be removed.
        If the package is required for a dependency, the service should be stopped and masked.               Impact:
        There may be packages that are dependent on the                    vsftpd
         package.  If the                    vsftpd
         package is removed, these dependent packages will be removed as well. Before removing the                    vsftpd
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    vsftpd.service
          leaving the                    vsftpd
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.7":
    title: '2.1.7 | Ensure ldap server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Lightweight Directory Access Protocol LDAP was introduced as a replacement for NIS/YP. It is a service that provides
        a method for looking up information from a central database.
    remediation: |
        Run the following commands to stop                  slapd.service
         and remove the                  slapd
         package:
        # systemctl stop slapd.service
        # apt purge slapd
                       - OR - - IF -
         the                  slapd
         package is required as a dependency:
        Run the following commands to stop and mask                  slapd.service
        :
        # systemctl stop slapd.service
        # systemctl mask slapd.service
                       Impact:
        There may be packages that are dependent on the                    slapd
         package.  If the                    slapd
         package is removed, these dependent packages will be removed as well. Before removing the                    slapd
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    slapd.service
         leaving the                    slapd
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.8":
    title: '2.1.8 | Ensure message access server services are not in use'
    section: 'Configure Server Services'
    description: |
        dovecotimapd
         and              dovecotpop3d
         are an open source IMAP and POP3 server for Linux based systems.
    remediation: |
        Run one of the following commands to remove                  dovecot-imapd
         and                  dovecot-pop3d
        :
        Run the following commands to stop                  dovecot.socket
         and                  dovecot.service
        , and remove the                  dovecot-imapd
         and                  dovecot-pop3d
         packages:
        # systemctl stop dovecot.socket dovecot.service
        # apt purge dovecot-imapd dovecot-pop3d
                       - OR - - IF -
         a package is installed                  and
         is required for dependencies:
        Run the following commands to stop and mask                  dovecot.socket
         and                  dovecot.service
        :
        # systemctl stop dovecot.socket dovecot.service
        # systemctl mask dovecot.socket dovecot.service
                       Impact:
        There may be packages that are dependent on                    dovecot-imapd
         and/or                    dovecot-pop3d
         packages. If                    dovecot-imapd
         and                    dovecot-pop3d
         packages are removed, these dependent packages will be removed as well. Before removing                    dovecot-
        imapd
         and/or                    dovecot-pop3d
         packages, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask                    dovecot.socket
         and                     dovecot.service
         leaving                    dovecot-imapd
         and/or                    dovecot-pop3d
         packages installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.9":
    title: '2.1.9 | Ensure network file system services are not in use'
    section: 'Configure Server Services'
    description: |
        The Network File System NFS is one of the first and most widely distributed file systems in the UNIX environment. It
        provides the ability for systems to mount file systems of other servers through the network.
    remediation: |
        Run the following command to stop                  nfs-server.service
         and remove                  nfs-kernel-server
         package:
        # systemctl stop nfs-server.service
        # apt purge nfs-kernel-server
                       - OR - - IF -
         the                  nfs-kernel-server
         package is required as a dependency:
        Run the following commands to stop and mask the                  nfs-server.service
        :
        # systemctl stop nfs-server.service
        # systemctl mask nfs-server.service
                       Impact:
        There may be packages that are dependent on the                    nfs-kernel-server
         package. If the                    nfs-kernel-server
         package is removed, these dependent packages will be removed as well. Before removing the                    nfs-
        kernel-server
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    nfs-server.service
          leaving the                    nfs-kernel-server
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.10":
    title: '2.1.10 | Ensure nis server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Network Information Service NIS formally known as Yellow Pages is a clientserver directory service protocol for
        distributing system configuration files. The NIS server is a collection of programs that allow for the distribution of
        configuration files. The NIS client              ypbind
         was used to bind a machine to an NIS server and receive the distributed configuration files.
    remediation: |
        Run the following commands to stop                  ypserv.service
         and remove                  ypserv
         package:
        # systemctl stop ypserv.service
        # apt purge ypserv
                       - OR - - IF -
         the                  ypserv
         package is required as a dependency:
        Run the following commands to stop and mask                  ypserv.service
        :
        # systemctl stop ypserv.service
        # systemctl mask ypserv.service
                       Impact:
        There may be packages that are dependent on the                    ypserv
         package.  If the                    ypserv
         package is removed, these dependent packages will be removed as well. Before removing the                    ypserv
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    ypserv.service
         leaving the                    ypserv
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.11":
    title: '2.1.11 | Ensure print server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Common Unix Print System CUPS provides the ability to print to both local and network printers. A system running
        CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based
        remote administration capability.
    remediation: |
        Run the following commands to stop                  cups.socket
         and                  cups.service
        , and remove the                  cups
         package:
        # systemctl stop cups.socket cups.service
        # apt purge cups
                       - OR - - IF -
         the                  cups
         package is required as a dependency:
        Run the following commands to stop and mask the                  cups.socket
         and                  cups.service
        :
        # systemctl stop cups.socket cups.service
        # systemctl mask cups.socket cups.service
                       Impact:
        Removing the cups package, or disabling                    cups.socket
         and/or                    cups.service
         will prevent printing from the system, a common task for workstation systems.
        There may be packages that are dependent on the                    cups
         package. If the                    cups
         package is removed, these dependent packages will be removed as well. Before removing the                    cups
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask                    cups.socket
         and                    cups.service
         leaving the                    cups
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.11', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.12":
    title: '2.1.12 | Ensure rpcbind services are not in use'
    section: 'Configure Server Services'
    description: |
        The              rpcbind
         utility maps RPC services to the ports on which they listen. RPC processes notify              rpcbind
         when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The
        client system then contacts              rpcbind
         on the server with a particular RPC program number. The              rpcbind.service
         redirects the client to the proper port number so it can communicate with the requested service.           Portmapper
        is an RPC service, which always listens on tcp and udp 111, and is used to map other RPC services such as nfs, nlockmgr,
        quotad, mountd, etc. to their corresponding port number on the server. When a remote host makes an RPC call to that
        server, it first consults with portmap to determine where the RPC server is listening.
    remediation: |
        Run the following commands to stop                  rpcbind.socket
         and                  rpcbind.service
        , and remove the                  rpcbind
         package:
        # systemctl stop rpcbind.socket rpcbind.service
        # apt purge rpcbind
                       - OR - - IF -
         the                  rpcbind
         package is required as a dependency:
        Run the following commands to stop and mask the                  rpcbind.socket
         and                  rpcbind.service
        :
        # systemctl stop rpcbind.socket rpcbind.service
        # systemctl mask rpcbind.socket rpcbind.service
                       Impact:
        Many of the libvirt packages used by Enterprise Linux virtualization, and the                    nfs-utils
         package used for The Network File System (NFS), are dependent on the                    rpcbind
         package. If the                    rpcbind
         package is removed, these dependent packages will be removed as well. Before removing the                    rpcbind
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    rpcbind.socket
         and                    rpcbind.service
         leaving the                    rpcbind
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.12', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.13":
    title: '2.1.13 | Ensure rsync services are not in use'
    section: 'Configure Server Services'
    description: |
        The              rsync
          service can be used to synchronize files between systems over network links.
    remediation: |
        Run the following commands to stop                  rsync.service
        , and remove the                  rsync
         package:
        # systemctl stop rsync.service
        # apt purge rsync
                       - OR - - IF -
         the                  rsync
         package is required as a dependency:
        Run the following commands to stop and mask                  rsync.service
        :
        # systemctl stop rsync.service
        # systemctl mask rsync.service
                       Impact:
        There may be packages that are dependent on the                    rsync
         package.  If the                    rsync
         package is removed, these dependent packages will be removed as well. Before removing the                    rsync
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask                    rsync.service
         leaving the                    rsync
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.13', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.14":
    title: '2.1.14 | Ensure samba file server services are not in use'
    section: 'Configure Server Services'
    description: |
        The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories
        with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block SMB protocol.
        Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.
    remediation: |
        Run the following commands to stop                  smbd.service
         and remove                  samba
         package:
        # systemctl stop smbd.service
        # apt purge samba
                       - OR - - IF -
         the                  samba
         package is required as a dependency:
        Run the following commands to stop and mask the                  smbd.service
        :
        # systemctl stop smbd.service
        # systemctl mask smbd.service
                       Impact:
        There may be packages that are dependent on the                    samba
         package.  If the                    samba
         package is removed, these dependent packages will be removed as well. Before removing the                    samba
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    smbd.service
          leaving the                    samba
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.14', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.15":
    title: '2.1.15 | Ensure snmp services are not in use'
    section: 'Configure Server Services'
    description: |
        Simple Network Management Protocol SNMP is a widely used protocol for monitoring the health and welfare of network
        equipment, computer equipment and devices like UPSs. NetSNMP is a suite of applications used to implement SNMPv1 RFC
        1157, SNMPv2 RFCs 19011908, and SNMPv3 RFCs 34113418 using both IPv4 and IPv6. Support for SNMPv2 classic a.k.a. SNMPv2
        historic  RFCs 14411452 was dropped with the 4.0 release of the UCDsnmp package. The Simple Network Management Protocol
        SNMP server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the
        information and then send results back to the requesting system.
    remediation: |
        Run the following commands to stop                  snmpd.service
         and remove the                  snmpd
         package:
        # systemctl stop snmpd.service
        # apt purge snmpd
                       - OR -
         If the package is required for dependencies:
        Run the following commands to stop and mask the                  snmpd.service
        :
        # systemctl stop snmpd.service
        # systemctl mask snmpd.service
                       Impact:
        There may be packages that are dependent on the                    snmpd
         package. If the                    snmpd
         package is removed, these packages will be removed as well.
        Before removing the                    snmpd
         package, review any dependent packages to determine if they are required on the system. If a dependent package is
        required, stop and mask the                    snmpd.service
         leaving the                    snmpd
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.15', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.16":
    title: '2.1.16 | Ensure tftp server services are not in use'
    section: 'Configure Server Services'
    description: |
        Trivial File Transfer Protocol TFTP is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers
        allow connections from a TFTP Client for sending and receiving files.
    remediation: |
        Run the following commands to stop                  tftpd-hpa.service
        , and remove the                  tftpd-hpa
         package:
        # systemctl stop tftpd-hpa.service
        # apt purge tftpd-hpa
                       - OR - - IF -
         the                  tftpd-hpa
         package is required as a dependency:
        Run the following commands to stop and mask                  tftpd-hpa.service
        :
        # systemctl stop tftpd-hpa.service
        # systemctl mask tftpd-hpa.service
                       Impact: TFTP is often used to provide files for network booting such as for PXE based installation of
        servers.
        There may be packages that are dependent on the                    tftpd-hpa
         package.  If the                    tftpd-hpa
         package is removed, these dependent packages will be removed as well. Before removing the                    tftpd-hpa
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask                    tftpd-hpa.service
         leaving the                    tftpd-hpa
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.16', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.17":
    title: '2.1.17 | Ensure web proxy server services are not in use'
    section: 'Configure Server Services'
    description: |
        Squid is a standard proxy server used in many distributions and environments.
    remediation: |
        Run the following commands to stop                  squid.service
         and remove the                  squid
         package:
        # systemctl stop squid.service
        # apt purge squid
                       - OR -
         If the                  squid
         package is required as a dependency:
        Run the following commands to stop and mask the                  squid.service
        :
        # systemctl stop squid.service
        # systemctl mask squid.service
                       Impact:
        There may be packages that are dependent on the                    squid
         package.  If the                    squid
         package is removed, these dependent packages will be removed as well. Before removing the                    squid
         package, review any dependent packages to determine if they are required on the system.                 - IF -
         a dependent package is required: stop and mask the                    squid.service
          leaving the                    squid
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.17', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.18":
    title: '2.1.18 | Ensure web server services are not in use'
    section: 'Configure Server Services'
    description: |
        Web servers provide the ability to host web site content.
    remediation: |
        Run the following commands to stop                  httpd.socket
        ,                  httpd.service
        , and                  nginx.service
        , and remove                  httpd
         and                  nginx
         packages:
        # systemctl stop apache2.socket httpd.service nginx.service
        # apt purge apache2 nginx
                       - OR - - IF -
         a package is installed                  and
         is required for dependencies:
        Run the following commands to stop and mask                  apache2.socket
        ,                  apache2.service
        , and                  nginx.service
        :
        # systemctl stop apache2.socket apache2.service nginx.service
        # systemctl mask apache2.socket apache2.service nginx.service
                       Note:
         Other web server packages may exist. If not required and authorized by local site policy, they should also be removed.
        If the package is required for a dependency, the service and socket should be stopped and masked.               Impact:
        Removal of web server packages will remove that ability for the server to host web services. - IF -
         the web server package is required for a dependency, any related service or socket should be stopped and masked.
        Note:
         If the remediation steps to mask a service are followed and that package is not installed on the system, the service
        and/or socket will still be masked. If the package is installed due to an approved requirement to host a web server, the
        associated service and/or socket would need to be unmasked before it could be enabled and/or started.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.18', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.19":
    title: '2.1.19 | Ensure xinetd services are not in use'
    section: 'Configure Server Services'
    description: |
        The X Window System provides a Graphical User Interface GUI where users can have multiple windows in which to run
        programs and various add on. The X Windows system is typically used on workstations where users login, but not on
        servers where users typically do not login.
    remediation: |
        Run the following commands to stop                  xinetd.service
        , and remove the                  xinetd
         package:
        # systemctl stop xinetd.service
        # apt purge xinetd
                       -OR- -IF-
         the                  xinetd
         package is required as a dependency:
        Run the following commands to stop and mask the                  xinetd.service
        :
        # systemctl stop xinetd.service
        # systemctl mask xinetd.service
                       Impact:
        There may be packages that are dependent on the                    xinetd
         package. If the                    xinetd
         package is removed, these dependent packages will be removed as well. Before removing the                    xinetd
         package, review any dependent packages to determine if they are required on the system.                 -IF-
         a dependent package is required: stop and mask xinetd.service leaving the xinetd package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.19', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "2.1.20":
    title: '2.1.20 | Ensure X window server services are not in use'
    section: 'Configure Server Services'
    description: |
        The X Window System provides a Graphical User Interface GUI where users can have multiple windows in which to run
        programs and various add on. The X Windows system is typically used on workstations where users login, but not on
        servers where users typically do not login.
    remediation: |
        - IF -
         a Graphical Desktop Manager or X-Windows server is not required and approved by local site policy:               Run
        the following command to remove the X Windows Server package: # apt purge xserver-common
         Impact:
        If a Graphical Desktop Manager (GDM) is in use on the system, there may be a dependency on the
        xorg-x11-server-common
         package. If the GDM is required and approved by local site policy, the package should                    not
         be removed.                 Many Linux systems run applications which require a Java runtime.  Some Linux Java packages
        have a dependency on specific X Windows xorg-x11-fonts.  One workaround to avoid this dependency is to use the
        "headless" Java packages for your specific Java runtime.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.1.20', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.1.21":
    title: '2.1.21 | Ensure mail transfer agent is configured for local-only mode - manual'
    section: 'Configure Server Services'
    description: |
        Mail Transfer Agents MTA, such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages
        to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the
        MTA be configured to only process local mail.
    remediation: |
        Edit                  /etc/postfix/main.cf
         and add the following line to the RECEIVING MAIL section. If the line already exists, change it to look like the line
        below:               inet_interfaces = loopback-only

        Run the following command to restart                  postfix
        :               # systemctl restart postfix
         Note: This recommendation is designed around the postfix mail server. Depending on your environment you may have an
        alternative MTA installed such as exim4. If this is the case consult the documentation for your installed MTA to
        configure the recommended state.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.21', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.1.22":
    title: '2.1.22 | Ensure only approved services are listening on a network interface - manual'
    section: 'Configure Server Services'
    description: |
        A network port is identified by its number, the associated IP address, and the type of the communication protocol such
        as TCP or UDP. A listening port is a network port on which an application or process listens on, acting as a
        communication endpoint. Each listening port can be open or closed filtered using a firewall. In general terms, an open
        port is a network port that accepts incoming packets from remote locations.
    remediation: |
        Run the following commands to stop the service and remove the package containing the service:
        # systemctl stop <service_name>.socket <service_name>.service
        # apt purge <package_name>
                       - OR -
         If required packages have a dependency:               Run the following commands to stop and mask the service and
        socket:
        # systemctl stop <service_name>.socket <service_name>.service
        # systemctl mask <service_name>.socket <service_name>.service
                       Note:
         replace                  <service_name>
         with the appropriate service name.               Impact: There may be packages that are dependent on the service's
        package.  If the service's package is removed, these dependent packages will be removed as well. Before removing the
        service's package, review any dependent packages to determine if they are required on the system. - IF -
         a dependent package is required: stop and mask the                    <service_name>.socket
         and                    <service_name>.service
          leaving the service's package installed.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_2.1.22', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.2.1":
    title: '2.2.1 | Ensure NIS Client is not installed'
    section: 'Configure Client Services'
    description: |
        The Network Information Service NIS, formerly known as Yellow Pages, is a clientserver directory service protocol used
        to distribute system configuration files. The NIS client was used to bind a machine to an NIS server and receive the
        distributed configuration files.
    remediation: |
        Uninstall                  nis
        :               # apt purge nis
         Impact: Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them
        can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to
        prevent accidental or intentional misuse.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.2":
    title: '2.2.2 | Ensure rsh client is not installed'
    section: 'Configure Client Services'
    description: |
        The              rshclient
         package contains the client commands for the rsh services.
    remediation: |
        Uninstall                  rsh
        :               # apt purge rsh-client
         Impact: Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them
        can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to
        prevent accidental or intentional misuse.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.3":
    title: '2.2.3 | Ensure talk client is not installed'
    section: 'Configure Client Services'
    description: |
        The              talk
         software makes it possible for users to send and receive messages across systems through a terminal session. The
        talk
         client, which allows initialization of talk sessions, is installed by default.
    remediation: |
        Uninstall                  talk
        :               # apt purge talk
         Impact: Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them
        can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to
        prevent accidental or intentional misuse.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.4":
    title: '2.2.4 | Ensure telnet client is not installed'
    section: 'Configure Client Services'
    description: |
        The              telnet
         package contains the              telnet
         client, which allows users to start connections to other systems via the telnet protocol.
    remediation: |
        Uninstall                  telnet
        :               # apt purge telnet
         Impact: Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them
        can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to
        prevent accidental or intentional misuse.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.5":
    title: '2.2.5 | Ensure ldap client is not installed'
    section: 'Configure Client Services'
    description: |
        The Lightweight Directory Access Protocol LDAP was introduced as a replacement for NIS/YP. It is a service that provides
        a method for looking up information from a central database.
    remediation: |
        Uninstall                  ldap-utils
        :               # apt purge ldap-utils
         Impact: Removing the LDAP client will prevent or inhibit using LDAP for authentication in your environment.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.2.6":
    title: '2.2.6 | Ensure ftp client is not installed'
    section: 'Configure Client Services'
    description: |
        FTP File Transfer Protocol is a traditional and widely used standard tool for transferring files between a server and
        clients over a network, especially where no authentication is necessary permits anonymous users to connect to a server.
    remediation: |
        Run the following command to uninstall                  ftp
        :               # apt purge ftp
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "2.3.1.1":
    title: '2.3.1.1 | Ensure a single time synchronization daemon is in use - manual'
    section: 'Ensure time synchronization is in use'
    description: |
        System time should be synchronized between all systems in an environment. This is typically done by establishing an
        authoritative time server or set of servers and having all systems synchronize their clocks to them. Notes On virtual
        systems where host based time synchronization is available consult your virtualization software documentation and verify
        that host based synchronization is in use and follows local site policy. In this scenario, this section should be
        skipped
        Only                  one
         time synchronization method should be in use on the system. Configuring multiple time synchronization methods could
        lead to unexpected or unreliable results
    remediation: |
        On physical systems, and virtual systems where host based time synchronization is not available.
        Select                    one
         of the two time synchronization daemons;                    chrony (1)
         or                    systemd-timesyncd (2)
         and following the remediation procedure for the selected daemon.                 Note:
         enabling more than one synchronization daemon could lead to unexpected or unreliable results:                 chrony
        Run the following command to install                    chrony
        :                 # apt install chrony

        Run the following commands to stop and mask the                    systemd-timesyncd
         daemon:
        # systemctl stop systemd-timesyncd.service

        # systemctl mask systemd-timesyncd.service
                         Note:
        Subsection:                      Configure chrony
         should be followed
        Subsection:                      Configure systemd-timesyncd
         should be skipped                   systemd-timesyncd Run the following command to remove the chrony package:
        # apt purge chrony
        # apt autoremove chrony
                         Note:
        Subsection:                      Configure systemd-timesyncd
         should be followed
        Subsection:                      Configure chrony
         should be skipped
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.3.2.1":
    title: '2.3.2.1 | Ensure systemd-timesyncd configured with authorized timeserver'
    section: 'Configure systemd-timesyncd'
    description: |
        NTP A spaceseparated list of NTP server host names or IP addresses. During runtime this list is combined with any
        perinterface NTP servers acquired from systemdnetworkd.service8. systemdtimesyncd will contact all configured system or
        perinterface servers in turn, until one responds. When the empty string is assigned, the list of NTP servers is reset,
        and all prior assignments will have no effect. This setting defaults to an empty list. FallbackNTP A spaceseparated list
        of NTP server host names or IP addresses to be used as the fallback NTP servers. Any perinterface NTP servers obtained
        from systemdnetworkd.service8 take precedence over this setting, as do any servers set via NTP above. This setting is
        hence only relevant if no other NTP server information is known. When the empty string is assigned, the list of NTP
        servers is reset, and all prior assignments will have no effect. If this option is not given, a compiledin list of NTP
        servers is used.
    remediation: |
        Set                    NTP
         and/or                    FallbackNPT
         parameters to local site approved authoritative time server(s) in                    /etc/systemd/timesyncd.conf
         or a file in                    /etc/systemd/timesyncd.conf.d/
         ending in                    .conf
         in the                    [Time]
         section:                 Example file:
        [Time]
        NTP=time.nist.gov # Uses the generic name for NIST's time servers
        FallbackNTP=time-a-g.nist.gov time-b-g.nist.gov time-c-g.nist.gov # Space separated list of NIST time servers
                         Example script to create systemd drop-in file:
        #!/usr/bin/env bash

        {
           [ ! -d /etc/systemd/timesyncd.conf.d/ ] && mkdir /etc/systemd/timesyncd.conf.d/
           printf '%s\n' "[Time]" "NTP=time.nist.gov" "FallbackNTP=time-a-g.nist.gov time-b-g.nist.gov time-c-g.nist.gov" >>
        /etc/systemd/timesyncd.conf.d/60-timesyncd.conf
        }
                         Note:
         If this setting appears in a canonically later file, or later in the same file, the setting will be overwritten
        Run to following command to update the parameters in the service: # systemctl reload-or-restart systemd-journald
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'should cmp == NTP=[^#\n\r]+:/etc/systemd/timesyncd.conf'
            - name: Undefined
              rule: 'should cmp == FallbackNTP=[^#\n\r]+:/etc/systemd/timesyncd.conf'

  "2.3.2.2":
    title: '2.3.2.2 | Ensure systemd-timesyncd is enabled and running'
    section: 'Configure systemd-timesyncd'
    description: |
        systemdtimesyncd is a daemon that has been added for synchronizing the system clock across the network
    remediation: |
        - IF - systemd-timesyncd
         is in use on the system, run the following commands:
        Run the following command to unmask                    systemd-timesyncd.service
        :                 # systemctl unmask systemd-timesyncd.service

        Run the following command to enable and start                    systemd-timesyncd.service
        :                 # systemctl --now enable systemd-timesyncd.service
         - OR -
        If another time synchronization service is in use on the system, run the following command to stop and mask
        systemd-timesyncd
        :                 # systemctl --now mask systemd-timesyncd.service
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_2.3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'
            - name: Undefined
              rule: 'should cmp == masked'
            - name: Undefined
              rule: 'should cmp == inactive'

  "2.3.3.1":
    title: '2.3.3.1 | Ensure chrony is configured with authorized timeserver - manual'
    section: 'Configure chrony'
    description: |
        server The server directive specifies an NTP server which can be used as a time source. The clientserver relationship is
        strictly hierarchical a client might synchronize its system time to that of the server, but the servers system time will
        never be influenced by that of a client. This directive can be used multiple times to specify multiple servers. The
        directive is immediately followed by either the name of the server, or its IP address. pool The syntax of this directive
        is similar to that for the server directive, except that it is used to specify a pool of NTP servers rather than a
        single NTP server. The pool name is expected to resolve to multiple addresses which might change over time. This
        directive can be used multiple times to specify multiple pools. All options valid in the server directive can be used in
        this directive too.
    remediation: |
        Edit                    /etc/chrony/chrony.conf
         or a file ending in                    .sources
         in                    /etc/chrony/sources.d/
         and add or edit server or pool lines as appropriate according to local site policy:                 <[server|pool]>
        <[remote-server|remote-pool]>
         Examples: pool
         directive:                   pool time.nist.gov iburst maxsources 4 #The maxsources option is unique to the pool
        directive
         server
         directive:
        server time-a-g.nist.gov iburst
        server 132.163.97.3 iburst
        server time-d-b.nist.gov iburst

        Run one of the following commands to load the updated time sources into                    chronyd
         running config:
        # systemctl restart chronyd

        - OR if sources are in a .sources file -

        # chronyc reload sources
                         - OR -
        If another time synchronization service is in use on the system, run the following command to remove
        chrony
         from the system:
        # apt purge chrony
        # apt autoremove chrony
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_2.3.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "2.3.3.2":
    title: '2.3.3.2 | Ensure chrony is running as user  chrony'
    section: 'Configure chrony'
    description: |
        The                chrony
         package is installed with a dedicated user account                chrony
        .  This account is granted the access required by the                chronyd
         service
    remediation: |
        Add or edit the                    user
         line to                    /etc/chrony/chrony.conf
         or a file ending in                    .conf
         in                    /etc/chrony/conf.d/
        :                 user _chrony
         - OR -
        If another time synchronization service is in use on the system, run the following command to remove
        chrony
         from the system:
        # apt purge chrony
        # apt autoremove chrony
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == [c]hronyd:_chrony'

  "2.3.3.3":
    title: '2.3.3.3 | Ensure chrony is enabled and running'
    section: 'Configure chrony'
    description: |
        chrony is a daemon for synchronizing the system clock across the network
    remediation: |
        - IF - chrony
         is in use on the system, run the following commands:
        Run the following command to unmask                    chrony.service
        :                 # systemctl unmask chrony.service

        Run the following command to enable and start                    chrony.service
        :                 # systemctl --now enable chrony.service
         - OR -
        If another time synchronization service is in use on the system, run the following command to remove
        chrony
        :
        # apt purge chrony
        # apt autoremove chrony
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "2.4.1.1":
    title: '2.4.1.1 | Ensure cron daemon is enabled and active'
    section: 'Configure cron'
    description: |
        The                cron
         daemon is used to execute batch jobs on the system.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to unmask, enable, and start                    cron
        :
        # systemctl unmask "$(systemctl list-unit-files | awk '$1~/^crond?\.service/{print $1}')"
        # systemctl --now enable "$(systemctl list-unit-files | awk '$1~/^crond?\.service/{print $1}')"
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "2.4.1.2":
    title: '2.4.1.2 | Ensure permissions on etccrontab are configured'
    section: 'Configure cron'
    description: |
        The                /etc/crontab
         file is used by                cron
         to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that
        only the owner can access the file.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on                    /etc/crontab
        :
        # chown root:root /etc/crontab
        # chmod og-rwx /etc/crontab
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/crontab:0177'
            - name: Undefined
              rule: 'should cmp == /etc/crontab:root'
            - name: Undefined
              rule: 'should cmp == /etc/crontab:root'

  "2.4.1.3":
    title: '2.4.1.3 | Ensure permissions on etccron.hourly are configured'
    section: 'Configure cron'
    description: |
        This directory contains system                cron
         jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the
        crontab
         command, but are instead edited by system administrators using a text editor. The commands below restrict read/write
        and search access to user and group root, preventing regular users from accessing this directory.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on the                    /etc/cron.hourly
         directory:
        # chown root:root /etc/cron.hourly/
        # chmod og-rwx /etc/cron.hourly/
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.hourly/:0077'
            - name: Undefined
              rule: 'should cmp == /etc/cron.hourly/:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.hourly/:root'

  "2.4.1.4":
    title: '2.4.1.4 | Ensure permissions on etccron.daily are configured'
    section: 'Configure cron'
    description: |
        The                /etc/cron.daily
         directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be
        manipulated by the                crontab
         command, but are instead edited by system administrators using a text editor. The commands below restrict read/write
        and search access to user and group root, preventing regular users from accessing this directory.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on the                    /etc/cron.daily
         directory:
        # chown root:root /etc/cron.daily/
        # chmod og-rwx /etc/cron.daily/
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.daily/:0077'
            - name: Undefined
              rule: 'should cmp == /etc/cron.daily/:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.daily/:root'

  "2.4.1.5":
    title: '2.4.1.5 | Ensure permissions on etccron.weekly are configured'
    section: 'Configure cron'
    description: |
        The                /etc/cron.weekly
         directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be
        manipulated by the                crontab
         command, but are instead edited by system administrators using a text editor. The commands below restrict read/write
        and search access to user and group root, preventing regular users from accessing this directory.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on the                    /etc/cron.weekly
         directory:
        # chown root:root /etc/cron.weekly/
        # chmod og-rwx /etc/cron.weekly/
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.weekly/:0077'
            - name: Undefined
              rule: 'should cmp == /etc/cron.weekly/:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.weekly/:root'

  "2.4.1.6":
    title: '2.4.1.6 | Ensure permissions on etccron.monthly are configured'
    section: 'Configure cron'
    description: |
        The                /etc/cron.monthly
         directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be
        manipulated by the                crontab
         command, but are instead edited by system administrators using a text editor. The commands below restrict read/write
        and search access to user and group root, preventing regular users from accessing this directory.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on the                    /etc/cron.monthly
         directory:
        # chown root:root /etc/cron.monthly/
        # chmod og-rwx /etc/cron.monthly/
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.monthly/:0077'
            - name: Undefined
              rule: 'should cmp == /etc/cron.monthly/:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.monthly/:root'

  "2.4.1.7":
    title: '2.4.1.7 | Ensure permissions on etccron.d are configured'
    section: 'Configure cron'
    description: |
        The                /etc/cron.d
         directory contains system                cron
         jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from                /etc/crontab
        , but require more granular control as to when they run. The files in this directory cannot be manipulated by the
        crontab
         command, but are instead edited by system administrators using a text editor. The commands below restrict read/write
        and search access to user and group root, preventing regular users from accessing this directory.
    remediation: |
        - IF -
         cron is installed on the system:
        Run the following commands to set ownership and permissions on the                    /etc/cron.d
         directory:
        # chown root:root /etc/cron.d/
        # chmod og-rwx /etc/cron.d/
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.d/:0077'
            - name: Undefined
              rule: 'should cmp == /etc/cron.d/:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.d/:root'

  "2.4.1.8":
    title: '2.4.1.8 | Ensure crontab is restricted to authorized users'
    section: 'Configure cron'
    description: |
        crontab
         is the program used to install, deinstall, or list the tables used to drive the cron daemon. Each user can have their
        own crontab, and though these are files in                /var/spool/cron/crontabs
        , they are not intended to be edited directly.
        If the                /etc/cron.allow
         file exists, then you must be listed one user per line therein in order to be allowed to use this command. If the
        /etc/cron.allow
         file does not exist but the                /etc/cron.deny
         file does exist, then you must not be listed in the                /etc/cron.deny
         file in order to use this command.             If neither of these files exists, then depending on sitedependent
        configuration parameters, only the super user will be allowed to use this command, or all users will be able to use this
        command.
        If both files exist then                /etc/cron.allow
         takes precedence. Which means that                /etc/cron.deny
         is not considered and your user must be listed in                /etc/cron.allow
         in order to be able to use the crontab.             Regardless of the existence of any of these files, the root
        administrative user is always allowed to setup a crontab.
        The files                /etc/cron.allow
         and                /etc/cron.deny
        , if they exist, must be either worldreadable, or readable by group                crontab
        . If they are not, then cron will deny access to all users until the permissions are fixed.
        There is one file for each users crontab under the                /var/spool/cron/crontabs
         directory. Users are not allowed to edit the files under that directory directly to ensure that only users allowed by
        the system to run periodic tasks can add them, and only syntactically correct crontabs will be written there. This is
        enforced by having the directory writable only by the                crontab
         group and configuring crontab command with the setgid bid set for that specific group.             Note
        Even though a given user is not listed in                  cron.allow
        , cron jobs can still be run as that user
        The files                  /etc/cron.allow
         and                  /etc/cron.deny
        , if they exist, only controls administrative access to the crontab command for scheduling and modifying cron jobs
    remediation: |
        - IF -
         cron is installed on the system:                 Run the following script to:
        Create                      /etc/cron.allow
         if it doesn't exist
        Change owner or user                      root

        Change group owner to group                      root

        Change mode to                      640
         or more restrictive
        #!/usr/bin/env bash

        {
           [ ! -e "/etc/cron.allow" ] && touch /etc/cron.allow
           chown root:root /etc/cron.allow
           chmod u-x,g-wx,o-rwx /etc/cron.allow
        }
                         - IF - /etc/cron.deny
         exists, run the following commands to:
        Change owner or user                      root

        Change group owner to group                      root

        Change mode to                      640
         or more restrictive
        # [ -e "/etc/cron.deny" ] && chown root:root /etc/cron.deny
        # [ -e "/etc/cron.deny" ] && chmod u-x,g-wx,o-rwx /etc/cron.deny
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.1.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/cron.deny:0137'
            - name: Undefined
              rule: 'should cmp == /etc/cron.deny:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.deny:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.allow:0137'
            - name: Undefined
              rule: 'should cmp == /etc/cron.allow:root'
            - name: Undefined
              rule: 'should cmp == /etc/cron.allow:root'

  "2.4.2.1":
    title: '2.4.2.1 | Ensure at is restricted to authorized users'
    section: 'Configure at'
    description: |
        at
         allows fairly complex time specifications, extending the POSIX.2 standard. It accepts times of the form HHMM to run a
        job at a specific time of day. If that time is already past, the next day is assumed. You may also specify midnight,
        noon, or teatime 4pm and you can have a timeofday suffixed with AM or PM for running in the morning or the evening. You
        can also say what day the job will be run, by giving a date in the form monthname day with an optional year, or giving a
        date of the form MMDDCCYY, MM/DD/CCYY,  DD.MM.CCYY or CCYYMMDD. The specification of a date must follow the
        specification of the time of day. You can also give times like now  count timeunits, where the timeunits can be minutes,
        hours, days, or weeks and you can tell at to run the job today by suffixing the time with today and to run the job
        tomorrow by suffixing the time with tomorrow.
        The                /etc/at.allow
         and                /etc/at.deny
         files determine which user can submit commands for later execution via at or batch. The format of the files is a list
        of usernames, one on each line. Whitespace is not permitted. If the file                /etc/at.allow
         exists, only usernames mentioned in it are allowed to use at. If                /etc/at.allow
         does not exist,                /etc/at.deny
         is checked, every username not mentioned in it is then allowed to use at. An empty                /etc/at.deny
         means that every user may use at. If neither file exists, only the superuser is allowed to use at.
    remediation: |
        -IF-
         at is installed on the system:                 Run the following script to: /etc/at.allow
        :
                             Create the file if it doesn't exist
        Change owner or user                          root

        If group                          daemon
         exists, change to group                          daemon
        , else change group to                          root

        Change mode to                          640
         or more restrictive
                                    -IF- /etc/at.deny
         exists:

        Change owner or user                          root

        If group                          daemon
         exists, change to group                          daemon
        , else change group to                          root

        Change mode to                          640
         or more restrictive

        #!/usr/bin/env bash

        {
           grep -Pq -- '^daemon\b' /etc/group && l_group="daemon" || l_group="root"
           [ ! -e "/etc/at.allow" ] && touch /etc/at.allow
           chown root:"$l_group" /etc/at.allow
           chmod u-x,g-wx,o-rwx /etc/at.allow
           [ -e "/etc/at.deny" ] && chown root:"$l_group" /etc/at.deny
           [ -e "/etc/at.deny" ] && chmod u-x,g-wx,o-rwx /etc/at.deny
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.4.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/at.allow:0137'
            - name: Undefined
              rule: 'should cmp == /etc/at.allow:root'
            - name: Undefined
              rule: 'should cmp == /etc/at.allow:(root|daemon)'
            - name: Undefined
              rule: 'should cmp == /etc/at.deny:0137'
            - name: Undefined
              rule: 'should cmp == /etc/at.deny:root'
            - name: Undefined
              rule: 'should cmp == /etc/at.deny:(root|daemon)'

  "3.1.1":
    title: '3.1.1 | Ensure IPv6 status is identified - manual'
    section: 'Configure Network Devices'
    description: |
        Internet Protocol Version 6 IPv6 is the most recent version of Internet Protocol IP. Its designed to supply IP
        addressing and additional security to support the predicted growth of connected devices. IPv6 is based on 128bit
        addressing and can support 340 undecillion, which is 340 trillion3 addresses. Features of IPv6 Hierarchical addressing
        and routing infrastructure Stateful and Stateless configuration Support for quality of service QoS An ideal protocol for
        neighboring node interaction
    remediation: |
        Enable or disable IPv6 in accordance with system requirements and local site policy Impact: IETF RFC 4038 recommends
        that applications are built with an assumption of dual stack. When enabled, IPv6 will require additional configuration
        to reduce risk to the system.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "3.1.2":
    title: '3.1.2 | Ensure wireless interfaces are disabled - manual'
    section: 'Configure Network Devices'
    description: |
        Wireless networking is used when wired networks are unavailable.
    remediation: |
        Run the following script to disable any wireless interfaces:
        #!/usr/bin/env bash

        {
           module_fix()
           {
              if ! modprobe -n -v "$l_mname" | grep -P -- '^\h*install \/bin\/(true|false)'; then
                 echo -e " - setting module: \"$l_mname\" to be un-loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mname".conf
              fi
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e " - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
              if ! grep -Pq -- "^\h*blacklist\h+$l_mname\b" /etc/modprobe.d/*; then
                 echo -e " - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mname".conf
              fi
           }
           if [ -n "$(find /sys/class/net/*/ -type d -name wireless)" ]; then
              l_dname=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename
        "$(readlink -f "$driverdir"/device/driver/module)";done | sort -u)
              for l_mname in $l_dname; do
                 module_fix
              done
           fi
        }
                       Impact: Many if not all laptop workstations and some desktop workstations will connect via wireless
        requiring these interfaces be enabled.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "3.1.3":
    title: '3.1.3 | Ensure bluetooth services are not in use'
    section: 'Configure Network Devices'
    description: |
        Bluetooth is a shortrange wireless technology standard that is used for exchanging data between devices over short
        distances. It employs UHF radio waves in the ISM bands, from 2.402 GHz to 2.48 GHz. It is mainly used as an alternative
        to wire connections.
    remediation: |
        Run the following commands to stop                  bluetooth.service
        , and remove the                  bluez
         package:
        # systemctl stop bluetooth.service
        # apt purge bluez
                       - OR - - IF -
         the                  bluez
         package is required as a dependency:
        Run the following commands to stop and mask                  bluetooth.service
        :
        # systemctl stop bluetooth.service
        # systemctl mask bluetooth.service
                       Note:
         A reboot may be required               Impact: Many personal electronic devices (PEDs) use Bluetooth technology. For
        example, you may be able to operate your computer with a wireless keyboard. Disabling Bluetooth will prevent these
        devices from connecting to the system.
        There may be packages that are dependent on the                    bluez
         package.  If the                    bluez
         package is removed, these dependent packages will be removed as well. Before removing the                    bluez
         package, review any dependent packages to determine if they are required on the system.                 -IF-
         a dependent package is required: stop and mask                    bluetooth.service
         leaving the                    bluez
         package installed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "3.2.1":
    title: '3.2.1 | Ensure dccp kernel module is not available - manual'
    section: 'Configure Network Kernel Modules'
    description: |
        The Datagram Congestion Control Protocol DCCP is a transport layer protocol that supports streaming media and telephony.
        DCCP provides a way to gain access to congestion control, without having to do it at the application layer, but does not
        provide insequence delivery.
    remediation: |
        Run the following script to disable the                  dccp
         module:               -IF-
         the module is available in the running kernel:
        Create a file with                    install dccp /bin/false
         in the                    /etc/modprobe.d/
         directory
        Create a file with                    blacklist dccp
         in the                    /etc/modprobe.d/
         directory
        Unload                    dccp
         from the kernel                 -IF-
         available in ANY installed kernel:
        Create a file with                    blacklist dccp
         in the                    /etc/modprobe.d/
         directory                 -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:               No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="dccp" # set module name
           l_mtype="net" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == dccp:net'

  "3.2.2":
    title: '3.2.2 | Ensure tipc kernel module is not available - manual'
    section: 'Configure Network Kernel Modules'
    description: |
        The Transparent InterProcess Communication TIPC protocol is designed to provide communication between cluster nodes.
    remediation: |
        Run the following script to disable the                  tipc
         module:               -IF-
         the module is available in the running kernel:
        Create a file with                    install tipc /bin/false
         in the                    /etc/modprobe.d/
         directory
        Create a file with                    blacklist tipc
         in the                    /etc/modprobe.d/
         directory
        Unload                    tipc
         from the kernel                 -IF-
         available in ANY installed kernel:
        Create a file with                    blacklist tipc
         in the                    /etc/modprobe.d/
         directory                 -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:               No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="tipc" # set module name
           l_mtype="net" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == tipc:net'

  "3.2.3":
    title: '3.2.3 | Ensure rds kernel module is not available - manual'
    section: 'Configure Network Kernel Modules'
    description: |
        The Reliable Datagram Sockets RDS protocol is a transport layer protocol designed to provide lowlatency, highbandwidth
        communications between cluster nodes. It was developed by the Oracle Corporation.
    remediation: |
        Run the following script to disable the                  rds
         module:               -IF-
         the module is available in the running kernel:
        Create a file with                    install rds /bin/false
         in the                    /etc/modprobe.d/
         directory
        Create a file with                    blacklist rds
         in the                    /etc/modprobe.d/
         directory
        Unload                    rds
         from the kernel                 -IF-
         available in ANY installed kernel:
        Create a file with                    blacklist rds
         in the                    /etc/modprobe.d/
         directory                 -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:               No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="rds" # set module name
           l_mtype="net" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_3.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == rds:net'

  "3.2.4":
    title: '3.2.4 | Ensure sctp kernel module is not available - manual'
    section: 'Configure Network Kernel Modules'
    description: |
        The Stream Control Transmission Protocol SCTP is a transport layer protocol used to support message oriented
        communication, with several streams of messages in one connection. It serves a similar function as TCP and UDP,
        incorporating features of both. It is messageoriented like UDP, and ensures reliable insequence transport of messages
        with congestion control like TCP.
    remediation: |
        Run the following script to disable the                  sctp
         module:               -IF-
         the module is available in the running kernel:
        Create a file with                    install sctp /bin/false
         in the                    /etc/modprobe.d/
         directory
        Create a file with                    blacklist sctp
         in the                    /etc/modprobe.d/
         directory
        Unload                    sctp
         from the kernel                 -IF-
         available in ANY installed kernel:
        Create a file with                    blacklist sctp
         in the                    /etc/modprobe.d/
         directory                 -IF-
         the kernel module is not available on the system or pre-compiled into the kernel:               No remediation is
        necessary
        #!/usr/bin/env bash

        {
           l_mname="sctp" # set module name
           l_mtype="net" # set module type
           l_mpath="/lib/modules/**/kernel/$l_mtype"
           l_mpname="$(tr '-' '_' <<< "$l_mname")"
           l_mndir="$(tr '-' '/' <<< "$l_mname")"

           module_loadable_fix()
           {
              # If the module is currently loadable, add "install {MODULE_NAME} /bin/false" to a file in "/etc/modprobe.d"
              l_loadable="$(modprobe -n -v "$l_mname")"
              [ "$(wc -l <<< "$l_loadable")" -gt "1" ] && l_loadable="$(grep -P -- "(^\h*install|\b$l_mname)\b" <<<
        "$l_loadable")"
              if ! grep -Pq -- '^\h*install \/bin\/(true|false)' <<< "$l_loadable"; then
                 echo -e "\n - setting module: \"$l_mname\" to be not loadable"
                 echo -e "install $l_mname /bin/false" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           module_loaded_fix()
           {
              # If the module is currently loaded, unload the module
              if lsmod | grep "$l_mname" > /dev/null 2>&1; then
                 echo -e "\n - unloading module \"$l_mname\""
                 modprobe -r "$l_mname"
              fi
           }
           module_deny_fix()
           {
              # If the module isn't deny listed, denylist the module
              if ! modprobe --showconfig | grep -Pq -- "^\h*blacklist\h+$l_mpname\b"; then
                 echo -e "\n - deny listing \"$l_mname\""
                 echo -e "blacklist $l_mname" >> /etc/modprobe.d/"$l_mpname".conf
              fi
           }
           # Check if the module exists on the system
           for l_mdir in $l_mpath; do
              if [ -d "$l_mdir/$l_mndir" ] && [ -n "$(ls -A $l_mdir/$l_mndir)" ]; then
                 echo -e "\n - module: \"$l_mname\" exists in \"$l_mdir\"\n - checking if disabled..."
                 module_deny_fix
                 if [ "$l_mdir" = "/lib/modules/$(uname -r)/kernel/$l_mtype" ]; then
                    module_loadable_fix
                    module_loaded_fix
                 fi
              else
                 echo -e "\n - module: \"$l_mname\" doesn't exist in \"$l_mdir\"\n"
              fi
           done
           echo -e "\n - remediation of module: \"$l_mname\" complete\n"
        }
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_3.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == sctp:net'

  "3.3.1":
    title: '3.3.1 | Ensure ip forwarding is disabled - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        The              net.ipv4.ipforward
         and              net.ipv6.conf.all.forwarding
         flags are used to tell the system whether it can forward packets or not.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.ip_forward = 0 Example: # printf '%s\n' "net.ipv4.ip_forward = 0" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.ip_forward=0
           sysctl -w net.ipv4.route.flush=1
        }
                       - IF -
         IPv6 is enabled on the system:
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv6.conf.all.forwarding = 0 Example: # printf '%s\n' "net.ipv6.conf.all.forwarding = 0" >>
        /etc/sysctl.d/60-netipv6_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv6.conf.all.forwarding=0
           sysctl -w net.ipv6.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
        Impact: IP forwarding is required on systems configured to act as a router. If these parameters are disabled, the system
        will not be able to perform as a router. Many Cloud Service Provider (CSP) hosted systems require IP forwarding to be
        enabled. If the system is running on a CSP platform, this requirement should be reviewed before disabling IP forwarding.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.ip_forward=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.forwarding=0'

  "3.3.2":
    title: '3.3.2 | Ensure packet redirect sending is disabled - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router in a host
        only configuration, there is no need to send redirects.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.default.send_redirects = 0 Example: # printf '%s\n'
        "net.ipv4.conf.all.send_redirects = 0" "net.ipv4.conf.default.send_redirects = 0" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.send_redirects=0
           sysctl -w net.ipv4.conf.default.send_redirects=0
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
        Impact: IP forwarding is required on systems configured to act as a router. If these parameters are disabled, the system
        will not be able to perform as a router.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.send_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.send_redirects=0'

  "3.3.3":
    title: '3.3.3 | Ensure bogus icmp responses are ignored - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        Setting              net.ipv4.icmpignoreboguserrorresponses
         to              1
         prevents the kernel from logging bogus responses RFC1122 noncompliant from broadcast reframes, keeping file systems
        from filling up with useless log messages.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.icmp_ignore_bogus_error_responses = 1 Example: # printf '%s\n'
        "net.ipv4.icmp_ignore_bogus_error_responses = 1" >> /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.icmp_ignore_bogus_error_responses=1'

  "3.3.4":
    title: '3.3.4 | Ensure broadcast icmp requests are ignored - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        Setting              net.ipv4.icmpechoignorebroadcasts
         to              1
         will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.icmp_echo_ignore_broadcasts = 1 Example: # printf '%s\n' "net.ipv4.icmp_echo_ignore_broadcasts
        = 1" >> /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.icmp_echo_ignore_broadcasts=1'

  "3.3.5":
    title: '3.3.5 | Ensure icmp redirects are not accepted - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        ICMP redirect messages are packets that convey routing information and tell your host acting as a router to send packets
        via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.accept_redirects = 0 net.ipv4.conf.default.accept_redirects = 0 Example: # printf
        '%s\n' "net.ipv4.conf.all.accept_redirects = 0" "net.ipv4.conf.default.accept_redirects = 0" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.accept_redirects=0
           sysctl -w net.ipv4.conf.default.accept_redirects=0
           sysctl -w net.ipv4.route.flush=1
        }
                       - IF -
         IPv6 is enabled on the system:
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv6.conf.all.accept_redirects = 0 net.ipv6.conf.default.accept_redirects = 0 Example: # printf
        '%s\n' "net.ipv6.conf.all.accept_redirects = 0" "net.ipv6.conf.default.accept_redirects = 0" >>
        /etc/sysctl.d/60-netipv6_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv6.conf.all.accept_redirects=0
           sysctl -w net.ipv6.conf.default.accept_redirects=0
           sysctl -w net.ipv6.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.accept_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.default.accept_redirects=0'

  "3.3.6":
    title: '3.3.6 | Ensure secure icmp redirects are not accepted - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list.
        It is assumed that these gateways are known to your system, and that they are likely to be secure.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.secure_redirects = 0 net.ipv4.conf.default.secure_redirects = 0 Example: # printf
        '%s\n' "net.ipv4.conf.all.secure_redirects = 0" "net.ipv4.conf.default.secure_redirects = 0" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.secure_redirects=0
           sysctl -w net.ipv4.conf.default.secure_redirects=0
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.secure_redirects=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.secure_redirects=0'

  "3.3.7":
    title: '3.3.7 | Ensure reverse path filtering is enabled - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        Setting              net.ipv4.conf.all.rpfilter
         and              net.ipv4.conf.default.rpfilter
         to              1
         forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid.
        Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding
        source packet came from, the packet is dropped and logged if              logmartians
         is set.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.rp_filter = 1 net.ipv4.conf.default.rp_filter = 1 Example: # printf '%s\n'
        "net.ipv4.conf.all.rp_filter = 1" "net.ipv4.conf.default.rp_filter = 1" >> /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.rp_filter=1
           sysctl -w net.ipv4.conf.default.rp_filter=1
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
        Impact: If you are using asymmetrical routing on your system, you will not be able to enable this feature without
        breaking the routing.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.rp_filter=1'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.rp_filter=1'

  "3.3.8":
    title: '3.3.8 | Ensure source routed packets are not accepted - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In
        contrast, nonsource routed packets travel a path determined by routers in the network. In some cases, systems may not be
        routable or reachable from some locations e.g. private addresses vs. Internet routable, and so source routed packets
        would need to be used.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.accept_source_route = 0 net.ipv4.conf.default.accept_source_route = 0 Example: #
        printf '%s\n' "net.ipv4.conf.all.accept_source_route = 0" "net.ipv4.conf.default.accept_source_route = 0" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.accept_source_route=0
           sysctl -w net.ipv4.conf.default.accept_source_route=0
           sysctl -w net.ipv4.route.flush=1
        }
                       - IF -
         IPv6 is enabled on the system:
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv6.conf.all.accept_source_route = 0 net.ipv6.conf.default.accept_source_route = 0 Example: #
        printf '%s\n' "net.ipv6.conf.all.accept_source_route = 0" "net.ipv6.conf.default.accept_source_route = 0" >>
        /etc/sysctl.d/60-netipv6_sysctl.conf
         Run the following command to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv6.conf.all.accept_source_route=0
           sysctl -w net.ipv6.conf.default.accept_source_route=0
           sysctl -w net.ipv6.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.accept_source_route=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.default.accept_source_route=0'

  "3.3.9":
    title: '3.3.9 | Ensure suspicious packets are logged - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        When enabled, this feature logs packets with unroutable source addresses to the kernel log.
    remediation: |
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.conf.all.log_martians = 1 net.ipv4.conf.default.log_martians = 1 Example: # printf '%s\n'
        "net.ipv4.conf.all.log_martians = 1" "net.ipv4.conf.default.log_martians = 1" >> /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.conf.all.log_martians=1
           sysctl -w net.ipv4.conf.default.log_martians=1
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.all.log_martians=1'
            - name: Undefined
              rule: 'should cmp == net.ipv4.conf.default.log_martians=1'

  "3.3.10":
    title: '3.3.10 | Ensure tcp syn cookies is enabled - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        When              tcpsyncookies
         is set, the kernel will handle TCP SYN packets normally until the halfopen connection queue is full, at which time, the
        SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply
        replies to the SYN with a SYNACK, but will include a specially crafted TCP sequence number that encodes the source and
        destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK
        packet of the three way handshake with the specially crafted sequence number. This allows the system to verify that it
        has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the
        queue.
    remediation: |
        Set the following parameter in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv4.tcp_syncookies = 1 Example: # printf '%s\n' "net.ipv4.tcp_syncookies = 1" >>
        /etc/sysctl.d/60-netipv4_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv4.tcp_syncookies=1
           sysctl -w net.ipv4.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv4.tcp_syncookies=1'

  "3.3.11":
    title: '3.3.11 | Ensure ipv6 router advertisements are not accepted - manual'
    section: 'Configure Network Kernel Parameters'
    description: |
        This setting disables the systems ability to accept IPv6 router advertisements.
    remediation: |
        - IF -
         IPv6 is enabled on the system:
        Set the following parameters in                  /etc/sysctl.conf
         or a file in                  /etc/sysctl.d/
         ending in                  .conf
        :               net.ipv6.conf.all.accept_ra = 0 net.ipv6.conf.default.accept_ra = 0 Example: # printf '%s\n'
        "net.ipv6.conf.all.accept_ra = 0" "net.ipv6.conf.default.accept_ra = 0" >> /etc/sysctl.d/60-netipv6_sysctl.conf
         Run the following script to set the active kernel parameters:
        #!/usr/bin/env bash

        {
           sysctl -w net.ipv6.conf.all.accept_ra=0
           sysctl -w net.ipv6.conf.default.accept_ra=0
           sysctl -w net.ipv6.route.flush=1
        }
                       Note:
         If these settings appear in a canonically later file, or later in the same file, these settings will be overwritten
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_3.3.11', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.all.accept_ra=0'
            - name: Undefined
              rule: 'should cmp == net.ipv6.conf.default.accept_ra=0'

  "4.1.1":
    title: '4.1.1 | Ensure ufw is installed'
    section: 'Configure UncomplicatedFirewall'
    description: |
        The Uncomplicated Firewall ufw is a frontend for iptables and is particularly wellsuited for hostbased firewalls. ufw
        provides a framework for managing netfilter, as well as a commandline interface for manipulating the firewall
    remediation: |
        Run the following command to install Uncomplicated Firewall (UFW): apt install ufw
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.2":
    title: '4.1.2 | Ensure iptables-persistent is not installed with ufw'
    section: 'Configure UncomplicatedFirewall'
    description: |
        The              iptablespersistent
         is a boottime loader for netfilter rules, iptables plugin
    remediation: |
        Run the following command to remove the                  iptables-persistent
         package:               # apt purge iptables-persistent
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.1.3":
    title: '4.1.3 | Ensure ufw service is enabled - manual'
    section: 'Configure UncomplicatedFirewall'
    description: |
        UncomplicatedFirewall ufw is a frontend for iptables. ufw provides a framework for managing netfilter, as well as a
        commandline and available graphical user interface for manipulating the firewall. Note When running ufw enable or
        starting ufw via its initscript, ufw will flush its chains. This is required so ufw can maintain a consistent state, but
        it may drop existing connections eg ssh.  ufw does support adding rules before enabling the firewall.
        Run the following command before running                ufw enable
        .              ufw allow proto tcp from any to any port 22
         The rules will still be flushed, but the ssh port will be open after enabling the firewall. Please note that once ufw
        is enabled, ufw will not flush the chains when adding or removing rules but will when modifying a rule or changing the
        default policy
        By default, ufw will prompt when enabling the firewall while running under ssh. This can be disabled by using
        ufw force enable
    remediation: |
        Run the following command to unmask the                  ufw
         daemon:               # systemctl unmask ufw.service

        Run the following command to enable and start the                  ufw
         daemon:
        # systemctl --now enable ufw.service

        active
                       Run the following command to enable ufw: # ufw enable
         Impact: Changing firewall settings while connected over network can result in being locked out of the system.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.4":
    title: '4.1.4 | Ensure ufw loopback traffic is configured - manual'
    section: 'Configure UncomplicatedFirewall'
    description: |
        Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback
        network 127.0.0.0/8 for IPv4 and 1/128 for IPv6.
    remediation: |
        Run the following commands to implement the loopback rules:
        # ufw allow in on lo
        # ufw allow out on lo
        # ufw deny in from 127.0.0.0/8
        # ufw deny in from ::1
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*Anywhere\h+\(v6\)\s+DENY\h+IN\s+\:\:1\b'
            - name: Undefined
              rule: 'should cmp == ^\h*Anywhere\h+DENY\h+IN\s+127\.0\.0\.0\/8\b'

  "4.1.5":
    title: '4.1.5 | Ensure ufw outbound connections are configured - manual'
    section: 'Configure UncomplicatedFirewall'
    description: |
        Configure the firewall rules for new outbound connections. Note Changing firewall settings while connected over network
        can result in being locked out of the system. Unlike iptables, when a new outbound rule is added, ufw automatically
        takes care of associated established connections, so no rules for the latter kind are required.
    remediation: |
        Configure ufw in accordance with site policy. The following commands will implement a policy to allow all outbound
        connections on all interfaces: # ufw allow out on all
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_4.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.6":
    title: '4.1.6 | Ensure ufw firewall rules exist for all open ports - manual'
    section: 'Configure UncomplicatedFirewall'
    description: |
        Services and ports can be accepted or explicitly rejected. Note Changing firewall settings while connected over network
        can result in being locked out of the system The remediation command opens up the port to traffic from all sources.
        Consult ufw documentation and set any restrictions in compliance with site policy
    remediation: |
        For each port identified in the audit which does not have a firewall rule, evaluate the service listening on the port
        and add a rule for accepting or denying inbound connections in accordance with local site policy: Examples:
        # ufw allow in <port>/<tcp or udp protocol>

        # ufw deny in <port>/<tcp or udp protocol>
                       Note:
         Examples create rules for from any, to any.  More specific rules should be concentered when allowing inbound traffic
        e.g only traffic from this network.               Example to allow traffic on port 443 using the tcp protocol from the
        192.168.1.0 network: ufw allow from 192.168.1.0/24 to any proto tcp port 443
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.1.7":
    title: '4.1.7 | Ensure ufw default deny firewall policy - manual'
    section: 'Configure UncomplicatedFirewall'
    description: |
        A default deny policy on connections ensures that any unconfigured network usage will be rejected. Note
         Any port or protocol without a explicit allow before the default deny will be blocked
    remediation: |
        Run the following commands to implement a default                  deny
         policy:
        # ufw default deny incoming
        # ufw default deny outgoing
        # ufw default deny routed
                       Impact: Any port and protocol not explicitly allowed will be blocked.  The following rules should be
        considered before applying the default deny.
        ufw allow out http
        ufw allow out https
        ufw allow out ntp # Network Time Protocol
        ufw allow out to any port 53 # DNS
        ufw allow out to any port 853 # DNS over TLS
        ufw logging on
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\h*Default:\h+(deny|reject)\h+\(incoming\),\h*\H+\h+\(outgoing\),\h*\H+\h+\(routed\)'
            - name: Undefined
              rule: 'should cmp == ^\h*Default:\h+\H+\h+\(incoming\),\h*(deny|reject)\h+\(outgoing\),\h*\H+\h+\(routed\)'
            - name: Undefined
              rule: 'should cmp == ^\h*Default:\h+\H+\h+\(incoming\),\h*\H+\h+\(outgoing\),\h*(disabled|deny|reject)\h+\(routed\)'

  "4.2.1":
    title: '4.2.1 | Ensure nftables is installed'
    section: 'Configure nftables'
    description: |
        nftables provides a new inkernel packet classification framework that is based on a networkspecific Virtual Machine VM
        and a new nft userspace command line tool. nftables reuses the existing Netfilter subsystems such as the existing hook
        infrastructure, the connection tracking system, NAT, userspace queuing and logging subsystem. Notes nftables is
        available in Linux kernel 3.13 and newer Only one firewall utility should be installed and configured Changing firewall
        settings while connected over the network can result in being locked out of the system
    remediation: |
        Run the following command to install                  nftables
        :               # apt install nftables
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.2.2":
    title: '4.2.2 | Ensure ufw is uninstalled or disabled with nftables'
    section: 'Configure nftables'
    description: |
        Uncomplicated Firewall UFW is a program for managing a netfilter firewall designed to be easy to use.
    remediation: |
        Run                  one
         of the following to either remove                  ufw
                                 or
         disable                  ufw
         and mask                  ufw.service
        :
        Run the following command to remove                  ufw
        :               # apt purge ufw
         -OR-
        Run the following commands to disable                  ufw
         and mask                  ufw.service
        :
        # ufw disable
        # systemctl stop ufw.service
        # systemctl mask ufw.service
                       Note: ufw disable
         needs to be run before                  systemctl mask ufw.service
         in order to correctly disable                  UFW
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.2.3":
    title: '4.2.3 | Ensure iptables are flushed with nftables - manual'
    section: 'Configure nftables'
    description: |
        nftables is a replacement for iptables, ip6tables, ebtables and arptables
    remediation: |
        Run the following commands to flush iptables: For iptables: # iptables -F
         For ip6tables: # ip6tables -F
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_4.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.2.4":
    title: '4.2.4 | Ensure a nftables table exists - manual'
    section: 'Configure nftables'
    description: |
        Tables hold chains.  Each table only has one address family and only applies to packets of this family.  Tables can have
        one of five families.
    remediation: |
        Run the following command to create a table in nftables # nft create table inet <table name>
         Example: # nft create table inet filter
         Impact: Adding rules to a running nftables can cause loss of connectivity to the system
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^table\s+\S+\s+\S+'

  "4.2.5":
    title: '4.2.5 | Ensure nftables base chains exist - manual'
    section: 'Configure nftables'
    description: |
        Chains are containers for rules. They exist in two kinds, base chains and regular chains. A base chain is an  entry
        point  for packets from the networking stack, a regular chain may be used as jump target and is used for better rule
        organization.
    remediation: |
        Run the following command to create the base chains: # nft create chain inet <table name> <base chain name> { type
        filter hook <(input|forward|output)> priority 0 \; }
         Example:
        # nft create chain inet filter input { type filter hook input priority 0 \; }

        # nft create chain inet filter forward { type filter hook forward priority 0 \; }

        # nft create chain inet filter output { type filter hook output priority 0 \; }
                       Impact:
        If configuring nftables over ssh,                    creating
         a                    base chain
         with a  policy of                    drop
         will cause loss of connectivity.                 Ensure that a rule allowing ssh has been added to the base chain prior
        to setting the base chain's policy to drop
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+hook\s+input'
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+hook\s+forward'
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+hook\s+output'

  "4.2.6":
    title: '4.2.6 | Ensure nftables loopback traffic is configured - manual'
    section: 'Configure nftables'
    description: |
        Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback
        network
    remediation: |
        Run the following commands to implement the loopback rules: # nft add rule inet filter input iif lo accept
         # nft create rule inet filter input ip saddr 127.0.0.0/8 counter drop
         -IF-
         IPv6 is enabled on the system:               Run the following command to implement the IPv6 loopback rule: # nft add
        rule inet filter input ip6 saddr ::1 counter drop
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.2.7":
    title: '4.2.7 | Ensure nftables outbound and established connections are configured - manual'
    section: 'Configure nftables'
    description: |
        Configure the firewall rules for new outbound, and established connections
    remediation: |
        Configure nftables in accordance with site policy. The following commands will implement a policy to allow all outbound
        connections and all established connections:
        # nft add rule inet filter input ip protocol tcp ct state established accept

        # nft add rule inet filter input ip protocol udp ct state established accept

        # nft add rule inet filter input ip protocol icmp ct state established accept

        # nft add rule inet filter output ip protocol tcp ct state new,related,established accept

        # nft add rule inet filter output ip protocol udp ct state new,related,established accept

        # nft add rule inet filter output ip protocol icmp ct state new,related,established accept
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_4.2.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.2.8":
    title: '4.2.8 | Ensure nftables default deny firewall policy - manual'
    section: 'Configure nftables'
    description: |
        Base chain policy is the default verdict that will be applied to packets reaching the end of the chain.
    remediation: |
        Run the following command for the base chains with the input, forward, and output hooks to implement a default DROP
        policy: # nft chain <table family> <table name> <chain name> { policy drop \; }
         Example:
        # nft chain inet filter input { policy drop \; }

        # nft chain inet filter forward { policy drop \; }

        # nft chain inet filter output { policy drop \; }
                       Impact: If configuring nftables over ssh, creating a base chain with a policy of drop will cause loss of
        connectivity. Ensure that a rule allowing ssh has been added to the base chain prior to setting the base chain's policy
        to drop
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == input'
            - name: Undefined
              rule: 'should cmp == forward'
            - name: Undefined
              rule: 'should cmp == output'

  "4.2.9":
    title: '4.2.9 | Ensure nftables service is enabled'
    section: 'Configure nftables'
    description: |
        The nftables service allows for the loading of nftables rulesets during boot, or starting on the nftables service
    remediation: |
        Run the following command to enable the nftables service: # systemctl enable nftables
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.2.10":
    title: '4.2.10 | Ensure nftables rules are permanent'
    section: 'Configure nftables'
    description: |
        nftables is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames.
        The nftables service reads the              /etc/nftables.conf
         file for a nftables file or files to include in the nftables ruleset.           A nftables ruleset containing the
        input, forward, and output base chains allow network traffic to be filtered.
    remediation: |
        Edit the                  /etc/nftables.conf
         file and un-comment or add a line with                  include <Absolute path to nftables rules file>
         for each nftables file you want included in the nftables ruleset on boot               Example: # vi /etc/nftables.conf
         Add the line: include "/etc/nftables.rules"
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.2.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.3.1.1":
    title: '4.3.1.1 | Ensure iptables packages are installed'
    section: 'Configure iptables software'
    description: |
        iptables
         is a utility program that allows a system administrator to configure the tables provided by the Linux kernel firewall,
        implemented as different Netfilter modules, and the chains and rules it stores. Different kernel modules and programs
        are used for different protocols                iptables
         applies to IPv4, ip6tables to IPv6, arptables to ARP, and ebtables to Ethernet frames.
    remediation: |
        Run the following command to install                    iptables
         and                    iptables-persistent
                                 # apt install iptables iptables-persistent
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.3.1.2":
    title: '4.3.1.2 | Ensure nftables is not installed with iptables'
    section: 'Configure iptables software'
    description: |
        nftables
         is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames and is
        the successor to iptables.
    remediation: |
        Run the following command to remove                    nftables
        :                 # apt purge nftables
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.3.1.3":
    title: '4.3.1.3 | Ensure ufw is uninstalled or disabled with iptables'
    section: 'Configure iptables software'
    description: |
        Uncomplicated Firewall UFW is a program for managing a netfilter firewall designed to be easy to use. Uses a commandline
        interface consisting of a small number of simple commands Uses iptables for configuration
    remediation: |
        Run                    one
         of the following commands to either remove                    ufw
         or stop and mask                    ufw

        Run the following command to remove                    ufw
        :                 # apt purge ufw
         - OR -
        Run the following commands to disable                    ufw
        :
        # ufw disable
        # systemctl stop ufw
        # systemctl mask ufw
                         Note: ufw disable
         needs to be run before                    systemctl mask ufw
         in order to correctly disable                    UFW
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "4.3.2.1":
    title: '4.3.2.1 | Ensure iptables default deny firewall policy - manual'
    section: 'Configure IPv4 iptables'
    description: |
        A default deny all policy on connections ensures that any unconfigured network usage will be rejected. Notes Changing
        firewall settings while connected over network can result in being locked out of the system Remediation will only affect
        the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well
    remediation: |
        Run the following commands to implement a default DROP policy:
        # iptables -P INPUT DROP
        # iptables -P OUTPUT DROP
        # iptables -P FORWARD DROP
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+INPUT\s+\(policy\s+(DROP|REJECT)\)\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+FORWARD\s+\(policy (DROP|REJECT)\)\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+OUTPUT\s+\(policy (DROP|REJECT)\)\s*(\s+#.*)?$'

  "4.3.2.2":
    title: '4.3.2.2 | Ensure iptables loopback traffic is configured - manual'
    section: 'Configure IPv4 iptables'
    description: |
        Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback
        network 127.0.0.0/8. Notes Changing firewall settings while connected over network can result in being locked out of the
        system Remediation will only affect the active system firewall, be sure to configure the default policy in your firewall
        management to apply on boot as well
    remediation: |
        Run the following commands to implement the loopback rules:
        # iptables -A INPUT -i lo -j ACCEPT
        # iptables -A OUTPUT -o lo -j ACCEPT
        # iptables -A INPUT -s 127.0.0.0/8 -j DROP
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+ACCEPT\s+all\s+--\s+lo\s+\*\s+0\.0\.0\.0\/0\s+0\.0\.0\.0\/0\s*\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+DROP\s+all\s+--\s+\*\s+\*\s+127\.0\.0\.0\/8\s+0\.0\.0\.0\/0\s*\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*\S+\s+\S+\s+ACCEPT\s+all\s+--\s+\*\s+lo\s+0\.0\.0\.0\/0\s+0\.0\.0\.0\/0\s*\s*(\s+#.*)?$'

  "4.3.2.3":
    title: '4.3.2.3 | Ensure iptables outbound and established connections are configured - manual'
    section: 'Configure IPv4 iptables'
    description: |
        Configure the firewall rules for new outbound, and established connections. Notes Changing firewall settings while
        connected over network can result in being locked out of the system Remediation will only affect the active system
        firewall, be sure to configure the default policy in your firewall management to apply on boot as well
    remediation: |
        Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound
        connections and all established connections:
        # iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT
        # iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT
        # iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT
        # iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT
        # iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT
        # iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_4.3.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.3.2.4":
    title: '4.3.2.4 | Ensure iptables firewall rules exist for all open ports - manual'
    section: 'Configure IPv4 iptables'
    description: |
        Any ports that have been opened on nonloopback addresses need firewall rules to govern traffic. Note Changing firewall
        settings while connected over network can result in being locked out of the system Remediation will only affect the
        active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well The
        remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any
        restrictions in compliance with site policy
    remediation: |
        For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound
        connections: # iptables -A INPUT -p <protocol> --dport <port> -m state --state NEW -j ACCEPT
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.3.3.1":
    title: '4.3.3.1 | Ensure ip6tables default deny firewall policy - manual'
    section: 'Configure IPv6  ip6tables'
    description: |
        A default deny all policy on connections ensures that any unconfigured network usage will be rejected. Note Changing
        firewall settings while connected over network can result in being locked out of the system Remediation will only affect
        the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well
    remediation: |
        IF
         IPv6 is enabled on your system:                 Run the following commands to implement a default DROP policy:
        # ip6tables -P INPUT DROP
        # ip6tables -P OUTPUT DROP
        # ip6tables -P FORWARD DROP
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+INPUT\s+\(policy (DROP|REJECT)\)\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+FORWARD\s+\(policy (DROP|REJECT)\)\s*(\s+#.*)?$'
            - name: Undefined
              rule: 'should cmp == ^\s*Chain\s+OUTPUT\s+\(policy (DROP|REJECT)\)\s*(\s+#.*)?$'

  "4.3.3.2":
    title: '4.3.3.2 | Ensure ip6tables loopback traffic is configured - manual'
    section: 'Configure IPv6  ip6tables'
    description: |
        Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback
        network 1. Note Changing firewall settings while connected over network can result in being locked out of the system
        Remediation will only affect the active system firewall, be sure to configure the default policy in your firewall
        management to apply on boot as well
    remediation: |
        Run the following commands to implement the loopback rules:
        # ip6tables -A INPUT -i lo -j ACCEPT
        # ip6tables -A OUTPUT -o lo -j ACCEPT
        # ip6tables -A INPUT -s ::1 -j DROP
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.3.3.3":
    title: '4.3.3.3 | Ensure ip6tables outbound and established connections are configured - manual'
    section: 'Configure IPv6  ip6tables'
    description: |
        Configure the firewall rules for new outbound, and established IPv6 connections. Note Changing firewall settings while
        connected over network can result in being locked out of the system Remediation will only affect the active system
        firewall, be sure to configure the default policy in your firewall management to apply on boot as well
    remediation: |
        Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound
        connections and all established connections:
        # ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT
        # ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT
        # ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT
        # ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT
        # ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT
        # ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_4.3.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "4.3.3.4":
    title: '4.3.3.4 | Ensure ip6tables firewall rules exist for all open ports - manual'
    section: 'Configure IPv6  ip6tables'
    description: |
        Any ports that have been opened on nonloopback addresses need firewall rules to govern traffic. Note Changing firewall
        settings while connected over network can result in being locked out of the system Remediation will only affect the
        active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well The
        remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any
        restrictions in compliance with site policy
    remediation: |
        For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound
        connections: # ip6tables -A INPUT -p <protocol> --dport <port> -m state --state NEW -j ACCEPT
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_4.3.3.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.1.1":
    title: '5.1.1 | Ensure permissions on etcsshsshd config are configured'
    section: 'Configure SSH Server'
    description: |
        The file              /etc/ssh/sshdconfig
        , and files ending in              .conf
         in the              /etc/ssh/sshdconfig.d
         directory, contain configuration specifications for              sshd
        .
    remediation: |
        Run the following script to set ownership and permissions on                  /etc/ssh/sshd_config
         and files ending in                  .conf
         in the                  /etc/ssh/sshd_config.d
         directory:
        #!/usr/bin/env bash

        {
           chmod u-x,og-rwx /etc/ssh/sshd_config
           chown root:root /etc/ssh/sshd_config
           while IFS= read -r -d $'\0' l_file; do
              if [ -e "$l_file" ]; then
                 chmod u-x,og-rwx "$l_file"
                 chown root:root "$l_file"
              fi
           done < <(find /etc/ssh/sshd_config.d -type f -print0 2>/dev/null)
        }
                       - IF -
         other locations are listed in an                  Include
         statement,                  *.conf
         files in these locations access should also be modified.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config:0177'
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config:root'
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config:root'
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config.d:0177:*.conf'
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config.d:root:*.conf'
            - name: Undefined
              rule: 'should cmp == /etc/ssh/sshd_config.d:root:*.conf'

  "5.1.2":
    title: '5.1.2 | Ensure permissions on SSH private host key files are configured'
    section: 'Configure SSH Server'
    description: |
        An SSH private key is one of two files used in SSH public key authentication.  In this authentication method, the
        possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to
        authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key
        should be distributed.
    remediation: |
        Run the following script to set mode, ownership, and group on the private SSH host key files:
        #!/usr/bin/env bash

        {
           l_output="" l_output2=""
           l_ssh_group_name="$(awk -F: '($1 ~ /^(ssh_keys|_?ssh)$/) {print $1}' /etc/group)"
           FILE_ACCESS_FIX()
           {
              while IFS=: read -r l_file_mode l_file_owner l_file_group; do
                 echo "File: \"$l_file\" mode: \"$l_file_mode\" owner \"$l_file_own\" group \"$l_file_group\""
                 l_out2=""
                 [ "l_file_group" = "$l_ssh_group_name" ] && l_pmask="0137" || l_pmask="0177"
                 l_maxperm="$( printf '%o' $(( 0777 & ~$l_pmask )) )"
                 if [ $(( $l_file_mode & $l_pmask )) -gt 0 ]; then
                    l_out2="$l_out2\n  - Mode: \"$l_file_mode\" should be mode: \"$l_maxperm\" or more restrictive\n   -
        updating to mode: \:$l_maxperm\""
                    [ "l_file_group" = "$l_ssh_group_name" ] && chmod u-x,g-wx,o-rwx "$l_file" || chmod u-x,go-rwx
                 fi
                 if [ "$l_file_owner" != "root" ]; then
                    l_out2="$l_out2\n  - Owned by: \"$l_file_owner\" should be owned by \"root\"\n   - Changing ownership to
        \"root\""
                    chown root "$l_file"
                 fi
                 if [[ ! "$l_file_group" =~ ($l_ssh_group_name|root) ]]; then
                    [ -n "$l_ssh_group_name" ] && l_new_group="$l_ssh_group_name" || l_new_group="root"
                    l_out2="$l_out2\n  - Owned by group \"$l_file_group\" should be group owned by: \"$l_ssh_group_name\" or
        \"root\"\n   - Changing group ownership to \"$l_new_group\""
                    chgrp "$l_new_group" "$l_file"
                 fi
                 if [ -n "$l_out2" ]; then
                    l_output2="$l_output2\n - File: \"$l_file\"$l_out2"
                 else
                    l_output="$l_output\n - File: \"$l_file\"\n  - Correct: mode: \"$l_file_mode\", owner: \"$l_file_owner\",
        and group owner: \"$l_file_group\" configured"
                 fi
              done < <(stat -Lc '%#a:%U:%G' "$l_file")
           }
           while IFS= read -r -d $'\0' l_file; do
              if ssh-keygen -lf &>/dev/null "$l_file"; then
                 file "$l_file" | grep -Piq -- '\bopenssh\h+([^#\n\r]+\h+)?private\h+key\b' && FILE_ACCESS_FIX
              fi
           done < <(find -L /etc/ssh -xdev -type f -print0 2>/dev/null)
           if [ -z "$l_output2" ]; then
              echo -e "\n- No access changes required\n"
           else
              echo -e "\n- Remediation results:\n$l_output2\n"
           fi
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.1.3":
    title: '5.1.3 | Ensure permissions on SSH public host key files are configured'
    section: 'Configure SSH Server'
    description: |
        An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key
        is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public
        key that corresponds to a private key will be able to authenticate successfully.
    remediation: |
        Run the following script to set mode, ownership, and group on the public SSH host key files:
        #!/usr/bin/env bash

        {
           l_output="" l_output2=""
           l_pmask="0133" && l_maxperm="$( printf '%o' $(( 0777 & ~$l_pmask )) )"
           FILE_ACCESS_FIX()
           {
              while IFS=: read -r l_file_mode l_file_owner l_file_group; do
                 l_out2=""
                 if [ $(( $l_file_mode & $l_pmask )) -gt 0 ]; then
                    l_out2="$l_out2\n  - Mode: \"$l_file_mode\" should be mode: \"$l_maxperm\" or more restrictive\n   -
        updating to mode: \:$l_maxperm\""
                    chmod u-x,go-wx
                 fi
                 if [ "$l_file_owner" != "root" ]; then
                    l_out2="$l_out2\n  - Owned by: \"$l_file_owner\" should be owned by \"root\"\n   - Changing ownership to
        \"root\""
                    chown root "$l_file"
                 fi
                 if [ "$l_file_group" != "root" ]; then
                    l_out2="$l_out2\n  - Owned by group \"$l_file_group\" should be group owned by: \"root\"\n   - Changing
        group ownership to \"root\""
                    chgrp root "$l_file"
                 fi
                 if [ -n "$l_out2" ]; then
                    l_output2="$l_output2\n - File: \"$l_file\"$l_out2"
                 else
                    l_output="$l_output\n - File: \"$l_file\"\n  - Correct: mode: \"$l_file_mode\", owner: \"$l_file_owner\",
        and group owner: \"$l_file_group\" configured"
                 fi
              done < <(stat -Lc '%#a:%U:%G' "$l_file")
           }
           while IFS= read -r -d $'\0' l_file; do
              if ssh-keygen -lf &>/dev/null "$l_file"; then
                 file "$l_file" | grep -Piq -- '\bopenssh\h+([^#\n\r]+\h+)?public\h+key\b' && FILE_ACCESS_FIX
              fi
           done < <(find -L /etc/ssh -xdev -type f -print0 2>/dev/null)
           if [ -z "$l_output2" ]; then
              echo -e "\n- No access changes required\n"
           else
              echo -e "\n- Remediation results:\n$l_output2\n"
           fi
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.1.4":
    title: '5.1.4 | Ensure sshd access is configured'
    section: 'Configure SSH Server'
    description: |
        There are several options available to limit which users and group can access the system via SSH. It is recommended that
        at least one of the following options be leveraged AllowUsers


        The                    AllowUsers
         variable gives the system administrator the option of allowing specific users to                    ssh
         into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this
        variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in
        from a particular host, the entry can be specified in the form of userhost.
                           AllowGroups


        The                    AllowGroups
         variable gives the system administrator the option of allowing specific groups of users to                    ssh
         into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this
        variable.
                           DenyUsers


        The                    DenyUsers
         variable gives the system administrator the option of denying specific users to                    ssh
         into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this
        variable. If a system administrator wants to restrict user access further by specifically denying a users access from a
        particular host, the entry can be specified in the form of userhost.
                           DenyGroups


        The                    DenyGroups
         variable gives the system administrator the option of denying specific groups of users to                    ssh
         into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this
        variable.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set one or more of the parameters above any                  Include
         and                  Match
         set statements as follows:
        AllowUsers <userlist>
         - AND/OR -
        AllowGroups <grouplist>
                       Note:
        First occurrence of a option takes precedence,                    Match
         set statements withstanding. If                    Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        .conf
         file in a                    Include
         directory.                 It is easier to manage an allow list than a deny list. In a deny list, you could potentially
        add a user or group and forget to add it to the deny list.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == allowusers,allowgroups,denyusers,denygroups:\H+\b(\h+\H+\b)*'

  "5.1.5":
    title: '5.1.5 | Ensure sshd Banner is configured'
    section: 'Configure SSH Server'
    description: |
        The              Banner
         parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By
        default, no banner is displayed.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  Banner
         parameter above any                  Include
         and                  Match
         entries as follows:               Banner /etc/issue.net
         Note:
         First occurrence of a option takes precedence, Match set statements withstanding. If Include locations are enabled,
        used, and order of precedence is understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == banner:\/\H+'

  "5.1.6":
    title: '5.1.6 | Ensure sshd Ciphers are configured'
    section: 'Configure SSH Server'
    description: |
        This variable limits the ciphers that SSH can use during communication. Notes Some organizations may have stricter
        requirements for approved ciphers. Ensure that ciphers used are in compliance with site policy.
        The only strong ciphers currently FIPS 140 compliant are
                       aes256gcmopenssh.com aes128gcmopenssh.com aes256ctr aes192ctr aes128ctr
    remediation: |
        Edit the /etc/ssh/sshd_config file and add/modify the                  Ciphers
         line to contain a comma separated list of the site unapproved (weak) Ciphers preceded with a                  -
         above any                  Include
         entries:               Example: Ciphers -3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,chacha20-poly1305@openssh.com
         - IF - CVE-2023-48795
         has been addressed, and it meets local site policy,                  chacha20-poly1305@openssh.com
         may be removed from the list of excluded ciphers.               Note:
         First occurrence of an option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ciphers:3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,arcfour,arcfour128,arcfour256,blowfish-cbc,cast128-cbc,rijndael-cbc@lysator\.liu\.se'

  "5.1.7":
    title: '5.1.7 | Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured'
    section: 'Configure SSH Server'
    description: |
        Note
         To clarify, the two settings described below are only meant for idle connections from a protocol perspective and are
        not meant to check if the user is active or not. An idle user does not mean an idle connection. SSH does not and never
        had, intentionally, the capability to drop idle users. In SSH versions before              8.2p1
         there was a bug that caused these values to behave in such a manner that they were abused to disconnect idle users.
        This bug has been resolved in              8.2p1
         and thus it can no longer be abused disconnect idle users.
        The two options              ClientAliveInterval
         and              ClientAliveCountMax
         control the timeout of SSH sessions. Taken directly from              man 5 sshdconfig
                   ClientAliveInterval
         Sets a timeout interval in seconds after which if no data has been received from the client, sshd8 will send a message
        through the encrypted channel to request a response from the client. The default is 0, indicating that these messages
        will not be sent to the client.               ClientAliveCountMax
         Sets the number of client alive messages which may be sent without sshd8 receiving any messages back from the client.
        If this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating
        the session.  It is important to note that the use of client alive messages is very different from TCPKeepAlive. The
        client alive messages are sent through the encrypted channel and therefore will not be spoofable. The TCP keepalive
        option enabled by TCPKeepAlive is spoofable. The client alive mechanism is valuable when the client or server depend on
        knowing when a connection has become unresponsive.
        The default value is 3. If ClientAliveInterval is set to 15, and ClientAliveCountMax is left at the default,
        unresponsive SSH clients will be disconnected after approximately 45 seconds. Setting a zero ClientAliveCountMax
        disables connection termination.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  ClientAliveInterval
         and                  ClientAliveCountMax
         parameters above any                  Include
         and                  Match
         entries according to site policy.               Example:
        ClientAliveInterval 15
        ClientAliveCountMax 3
                       Note:
         First occurrence of a option takes precedence, Match set statements withstanding. If Include locations are enabled,
        used, and order of precedence is understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == clientalivecountmax:[1-9][0-9]*m?'
            - name: Undefined
              rule: 'should cmp == ClientAliveInterval:[1-9][0-9]*m?'

  "5.1.8":
    title: '5.1.8 | Ensure sshd DisableForwarding is enabled'
    section: 'Configure SSH Server'
    description: |
        The              DisableForwarding
         parameter disables all forwarding features, including X11, sshagent1, TCP and StreamLocal. This option overrides all
        other forwardingrelated options and may simplify restricted configurations.           X11Forwarding provides the ability
        to tunnel X11 traffic through the connection to enable remote graphic connections. sshagent is a program to hold private
        keys used for public key authentication. Through use of environment variables the agent can be located and automatically
        used for authentication when logging in to other machines using ssh. SSH port forwarding is a mechanism in SSH for
        tunneling application ports from the client to the server, or servers to clients. It can be used for adding encryption
        to legacy applications, going through firewalls, and some system administrators and IT professionals use it for opening
        backdoors into the internal network from their home machines.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  DisableForwarding
         parameter to                  yes
         above any                  Include
         entry as follows:               DisableForwarding yes
         Note:
         First occurrence of a option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.               Impact: SSH
        tunnels are widely used in many corporate environments. In some environments the applications themselves may have very
        limited native support for security. By utilizing tunneling, compliance with SOX, HIPAA, PCI-DSS, and other standards
        can be achieved without having to modify the applications.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_5.1.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == disableforwarding:yes'

  "5.1.9":
    title: '5.1.9 | Ensure sshd GSSAPIAuthentication is disabled'
    section: 'Configure SSH Server'
    description: |
        The              GSSAPIAuthentication
         parameter specifies whether user authentication based on GSSAPI is allowed
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  GSSAPIAuthentication
         parameter to                  no
         above any                  Include
         and                  Match
         entries as follows:               GSSAPIAuthentication no
         Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_5.1.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == gssapiauthentication:no\b'

  "5.1.10":
    title: '5.1.10 | Ensure sshd HostbasedAuthentication is disabled'
    section: 'Configure SSH Server'
    description: |
        The              HostbasedAuthentication
         parameter specifies if authentication is allowed through trusted hosts via the user of              .rhosts
        , or              /etc/hosts.equiv
        , along with successful public key client host authentication.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  HostbasedAuthentication
         parameter to                  no
         above any                  Include
         and                  Match
         entries as follows:               HostbasedAuthentication no
         Note:
         First occurrence of a option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == hostbasedauthentication:no'

  "5.1.11":
    title: '5.1.11 | Ensure sshd IgnoreRhosts is enabled'
    section: 'Configure SSH Server'
    description: |
        The              IgnoreRhosts
         parameter specifies that              .rhosts
         and              .shosts
         files will not be used in              RhostsRSAAuthentication
         or              HostbasedAuthentication
        .
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  IgnoreRhosts
         parameter to                  yes
         above any                  Include
         and                  Match
         entries as follows:               IgnoreRhosts yes
         Note:
         First occurrence of a option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.11', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ignorerhosts:yes\b'

  "5.1.12":
    title: '5.1.12 | Ensure sshd KexAlgorithms is configured'
    section: 'Configure SSH Server'
    description: |
        Key exchange is any method in cryptography by which cryptographic keys are exchanged between two parties, allowing use
        of a cryptographic algorithm. If the sender and receiver wish to exchange encrypted messages, each must be equipped to
        encrypt messages to be sent and decrypt messages received Notes Kex algorithms have a higher preference the earlier they
        appear in the list Some organizations may have stricter requirements for approved Key exchange algorithms Ensure that
        Key exchange algorithms used are in compliance with site policy
        The only Key Exchange Algorithms currently FIPS 140 approved are
                       ecdhsha2nistp256 ecdhsha2nistp384 ecdhsha2nistp521 diffiehellmangroupexchangesha256
        diffiehellmangroup16sha512 diffiehellmangroup18sha512 diffiehellmangroup14sha256
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file and add/modify the                  KexAlgorithms
         line to contain a comma separated list of the site unapproved (weak) KexAlgorithms preceded with a                  -
         above any                  Include
         entries:               Example: KexAlgorithms -diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,diffie-hellman-
        group-exchange-sha1
         Note:
         First occurrence of an option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.12', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == kexalgorithms:diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1'

  "5.1.13":
    title: '5.1.13 | Ensure sshd LoginGraceTime is configured'
    section: 'Configure SSH Server'
    description: |
        The              LoginGraceTime
         parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is
        the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should
        be limited to appropriate organizational limits to ensure the service is available for needed access.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  LoginGraceTime
         parameter to                  60
         seconds or less above any                  Include
         entry as follows:               LoginGraceTime 60
         Note:
         First occurrence of a option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.13', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == logingracetime:\b([1-9]|[1-5][0-9]|60)\b'

  "5.1.14":
    title: '5.1.14 | Ensure sshd LogLevel is configured'
    section: 'Configure SSH Server'
    description: |
        SSH provides several logging levels with varying amounts of verbosity. The              DEBUG
         options are specifically not recommended other than strictly for debugging SSH communications. These levels provide so
        much data that it is difficult to identify important security information, and may violate the privacy of users.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  LogLevel
         parameter to                  VERBOSE
         or                  INFO
         above any                  Include
         and                  Match
         entries as follows:
        LogLevel VERBOSE
           - OR -
        LogLevel INFO
                       Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.14', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == loglevel:(VERBOSE|INFO)\b'

  "5.1.15":
    title: '5.1.15 | Ensure sshd MACs are configured'
    section: 'Configure SSH Server'
    description: |
        This variable limits the types of MAC algorithms that SSH can use during communication. Notes Some organizations may
        have stricter requirements for approved MACs. Ensure that MACs used are in compliance with site policy.
        The only strong MACs currently FIPS 140 approved are
                       HMACSHA1 HMACSHA2256 HMACSHA2384 HMACSHA2512
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file and add/modify the                  MACs
         line to contain a comma separated list of the site unapproved (weak) MACs preceded with a                  -
         above any                  Include
         entries:               Example: MACs -hmac-md5,hmac-md5-96,hmac-ripemd160,hmac-sha1-96,umac-64@openssh.com,hmac-
        md5-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-
        sha1-96-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com
         - IF - CVE-2023-48795
         has not been reviewed and addressed, the following                  etm
         MACs should be added to the exclude list:                  hmac-sha1-etm@openssh.com
        ,                 hmac-sha2-256-etm@openssh.com
        ,                 hmac-sha2-512-etm@openssh.com
                              Note:
         First occurrence of an option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.15', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == macs:hmac-md5,hmac-md5-96,hmac-ripemd160,hmac-sha1-96,umac-64@openssh\.com,hmac-md5-etm@openssh\.com,hmac-md5-96-etm@openssh\.com,hmac-ripemd160-etm@openssh\.com,hmac-sha1-96-etm@openssh\.com,umac-64-etm@openssh\.com,umac-128-etm@openssh\.com'

  "5.1.16":
    title: '5.1.16 | Ensure sshd MaxAuthTries is configured'
    section: 'Configure SSH Server'
    description: |
        The              MaxAuthTries
         parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure
        count reaches half the number, error messages will be written to the              syslog
         file detailing the login failure.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  MaxAuthTries
         parameter to                  4
         or less above any                  Include
         and                  Match
         entries as follows:               MaxAuthTries 4
         Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.16', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == maxauthtries:[0-4]\b'

  "5.1.17":
    title: '5.1.17 | Ensure sshd MaxSessions is configured'
    section: 'Configure SSH Server'
    description: |
        The              MaxSessions
         parameter specifies the maximum number of open sessions permitted from a given connection.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  MaxSessions
         parameter to                  10
         or less above any                  Include
         and                  Match
         entries as follows:               MaxSessions 10
         Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.17', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == maxsessions:([1-9]|10)\b'

  "5.1.18":
    title: '5.1.18 | Ensure sshd MaxStartups is configured'
    section: 'Configure SSH Server'
    description: |
        The              MaxStartups
         parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  MaxStartups
         parameter to                  10:30:60
         or more restrictive above any                  Include
         entries as follows:               MaxStartups 10:30:60
         Note:
         First occurrence of a option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.18', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == maxstartups:(10|[1-9])\H(30|[1-2][0-9]|[1-9])\H(60|[1-5][0-9]|[1-9])\b'

  "5.1.19":
    title: '5.1.19 | Ensure sshd PermitEmptyPasswords is disabled'
    section: 'Configure SSH Server'
    description: |
        The              PermitEmptyPasswords
         parameter specifies if the SSH server allows login to accounts with empty password strings.
    remediation: |
        Edit                  /etc/ssh/sshd_config
         and set the                  PermitEmptyPasswords
         parameter to                  no
         above any                  Include
         and                  Match
         entries as follows:               PermitEmptyPasswords no
         Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.19', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == permitemptypasswords:no\b'

  "5.1.20":
    title: '5.1.20 | Ensure sshd PermitRootLogin is disabled'
    section: 'Configure SSH Server'
    description: |
        The              PermitRootLogin
         parameter specifies if the root user can log in using SSH. The default is              prohibitpassword
        .
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  PermitRootLogin
         parameter to                  no
         above any                  Include
         and                  Match
         entries as follows:               PermitRootLogin no
         Note:
         First occurrence of an option takes precedence,                  Match
         set statements withstanding. If                  Include
         locations are enabled, used, and order of precedence is understood in your environment, the entry may be created in a
        file in                  Include
         location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.20', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == permitrootlogin:no\b'

  "5.1.21":
    title: '5.1.21 | Ensure sshd PermitUserEnvironment is disabled'
    section: 'Configure SSH Server'
    description: |
        The              PermitUserEnvironment
         option allows users to present environment options to the SSH daemon.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  PermitUserEnvironment
         parameter to                  no
         above any                  Include
         entries as follows:               PermitUserEnvironment no
         Note:
         First occurrence of an option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.21', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == permituserenvironment:no\b'

  "5.1.22":
    title: '5.1.22 | Ensure sshd UsePAM is enabled'
    section: 'Configure SSH Server'
    description: |
        The              UsePAM
         directive enables the Pluggable Authentication Module PAM interface. If set to              yes
         this will enable PAM authentication using              ChallengeResponseAuthentication
         and              PasswordAuthentication
         directives in addition to PAM account and session module processing for all authentication types.
    remediation: |
        Edit the                  /etc/ssh/sshd_config
         file to set the                  UsePAM
         parameter to                  yes
         above any                  Include
         entries as follows:               UsePAM yes
         Note:
         First occurrence of an option takes precedence. If Include locations are enabled, used, and order of precedence is
        understood in your environment, the entry may be created in a file in Include location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.1.22', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == usepam:yes\b'

  "5.2.1":
    title: '5.2.1 | Ensure sudo is installed'
    section: 'Configure privilege escalation'
    description: |
        sudo
         allows a permitted user to execute a command as the superuser or another user, as specified by the security policy.
        The invoking users real not effective user ID is used to determine the user name with which to query the security
        policy.
    remediation: |
        First determine is LDAP functionality is required. If so, then install                  sudo-ldap
        , else install                  sudo
        .               Example: # apt install sudo
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.2":
    title: '5.2.2 | Ensure sudo commands use pty'
    section: 'Configure privilege escalation'
    description: |
        sudo
         can be configured to run only from a pseudo terminal              pseudopty
        .
    remediation: |
        Edit the file                  /etc/sudoers
         with                  visudo
         or a file in                  /etc/sudoers.d/
         with                  visudo -f <PATH TO FILE>
         and add the following line:               Defaults use_pty

        Edit the file                  /etc/sudoers
         with                  visudo
         and any files in                  /etc/sudoers.d/
         with                  visudo -f <PATH TO FILE>
         and remove any occurrence of                  !use_pty
                              Note:
        sudo will read each file in                    /etc/sudoers.d
        , skipping file names that end in                    ~
         or contain a                    .
         character to avoid causing problems with package manager or editor temporary/backup files.
        Files are parsed in sorted lexical order. That is,                    /etc/sudoers.d/01_first
         will be parsed before                    /etc/sudoers.d/10_second
        .
        Be aware that because the sorting is lexical, not numeric,                    /etc/sudoers.d/1_whoops
         would be loaded after                    /etc/sudoers.d/10_second
        .                 Using a consistent number of leading zeroes in the file names can be used to avoid such problems.
        Impact: WARNING:
         Editing the                    sudo
         configuration incorrectly can cause                    sudo
         to stop functioning. Always use                    visudo
         to modify                    sudo
         configuration files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.3":
    title: '5.2.3 | Ensure sudo log file exists'
    section: 'Configure privilege escalation'
    description: |
        sudo can use a custom log file
    remediation: |
        Edit the file                  /etc/sudoers
         or a file in                  /etc/sudoers.d/
         with                  visudo
         or                  visudo -f <PATH TO FILE>
         and add the following line:               Example: Defaults logfile="/var/log/sudo.log"
         Note:
        sudo will read each file in                    /etc/sudoers.d
        , skipping file names that end in                    ~
         or contain a                    .
         character to avoid causing problems with package manager or editor temporary/backup files.
        Files are parsed in sorted lexical order. That is,                    /etc/sudoers.d/01_first
         will be parsed before                    /etc/sudoers.d/10_second
        .
        Be aware that because the sorting is lexical, not numeric,                    /etc/sudoers.d/1_whoops
         would be loaded after                    /etc/sudoers.d/10_second
        .                 Using a consistent number of leading zeroes in the file names can be used to avoid such problems.
        Impact: WARNING:
         Editing the                    sudo
         configuration incorrectly can cause                    sudo
         to stop functioning. Always use                    visudo
         to modify                    sudo
         configuration files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.4":
    title: '5.2.4 | Ensure users must provide password for privilege escalation'
    section: 'Configure privilege escalation'
    description: |
        The operating system must be configured so that users must provide a password for privilege escalation.
    remediation: |
        Based on the outcome of the audit procedure, use                  visudo -f <PATH TO FILE>
         to edit the relevant sudoers file.
        Remove any line with occurrences of                  NOPASSWD
         tags in the file.               Impact: This will prevent automated processes from being able to elevate privileges.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_5.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.5":
    title: '5.2.5 | Ensure re-authentication for privilege escalation is not disabled globally'
    section: 'Configure privilege escalation'
    description: |
        The operating system must be configured so that users must reauthenticate for privilege escalation.
    remediation: |
        Configure the operating system to require users to reauthenticate for privilege escalation.
        Based on the outcome of the audit procedure, use                  visudo -f <PATH TO FILE>
         to edit the relevant sudoers file.
        Remove any occurrences of                  !authenticate
         tags in the file(s).
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.6":
    title: '5.2.6 | Ensure sudo authentication timeout is configured correctly'
    section: 'Configure privilege escalation'
    description: |
        sudo
         caches used credentials for a default of 15 minutes. This is for ease of use when there are multiple administrative
        tasks to perform. The timeout can be modified to suit local security policies.           This default is distribution
        specific. See audit section for further information.
    remediation: |
        If the currently configured timeout is larger than 15 minutes, edit the file listed in the audit section with
        visudo -f <PATH TO FILE>
         and modify the entry                  timestamp_timeout=
         to 15 minutes or less as per your site policy. The value is in minutes. This particular entry may appear on it's own,
        or on the same line as                  env_reset
        . See the following two examples:               Defaults    env_reset, timestamp_timeout=15

        Defaults    timestamp_timeout=15
        Defaults    env_reset
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.2.7":
    title: '5.2.7 | Ensure access to the su command is restricted'
    section: 'Configure privilege escalation'
    description: |
        The              su
         command allows a user to run a command or shell as another user. The program has been superseded by              sudo
        , which allows for more granular control over privileged access. Normally, the              su
         command can be executed by any user. By uncommenting the              pamwheel.so
         statement in              /etc/pam.d/su
        , the              su
         command will only allow users in a specific groups to execute              su
        . This group should be empty to reinforce the use of              sudo
         for privileged access.
    remediation: |
        Create an empty group that will be specified for use of the                  su
         command.  The group should be named according to site policy.               Example: # groupadd sugroup

        Add the following line to the                  /etc/pam.d/su
         file, specifying the empty group:               auth required pam_wheel.so use_uid group=sugroup
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.2.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.1.1":
    title: '5.3.1.1 | Ensure latest version of pam is installed'
    section: 'Configure PAM software packages'
    description: |
        Updated versions of PAM include additional functionality
    remediation: |
        - IF -
         the version of                    libpam-runtime
         on the system is less that version                    1.5.2-6
        :
        Run the following command to update to the latest version of                    PAM
        :                 # apt upgrade libpam-runtime
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.1.2":
    title: '5.3.1.2 | Ensure libpam-modules is installed'
    section: 'Configure PAM software packages'
    description: |
        Pluggable Authentication Modules for PAM
    remediation: |
        - IF -
         the version of                    libpam-modules
         on the system is less that version                    1.5.2-6
        :
        Run the following command to update to the latest version of                    PAM
        :                 # apt upgrade libpam-modules
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.1.3":
    title: '5.3.1.3 | Ensure libpam-pwquality is installed'
    section: 'Configure PAM software packages'
    description: |
        libpwquality
         provides common functions for password quality checking and scoring them based on their apparent randomness. The
        library also provides a function for generating random passwords with good pronounceability.
        This module can be plugged into the password stack of a given service to provide some plugin strengthchecking for
        passwords. The code was originally based on                pamcracklib
         module and the module is backwards compatible with its options.
    remediation: |
        Run the following command to install                    libpam-pwquality
        :                 # apt install libpam-pwquality
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.2.1":
    title: '5.3.2.1 | Ensure pam unix module is enabled'
    section: 'Configure pam-auth-update profiles'
    description: |
        pamunix
         is the standard Unix authentication module. It uses standard calls from the systems libraries to retrieve and set
        account information as well as authentication. Usually this is obtained from the                /etc/passwd
         and if shadow is enabled, the                /etc/shadow
         file as well.
        The account component performs the task of establishing the status of the users account and password based on the
        following shadow elements                expire
        ,                lastchange
        ,                maxchange
        ,                minchange
        ,                warnchange
        . In the case of the latter, it may offer advice to the user on changing their password or, through the
        PAMAUTHTOKENREQD
         return, delay giving service to the user until they have established a new password. The entries listed above are
        documented in the shadow5 manual page. Should the users record not contain one or more of these entries, the
        corresponding shadow check is not performed.             The authentication component performs the task of checking the
        users credentials password. The default action of this module is to not permit the user access to a service if their
        official password is blank.
    remediation: |
        Run the following command to enable the                    pam_unix
         module:                 # pam-auth-update --enable unix
         Note:
         If a site specific custom profile is being used in your environment to configure PAM that includes the configuration
        for the                    pam_faillock
         module, enable that module instead
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.2.2":
    title: '5.3.2.2 | Ensure pam faillock module is enabled'
    section: 'Configure pam-auth-update profiles'
    description: |
        The                pamfaillock.so
         module maintains a list of failed authentication attempts per user during a specified interval and locks the account in
        case there were more than the configured number of consecutive failed authentications this is defined by the
        deny
         parameter in the faillock configuration. It stores the failure records into peruser files in the tally directory.
    remediation: |
        Create two pam-auth-update profiles in                    /usr/share/pam-configs/
        :                 Create the first profile with the following lines:
        Name: Enable pam_faillock to deny access
        Default: yes
        Priority: 0
        Auth-Type: Primary
        Auth:
                [default=die]                   pam_faillock.so authfail
                         Example:
        #!/usr/bin/env bash

        {
           arr=('Name: Enable pam_faillock to deny access' 'Default: yes' 'Priority: 0' 'Auth-Type: Primary' 'Auth:' '
        [default=die]                   pam_faillock.so authfail')
           printf '%s\n' "${arr[@]}" > /usr/share/pam-configs/faillock
        }
                         Create the second profile with the following lines:
        Name: Notify of failed login attempts and reset count upon success
        Default: yes
        Priority: 1024
        Auth-Type: Primary
        Auth:
                requisite                       pam_faillock.so preauth
        Account-Type: Primary
        Account:
                required                        pam_faillock.so
                         Example:
        #!/usr/bin/env bash

        {
           arr=('Name: Notify of failed login attempts and reset count upon success' 'Default: yes' 'Priority: 1024' 'Auth-Type:
        Primary' 'Auth:' '        requisite                       pam_faillock.so preauth' 'Account-Type: Primary' 'Account:' '
        required                        pam_faillock.so')
           printf '%s\n' "${arr[@]}" > /usr/share/pam-configs/faillock_notify
        }

        Run the following command to update the                    common-auth
         and                    common-account
         PAM files with the new profiles:                 # pam-auth-update --enable <profile_filename>
         Example:
        # pam-auth-update --enable faillock
        # pam-auth-update --enable faillock_notify
                         Note:
        The name used for the file must be used in the                      pam-auth-update --enable
         command
        The                      Name:
         line should be easily recognizable and understood
        The                      Priority:
         Line is important as it effects the order of the lines in the                      /etc/pam.d/
         files
        If a site specific custom profile is being used in your environment to configure PAM that includes the configuration for
        the                      pam_faillock
         module, enable that module instead
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.2.3":
    title: '5.3.2.3 | Ensure pam pwquality module is enabled'
    section: 'Configure pam-auth-update profiles'
    description: |
        The                pampwquality.so
         module performs password quality checking. This module can be plugged into the password stack of a given service to
        provide strengthchecking for passwords. The code was originally based on pamcracklib module and the module is backwards
        compatible with its options.             The action of this module is to prompt the user for a password and check its
        strength against a system dictionary and a set of rules for identifying poor choices. The first action is to prompt for
        a single password, check its strength and then, if it is considered strong, prompt for the password a second time to
        verify that it was typed correctly on the first occasion. All being well, the password is passed on to subsequent
        modules to be installed as the new authentication token.
    remediation: |
        Run the following script to verify the                    pam_pwquality.so
         line exists in a                    pam-auth-update
         profile:                 # grep -P -- '\bpam_pwquality\.so\b' /usr/share/pam-configs/*
         Output should be similar to:
        /usr/share/pam-configs/pwquality:       requisite                       pam_pwquality.so retry=3
        /usr/share/pam-configs/pwquality:       requisite                       pam_pwquality.so retry=3
                         - IF -
         similar output is returned:
        Run the following command to update                    /etc/pam.d/common-password
         with the returned profile:                 # pam-auth-update --enable {PROFILE_NAME}
         Example: # pam-auth-update pwquality
         - IF -
         similar output is                    NOT
         returned:
        Run the following script to create a                    pam-auth-update
         profile for                    pwquality
        :
        !#/usr/bin/env bash

        {
           arr=('Name: Pwquality password strength checking' 'Default: yes' 'Priority: 1024' 'Conflicts: cracklib' 'Password-
        Type: Primary' 'Password:' '        requisite                       pam_pwquality.so retry=3' 'Password-Initial:'
        'requisite')
           printf '%s\n' "${arr[@]}" > /usr/share/pam-configs/pwquality
        }

        Run the following command to update                    /etc/pam.d/common-password
         with the                    pwquality
         profile:                 # pam-auth-update --enable pwquality
         Note:
        The name used for the file must be used in the                      pam-auth-update --enable
         command
        The                      Name:
         line should be easily recognizable and understood
        The                      Priority:
         Line is important as it effects the order of the lines in the                      /etc/pam.d/
         files
        If a site specific custom profile is being used in your environment to configure PAM that includes the configuration for
        the                      pam_pwquality
         module, enable that module instead
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.2.4":
    title: '5.3.2.4 | Ensure pam pwhistory module is enabled'
    section: 'Configure pam-auth-update profiles'
    description: |
        The                pampwhistory.so
         module saves the last passwords for each user in order to force password change history and keep the user from
        alternating between the same password too frequently.
        This module does not work together with kerberos. In general, it does not make much sense to use this module in
        conjunction with                NIS
         or                LDAP
        , since the old passwords are stored on the local machine and are not available on another machine for password history
        checking.
    remediation: |
        Run the following script to verify the                    pam_pwquality.so
         line exists in a                    pam-auth-update
         profile:                 # grep -P -- '\bpam_pwhistory\.so\b' /usr/share/pam-configs/*
         Output should be similar to: /usr/share/pam-configs/pwhistory:   requisite   pam_pwhistory.so remember=24
        enforce_for_root try_first_pass use_authtok
         - IF -
         similar output is returned:
        Run the following command to update                    /etc/pam.d/common-password
         with the returned profile:                 # pam-auth-update --enable {PROFILE_NAME}
         Example: # pam-auth-update pwhistory
         - IF -
         similar output is                    NOT
         returned:
        Run the following script to create a                    pam-auth-update
         profile for                    pwhistory
        :
        !#/usr/bin/env bash

        {
           arr=('Name: pwhistory password history checking' 'Default: yes' 'Priority: 1024' 'Password-Type: Primary' 'Password:'
        '        requisite                       pam_pwhistory.so remember=24 enforce_for_root try_first_pass use_authtok')
           printf '%s\n' "${arr[@]}" > /usr/share/pam-configs/pwhistory
        }

        Run the following command to update                    /etc/pam.d/common-password
         with the                    pwhistory
         profile:                 # pam-auth-update --enable pwhistory
         Note:
        The name used for the file must be used in the                      pam-auth-update --enable
         command
        The                      Name:
         line should be easily recognizable and understood
        The                      Priority:
         Line is important as it effects the order of the lines in the                      /etc/pam.d/
         files
        If a site specific custom profile is being used in your environment to configure PAM that includes the configuration for
        the                      pam_pwhistory
         module, enable that module instead
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.1.1":
    title: '5.3.3.1.1 | Ensure password failed attempts lockout is configured'
    section: 'Configure pam_faillock module'
    description: |
        The                  denyn
         option will deny access if the number of consecutive authentication failures for this user during the recent interval
        exceeds
        .
    remediation: |
        Create or edit the following line in                      /etc/security/faillock.conf
         setting the                      deny
         option to                      5
         or less:                   deny = 5
         Run the following command: # grep -Pl -- '\bpam_faillock\.so\h+([^#\n\r]+\h+)?deny\b' /usr/share/pam-configs/*

        Edit any returned files and remove the                      deny=<N>
         arguments from the                      pam_faillock.so
         line(s):
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.1.2":
    title: '5.3.3.1.2 | Ensure password unlock time is configured'
    section: 'Configure pam_faillock module'
    description: |
        unlocktimen
          The access will be reenabled after
         seconds after the lock out. The value                  0
         has the same meaning as value never  the access will not be reenabled without resetting the faillock entries by the
        faillock8 command.               Note The default directory that pamfaillock uses is usually cleared on system boot so
        the access will be also reenabled after system reboot. If that is undesirable a different tally directory must be set
        with the dir option. It is usually undesirable to permanently lock out users as they can become easily a target of
        denial of service attack unless the usernames are random and kept secret to potential attackers.
        The maximum configurable value for                    unlocktime
         is                    604800
    remediation: |
        Set password unlock time to conform to site policy.                      unlock_time
         should be                      0
         (never), or                      900
         seconds or greater.
        Edit                      /etc/security/faillock.conf
         and update or add the following line:                   unlock_time = 900

        Run the following command: remove the                      unlock_time
         argument from the                      pam_faillock.so
         module in the PAM files:                   # grep -Pl -- '\bpam_faillock\.so\h+([^#\n\r]+\h+)?unlock_time\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      unlock_time=<N>
         argument from the                      pam_faillock.so
         line(s):                   Impact:
        Use of                        unlock_time=0
         may allow an attacker to cause denial of service to legitimate users. This will also require a systems administrator
        with elevated privileges to unlock the account.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.1.3":
    title: '5.3.3.1.3 | Ensure password failed attempts lockout includes root account'
    section: 'Configure pam_faillock module'
    description: |
        evendenyroot
          Root account can become locked as well as regular accounts               rootunlocktimen
          This option implies evendenyroot option. Allow access after n seconds to root account after the account is locked. In
        case the option is not specified the value is the same as of the unlocktime option.
    remediation: |
        Edit                      /etc/security/faillock.conf
        :
        Remove or update any line containing                        root_unlock_time
        ,                        - OR -
         set it to a value of                        60
         or more                     Update or add the following line: even_deny_root
         Run the following command: # grep -Pl -- '\bpam_faillock\.so\h+([^#\n\r]+\h+)?(even_deny_root|root_unlock_time)'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      even_deny_root
         and                      root_unlock_time
         arguments from the                      pam_faillock.so
         line(s):                   Impact:
        Use of                        unlock_time=0
         or                        root_unlock_time=0
         may allow an attacker to cause denial of service to legitimate users.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_5.3.3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.1":
    title: '5.3.3.2.1 | Ensure password number of changed characters is configured'
    section: 'Configure pam_pwquality module'
    description: |
        The                  pwquality
                                 difok
         option sets the number of characters in a password that must not be present in the old password.
    remediation: |
        Create or modify a file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory or the file                      /etc/security/pwquality.conf
         and add or modify the following line to set                      difok
         to                      2
         or more. Ensure setting conforms to local site policy:                   Example:
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*difok\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s' "difok = 2" > /etc/security/pwquality.conf.d/50-pwdifok.conf
        }
                           Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?difok\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      difok
         argument from the                      pam_pwquality.so
         line(s):
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.2":
    title: '5.3.3.2.2 | Ensure minimum password length is configured'
    section: 'Configure pam_pwquality module'
    description: |
        The minimum password length setting determines the lowers number of characters that make up a password for a user
        account. There are many different theories about how to determine the best password length for an organization, but
        perhaps passphrase is a better term than password.
        The                  minlen
         option sets the minimum acceptable size for the new password plus one if credits are not disabled which is the default.
        Cannot be set to lower value than 6.
    remediation: |
        Create or modify a file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory or the file                      /etc/security/pwquality.conf
         and add or modify the following line to set password length of                      14
         or more characters. Ensure that password length conforms to local site policy:                   Example:
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*minlen\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s' "minlen = 14" > /etc/security/pwquality.conf.d/50-pwlength.conf
        }
                           Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?minlen\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      minlen
         argument from the                      pam_pwquality.so
         line(s):                   Impact: In general, it is true that longer passwords are better (harder to crack), but it is
        also true that forced password length requirements can cause user behavior that is predictable and undesirable. For
        example, requiring users to have a minimum 16-character password may cause them to choose repeating patterns like
        fourfourfourfour or passwordpassword that meet the requirement but aren’t hard to guess. Additionally, length
        requirements increase the chances that users will adopt other insecure practices, like writing them down, re-using them
        or storing them unencrypted in their documents. Having a reasonable minimum length with no maximum character limit
        increases the resulting
        average password length used (and therefore the strength).6
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.3":
    title: '5.3.3.2.3 | Ensure password complexity is configured - manual'
    section: 'Configure pam_pwquality module'
    description: |
        Password complexity can be set through minclass
          The minimum number of classes of characters required in a new password. digits, uppercase, lowercase, others. e.g.
        minclass  4
         requires digits, uppercase, lower case, and special characters.                 dcredit
          The maximum credit for having digits in the new password. If less than                    0
         it is the minimum number of digits in the new password. e.g.                    dcredit  1
         requires at least one digit                 ucredit
          The maximum credit for having uppercase characters in the new password. If less than                    0
         it is the minimum number of uppercase characters in the new password. e.g.                    ucredit  1
         requires at least one uppercase character                 ocredit
          The maximum credit for having other characters in the new password. If less than                    0
         it is the minimum number of other characters in the new password. e.g.                    ocredit  1
         requires at least one special character                 lcredit
          The maximum credit for having lowercase characters in the new password.  If less than                    0
         it is the minimum number of lowercase characters in the new password. e.g.                    lcredit  1
         requires at least one lowercase character
    remediation: |
        Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?(minclass|[dulo]credit)\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      minclass
        ,                      dcredit
        ,                      ucredit
        ,                      lcredit
        , and                      ocredit
         arguments from the                      pam_pwquality.so
         line(s)
        Create or modify a file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory or the file                      /etc/security/pwquality.conf
         and add or modify the following line(s) to set complexity according to local site policy:                   minclass =
        _N_ dcredit = _N_
         # Value should be either                        0
         or a number proceeded by a minus (                       -
        ) symbol                     ucredit = -1
         # Value should be either                        0
         or a number proceeded by a minus (                       -
        ) symbol                     ocredit = -1
         # Value should be either                        0
         or a number proceeded by a minus (                       -
        ) symbol                     lcredit = -1
         # Value should be either                        0
         or a number proceeded by a minus (                       -
        ) symbol
        Example 1 - Set                        minclass = 3
        :
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*minclass\s*=/# &/' /etc/security/pwquality.conf
           sed -ri 's/^\s*[dulo]credit\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s' "minclass = 3" > /etc/security/pwquality.conf.d/50-pwcomplexity.conf
        }

        Example 2 - set                        dcredit = -1
        ,                        ucredit = -1
        , and                        lcredit = -1
        :
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*minclass\s*=/# &/' /etc/security/pwquality.conf
           sed -ri 's/^\s*[dulo]credit\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '%s\n' "dcredit = -1" "ucredit = -1" "lcredit = -1" > /etc/security/pwquality.conf.d/50-pwcomplexity.conf
        }
                           Impact: Passwords that are too complex in nature make it harder for users to remember, leading to bad
        practices. In addition, composition requirements provide no defense against common attack types such as social
        engineering or insecure storage of passwords
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_5.3.3.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.3.3.2.4":
    title: '5.3.3.2.4 | Ensure password same consecutive characters is configured'
    section: 'Configure pam_pwquality module'
    description: |
        The                  pwquality
                                 maxrepeat
         option sets the maximum number of allowed same consecutive characters in a new password.
    remediation: |
        Create or modify a file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory or the file                      /etc/security/pwquality.conf
         and add or modify the following line to set                      maxrepeat
         to                      3
         or less and not                      0
        . Ensure setting conforms to local site policy:                   Example:
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*maxrepeat\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s' "maxrepeat = 3" > /etc/security/pwquality.conf.d/50-pwrepeat.conf
        }
                           Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?maxrepeat\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      maxrepeat
         argument from the                      pam_pwquality.so
         line(s):
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.5":
    title: '5.3.3.2.5 | Ensure password maximum sequential characters is configured'
    section: 'Configure pam_pwquality module'
    description: |
        The                  pwquality
                                 maxsequence
         option sets the maximum length of monotonic character sequences in the new password. Examples of such sequence are
        12345
         or                  fedcb
        . The check is disabled if the value is                  0
        .               Note
         Most such passwords will not pass the simplicity check unless the sequence is only a minor part of the password.
    remediation: |
        Create or modify a file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory or the file                      /etc/security/pwquality.conf
         and add or modify the following line to set                      maxsequence
         to                      3
         or less and not                      0
        . Ensure setting conforms to local site policy:                   Example:
        #!/usr/bin/env bash

        {
           sed -ri 's/^\s*maxsequence\s*=/# &/' /etc/security/pwquality.conf
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s' "maxsequence = 3" > /etc/security/pwquality.conf.d/50-pwmaxsequence.conf
        }
                           Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?maxsequence\b'
        /usr/share/pam-configs/*

        Edit any returned files and remove the                      maxsequence
         argument from the                      pam_pwquality.so
         line(s):
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.6":
    title: '5.3.3.2.6 | Ensure password dictionary check is enabled'
    section: 'Configure pam_pwquality module'
    description: |
        The                  pwquality
                                 dictcheck
         option sets whether to check for the words from the                  cracklib
         dictionary.
    remediation: |
        Edit any file ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory and/or the file                      /etc/security/pwquality.conf
         and comment out or remove any instance of                      dictcheck = 0
        :                   Example: # sed -ri 's/^\s*dictcheck\s*=/# &/' /etc/security/pwquality.conf
        /etc/security/pwquality.conf.d/*.conf
         Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?dictcheck\b' /usr/share/pam-configs/*

        Edit any returned files and remove the                      dictcheck
         argument from the                      pam_pwquality.so
         line(s)
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.7":
    title: '5.3.3.2.7 | Ensure password quality checking is enforced'
    section: 'Configure pam_pwquality module'
    description: |
        The                  pampwquality
         module can be configured to either reject a password if it fails the checks, or only print a warning.
        This is configured by setting the                  enforcingN
         argument. If nonzero, a password will be rejected if it fails the checks, otherwise only a warning message will be
        provided.               This setting applies only to the pampwquality module and possibly other applications that
        explicitly change their behavior based on it. It does not affect pwmake1 and pwscore1.
    remediation: |
        Run the following command: # grep -Pl -- '\bpam_pwquality\.so\h+([^#\n\r]+\h+)?enforcing=0\b' /usr/share/pam-configs/*

        Edit any returned files and remove the                      enforcing=0
         argument from the                      pam_pwquality.so
         line(s)
        Edit                      /etc/security/pwquality.conf
         and all files ending in                      .conf
         in the                      /etc/security/pwquality.conf.d/
         directory and remove or comment out any line containing the                      enforcing = 0
         argument:                   Example: # sed -ri 's/^\s*enforcing\s*=\s*0/# &/' /etc/security/pwquality.conf
        /etc/security/pwquality.conf.d/*.conf
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.2.8":
    title: '5.3.3.2.8 | Ensure password quality is enforced for the root user'
    section: 'Configure pam_pwquality module'
    description: |
        If the                  pwquality
                                 enforceforroot
         option is enabled, the module will return error on failed check even if the user changing the password is root.
        This option is off by default which means that just the message about the failed check is printed but root can change
        the password anyway. Note
         The root is not asked for an old password so the checks that compare the old and new password are not performed.
    remediation: |
        Edit or add the following line in a                      *.conf
         file in                      /etc/security/pwquality.conf.d
         or in                        /etc/security/pwquality.conf
        :                   Example:
        #!/urs/bin/env bash

        {
           [ ! -d /etc/security/pwquality.conf.d/ ] && mkdir /etc/security/pwquality.conf.d/
           printf '\n%s\n' "enforce_for_root" > /etc/security/pwquality.conf.d/50-pwroot.conf
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.2.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.3.1":
    title: '5.3.3.3.1 | Ensure password history remember is configured'
    section: 'Configure pam_pwhistory module'
    description: |
        The                  /etc/security/opasswd
         file stores the users old passwords and can be checked to ensure that users are not recycling recent passwords. The
        number of passwords remembered is set via the remember argument value in set for the                  pampwhistory
         module.
        rememberN                     N
         is the number of old passwords to remember
    remediation: |
        Run the following command: # awk '/Password-Type:/{ f = 1;next } /-Type:/{ f = 0 } f {if (/pam_pwhistory\.so/) print
        FILENAME}' /usr/share/pam-configs/*

        Edit any returned files and edit or add the                      remember=
         argument, with a value of                      24
         or more, that meets local site policy to the                      pam_pwhistory
         line in the                      Password
         section:                   Example File:
        Name: pwhistory password history checking
        Default: yes
        Priority: 1024
        Password-Type: Primary
        Password:
           requisite   pam_pwhistory.so remember=24 enforce_for_root try_first_pass use_authtok # <- **ensure line includes
        remember=<N>**

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <MODIFIED_PROFILE_NAME>
         Example: # pam-auth-update --enable pwhistory
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.3.2":
    title: '5.3.3.3.2 | Ensure password history is enforced for the root user'
    section: 'Configure pam_pwhistory module'
    description: |
        If the                  pwhistory
                                 enforceforroot
         option is enabled, the module will enforce password history for the root user as well
    remediation: |
        Run the following command: # awk '/Password-Type:/{ f = 1;next } /-Type:/{ f = 0 } f {if (/pam_pwhistory\.so/) print
        FILENAME}' /usr/share/pam-configs/*

        Edit any returned files and add the                      enforce_for_root
         argument to the                      pam_pwhistory
         line in the                      Password
         section:                   Example File:
        Name: pwhistory password history checking
        Default: yes
        Priority: 1024
        Password-Type: Primary
        Password:
           requisite   pam_pwhistory.so remember=24 enforce_for_root try_first_pass use_authtok # <- **ensure line includes
        enforce_for_root**

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <MODIFIED_PROFILE_NAME>
         Example: # pam-auth-update --enable pwhistory
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.3.3":
    title: '5.3.3.3.3 | Ensure pam pwhistory includes use authtok'
    section: 'Configure pam_pwhistory module'
    description: |
        useauthtok
          When password changing enforce the module to set the new password to the one provided by a previously stacked password
        module
    remediation: |
        Edit any returned files and add the                      use_authtok
         argument to the                      pam_pwhistory
         line in the                      Password
         section:                   Example File:
        Name: pwhistory password history checking
        Default: yes
        Priority: 1024
        Password-Type: Primary
        Password:
           requisite   pam_pwhistory.so remember=24 enforce_for_root try_first_pass use_authtok # <- **ensure line includes
        use_authtok**

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <MODIFIED_PROFILE_NAME>
         Example: # pam-auth-update --enable pwhistory
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.4.1":
    title: '5.3.3.4.1 | Ensure pam unix does not include nullok'
    section: 'Configure pam_unix module'
    description: |
        The                  nullok
         argument overrides the default action of                  pamunix.so
         to not permit the user access to a service if their official password is blank.
    remediation: |
        Run the following command: # grep -PH -- '^\h*([^#\n\r]+\h+)?pam_unix\.so\h+([^#\n\r]+\h+)?nullok\b' /usr/share/pam-
        configs/*

        Edit any files returned and remove the                      nullok
         argument for the                      pam_unix
         lines                   Example File:
        Name: Unix authentication
        Default: yes
        Priority: 256
        Auth-Type: Primary
        Auth:
                [success=end default=ignore]    pam_unix.so try_first_pass # <- **ensure line does not include nullok nullok**
        Auth-Initial:
                [success=end default=ignore]    pam_unix.so # <- **ensure line does not include nullok nullok**
        Account-Type: Primary
        Account:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Account-Initial:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Session-Type: Additional
        Session:
                required        pam_unix.so
        Session-Initial:
                required        pam_unix.so
        Password-Type: Primary
        Password:
                [success=end default=ignore]    pam_unix.so obscure use_authtok try_first_pass yescrypt
        Password-Initial:
                [success=end default=ignore]    pam_unix.so obscure yescrypt

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <EDITED_PROFILE_NAME>
         Example: # pam-auth-update --enable unix
         Note:
         If custom files are being used, the corresponding files in                      /etc/pam.d/
         would need to be edited directly, and the                      pam-auth-update --enable <EDITED_PROFILE_NAME>
         command skipped
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.4.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.4.2":
    title: '5.3.3.4.2 | Ensure pam unix does not include remember'
    section: 'Configure pam_unix module'
    description: |
        The                  remembern
         argument saves the last n passwords for each user in                  /etc/security/opasswd
         in order to force password change history and keep the user from alternating between the same password too frequently.
        The MD5 password hash algorithm is used for storing the old passwords. Instead of this option the
        pampwhistory
         module should be used. The                  pampwhistory
         module saves the last n passwords for each user in                  /etc/security/opasswd
         using the password hash algorithm set on the                  pamunix
         module. This allows for the                  yescrypt
         or                  sha512
         hash algorithm to be used.
    remediation: |
        Run the following command: # grep -PH -- '^\h*([^#\n\r]+\h+)?pam_unix\.so\h+([^#\n\r]+\h+)?remember\b' /usr/share/pam-
        configs/*

        Edit any files returned and remove the                      remember=_<N>_
         argument for the                      pam_unix
         lines                   Example output:
        [success=end default=ignore]   pam_unix.so obscure use_authtok try_first_pass yescrypt remember=5 # **<- remove
        remember=<N>**
        [success=end default=ignore]   pam_unix.so obscure yescrypt remember=5 # **<- remove remember=<N>**

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <EDITED_PROFILE_NAME>
         Example: # pam-auth-update --enable unix
         Note:
         If custom files are being used, the corresponding files in                      /etc/pam.d/
         would need to be edited directly, and the                      pam-auth-update --enable <EDITED_PROFILE_NAME>
         command skipped
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.4.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.4.3":
    title: '5.3.3.4.3 | Ensure pam unix includes a strong password hashing algorithm'
    section: 'Configure pam_unix module'
    description: |
        A cryptographic hash function converts an arbitrarylength input into a fixed length output. Password hashing performs a
        oneway transformation of a password, turning the password into another string, called the hashed password.
        The                  pamunix
         module can be configured to use one of the following hashing algorithms for users passwords               md5
          When a user changes their password next, encrypt it with the                    MD5
         algorithm.                 bigcrypt
          When a user changes their password next, encrypt it with the                    DEC C2
         algorithm.                 sha256
          When a user changes their password next, encrypt it with the                    SHA256
         algorithm. The                    SHA256
         algorithm must be supported by the crypt3 function.                 sha512
          When a user changes their password next, encrypt it with the                    SHA512
         algorithm. The                    SHA512
         algorithm must be supported by the crypt3 function.                 blowfish
          When a user changes their password next, encrypt it with the                    blowfish
         algorithm. The                    blowfish
         algorithm must be supported by the crypt3 function.                 gostyescrypt
          When a user changes their password next, encrypt it with the                    gostyescrypt
         algorithm. The                    gostyescrypt
         algorithm must be supported by the crypt3 function.                 yescrypt
          When a user changes their password next, encrypt it with the                    yescrypt
         algorithm. The                    yescrypt
         algorithm must be supported by the crypt3 function.
    remediation: |
        Run the following command: # awk '/Password-Type:/{ f = 1;next } /-Type:/{ f = 0 } f {if (/pam_unix\.so/) print
        FILENAME}' /usr/share/pam-configs/*

        Edit any returned files and edit or add a strong hashing algorithm, either sha512 or yescrypt, that meets local site
        policy to the                      pam_unix
         lines in the                      Password
         section:                   Example File:
        Name: Unix authentication
        Default: yes
        Priority: 256
        Auth-Type: Primary # <- Start of "Auth" section
        Auth:
                [success=end default=ignore]    pam_unix.so try_first_pass
        Auth-Initial:
                [success=end default=ignore]    pam_unix.so
        Account-Type: Primary # <- Start of "Account" section
        Account:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Account-Initial:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Session-Type: Additional  # <- Start of "Session" section
        Session:
                required        pam_unix.so
        Session-Initial:
                required        pam_unix.so
        Password-Type: Primary # <- Start of "Password" section
        Password:
                [success=end default=ignore]    pam_unix.so obscure use_authtok try_first_pass yescrypt # <- **ensure hashing
        algorithm is either sha512 or yescrypt**
        Password-Initial:
                [success=end default=ignore]    pam_unix.so obscure yescrypt # <- **ensure hashing algorithm is either sha512 or
        yescrypt**

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <MODIFIED_PROFILE_NAME>
         Example: # pam-auth-update --enable unix
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.4.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.3.3.4.4":
    title: '5.3.3.4.4 | Ensure pam unix includes use authtok'
    section: 'Configure pam_unix module'
    description: |
        useauthtok
          When password changing enforce the module to set the new password to the one provided by a previously stacked password
        module
    remediation: |
        Run the following command: # awk '/Password-Type:/{ f = 1;next } /-Type:/{ f = 0 } f {if (/pam_unix\.so/) print
        FILENAME}' /usr/share/pam-configs/*

        Edit any returned files add                      use_authtok
         to the                      pam_unix
         line in the                      Password
         section under                      Password:
         subsection:                   Note:
         The if the file's                      Password
         section includes a                      Password-Initial:
         subsection,                      use_authtok
         should not be added to the                      pam_unix
         line in the                      Password-Initial:
         subsection                   Example File:
        Name: Unix authentication
        Default: yes
        Priority: 256
        Auth-Type: Primary # <- Start of "Auth" section
        Auth:
                [success=end default=ignore]    pam_unix.so try_first_pass
        Auth-Initial:
                [success=end default=ignore]    pam_unix.so
        Account-Type: Primary # <- Start of "Account" section
        Account:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Account-Initial:
                [success=end new_authtok_reqd=done default=ignore]      pam_unix.so
        Session-Type: Additional  # <- Start of "Session" section
        Session:
                required        pam_unix.so
        Session-Initial:
                required        pam_unix.so
        Password-Type: Primary # <- Start of "Password" section
        Password:
                [success=end default=ignore]    pam_unix.so obscure use_authtok try_first_pass yescrypt # <- **ensure line
        includes use_authtok**
        Password-Initial:
                [success=end default=ignore]    pam_unix.so obscure yescrypt # <- **Password-Initial: subsection does not
        include use_authtok

        Run the following command to update the files in the                      /etc/pam.d/
         directory:                   # pam-auth-update --enable <MODIFIED_PROFILE_NAME>
         Example: # pam-auth-update --enable unix
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.3.3.4.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.1.1":
    title: '5.4.1.1 | Ensure password expiration is configured'
    section: 'Configure shadow password suite parameters'
    description: |
        The                PASSMAXDAYS
         parameter in                /etc/login.defs
         allows an administrator to force passwords to expire once they reach a defined age.             PASSMAXDAYS N
          The maximum number of days a password may be used. If the password is older than this, a password change will be
        forced. If not specified, 1 will be assumed which disables the restriction.
    remediation: |
        Set the                    PASS_MAX_DAYS
         parameter to conform to site policy in                    /etc/login.defs
         :                 PASS_MAX_DAYS 365
         Modify user parameters for all users with a password set to match: # chage --maxdays 365 <user>

        Edit                    /etc/login.defs
         and set                    PASS_MAX_DAYS
         to a value greater than                    0
         that follows local site policy:                 Example: PASS_MAX_DAYS 365

        Run the following command to modify user parameters for all users with a password set to a maximum age no greater than
        356
         or less than                    1
         that follows local site policy:                 # chage --maxdays <N> <user>
         Example: # awk -F: '($2~/^\$.+\$/) {if($5 > 365 || $5 < 1)system ("chage --maxdays 365 " $1)}' /etc/shadow
         Impact: The password expiration must be greater than the minimum days between password changes or users will be unable
        to change their password. Excessive password expiration requirements do more harm than good, because these requirements
        make users select predictable passwords, composed of sequential words and numbers that are closely related to each
        other. In these cases, the next password can be predicted based on the previous one (incrementing a number used in the
        password for
        example). Also, password expiration requirements offer no containment benefits because attackers will often use
        credentials as soon as they compromise them. Instead, immediate password changes should be based on key events
        including, but not limited to: Indication of compromise Change of user roles When a user leaves the organization. Not
        only does changing passwords every few weeks or months frustrate the user, it’s been suggested that it does more harm
        than good, because it could lead to bad practices by the user such as adding a character to the end of their existing
        password.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "5.4.1.2":
    title: '5.4.1.2 | Ensure minimum password age is configured'
    section: 'Configure shadow password suite parameters'
    description: |
        The minimum password age determines the number of days that you must use a password before you can change it.
        PASSMINDAYS
                        N
          The minimum number of days allowed between password changes. Any password changes attempted sooner than this will be
        rejected. If not specified, 0 will be assumed which disables the restriction.
    remediation: |
        Edit                    /etc/login.defs
         and set                    PASS_MIN_DAYS
         to a value greater than                    0
         that follows local site policy:                 Example: PASS_MIN_DAYS 1
         Run the following command to modify user parameters for all users with a password set to a minimum age greater than
        zero that follows local site policy: # chage --mindays <N> <user>
         Example: # awk -F: '($2~/^\$.+\$/) {if($4 < 1)system ("chage --mindays 1 " $1)}' /etc/shadow
         Impact: By enforcing a minimum password age, a user will be unable to change their password if they observe a potential
        compromise of their password, e.g. "shoulder surfing", during the time defined by minimum password age. In this event
        the user should follow local site policy to report a compromised password. If a users password is set by other personnel
        as a procedure in dealing with a lost or expired password, the user should be forced to update this "set" password with
        their own password. e.g. force "change at next logon".
        If it is not possible to have a user set their own password immediately, and this recommendation or local site procedure
        may cause a user to continue using a third party generated password,                      PASS_MIN_DAYS
         for the effected user should be temporally changed to                      0
        , to allow a user to change their password immediately.                   For applications where the user is not using
        the password at console, the ability to "change at next logon" may be limited. This may cause a user to continue to use
        a password created by other personnel.
    type: Undefined
    impact: '0.0'
    tags: ['level2', 'rule_5.4.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "5.4.1.3":
    title: '5.4.1.3 | Ensure password expiration warning days is configured'
    section: 'Configure shadow password suite parameters'
    description: |
        The                PASSWARNAGE
         parameter in                /etc/login.defs
          allows an administrator to notify users that their password will expire in a defined number of days.
        PASSWARNAGE N
          The number of days warning given before a password expires. A zero means warning is given only upon the day of
        expiration, a negative value means no warning is given. If not specified, no warning will be provided.
    remediation: |
        Edit                    /etc/login.defs
         and set                    PASS_WARN_AGE
         to a value of                    7
         or more that follows local site policy:                 Example: PASS_WARN_AGE 7

        Run the following command to modify user parameters for all users with a password set to a minimum warning to
        7
         or more days that follows local site policy:                 # chage --warndays <N> <user>
         Example: # awk -F: '($2~/^\$.+\$/) {if($6 < 7)system ("chage --warndays 7 " $1)}' /etc/shadow
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "5.4.1.4":
    title: '5.4.1.4 | Ensure strong password hashing algorithm is configured'
    section: 'Configure shadow password suite parameters'
    description: |
        A cryptographic hash function converts an arbitrarylength input into a fixed length output. Password hashing performs a
        oneway transformation of a password, turning the password into another string, called the hashed password. ENCRYPTMETHOD
         string  This defines the system default encryption algorithm for encrypting passwords if no algorithm are specified on
        the command line. It can take one of these values             MD5
          MD5based algorithm will be used for encrypting password               SHA256
          SHA256based algorithm will be used for encrypting password               SHA512
          SHA512based algorithm will be used for encrypting password               BCRYPT
          BCRYPTbased algorithm will be used for encrypting password               YESCRYPT
          YESCRYPTbased algorithm will be used for encrypting password               DES
          DESbased algorithm will be used for encrypting password default               Note
        This parameter overrides the deprecated                  MD5CRYPTENAB
         variable.               This parameter will only affect the generation of group passwords. The generation of user
        passwords is done by PAM and subject to the PAM configuration. It is recommended to set this variable consistently with
        the PAM configuration.
    remediation: |
        Edit                    /etc/login.defs
         and set the                    ENCRYPT_METHOD
         to                    SHA512
         or                    YESCRYPT
        :                 ENCRYPT_METHOD <HASHING_ALGORITHM>
         Example: ENCRYPT_METHOD YESCRYPT
         Note:
        This only effects local groups' passwords created after updating the file to use                      sha512
         or                      yescrypt
        .
        If it is determined that the password algorithm being used is not                      sha512
         or                      yescrypt
        , once it is changed, it is recommended that all group passwords be updated to use the stronger hashing algorithm.
        It is recommended that the chosen hashing algorithm is consistent across                      /etc/login.defs
         and the PAM configuration
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.1.5":
    title: '5.4.1.5 | Ensure inactive password lock is configured'
    section: 'Configure shadow password suite parameters'
    description: |
        User accounts that have been inactive for over a given period of time can be automatically disabled. INACTIVE
          Defines the number of days after the password exceeded its maximum age where the user is expected to replace this
        password.
        The value is stored in the shadow password file. An input of                0
         will disable an expired password with no delay. An input of                1
         will blank the respective field in the shadow password file.
    remediation: |
        Run the following command to set the default password inactivity period to 45 days or less that meets local site policy:
        # useradd -D -f <N>
         Example: # useradd -D -f 45

        Run the following command to modify user parameters for all users with a password set to a inactive age of
        45
         days or less that follows local site policy:                 # chage --inactive <N> <user>
         Example: # awk -F: '($2~/^\$.+\$/) {if($7 > 45 || $7 < 0)system ("chage --inactive 45 " $1)}' /etc/shadow
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "5.4.1.6":
    title: '5.4.1.6 | Ensure all users last password change date is in the past - manual'
    section: 'Configure shadow password suite parameters'
    description: |
        All users should have a password change date in the past.
    remediation: |
        Investigate any users with a password change date in the future and correct them.  Locking the account, expiring the
        password, or resetting the password manually may be appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.2.1":
    title: '5.4.2.1 | Ensure root is the only UID 0 account - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        Any account with UID 0 has superuser privileges on the system.
    remediation: |
        Run the following command to change the                    root
         account UID to                    0
        :                 # usermod -u 0 root

        Modify any users other than                    root
         with UID                    0
         and assign them a new UID.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == root:0'

  "5.4.2.2":
    title: '5.4.2.2 | Ensure root is the only GID 0 account - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        The                usermod
         command can be used to specify which group the                root
         account belongs to. This affects permissions of files that are created by the                root
         account.
    remediation: |
        Run the following command to set the                    root
         user's GID to                    0
        :                 # usermod -g 0 root

        Run the following command to set the                    root
         group's GID to                    0
        :                 # groupmod -g 0 root

        Remove any users other than the                    root
         user with GID 0 or assign them a new GID if appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == root:0'

  "5.4.2.3":
    title: '5.4.2.3 | Ensure group root is the only GID 0 group - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        The                groupmod
         command can be used to specify which group the                root
         group belongs to. This affects permissions of files that are group owned by the                root
         group.
    remediation: |
        Run the following command to set the                    root
         group's GID to                    0
        :                 # groupmod -g 0 root

        Remove any groups other than the                    root
         group with GID 0 or assign them a new GID if appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == root:0'

  "5.4.2.4":
    title: '5.4.2.4 | Ensure root password is set'
    section: 'Configure root and system accounts and environment'
    description: |
        There are a number of methods to access the root account directly. Without a password set any user would be able to gain
        access and thus control over the entire system.
    remediation: |
        Run the following command to set a password for the                    root
         user:                 # passwd root
         Impact: If there are any automated processes that relies on access to the root account without authentication, they
        will fail after remediation.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'

  "5.4.2.5":
    title: '5.4.2.5 | Ensure root path integrity - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        The                root
         user can execute any command on the system and could be fooled into executing programs unintentionally if the
        PATH
         is not set correctly.
    remediation: |
        Correct or justify any: Locations that are not directories
        Empty directories (                     ::
        )
        Trailing (                     :
        )
        Current working directory (                     .
        )
        Non                      root
         owned directories
        Directories that less restrictive than mode                      0755
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.2.6":
    title: '5.4.2.6 | Ensure root user umask is configured'
    section: 'Configure root and system accounts and environment'
    description: |
        The user filecreation mode mask                umask
         is used to determine the file permission for newly created directories and files. In Linux, the default permissions for
        any newly created directory is 0777                rwxrwxrwx
        , and for any newly created file it is 0666                rwrwrw
        . The                umask
         modifies the default Linux permissions by restricting masking these permissions. The                umask
         is not simply subtracted, but is processed bitwise. Bits set in the                umask
         are cleared in the resulting file mode.             umask
         can be set with either                Octal
         or                Symbolic
         values             Octal
         Numeric Value  Represented by either three or four digits. ie                  umask 0027
         or                  umask 027
        .  If a four digit umask is used, the first digit is ignored. The remaining three digits effect the resulting
        permissions for user, group, and world/other respectively.               Symbolic
         Value  Represented by a comma separated list for User                  u
        , group                  g
        , and world/other                  o
        .  The permissions listed are not masked by                  umask
        . ie a                  umask
         set by                  umask urwx,grx,o
         is the                  Symbolic
         equivalent of the                  Octal
                                 umask 027
        .  This                  umask
         would set a newly created directory with file mode                  drwxrx
         and a newly created file with file mode                  rwr
        .               root user Shell Configuration Files /root/.bashprofile
          Is executed to configure the root users shell before the initial command prompt.                  Is only read by
        login shells.
                              /root/.bashrc
          Is executed for interactive shells.                  only read by a shell thats both interactive and nonlogin
                              umask
         is set by order of precedence. If                umask
         is set in multiple locations, this order of precedence will determine the systems default                umask
        .             Order of precedence /root/.bashprofile /root/.bashrc The system default umask
    remediation: |
        Edit                    /root/.bash_profile
         and                    /root/.bashrc
         and remove, comment out, or update any line with                    umask
         to be                    0027
         or more restrictive.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.2.7":
    title: '5.4.2.7 | Ensure system accounts do not have a valid login shell - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        There are a number of accounts provided with most distributions that are used to manage applications and are not
        intended to provide an interactive shell. Furthermore, a user may add special accounts that are not intended to provide
        an interactive shell.
    remediation: |
        Run the following command to set the shell for any service accounts returned by the audit to                    nologin
        :                 # usermod -s $(command -v nologin) <user>
         Example script:
        #!/usr/bin/env bash

        {
           l_valid_shells="^($( awk -F\/ '$NF != "nologin" {print}' /etc/shells | sed -rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d
        '|' - ))$"
           awk -v pat="$l_valid_shells" -F: '($1!~/^(root|halt|sync|shutdown|nfsnobody)$/ && ($3<'"$(awk '/^\s*UID_MIN/{print
        $2}' /etc/login.defs)"' || $3 == 65534) && $(NF) ~ pat) {system ("usermod -s '"$(command -v nologin)"' " $1)}'
        /etc/passwd
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.2.8":
    title: '5.4.2.8 | Ensure accounts without a valid login shell are locked - manual'
    section: 'Configure root and system accounts and environment'
    description: |
        There are a number of accounts provided with most distributions that are used to manage applications and are not
        intended to provide an interactive shell. Furthermore, a user may add special accounts that are not intended to provide
        an interactive shell.
    remediation: |
        Run the following command to lock any non-root accounts without a valid login shell returned by the audit: # usermod -L
        <user>
         Example script:
        :
        #!/usr/bin/env bash

        {
           l_valid_shells="^($(awk -F\/ '$NF != "nologin" {print}' /etc/shells | sed -rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d
        '|' - ))$"
           while IFS= read -r l_user; do
              passwd -S "$l_user" | awk '$2 !~ /^L/ {system ("usermod -L " $1)}'
           done < <(awk -v pat="$l_valid_shells" -F: '($1 != "root" && $(NF) !~ pat) {print $1}' /etc/passwd)
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.2.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.3.1":
    title: '5.4.3.1 | Ensure nologin is not listed in etcshells'
    section: 'Configure user default environment'
    description: |
        /etc/shells
         is a text file which contains the full pathnames of valid login shells. This file is consulted by                chsh
         and available to be queried by other programs.             Be aware that there are programs which consult this file to
        find out if a user is a normal user for example, FTP daemons traditionally disallow access to users with shells not
        included in this file.
    remediation: |
        Edit                    /etc/shells
         and remove any lines that include                    nologin
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_5.4.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "5.4.3.2":
    title: '5.4.3.2 | Ensure default user shell timeout is configured - manual'
    section: 'Configure user default environment'
    description: |
        TMOUT
         is an environmental setting that determines the timeout of a shell in seconds.
        TMOUT                 n
          Sets the shell timeout to                  n
         seconds.  A setting of                  TMOUT0
         disables timeout.               readonly TMOUT Sets the TMOUT environmental variable as readonly, preventing unwanted
        modification during runtime. export TMOUT  exports the TMOUT variable System Wide Shell Configuration Files /etc/profile
          used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in
        the                  .bashprofile
        , however this file is used to set an initial PATH or PS1 for all shell users of the system.
        is only executed for interactive                    login
         shells, or shells executed with the login parameter.
                              /etc/profile.d
                           /etc/profile
         will execute the scripts within                  /etc/profile.d/.sh
        . It is recommended to place your configuration in a shell script within                  /etc/profile.d
         to set your own system wide environmental variables.               /etc/bashrc
          System wide version of                  .bashrc
        .  In Fedora derived distributions,                  /etc/bashrc
         also invokes /etc/profile.d/.sh if                  nonlogin
         shell, but redirects output to                  /dev/null
         if                  noninteractive.

        Is only executed for                    interactive
         shells or if                    BASHENV
         is set to                    /etc/bashrc
        .
    remediation: |
        Review                    /etc/bashrc
        ,                    /etc/profile
        , and all files ending in                    *.sh
         in the                    /etc/profile.d/
         directory and remove or edit all                    TMOUT=_n_
         entries to follow local site policy.                     TMOUT
         should not exceed 900 or be equal to                    0
        .
        Configure                    TMOUT
         in                    one
         of the following files:
        A file in the                      /etc/profile.d/
         directory ending in                      .sh
                                    /etc/profile /etc/bashrc TMOUT
         configuration examples:                   As multiple lines:
        TMOUT=900
        readonly TMOUT
        export TMOUT
                         As a single line: readonly TMOUT=900 ; export TMOUT
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "5.4.3.3":
    title: '5.4.3.3 | Ensure default user umask is configured - manual'
    section: 'Configure user default environment'
    description: |
        The user filecreation mode mask                umask
         is used to determine the file permission for newly created directories and files. In Linux, the default permissions for
        any newly created directory is 0777                rwxrwxrwx
        , and for any newly created file it is 0666                rwrwrw
        . The                umask
         modifies the default Linux permissions by restricting masking these permissions. The                umask
         is not simply subtracted, but is processed bitwise. Bits set in the                umask
         are cleared in the resulting file mode.             umask
         can be set with either                Octal
         or                Symbolic
         values             Octal
         Numeric Value  Represented by either three or four digits. ie                  umask 0027
         or                  umask 027
        .  If a four digit umask is used, the first digit is ignored. The remaining three digits effect the resulting
        permissions for user, group, and world/other respectively.               Symbolic
         Value  Represented by a comma separated list for User                  u
        , group                  g
        , and world/other                  o
        .  The permissions listed are not masked by                  umask
        . ie a                  umask
         set by                  umask urwx,grx,o
         is the                  Symbolic
         equivalent of the                  Octal
                                 umask 027
        .  This                  umask
         would set a newly created directory with file mode                  drwxrx
         and a newly created file with file mode                  rwr
        .
        The default                umask
         can be set to use the                pamumask
         module or in a                System Wide Shell Configuration File
        . The user creating the directories or files has the discretion of changing the permissions via the chmod command, or
        choosing a different default                umask
         by adding the                umask
         command into a                User Shell Configuration File
        ,                 .bashprofile
         or                .bashrc
        , in their home directory.             Setting the default umask
        pamumask module

        will set the umask according to the system default in                      /etc/login.defs
         and user settings, solving the problem of different                      umask
         settings with different shells, display managers, remote sessions etc.                   umaskmask
         value in the                      /etc/login.defs
         file is interpreted as Octal
        Setting                      USERGROUPSENAB
         to yes in                      /etc/login.defs
         default

        will enable setting of the                          umask
         group bits to be the same as owner bits. examples 022  002, 077  007 for nonroot users, if the
        uid
         is the same as                          gid
        , and                          username
         is the same as the                          primary group name
                                          userdel will remove the users group if it contains no more members, and useradd will
        create by default a group with the name of the user

                              System Wide Shell Configuration File

                         /etc/profile
          used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in
        the                      .bashprofile
        , however this file is used to set an initial PATH or PS1 for all shell users of the system.
        is only executed for interactive                        login
         shells, or shells executed with the login parameter.
                                    /etc/profile.d
                               /etc/profile
         will execute the scripts within                      /etc/profile.d/.sh
        . It is recommended to place your configuration in a shell script within                      /etc/profile.d
         to set your own system wide environmental variables.                   /etc/bashrc
          System wide version of                      .bashrc
        .  In Fedora derived distributions,                      etc/bashrc
         also invokes /etc/profile.d/.sh if                      nonlogin
         shell, but redirects output to                      /dev/null
         if                      noninteractive.

        Is only executed for                        interactive
         shells or if                        BASHENV
         is set to                        /etc/bashrc
        .

                              User Shell Configuration Files /.bashprofile
          Is executed to configure your shell before the initial command prompt.                  Is only read by login shells.
                              /.bashrc
          Is executed for interactive shells.                  only read by a shell thats both interactive and nonlogin
                              umask
         is set by order of precedence. If                umask
         is set in multiple locations, this order of precedence will determine the systems default                umask
        .             Order of precedence
        A file in                  /etc/profile.d/
         ending in                  .sh
          This will override any other systemwide                  umask
         setting
        In the file                  /etc/profile

        On the                  pamumask.so
         module in                  /etc/pam.d/postlogin

        In the file                  /etc/login.defs

        In the file                  /etc/default/login
    remediation: |
        Run the following script and perform the instructions in the output:
        #!/usr/bin/env bash

        {
           l_output="" l_output2="" l_out=""
           file_umask_chk()
           {
              if grep -Psiq -- '^\h*umask\h+(0?[0-7][2-7]7|u(=[rwx]{0,3}),g=([rx]{0,2}),o=)(\h*#.*)?$' "$l_file"; then
                 l_out="$l_out\n - umask is set correctly in \"$l_file\""
              elif grep -Psiq --
        '^\h*umask\h+(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b)|([0-7][01][0-7]\b|[0-7][0-7][0-6]\b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?\b)(,o=[rwx]{1,3})?)|((g=[wrx]{1,3},)?o=[wrx]{1,3}\b)))'
        "$l_file"; then
                 l_output2="$l_output2\n   - \"$l_file\""
              fi
           }
           while IFS= read -r -d $'\0' l_file; do
              file_umask_chk
           done < <(find /etc/profile.d/ -type f -name '*.sh' -print0)
           [ -n "$l_out" ] && l_output="$l_out"
           l_file="/etc/profile" && file_umask_chk
           l_file="/etc/bashrc" && file_umask_chk
           l_file="/etc/bash.bashrc" && file_umask_chk
           l_file="/etc/pam.d/postlogin"
           if grep -Psiq
        '^\h*session\h+[^#\n\r]+\h+pam_umask\.so\h+([^#\n\r]+\h+)?umask=(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b)|([0-7][01][0-7]\b))'
        "$l_file"; then
              l_output2="$l_output2\n   - \"$l_file\""
           fi
           l_file="/etc/login.defs" && file_umask_chk
           l_file="/etc/default/login" && file_umask_chk
           if [ -z "$l_output2" ]; then
              echo -e " - No files contain a UMASK that is not restrictive enough\n   No UMASK updates required to existing
        files"
           else
              echo -e "\n - UMASK is not restrictive enough in the following file(s):$l_output2\n\n- Remediation Procedure:\n -
        Update these files and comment out the UMASK line\n   or update umask to be \"0027\" or more restrictive"
           fi
           if [ -n "$l_output" ]; then
              echo -e "$l_output"
           else
              echo -e " - Configure UMASK in a file in the \"/etc/profile.d/\" directory ending in \".sh\"\n\n   Example Command
        (Hash to represent being run at a root prompt):\n\n# printf '%s\\\n' \"umask 027\" >
        /etc/profile.d/50-systemwide_umask.sh\n"
           fi
        }
                         Notes: This method only applies to bash and shell. If other shells are supported on the system, it is
        recommended that their configuration files also are checked
        If the                      pam_umask.so
         module is going to be used to set                      umask
        , ensure that it's not being overridden by another setting. Refer to the PAM_UMASK(8) man page for more information
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_5.4.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.1.1":
    title: '6.1.1 | Ensure AIDE is installed'
    section: 'Configure Filesystem Integrity Checking'
    description: |
        AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be
        used to compare against the current state of the filesystem to detect modifications to the system.
    remediation: |
        Install AIDE using the appropriate package manager or manual installation: # apt install aide aide-common
         Configure AIDE as appropriate for your environment. Consult the AIDE documentation for options. Run the following
        commands to initialize AIDE:
        # aideinit
        # mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.1.2":
    title: '6.1.2 | Ensure filesystem integrity is regularly checked'
    section: 'Configure Filesystem Integrity Checking'
    description: |
        Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.
    remediation: |
        If cron will be used to schedule and run aide check: Run the following command: # crontab -u root -e
         Add the following line to the crontab: 0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --update
         - OR -
         If aidecheck.service and aidecheck.timer will be used to schedule and run aide check:
        Create or edit the file                  /etc/systemd/system/aidecheck.service
         and add the following lines:
        [Unit]
        Description=Aide Check

        [Service]
        Type=simple
        ExecStart=/usr/bin/aide.wrapper --config /etc/aide/aide.conf --update

        [Install]
        WantedBy=multi-user.target

        Create or edit the file                  /etc/systemd/system/aidecheck.timer
         and add the following lines:
        [Unit]
        Description=Aide check every day at 5AM

        [Timer]
        OnCalendar=*-*-* 05:00:00
        Unit=aidecheck.service

        [Install]
        WantedBy=multi-user.target
                       Run the following commands:
        # chown root:root /etc/systemd/system/aidecheck.*
        # chmod 0644 /etc/systemd/system/aidecheck.*

        # systemctl daemon-reload

        # systemctl enable aidecheck.service
        # systemctl --now enable aidecheck.timer
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == aidecheck.service'

  "6.1.3":
    title: '6.1.3 | Ensure cryptographic mechanisms are used to protect the integrity of audit tools - manual'
    section: 'Configure Filesystem Integrity Checking'
    description: |
        Audit tools include, but are not limited to, vendorprovided and open source audit tools needed to successfully view and
        manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    remediation: |
        Edit                  /etc/aide/aide.conf
         and add or update the following selection lines:
        # Audit Tools
        /sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512
        /sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512
        /sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512
        /sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512
        /sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512
        /sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512
                       Note: - IF - /etc/aide/aide.conf
         includes a                  @@x_include
         statement:               Example: @@x_include /etc/aide/aide.conf.d ^[a-zA-Z0-9_-]+$
         @@x_include
         FILE                 @@x_include
         DIRECTORY REGEX
                           @x_include
         is identical to                        @@include
        , except that if a config file is executable it is run and the output is used as config.                     If the
        executable file exits with status greater than zero or writes to stderr aide stops with an error. For security reasons
        DIRECTORY and each executable config file must be owned by the current user and must not be  group or world-writable.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.1.1.1":
    title: '6.2.1.1.1 | Ensure journald service is enabled and active'
    section: 'Configure systemd-journald service'
    description: |
        Ensure that the                  systemdjournald
         service is enabled to allow capturing of logging events.
    remediation: |
        Run the following commands to unmask and start                      systemd-journald.service

        # systemctl unmask systemd-journald.service
        # systemctl start systemd-journald.service
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == static'
            - name: Undefined
              rule: 'should cmp == active'

  "6.2.1.1.2":
    title: '6.2.1.1.2 | Ensure journald log file access is configured - manual'
    section: 'Configure systemd-journald service'
    description: |
        Journald will create logfiles that do not already exist on the system. This setting controls what permissions will be
        applied to these newly created files.
    remediation: |
        If the default configuration is not appropriate for the site specific requirements, copy
        /usr/lib/tmpfiles.d/systemd.conf
         to                      /etc/tmpfiles.d/systemd.conf
         and modify as required. Requirements is either                      0640
         or site policy if that is less restrictive.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_6.2.1.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.1.1.3":
    title: '6.2.1.1.3 | Ensure journald log file rotation is configured - manual'
    section: 'Configure systemd-journald service'
    description: |
        Journald includes the capability of rotating log files regularly to avoid filling up the system with logs or making the
        logs unmanageably large. The file                  /etc/systemd/journald.conf
         is the configuration file used to specify how logs generated by Journald should be rotated.
    remediation: |
        Edit                      /etc/systemd/journald.conf
         or a file ending in                      .conf
         the                      /etc/systemd/journald.conf.d/
         directory. Set the following parameters in the                      [Journal]
         section to ensure logs are rotated according to site policy. The settings should be carefully understood as there are
        specific edge cases and prioritization of parameters.                   The specific parameters for log rotation are:
        SystemMaxUse=
        SystemKeepFree=
        RuntimeMaxUse=
        RuntimeKeepFree=
        MaxFileSec=
                           Note:
         If these settings appear in a canonically later file, or later in the same file, the setting will be overwritten
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_6.2.1.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.1.1.4":
    title: '6.2.1.1.4 | Ensure journald ForwardToSyslog is disabled - manual'
    section: 'Configure systemd-journald service'
    description: |
        Data from                  journald
         should be kept in the confines of the service and not forwarded to other services.
    remediation: |
        Set the following parameter in the                      [Journal]
         section in                      /etc/systemd/journald.conf
         or a file in /etc/systemd/journald.conf.d/ ending in                      .conf
        :                   ForwardToSyslog=no
         Example:
        #!/usr/bin/env bash

        {
           [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/
           if grep -Psq -- '^\h*\[Journal\] /etc/systemd/journald.conf.d/60-journald.conf; then
              printf '%s\n' "ForwardToSyslog=no" >> /etc/systemd/journald.conf.d/60-journald.conf
           else
              printf '%s\n' "[Journal]" "ForwardToSyslog=no" >> /etc/systemd/journald.conf.d/60-journald.conf
           fi
        }
                           Note:
         If this setting appears in a canonically later file, or later in the same file, the setting will be overwritten
        Run to following command to update the parameters in the service: # systemctl reload-or-restart systemd-journald
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == ForwardToSyslog=yes:/etc/systemd/journald.conf'

  "6.2.1.1.5":
    title: '6.2.1.1.5 | Ensure journald Storage is configured - manual'
    section: 'Configure systemd-journald service'
    description: |
        Data from journald may be stored in volatile memory or persisted locally on the server.  Logs in memory will be lost
        upon a system reboot.  By persisting logs to local disk on the server they are protected from loss due to a reboot.
    remediation: |
        Set the following parameter in the                      [Journal]
         section in                      /etc/systemd/journald.conf
         or a file in                      /etc/systemd/journald.conf.d/
         ending in                      .conf
        :                   Storage=persistent
         Example:
        #!/usr/bin/env bash

        {
           [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/
           if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-journald.conf; then
              printf '%s\n' "Storage=persistent" >> /etc/systemd/journald.conf.d/60-journald.conf
           else
              printf '%s\n' "[Journal]" "Storage=persistent" >> /etc/systemd/journald.conf.d/60-journald.conf
           fi
        }
                           Note:
         If this setting appears in a canonically later file, or later in the same file, the setting will be overwritten
        Run to following command to update the parameters in the service: # systemctl reload-or-restart systemd-journald
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == Storage=persistent:/etc/systemd/journald.conf'

  "6.2.1.1.6":
    title: '6.2.1.1.6 | Ensure journald Compress is configured - manual'
    section: 'Configure systemd-journald service'
    description: |
        The journald system includes the capability of compressing overly large files to avoid filling up the system with logs
        or making the logs unmanageably large.
    remediation: |
        Set the following parameter in the                      [Journal]
         section in                      /etc/systemd/journald.conf
         or a file in                      /etc/systemd/journald.conf.d/
         ending in                      .conf
        :                   Compress=yes
         Example:
        #!/usr/bin/env bash

        {
           [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir /etc/systemd/journald.conf.d/
           if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-journald.conf; then
              printf '%s\n' "Compress=yes" >> /etc/systemd/journald.conf.d/60-journald.conf
           else
              printf '%s\n' "[Journal]" "Compress=yes" >> /etc/systemd/journald.conf.d/60-journald.conf
           fi
        }
                           Note:
         If this setting appears in a canonically later file, or later in the same file, the setting will be overwritten
        Run to following command to update the parameters in the service: # systemctl reload-or-restart systemd-journald
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == Compress=yes:/etc/systemd/journald.conf'

  "6.2.1.2.1":
    title: '6.2.1.2.1 | Ensure systemd-journal-remote is installed'
    section: 'Configure systemd-journal-remote'
    description: |
        Journald                  systemdjournalremote
         supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus
        enabling centralized log management.
    remediation: |
        Run the following command to install                      systemd-journal-remote
        :                   # apt install systemd-journal-remote
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.2.1.2.2":
    title: '6.2.1.2.2 | Ensure systemd-journal-remote authentication is configured - manual'
    section: 'Configure systemd-journal-remote'
    description: |
        Journald                  systemdjournalupload
         supports the ability to send log events it gathers to a remote log host.
    remediation: |
        Edit the                      /etc/systemd/journal-upload.conf
         file or a file in                      /etc/systemd/journal-upload.conf.d
         ending in                      .conf
         and ensure the following lines are set in the                      [Upload]
         section per your environment:
        [Upload]
        URL=192.168.50.42
        ServerKeyFile=/etc/ssl/private/journal-upload.pem
        ServerCertificateFile=/etc/ssl/certs/journal-upload.pem
        TrustedCertificateFile=/etc/ssl/ca/trusted.pem
                           Restart the service: # systemctl restart systemd-journal-upload
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_6.2.1.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.2.1.2.3":
    title: '6.2.1.2.3 | Ensure systemd-journal-upload is enabled and active'
    section: 'Configure systemd-journal-remote'
    description: |
        Journald                  systemdjournalupload
         supports the ability to send log events it gathers to a remote log host.
    remediation: |
        Run the following commands to unmask, enable and start                      systemd-journal-upload
        :
        # systemctl unmask systemd-journal-upload.service
        # systemctl --now enable systemd-journal-upload.service
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "6.2.1.2.4":
    title: '6.2.1.2.4 | Ensure systemd-journal-remote service is not in use'
    section: 'Configure systemd-journal-remote'
    description: |
        Journald                  systemdjournalremote
         supports the ability to receive messages from remote hosts, thus acting as a log server. Clients should not receive
        data from other hosts.               NOTE
        The same package,                    systemdjournalremote
        , is used for both sending logs to remote hosts and receiving incoming logs.
        With regards to receiving logs, there are two services                    systemdjournalremote.socket
         and                    systemdjournalremote.service
        .
    remediation: |
        Run the following commands to stop and mask                      systemd-journal-remote.socket
         and systemd-journal-remote.service:
        # systemctl stop systemd-journal-remote.socket systemd-journal-remote.service
        # systemctl mask systemd-journal-remote.socket systemd-journal-remote.service
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.1.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'
            - name: Undefined
              rule: 'Undefined'

  "6.2.2.1":
    title: '6.2.2.1 | Ensure access to all logfiles has been configured - manual'
    section: 'Configure Logfiles'
    description: |
        Log files contain information from many services on the the local system, or in the event of a centralized log server,
        others systems logs as well.
        In general log files are found in                /var/log/
        , although application can be configured to store logs elsewhere. Should your application store logs in another, ensure
        to run the same test on that location.
    remediation: |
        Run the following script to update permissions and ownership on files in                    /var/log
        .                 Although the script is not destructive, ensure that the output of the audit procedure is captured in
        the event that the remediation causes issues.
        #!/usr/bin/env bash

        {
           l_op2="" l_output2=""
           l_uidmin="$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)"
           file_test_fix()
           {
              l_op2=""
              l_fuser="root"
              l_fgroup="root"
              if [ $(( $l_mode & $perm_mask )) -gt 0 ]; then
                 l_op2="$l_op2\n  - Mode: \"$l_mode\" should be \"$maxperm\" or more restrictive\n   - Removing excess
        permissions"
                 chmod "$l_rperms" "$l_fname"
              fi
              if [[ ! "$l_user" =~ $l_auser ]]; then
                 l_op2="$l_op2\n  - Owned by: \"$l_user\" and should be owned by \"${l_auser//|/ or }\"\n   - Changing ownership
        to: \"$l_fuser\""
                 chown "$l_fuser" "$l_fname"
              fi
              if [[ ! "$l_group" =~ $l_agroup ]]; then
                 l_op2="$l_op2\n  - Group owned by: \"$l_group\" and should be group owned by \"${l_agroup//|/ or }\"\n   -
        Changing group ownership to: \"$l_fgroup\""
                 chgrp "$l_fgroup" "$l_fname"
              fi
              [ -n "$l_op2" ] && l_output2="$l_output2\n - File: \"$l_fname\" is:$l_op2\n"
           }
           unset a_file && a_file=() # clear and initialize array
           # Loop to create array with stat of files that could possibly fail one of the audits
           while IFS= read -r -d $'\0' l_file; do
              [ -e "$l_file" ] && a_file+=("$(stat -Lc '%n^%#a^%U^%u^%G^%g' "$l_file")")
           done < <(find -L /var/log -type f \( -perm /0137 -o ! -user root -o ! -group root \) -print0)
           while IFS="^" read -r l_fname l_mode l_user l_uid l_group l_gid; do
              l_bname="$(basename "$l_fname")"
              case "$l_bname" in
                 lastlog | lastlog.* | wtmp | wtmp.* | wtmp-* | btmp | btmp.* | btmp-* | README)
                    perm_mask='0113'
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_rperms="ug-x,o-wx"
                    l_auser="root"
                    l_agroup="(root|utmp)"
                    file_test_fix
                    ;;
                 secure | auth.log | syslog | messages)
                    perm_mask='0137'
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_rperms="u-x,g-wx,o-rwx"
                    l_auser="(root|syslog)"
                    l_agroup="(root|adm)"
                    file_test_fix
                    ;;
                 SSSD | sssd)
                    perm_mask='0117'
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_rperms="ug-x,o-rwx"
                    l_auser="(root|SSSD)"
                    l_agroup="(root|SSSD)"
                    file_test_fix
                    ;;
                 gdm | gdm3)
                    perm_mask='0117'
                    l_rperms="ug-x,o-rwx"
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_auser="root"
                    l_agroup="(root|gdm|gdm3)"
                    file_test_fix
                    ;;
                 *.journal | *.journal~)
                    perm_mask='0137'
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_rperms="u-x,g-wx,o-rwx"
                    l_auser="root"
                    l_agroup="(root|systemd-journal)"
                    file_test_fix
                    ;;
                 *)
                    perm_mask='0137'
                    maxperm="$( printf '%o' $(( 0777 & ~$perm_mask)) )"
                    l_rperms="u-x,g-wx,o-rwx"
                    l_auser="(root|syslog)"
                    l_agroup="(root|adm)"
                    if [ "$l_uid" -lt "$l_uidmin" ] && [ -z "$(awk -v grp="$l_group" -F: '$1==grp {print $4}' /etc/group)" ];
        then
                       if [[ ! "$l_user" =~ $l_auser ]]; then
                          l_auser="(root|syslog|$l_user)"
                       fi
                       if [[ ! "$l_group" =~ $l_agroup ]]; then
                          l_tst=""
                          while l_out3="" read -r l_duid; do
                             [ "$l_duid" -ge "$l_uidmin" ] && l_tst=failed
                          done <<< "$(awk -F: '$4=='"$l_gid"' {print $3}' /etc/passwd)"
                          [ "$l_tst" != "failed" ] && l_agroup="(root|adm|$l_group)"
                       fi
                    fi
                    file_test_fix
                    ;;
              esac
           done <<< "$(printf '%s\n' "${a_file[@]}")"
           unset a_file # Clear array
           # If all files passed, then we report no changes
           if [ -z "$l_output2" ]; then
              echo -e "- All files in \"/var/log/\" have appropriate permissions and ownership\n  - No changes required\n"
           else
              # print report of changes
              echo -e "\n$l_output2"
           fi
        }
                         Note:
         You may also need to change the configuration for your logging software or services for any logs that had incorrect
        permissions.                 If there are services that log to other locations, ensure that those log files have the
        appropriate permissions.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_6.2.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.3.1.1":
    title: '6.3.1.1 | Ensure auditd packages are installed'
    section: 'Configure auditd Service'
    description: |
        auditd is the userspace component to the Linux Auditing System. Its responsible for writing audit records to the disk
    remediation: |
        Run the following command to Install                    auditd
         and                    audispd-plugins
                                 # apt install auditd audispd-plugins
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.3.1.2":
    title: '6.3.1.2 | Ensure auditd service is enabled and active'
    section: 'Configure auditd Service'
    description: |
        Turn on the                auditd
         daemon to record system events.
    remediation: |
        Run the following commands to unmask, enable and start                    auditd
        :
        # systemctl unmask auditd
        # systemctl enable auditd
        # systemctl start auditd
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == enabled'
            - name: Undefined
              rule: 'should cmp == active'

  "6.3.1.3":
    title: '6.3.1.3 | Ensure auditing for processes that start prior to auditd is enabled - manual'
    section: 'Configure auditd Service'
    description: |
        Configure                grub2
         so that processes that are capable of being audited can be audited even if they start up prior to                auditd
         startup.
    remediation: |
        Edit                    /etc/default/grub
         and add                    audit=1
         to                    GRUB_CMDLINE_LINUX
        :                 Example: GRUB_CMDLINE_LINUX="audit=1"

        Run the following command to update the                    grub2
         configuration:                 # update-grub
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == audit=1'

  "6.3.1.4":
    title: '6.3.1.4 | Ensure audit backlog limit is sufficient - manual'
    section: 'Configure auditd Service'
    description: |
        In the kernellevel audit subsystem, a socket buffer queue is used to hold audit events. Whenever a new audit event is
        received, it is logged and prepared to be added to this queue.
        The kernel boot parameter                auditbackloglimitN
        , with                N
         representing the amount of messages, will ensure that a queue cannot grow beyond a certain size. If an audit event is
        logged which would grow the queue beyond this limit, then a failure occurs and is handled according to the system
        configuration
    remediation: |
        Edit                    /etc/default/grub
         and add                    audit_backlog_limit=N
         to GRUB_CMDLINE_LINUX. The recommended size for                    N
         is                    8192
         or larger.                 Example: GRUB_CMDLINE_LINUX="audit_backlog_limit=8192"

        Run the following command to update the                    grub2
         configuration:                 # update-grub
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == audit_backlog_limit=\d+'

  "6.3.2.1":
    title: '6.3.2.1 | Ensure audit log storage size is configured'
    section: 'Configure Data Retention'
    description: |
        Configure the maximum size of the audit log file. Once the log reaches the maximum size, it will be rotated and a new
        log file will be started.
    remediation: |
        Set the following parameter in                    /etc/audit/auditd.conf
          in accordance with site policy:                 max_log_file = <MB>
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.3.2.2":
    title: '6.3.2.2 | Ensure audit logs are not automatically deleted'
    section: 'Configure Data Retention'
    description: |
        The                maxlogfileaction
          setting determines how to handle the audit log file reaching the max file size. A value of                keeplogs
          will rotate the logs but never delete old logs.
    remediation: |
        Set the following parameter in                    /etc/audit/auditd.conf:
                                 max_log_file_action = keep_logs
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.3.2.3":
    title: '6.3.2.3 | Ensure system is disabled when audit logs are full'
    section: 'Configure Data Retention'
    description: |
        The                auditd
         daemon can be configured to halt the system or put the system in single user mode, if no free space is available or an
        error is detected on the partition that holds the audit log files.
        The                diskfullaction
         parameter tells the system what action to take when no free space is available on the partition that holds the audit
        log files. Valid values are                ignore
        ,                syslog
        ,                rotate
        ,                exec
        ,                suspend
        ,                single
        , and                halt
        .             ignore
        , the audit daemon will issue a syslog message but no other action is taken               syslog
        , the audit daemon will issue a warning to syslog               rotate
        , the audit daemon will rotate logs, losing the oldest to free up space               exec
        ,   /pathtoscript will execute the script. You cannot pass parameters to the script. The script is also responsible for
        telling the auditd daemon to resume logging once its completed its action               suspend
        , the audit daemon will stop writing records to the disk               single
        , the audit daemon will put the computer system in single user mode               halt
        , the audit daemon will shut down the system
        The                diskerroraction
         parameter tells the system what action to take when an error is detected on the partition that holds the audit log
        files. Valid values are                ignore
        ,                syslog
        ,                exec
        ,                suspend
        ,                single
        , and                halt
        .             ignore
        , the audit daemon will not take any action               syslog
        , the audit daemon will issue no more than 5 consecutive warnings to syslog               exec
        ,   /pathtoscript will execute the script. You cannot pass parameters to the script               suspend
        , the audit daemon will stop writing records to the disk               single
        , the audit daemon will put the computer system in single user mode               halt
        , the audit daemon will shut down the system
    remediation: |
        Set one of the following parameters in                    /etc/audit/auditd.conf
         depending on your local security policies.
        disk_full_action = <halt|single>
        disk_error_action = <syslog|single|halt>
                         Example:
        disk_full_action = halt
        disk_error_action = halt
                         Impact: disk_full_action
         parameter:
        Set to                        halt
         - the                        auditd
         daemon will shutdown the system when the disk partition containing the audit logs becomes full.
        Set to                        single
         - the                        auditd
         daemon will put the computer system in single user mode when the disk partition containing the audit logs becomes full.
        disk_error_action
         parameter:
        Set to                        halt
         - the                        auditd
         daemon will shutdown the system when an error is detected on the partition that holds the audit log files.
        Set to                        single
         - the                        auditd
         daemon will put the computer system in single user mode when an error is detected on the partition that holds the audit
        log files.
        Set to                        syslog
         - the                        auditd
         daemon will issue no more than 5 consecutive warnings to syslog when an error is detected on the partition that holds
        the audit log files.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.3.2.4":
    title: '6.3.2.4 | Ensure system warns when audit logs are low on space'
    section: 'Configure Data Retention'
    description: |
        The                auditd
         daemon can be configured to halt the system, put the system in single user mode or send a warning message, if the
        partition that holds the audit log files is low on space.
        The                spaceleftaction
         parameter tells the system what action to take when the system has detected that it is starting to get low on disk
        space. Valid values are                ignore
        ,                syslog
        ,                rotate
        ,                email
        ,                exec
        ,                suspend
        ,                single
        , and                halt
        .             ignore
        , the audit daemon does nothing               syslog
        , the audit daemon will issue a warning to syslog               rotate
        , the audit daemon will rotate logs, losing the oldest to free up space               email
        , the audit daemon will send a warning to the email account specified in                  actionmailacct
         as well as sending the message to syslog               exec
        ,   /pathtoscript will execute the script. You cannot pass parameters to the script. The script is also responsible for
        telling the auditd daemon to resume logging once its completed its action               suspend
        , the audit daemon will stop writing records to the disk               single
        , the audit daemon will put the computer system in single user mode               halt
        , the audit daemon will shut down the system
        The                adminspaceleftaction
         parameter tells the system what action to take when the system has detected that it is  low on disk space. Valid values
        are                ignore
        ,                syslog
        ,                rotate
        ,                email
        ,                exec
        ,                suspend
        ,                single
        , and                halt
        .             ignore
        , the audit daemon does nothing               syslog
        , the audit daemon will issue a warning to syslog               rotate
        , the audit daemon will rotate logs, losing the oldest to free up space               email
        , the audit daemon will send a warning to the email account specified in                  actionmailacct
         as well as sending the message to syslog               exec
        ,   /pathtoscript will execute the script. You cannot pass parameters to the script. The script is also responsible for
        telling the auditd daemon to resume logging once its completed its action               suspend
        , the audit daemon will stop writing records to the disk               single
        , the audit daemon will put the computer system in single user mode               halt
        , the audit daemon will shut down the system
    remediation: |
        Set the                    space_left_action
         parameter in                    /etc/audit/auditd.conf
         to                    email
        ,                    exec
        ,                    single
        , or                    halt
        :                 Example: space_left_action = email

        Set the                    admin_space_left_action
         parameter in                    /etc/audit/auditd.conf
         to                    single
         or                    halt
        :                 Example: admin_space_left_action = single
         Note:
         A Mail Transfer Agent (MTA) must be installed and configured properly to set                    space_left_action =
        email
                                 Impact:
        If the                      admin_space_left_action
         is set to                      single
         the audit daemon will put the computer system in single user mode.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "6.3.3.1":
    title: '6.3.3.1 | Ensure changes to system administration scope sudoers is collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor scope changes for system administrators. If the system has been properly configured to force system
        administrators to log in as themselves first and then use the                sudo
         command to execute privileged commands, it is possible to monitor changes in scope. The file
        /etc/sudoers
        , or files in                /etc/sudoers.d
        , will be written to when the files or related attributes have changed. The audit records will be tagged with the
        identifier scope.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor scope changes for system administrators.                 Example: #
        printf '%s\n' "-w /etc/sudoers -p wa -k scope" "-w /etc/sudoers.d -p wa -k scope" >> /etc/audit/rules.d/50-scope.rules
         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -w /etc/sudoers::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/sudoers.d::-p wa'

  "6.3.3.2":
    title: '6.3.3.2 | Ensure actions as another user are always logged - manual'
    section: 'Configure auditd Rules'
    description: |
        sudo
         provides users with temporary elevated privileges to perform operations, either as the superuser or another user.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor elevated privileges.                 Example:
        # printf "
        -a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k user_emulation
        -a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k user_emulation
        " >> /etc/audit/rules.d/50-user_emulation.rules
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S execve:-F arch=b32:-a (always,exit|exit,always):-C (euid!=uid|uid!=euid):-F auid!=(unset|-1|4294967295):-F arch=b64'
            - name: Undefined
              rule: 'should cmp == -S execve:-F arch=b64:-a (always,exit|exit,always):-C (euid!=uid|uid!=euid):-F auid!=(unset|-1|4294967295):-F arch=b32'

  "6.3.3.3":
    title: '6.3.3.3 | Ensure events that modify the sudo log file are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor the                sudo
         log file. If the system has been properly configured to disable the use of the                su
         command and force all administrators to have to log in first and then use                sudo
         to execute privileged commands, then all administrator commands will be logged to                /var/log/sudo.log
         . Any time a command is executed, an audit event will be triggered as the                /var/log/sudo.log
         file will be opened for write and the executed administration command will be written to the log.
    remediation: |
        Note:
         This recommendation requires that the sudo logfile is configured.  See guidance provided in the recommendation "Ensure
        sudo log file exists"
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor events that modify the sudo log file.                 Example:
        # {
        SUDO_LOG_FILE=$(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,? .*//' -e 's/"//g')
        [ -n "${SUDO_LOG_FILE}" ] && printf "
        -w ${SUDO_LOG_FILE} -p wa -k sudo_log_file
        " >> /etc/audit/rules.d/50-sudo.rules || printf "ERROR: Variable 'SUDO_LOG_FILE' is unset.\n"
        }
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == SUDOLOGFILE::-p wa'

  "6.3.3.4":
    title: '6.3.3.4 | Ensure events that modify date and time information are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Capture events where the system date and/or time has been modified. The parameters in this section are set to determine
        if the adjtimex
          tune kernel clock               settimeofday
          set time using                  timeval
         and                  timezone
         structures               stime
          using seconds since 1/1/1970               clocksettime
          allows for the setting of several internal clocks and timers               system calls have been executed. Further,
        ensure to write an audit record to the configured audit log file upon exit, tagging the records with a unique identifier
        such as timechange.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor events that modify date and time information.                 Example:
        # printf "
        -a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time-change
        -a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time-change
        -w /etc/localtime -p wa -k time-change
        " >> /etc/audit/rules.d/50-time-change.rules
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S adjtimex,settimeofday,clock_settime:-F arch=b32:-a (always,exit|exit,always):-F arch=b64'
            - name: Undefined
              rule: 'should cmp == -S adjtimex,settimeofday,clock_settime:-F arch=b64:-a (always,exit|exit,always):-F arch=b32'
            - name: Undefined
              rule: 'should cmp == -w /etc/localtime::-p wa'

  "6.3.3.5":
    title: '6.3.3.5 | Ensure events that modify the systems network environment are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Record changes to network environment files or system calls. The below parameters monitors the following system calls,
        and write an audit event on system call exit sethostname
          set the systems host name               setdomainname
          set the systems domain name               The files being monitored are /etc/issue
         and                  /etc/issue.net
          messages displayed prelogin               /etc/hosts
          file containing host names and associated IP addresses               /etc/networks
          symbolic names for networks               /etc/network/
          directory containing network interface scripts and configurations files               /etc/netplan/
          central location for YAML networking configurations files
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor events that modify the system's network environment.
        Example:
        # printf "
        -a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale
        -a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale
        -w /etc/issue -p wa -k system-locale
        -w /etc/issue.net -p wa -k system-locale
        -w /etc/hosts -p wa -k system-locale
        -w /etc/networks -p wa -k system-locale
        -w /etc/network/ -p wa -k system-locale
        -w /etc/netplan/ -p wa -k system-locale
        " >> /etc/audit/rules.d/50-system_locale.rules
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S sethostname,setdomainname:-F arch=b32:-a (always,exit|exit,always):-F arch=b64'
            - name: Undefined
              rule: 'should cmp == -S sethostname,setdomainname:-F arch=b64:-a (always,exit|exit,always):-F arch=b32'
            - name: Undefined
              rule: 'should cmp == -w /etc/issue::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/issue.net::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/hosts::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/networks::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/network::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/netplan::-p wa'

  "6.3.3.6":
    title: '6.3.3.6 | Ensure use of privileged commands are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor privileged programs, those that have the                setuid
         and/or                setgid
         bit set on execution, to determine if unprivileged users are running these commands.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor the use of privileged commands.                 Example script:
        #!/usr/bin/env bash

        {
          UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
          AUDIT_RULE_FILE="/etc/audit/rules.d/50-privileged.rules"
          NEW_DATA=()
          for PARTITION in $(findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv
        "noexec|nosuid" | awk '{print $1}'); do
            readarray -t DATA < <(find "${PARTITION}" -xdev -perm /6000 -type f | awk -v UID_MIN=${UID_MIN} '{print "-a
        always,exit -F path=" $1 " -F perm=x -F auid>="UID_MIN" -F auid!=unset -k privileged" }')
              for ENTRY in "${DATA[@]}"; do
                NEW_DATA+=("${ENTRY}")
              done
          done
          readarray &> /dev/null -t OLD_DATA < "${AUDIT_RULE_FILE}"
          COMBINED_DATA=( "${OLD_DATA[@]}" "${NEW_DATA[@]}" )
          printf '%s\n' "${COMBINED_DATA[@]}" | sort -u > "${AUDIT_RULE_FILE}"
        }
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
         Special mount points
        If there are any special mount points that are not visible by default from just scanning                    /
        , change the                    PARTITION
         variable to the appropriate partition and re-run the remediation.                 Impact:
        Both the audit and remediation section of this recommendation will traverse all mounted file systems that is not mounted
        with either                      noexec
         or                      nosuid
         mount options. If there are large file systems without these mount options,                      such traversal will be
        significantly detrimental to the performance of the system.
                                    Before running either the audit or remediation section, inspect the output of the following
        command to determine exactly which file systems will be traversed: # findmnt -n -l -k -it $(awk '/nodev/ { print $2 }'
        /proc/filesystems | paste -sd,) | grep -Pv "noexec|nosuid"

        To exclude a particular file system due to adverse performance impacts, update the audit and remediation sections by
        adding a sufficiently unique string to the                      grep
         statement. The above command can be used to test the modified exclusions.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.3.3.7":
    title: '6.3.3.7 | Ensure unsuccessful file access attempts are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor for unsuccessful attempts to access files. The following parameters are associated with system calls that
        control files
        creation                   creat

        opening                   open
         ,                  openat

        truncation                   truncate
         ,                  ftruncate
                              An audit log record will only be written if all of the following criteria is met for the user when
        trying to access a file a nonprivileged user auidUIDMIN is not a Daemon event auid4294967295/unset/1 if the system call
        returned EACCES permission denied or EPERM some other permanent error associated with the specific system call
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor unsuccessful file access attempts.                 Example:
        # {
        UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
        [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid>=${UID_MIN} -F auid!=unset -k
        access
        -a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid>=${UID_MIN} -F auid!=unset -k
        access
        -a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid>=${UID_MIN} -F auid!=unset -k
        access
        -a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid>=${UID_MIN} -F auid!=unset -k
        access
        " >> /etc/audit/rules.d/50-access.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S creat,open,openat,truncate,ftruncate:-F (arch=b32|exit=-EPERM):-a always,exit:-F arch=b64:-F exit=-EACCES:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S creat,open,openat,truncate,ftruncate:-F (arch=b32|exit=-EACCES):-a always,exit:-F arch=b64:-F exit=-EPERM:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S creat,open,openat,truncate,ftruncate:-F (arch=b64|exit=-EPERM):-a always,exit:-F arch=b32:-F exit=-EACCES:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S creat,open,openat,truncate,ftruncate:-F (arch=b64|exit=-EACCES):-a always,exit:-F arch=b32:-F exit=-EPERM:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.8":
    title: '6.3.3.8 | Ensure events that modify usergroup information are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Record events affecting the modification of user or group information, including that of passwords and old passwords if
        in use. /etc/group
          system groups               /etc/passwd
          system users               /etc/gshadow
          encrypted password for each group               /etc/shadow
          system user passwords               /etc/security/opasswd
          storage of old passwords if the relevant PAM module is in use               /etc/nsswitch.conf
          file configures how the system uses various databases and name resolution mechanisms               /etc/pam.conf
          file determines the authentication services to be used, and the order in which the services are used.
        /etc/pam.d
          directory contains the PAM configuration files for each PAMaware application.               The parameters in this
        section will watch the files to see if they have been opened for write or have had attribute changes e.g. permissions
        and tag them with the identifier identity in the audit log file.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor events that modify user/group information.                 Example:
        # printf "
        -w /etc/group -p wa -k identity
        -w /etc/passwd -p wa -k identity
        -w /etc/gshadow -p wa -k identity
        -w /etc/shadow -p wa -k identity
        -w /etc/security/opasswd -p wa -k identity
        -w /etc/nsswitch.conf -p wa -k identity
        -w /etc/pam.conf -p wa -k identity
        -w /etc/pam.d -p wa -k identity
        " >> /etc/audit/rules.d/50-identity.rules
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -w /etc/group::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/passwd::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/gshadow::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/shadow::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/security/opasswd::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/nsswitch.conf::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/pam.conf::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/pam.d::-p wa'

  "6.3.3.9":
    title: '6.3.3.9 | Ensure discretionary access control permission modification events are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for
        system calls that affect file permissions and attributes. The following commands and system calls effect the
        permissions, ownership and various attributes of files. chmod fchmod fchmodat chown fchown fchownat lchown setxattr
        lsetxattr fsetxattr removexattr lremovexattr fremovexattr In all cases, an audit record will only be written for
        nonsystem user ids and will ignore Daemon events. All audit records will be tagged with the identifier permmod.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor discretionary access control permission modification events.
        Example:
        # {
        UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
        [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=${UID_MIN} -F auid!=unset -F key=perm_mod
        -a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid>=${UID_MIN} -F auid!=unset -F key=perm_mod
        -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=${UID_MIN} -F auid!=unset -F key=perm_mod
        -a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid>=${UID_MIN} -F auid!=unset -F key=perm_mod
        -a always,exit -F arch=b64 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=${UID_MIN} -F
        auid!=unset -F key=perm_mod
        -a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=${UID_MIN} -F
        auid!=unset -F key=perm_mod
        " >> /etc/audit/rules.d/50-perm_mod.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S chmod,fchmod,fchmodat,chown,fchown,lchown,fchownat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr:-F arch=b32:-a (always,exit|exit,always):-F arch=b64:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S chmod,fchmod,fchmodat,chown,fchown,lchown,fchownat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr:-F arch=b64:-a (always,exit|exit,always):-F arch=b32:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.10":
    title: '6.3.3.10 | Ensure successful file system mounts are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor the use of the                mount
         system call. The                mount
         and                umount
          system call controls the mounting and unmounting of file systems. The parameters below configure the system to create
        an audit record when the mount system call is used by a nonprivileged user
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor successful file system mounts.                 Example:
        # {
        UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
        [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F arch=b32 -S mount -F auid>=$UID_MIN -F auid!=unset -k mounts
        -a always,exit -F arch=b64 -S mount -F auid>=$UID_MIN -F auid!=unset -k mounts
        " >> /etc/audit/rules.d/50-mounts.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S mount:-F arch=b32:-a (always,exit|exit,always):-F arch=b64:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S mount:-F arch=b64:-a (always,exit|exit,always):-F arch=b32:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.11":
    title: '6.3.3.11 | Ensure session initiation information is collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor session initiation events. The parameters in this section track changes to the files associated with session
        events. /var/run/utmp
          tracks all currently logged in users.               /var/log/wtmp
          file tracks logins, logouts, shutdown, and reboot events.               /var/log/btmp
          keeps track of failed login attempts and can be read by entering the command                  /usr/bin/last f
        /var/log/btmp
        .               All audit records will be tagged with the identifier session.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor session initiation information.                 Example:
        # printf "
        -w /var/run/utmp -p wa -k session
        -w /var/log/wtmp -p wa -k session
        -w /var/log/btmp -p wa -k session
        " >> /etc/audit/rules.d/50-session.rules
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.11', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -w /var/run/utmp::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /var/log/wtmp::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /var/log/btmp::-p wa'

  "6.3.3.12":
    title: '6.3.3.12 | Ensure login and logout events are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor login and logout events. The parameters below track changes to files associated with login/logout events.
        /var/log/lastlog
          maintain records of the last time a user successfully logged in.               /var/run/faillock
          directory maintains records of login failures via the                  pamfaillock
         module.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor login and logout events.                 Example:
        # printf "
        -w /var/log/lastlog -p wa -k logins
        -w /var/run/faillock -p wa -k logins
        " >> /etc/audit/rules.d/50-login.rules
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.12', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -w /var/log/lastlog::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /var/run/faillock::-p wa'

  "6.3.3.13":
    title: '6.3.3.13 | Ensure file deletion events by users are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor the use of system calls associated with the deletion or renaming of files and file attributes. This
        configuration statement sets up monitoring for unlink
          remove a file               unlinkat
          remove a file attribute               rename
          rename a file               renameat
         rename a file attribute
        system calls and tags them with the identifier delete.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor file deletion events by users.                 Example:
        # {
        UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
        [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid>=${UID_MIN} -F auid!=unset -F key=delete
        -a always,exit -F arch=b32 -S rename,unlink,unlinkat,renameat -F auid>=${UID_MIN} -F auid!=unset -F key=delete
        " >> /etc/audit/rules.d/50-delete.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.13', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S rename,unlink,unlinkat,renameat:-F arch=b32:-a (always,exit|exit,always):-F arch=b64:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -S rename,unlink,unlinkat,renameat:-F arch=b64:-a (always,exit|exit,always):-F arch=b32:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.14":
    title: '6.3.3.14 | Ensure events that modify the systems Mandatory Access Controls are collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor AppArmor, an implementation of mandatory access controls. The parameters below monitor any write access
        potential additional, deletion or modification of files in the directory or attribute changes to the
        /etc/apparmor/
         and                /etc/apparmor.d/
         directories.             Note
         If a different Mandatory Access Control method is used, changes to the corresponding directories should be audited.
    remediation: |
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor events that modify the system's Mandatory Access Controls.
        Example:
        # printf "
        -w /etc/apparmor/ -p wa -k MAC-policy
        -w /etc/apparmor.d/ -p wa -k MAC-policy
        " >> /etc/audit/rules.d/50-MAC-policy.rules
                         Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.14', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -w /etc/apparmor::-p wa'
            - name: Undefined
              rule: 'should cmp == -w /etc/apparmor.d::-p wa'

  "6.3.3.15":
    title: '6.3.3.15 | Ensure successful and unsuccessful attempts to use the chcon command are recorded - manual'
    section: 'Configure auditd Rules'
    description: |
        The operating system must generate audit records for successful/unsuccessful uses of the                chcon
         command.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor successful and unsuccessful attempts to use the                    chcon
         command.                 Example:
        # {
         UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
         [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=${UID_MIN} -F auid!=unset -k perm_chng
        " >> /etc/audit/rules.d/50-perm_chng.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.15', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -F path=/usr/bin/chcon::-a (always,exit|exit,always):-F perm=x:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.16":
    title: '6.3.3.16 | Ensure successful and unsuccessful attempts to use the setfacl command are recorded - manual'
    section: 'Configure auditd Rules'
    description: |
        The operating system must generate audit records for successful/unsuccessful uses of the                setfacl
         command
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor successful and unsuccessful attempts to use the
        setfacl
         command.                 Example:
        # {
         UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
         [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=${UID_MIN} -F auid!=unset -k perm_chng
        " >> /etc/audit/rules.d/50-perm_chng.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.16', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -F path=/usr/bin/setfacl::-a (always,exit|exit,always):-F perm=x:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.17":
    title: '6.3.3.17 | Ensure successful and unsuccessful attempts to use the chacl command are recorded - manual'
    section: 'Configure auditd Rules'
    description: |
        The operating system must generate audit records for successful/unsuccessful uses of the                chacl
         command.             chacl
         is an IRIXcompatibility command, and is maintained for those users who are familiar with its use from either XFS or
        IRIX.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor successful and unsuccessful attempts to use the                    chacl
         command.                 Example:
        # {
         UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
         [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=${UID_MIN} -F auid!=unset -k perm_chng
        " >> /etc/audit/rules.d/50-perm_chng.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.17', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -F path=/usr/bin/chacl::-a (always,exit|exit,always):-F perm=x:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.18":
    title: '6.3.3.18 | Ensure successful and unsuccessful attempts to use the usermod command are recorded - manual'
    section: 'Configure auditd Rules'
    description: |
        The operating system must generate audit records for successful/unsuccessful uses of the                usermod
         command.
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor successful and unsuccessful attempts to use the
        usermod
         command.                 Example:
        # {
         UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
         [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=${UID_MIN} -F auid!=unset -k usermod
        " >> /etc/audit/rules.d/50-usermod.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.18', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -F path=/usr/sbin/usermod::-a (always,exit|exit,always):-F perm=x:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.19":
    title: '6.3.3.19 | Ensure kernel module loading unloading and modification is collected - manual'
    section: 'Configure auditd Rules'
    description: |
        Monitor the loading and unloading of kernel modules. All the loading / listing / dependency checking of modules is done
        by                kmod
         via symbolic links.             The following system calls control loading and unloading of modules initmodule
          load a module               finitmodule
          load a module used when the overhead of using cryptographically signed modules to determine the authenticity of a
        module can be avoided               deletemodule
          delete a module
        Any execution of the loading and unloading module programs and system calls will trigger an audit record with an
        identifier of                modules
        .
    remediation: |
        Create audit rules
        Edit or create a file in the                    /etc/audit/rules.d/
         directory, ending in                    .rules
         extension, with the relevant rules to monitor kernel module modification.                 Example:
        # {
        UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs)
        [ -n "${UID_MIN}" ] && printf "
        -a always,exit -F arch=b64 -S init_module,finit_module,delete_module -F auid>=${UID_MIN} -F auid!=unset -k
        kernel_modules
        -a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=${UID_MIN} -F auid!=unset -k kernel_modules
        " >> /etc/audit/rules.d/50-kernel_modules.rules || printf "ERROR: Variable 'UID_MIN' is unset.\n"
        }
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.19', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -S init_module,finit_module,delete_module:-F arch=b32:-a (always,exit|exit,always):-F arch=b64:-F auid>=1000:-F auid!=(unset|-1|4294967295)'
            - name: Undefined
              rule: 'should cmp == -F path=/usr/bin/kmod::-a (always,exit|exit,always):-F perm=x:-F auid>=1000:-F auid!=(unset|-1|4294967295)'

  "6.3.3.20":
    title: '6.3.3.20 | Ensure the audit configuration is immutable - manual'
    section: 'Configure auditd Rules'
    description: |
        Set system audit so that audit rules cannot be modified with                auditctl
         . Setting the flag e 2 forces audit to be put in immutable mode. Audit changes can only be made on system reboot.
        Note
         This setting will require the system to be rebooted to update the active                auditd
         configuration settings.
    remediation: |
        Edit or create the file                    /etc/audit/rules.d/99-finalize.rules
         and add the line                    -e 2
         at the end of the file:                 Example:
        # printf -- "-e 2
        " >> /etc/audit/rules.d/99-finalize.rules
                         Load audit rules Merge and load the rules into active configuration: # augenrules --load
         Check if reboot is required. # if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load
        rules\n"; fi
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.3.20', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == -e 2::'

  "6.3.3.21":
    title: '6.3.3.21 | Ensure the running and on disk configuration is the same - manual'
    section: 'Configure auditd Rules'
    description: |
        The Audit system have both on disk and running configuration. It is possible for these configuration settings to differ.
        Note
         Due to the limitations of                augenrules
         and                auditctl
        , it is not absolutely guaranteed that loading the rule sets via                augenrules load
         will result in all rules being loaded or even that the user will be informed if there was a problem loading the rules.
    remediation: |
        If the rules are not aligned across all three () areas, run the following command to merge and load all rules: #
        augenrules --load
         Check if reboot is required. if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then echo "Reboot required to load
        rules"; fi
    type: Undefined
    impact: '0.0'
    tags: ['level2', 'rule_6.3.3.21', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.3.4.1":
    title: '6.3.4.1 | Ensure audit log files mode is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit log files contain information about the system and system activity.
    remediation: |
        Run the following command to remove more permissive mode than                    0640
         from audit log files:                 # [ -f /etc/audit/auditd.conf ] && find "$(dirname $(awk -F "=" '/^\s*log_file/
        {print $2}' /etc/audit/auditd.conf | xargs))" -type f -perm /0137 -exec chmod u-x,g-wx,o-rwx {} +
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == 0137'

  "6.3.4.2":
    title: '6.3.4.2 | Ensure audit log files owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit log files contain information about the system and system activity.
    remediation: |
        Run the following command to configure the audit log files to be owned by the                    root
         user:                 # [ -f /etc/audit/auditd.conf ] && find "$(dirname $(awk -F "=" '/^\s*log_file/ {print $2}'
        /etc/audit/auditd.conf | xargs))" -type f ! -user root -exec chown root {} +
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == root'

  "6.3.4.3":
    title: '6.3.4.3 | Ensure audit log files group owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit log files contain information about the system and system activity.
    remediation: |
        Run the following command to configure the audit log files to be group owned by                    adm
        :                 # find $(dirname $(awk -F"=" '/^\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs)) -type f \( !
        -group adm -a ! -group root \) -exec chgrp adm {} +

        Run the following command to set the                    log_group
         parameter in the audit configuration file to                    log_group = adm
        :                 # sed -ri 's/^\s*#?\s*log_group\s*=\s*\S+(\s*#.*)?.*$/log_group = adm\1/' /etc/audit/auditd.conf
         Run the following command to restart the audit daemon to reload the configuration file: # systemctl restart auditd
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "6.3.4.4":
    title: '6.3.4.4 | Ensure the audit log file directory mode is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        The audit log directory contains audit log files.
    remediation: |
        Run the following command to configure the audit log directory to have a mode of "0750" or less permissive: # chmod
        g-w,o-rwx "$(dirname "$(awk -F= '/^\s*log_file\s*/{print $2}' /etc/audit/auditd.conf | xargs)")"
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == 0027'

  "6.3.4.5":
    title: '6.3.4.5 | Ensure audit configuration files mode is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit configuration files control auditd and what events are audited.
    remediation: |
        Run the following command to remove more permissive mode than                    0640
         from the audit configuration files:                 # find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \)
        -exec chmod u-x,g-wx,o-rwx {} +
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/audit/:0137:*.conf'
            - name: Undefined
              rule: 'should cmp == /etc/audit/:0137:*.rules'

  "6.3.4.6":
    title: '6.3.4.6 | Ensure audit configuration files owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit configuration files control auditd and what events are audited.
    remediation: |
        Run the following command to change ownership to                    root
         user:                 # find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -user root -exec chown root
        {} +
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/audit/:root:*.conf'
            - name: Undefined
              rule: 'should cmp == /etc/audit/:root:*.rules'

  "6.3.4.7":
    title: '6.3.4.7 | Ensure audit configuration files group owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit configuration files control auditd and what events are audited.
    remediation: |
        Run the following command to change group to                    root
        :                 # find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -group root -exec chgrp root {} +
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/audit/:root:*.conf'
            - name: Undefined
              rule: 'should cmp == /etc/audit/:root:*.rules'

  "6.3.4.8":
    title: '6.3.4.8 | Ensure audit tools mode is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit tools include, but are not limited to, vendorprovided and open source audit tools needed to successfully view and
        manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    remediation: |
        Run the following command to remove more permissive mode from the audit tools: # chmod go-w /sbin/auditctl
        /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /sbin/auditctl:0022'
            - name: Undefined
              rule: 'should cmp == /sbin/aureport:0022'
            - name: Undefined
              rule: 'should cmp == /sbin/ausearch:0022'
            - name: Undefined
              rule: 'should cmp == /sbin/autrace:0022'
            - name: Undefined
              rule: 'should cmp == /sbin/auditd:0022'
            - name: Undefined
              rule: 'should cmp == /sbin/augenrules:0022'

  "6.3.4.9":
    title: '6.3.4.9 | Ensure audit tools owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit tools include, but are not limited to, vendorprovided and open source audit tools needed to successfully view and
        manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    remediation: |
        Run the following command to change the owner of the audit tools to the                    root
         user:                 # chown root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd
        /sbin/augenrules
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /sbin/auditctl:root'
            - name: Undefined
              rule: 'should cmp == /sbin/aureport:root'
            - name: Undefined
              rule: 'should cmp == /sbin/ausearch:root'
            - name: Undefined
              rule: 'should cmp == /sbin/autrace:root'
            - name: Undefined
              rule: 'should cmp == /sbin/auditd:root'
            - name: Undefined
              rule: 'should cmp == /sbin/augenrules:root'

  "6.3.4.10":
    title: '6.3.4.10 | Ensure audit tools group owner is configured - manual'
    section: 'Configure auditd File Access'
    description: |
        Audit tools include, but are not limited to, vendorprovided and open source audit tools needed to successfully view and
        manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    remediation: |
        Run the following command to change group ownership to the groop                    root
        :                 # chgrp root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_6.3.4.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /sbin/auditctl:root'
            - name: Undefined
              rule: 'should cmp == /sbin/aureport:root'
            - name: Undefined
              rule: 'should cmp == /sbin/ausearch:root'
            - name: Undefined
              rule: 'should cmp == /sbin/autrace:root'
            - name: Undefined
              rule: 'should cmp == /sbin/auditd:root'
            - name: Undefined
              rule: 'should cmp == /sbin/augenrules:root'

  "7.1.1":
    title: '7.1.1 | Ensure permissions on etcpasswd are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/passwd
         file contains user account information that is used by many system utilities and therefore must be readable for these
        utilities to operate.
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on                  /etc/passwd
        :
        # chmod u-x,go-wx /etc/passwd
        # chown root:root /etc/passwd
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/passwd:0133'
            - name: Undefined
              rule: 'should cmp == /etc/passwd:root'
            - name: Undefined
              rule: 'should cmp == /etc/passwd:root'

  "7.1.2":
    title: '7.1.2 | Ensure permissions on etcpasswd- are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/passwd
         file contains backup user account information.
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on                  /etc/passwd-
        :
        # chmod u-x,go-wx /etc/passwd-
        # chown root:root /etc/passwd-
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/passwd-:0133'
            - name: Undefined
              rule: 'should cmp == /etc/passwd-:root'
            - name: Undefined
              rule: 'should cmp == /etc/passwd-:root'

  "7.1.3":
    title: '7.1.3 | Ensure permissions on etcgroup are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/group
         file contains a list of all the valid groups defined in the system. The command below allows read/write access for root
        and read access for everyone else.
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on                  /etc/group
        :
        # chmod u-x,go-wx /etc/group
        # chown root:root /etc/group
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/group:0133'
            - name: Undefined
              rule: 'should cmp == /etc/group:root'
            - name: Undefined
              rule: 'should cmp == /etc/group:root'

  "7.1.4":
    title: '7.1.4 | Ensure permissions on etcgroup- are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/group
         file contains a backup list of all the valid groups defined in the system.
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on                  /etc/group-
        :
        # chmod u-x,go-wx /etc/group-
        # chown root:root /etc/group-
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/group-:0133'
            - name: Undefined
              rule: 'should cmp == /etc/group-:root'
            - name: Undefined
              rule: 'should cmp == /etc/group-:root'

  "7.1.5":
    title: '7.1.5 | Ensure permissions on etcshadow are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/shadow
         file is used to store the information about user accounts that is critical to the security of those accounts, such as
        the hashed password and other security information.
    remediation: |
        Run                  one
         of the following commands to set ownership of                  /etc/shadow
         to                  root
         and group to either                  root
         or                  shadow
        :
        # chown root:shadow /etc/shadow
          -OR-
        # chown root:root /etc/shadow

        Run the following command to remove excess permissions form                  /etc/shadow
        :               # chmod u-x,g-wx,o-rwx /etc/shadow
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/shadow:0137'
            - name: Undefined
              rule: 'should cmp == /etc/shadow:root'
            - name: Undefined
              rule: 'should cmp == /etc/shadow:(root|shadow)'

  "7.1.6":
    title: '7.1.6 | Ensure permissions on etcshadow- are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/shadow
         file is used to store backup information about user accounts that is critical to the security of those accounts, such
        as the hashed password and other security information.
    remediation: |
        Run                  one
         of the following commands to set ownership of                  /etc/shadow-
         to                  root
         and group to either                  root
         or                  shadow
        :
        # chown root:shadow /etc/shadow-
          -OR-
        # chown root:root /etc/shadow-

        Run the following command to remove excess permissions form                  /etc/shadow-
        :               # chmod u-x,g-wx,o-rwx /etc/shadow-
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/shadow:0137'
            - name: Undefined
              rule: 'should cmp == /etc/shadow:root'
            - name: Undefined
              rule: 'should cmp == /etc/shadow:(root|shadow)'

  "7.1.7":
    title: '7.1.7 | Ensure permissions on etcgshadow are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/gshadow
         file is used to store the information about groups that is critical to the security of those accounts, such as the
        hashed password and other security information.
    remediation: |
        Run                  one
         of the following commands to set ownership of                  /etc/gshadow
         to                  root
         and group to either                  root
         or                  shadow
        :
        # chown root:shadow /etc/gshadow
          -OR-
        # chown root:root /etc/gshadow

        Run the following command to remove excess permissions form                  /etc/gshadow
        :               # chmod u-x,g-wx,o-rwx /etc/gshadow
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/gshadow:0137'
            - name: Undefined
              rule: 'should cmp == /etc/gshadow:root'
            - name: Undefined
              rule: 'should cmp == /etc/gshadow:(shadow|root)'

  "7.1.8":
    title: '7.1.8 | Ensure permissions on etcgshadow- are configured - manual'
    section: 'System File Permissions'
    description: |
        The              /etc/gshadow
         file is used to store backup information about groups that is critical to the security of those accounts, such as the
        hashed password and other security information.
    remediation: |
        Run                  one
         of the following commands to set ownership of                  /etc/gshadow-
         to                  root
         and group to either                  root
         or                  shadow
        :
        # chown root:shadow /etc/gshadow-
          -OR-
        # chown root:root /etc/gshadow-

        Run the following command to remove excess permissions form                  /etc/gshadow-
        :               # chmod u-x,g-wx,o-rwx /etc/gshadow-
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/gshadow-:0137'
            - name: Undefined
              rule: 'should cmp == /etc/gshadow-:root'
            - name: Undefined
              rule: 'should cmp == /etc/gshadow-:(shadow|root)'

  "7.1.9":
    title: '7.1.9 | Ensure permissions on etcshells are configured - manual'
    section: 'System File Permissions'
    description: |
        /etc/shells
         is a text file which contains the full pathnames of valid login shells. This file is consulted by              chsh
         and available to be queried by other programs.
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on                  /etc/shells
        :
        # chmod u-x,go-wx /etc/shells
        # chown root:root /etc/shells
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/shells:0133'
            - name: Undefined
              rule: 'should cmp == /etc/shells:root'
            - name: Undefined
              rule: 'should cmp == /etc/shells:root'

  "7.1.10":
    title: '7.1.10 | Ensure permissions on etcsecurityopasswd are configured - manual'
    section: 'System File Permissions'
    description: |
        /etc/security/opasswd
         and its backup              /etc/security/opasswd.old
         hold users previous passwords if              pamunix
         or              pampwhistory
         is in use on the system
    remediation: |
        Run the following commands to remove excess permissions, set owner, and set group on
        /etc/security/opasswd
         and                  /etc/security/opasswd.old
         is they exist:
        # [ -e "/etc/security/opasswd" ] && chmod u-x,go-rwx /etc/security/opasswd
        # [ -e "/etc/security/opasswd" ] && chown root:root /etc/security/opasswd
        # [ -e "/etc/security/opasswd.old" ] && chmod u-x,go-rwx /etc/security/opasswd.old
        # [ -e "/etc/security/opasswd.old" ] && chown root:root /etc/security/opasswd.old
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
        - checks:
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd:0177'
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd:root'
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd:root'
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd.old:0177'
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd.old:root'
            - name: Undefined
              rule: 'should cmp == /etc/security/opasswd.old:root'

  "7.1.11":
    title: '7.1.11 | Ensure world writable files and directories are secured - manual'
    section: 'System File Permissions'
    description: |
        World writable files are the least secure. Data in worldwritable files can be modified and compromised by any user on
        the system. World writable files may also indicate an incorrectly written script or program that could potentially be
        the cause of a larger compromise to the systems integrity. See the              chmod2
         man page for more information.           Setting the sticky bit on world writable directories prevents users from
        deleting or renaming files in that directory that are not owned by them.
    remediation: |
        World Writable Files:

        It is recommended that write access is removed from                        other
         with the command (                        chmod o-w <filename>
         ), but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.

        World Writable Directories:

        Set the sticky bit on all world writable directories with the command (                        chmod a+t
        <directory_name>
         )
                                 Run the following script to: Remove other write permission from any world writable files Add
        the sticky bit to all world writable directories
        #!/usr/bin/env bash

        {
           l_smask='01000'
           a_file=(); a_dir=() # Initialize arrays
           a_path=(! -path "/run/user/*" -a ! -path "/proc/*" -a ! -path "*/containerd/*" -a ! -path "*/kubelet/pods/*" -a !
        -path "*/kubelet/plugins/*" -a ! -path "/sys/*" -a ! -path "/snap/*")
           while IFS= read -r l_mount; do
              while IFS= read -r -d $'\0' l_file; do
                 if [ -e "$l_file" ]; then
                    l_mode="$(stat -Lc '%#a' "$l_file")"
                    if [ -f "$l_file" ]; then # Remove excess permissions from WW files
                       echo -e " - File: \"$l_file\" is mode: \"$l_mode\"\n  - removing write permission on \"$l_file\" from
        \"other\""
                       chmod o-w "$l_file"
                    fi
                    if [ -d "$l_file" ]; then # Add sticky bit
                       if [ ! $(( $l_mode & $l_smask )) -gt 0 ]; then
                          echo -e " - Directory: \"$l_file\" is mode: \"$l_mode\" and doesn't have the sticky bit set\n  -
        Adding the sticky bit"
                          chmod a+t "$l_file"
                       fi
                    fi
                 fi
              done < <(find "$l_mount" -xdev \( "${a_path[@]}" \) \( -type f -o -type d \) -perm -0002 -print0 2> /dev/null)
           done < <(findmnt -Dkerno fstype,target | awk '($1 !~ /^\s*(nfs|proc|smb|vfat|iso9660|efivarfs|selinuxfs)/ && $2 !~
        /^(\/run\/user\/|\/tmp|\/var\/tmp)/){print $2}')
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.11', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.1.12":
    title: '7.1.12 | Ensure no files or directories without an owner and a group exist - manual'
    section: 'System File Permissions'
    description: |
        Administrators may delete users or groups from the system and neglect to remove all files and/or directories owned by
        those users or groups.
    remediation: |
        Remove or set ownership and group ownership of these files and/or directories to an active user on the system as
        appropriate.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.1.12', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.1.13":
    title: '7.1.13 | Ensure SUID and SGID files are reviewed - manual'
    section: 'System File Permissions'
    description: |
        The owner of a file can set the files permissions to run with the owners or groups permissions, even if the user running
        the program is not the owner or a member of the group. The most common reason for a SUID or SGID program is to enable
        users to perform functions such as changing their password that require root privileges.
    remediation: |
        Ensure that no rogue SUID or SGID programs have been introduced into the system. Review the files returned by the action
        in the Audit section and confirm the integrity of these binaries.
    type: Undefined
    impact: '0.0'
    tags: ['level1', 'rule_7.1.13', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.1":
    title: '7.2.1 | Ensure accounts in etcpasswd use shadowed passwords'
    section: 'Local User and Group Settings'
    description: |
        Local accounts can uses shadowed passwords.  With shadowed passwords, The passwords are saved in shadow password file,
        /etc/shadow
        , encrypted by a salted oneway hash. Accounts with a shadowed password have an              x
         in the second field in              /etc/passwd
        .
    remediation: |
        Run the following command to set accounts to use shadowed passwords and migrate passwords in
        /etc/passwd
         to                  /etc/shadow
        :               # pwconv
         Investigate to determine if the account is logged in and what it is being used for, to determine if it needs to be
        forced off.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.1', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "7.2.2":
    title: '7.2.2 | Ensure etcshadow password fields are not empty - manual'
    section: 'Local User and Group Settings'
    description: |
        An account with an empty password field means that anybody may log in as that user without providing a password.
    remediation: |
        If any accounts in the                  /etc/shadow
         file do not have a password, run the following command to lock the account until it can be determined why it does not
        have a password:               # passwd -l <username>
         Also, check to see if the account is logged in and investigate what it is being used for to determine if it needs to be
        forced off.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.2', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.3":
    title: '7.2.3 | Ensure all groups in etcpasswd exist in etcgroup - manual'
    section: 'Local User and Group Settings'
    description: |
        Over time, system administration errors and changes can lead to groups being defined in              /etc/passwd
         but not in              /etc/group
         .
    remediation: |
        Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.3', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.4":
    title: '7.2.4 | Ensure shadow group is empty'
    section: 'Local User and Group Settings'
    description: |
        The shadow group allows system programs which require access the ability to read the /etc/shadow file. No users should
        be assigned to the shadow group.
    remediation: |
        Run the following command to remove all users from the shadow group # sed -ri 's/(^shadow:[^:]*:[^:]*:)([^:]+$)/\1/'
        /etc/group
         Change the primary group of any users with shadow as their primary group. # usermod -g <primary group> <user>
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.4', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: true
    properties:
      match: all
      rules:

  "7.2.5":
    title: '7.2.5 | Ensure no duplicate UIDs exist - manual'
    section: 'Local User and Group Settings'
    description: |
        Although the              useradd
         program will not let you create a duplicate User ID UID, it is possible for an administrator to manually edit the
        /etc/passwd
         file and change the UID field.
    remediation: |
        Based on the results of the audit script, establish unique UIDs and review all files owned by the shared UIDs to
        determine which UID they are supposed to belong to.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.5', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.6":
    title: '7.2.6 | Ensure no duplicate GIDs exist - manual'
    section: 'Local User and Group Settings'
    description: |
        Although the              groupadd
         program will not let you create a duplicate Group ID GID, it is possible for an administrator to manually edit the
        /etc/group
         file and change the GID field.
    remediation: |
        Based on the results of the audit script, establish unique GIDs and review all files owned by the shared GID to
        determine which group they are supposed to belong to.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.6', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.7":
    title: '7.2.7 | Ensure no duplicate user names exist - manual'
    section: 'Local User and Group Settings'
    description: |
        Although the              useradd
         program will not let you create a duplicate user name, it is possible for an administrator to manually edit the
        /etc/passwd
         file and change the user name.
    remediation: |
        Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically
        reflect the change as long as the users have unique UIDs.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.7', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.8":
    title: '7.2.8 | Ensure no duplicate group names exist - manual'
    section: 'Local User and Group Settings'
    description: |
        Although the              groupadd
         program will not let you create a duplicate group name, it is possible for an administrator to manually edit the
        /etc/group
         file and change the group name.
    remediation: |
        Based on the results of the audit script, establish unique names for the user groups. File group ownerships will
        automatically reflect the change as long as the groups have unique GIDs.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.8', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.9":
    title: '7.2.9 | Ensure local interactive user home directories are configured - manual'
    section: 'Local User and Group Settings'
    description: |
        The user home directory is space defined for the particular user to set local environment variables and to store
        personal files.  While the system administrator can establish secure permissions for users home directories, the users
        can easily override these. Users can be defined in              /etc/passwd
         without a home directory or with a home directory that does not actually exist.
    remediation: |
        If a local interactive users' home directory is undefined and/or doesn't exist, follow local site policy and perform one
        of the following: Lock the user account Remove the user from the system
        create a directory for the user.  If undefined, edit                    /etc/passwd
         and add the absolute path to the directory to the last field of the user.                 Run the following script to:
        Remove excessive permissions from local interactive users home directories Update the home directory's owner
        #!/usr/bin/env bash

        {
           l_output2=""
           l_valid_shells="^($( awk -F\/ '$NF != "nologin" {print}' /etc/shells | sed -rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d
        '|' - ))$"
           unset a_uarr && a_uarr=() # Clear and initialize array
           while read -r l_epu l_eph; do # Populate array with users and user home location
              a_uarr+=("$l_epu $l_eph")
           done <<< "$(awk -v pat="$l_valid_shells" -F: '$(NF) ~ pat { print $1 " " $(NF-1) }' /etc/passwd)"
           l_asize="${#a_uarr[@]}" # Here if we want to look at number of users before proceeding
           [ "$l_asize " -gt "10000" ] && echo -e "\n  ** INFO **\n  - \"$l_asize\" Local interactive users found on the
        system\n  - This may be a long running process\n"
           while read -r l_user l_home; do
              if [ -d "$l_home" ]; then
                 l_mask='0027'
                 l_max="$( printf '%o' $(( 0777 & ~$l_mask)) )"
                 while read -r l_own l_mode; do
                    if [ "$l_user" != "$l_own" ]; then
                       l_output2="$l_output2\n  - User: \"$l_user\" Home \"$l_home\" is owned by: \"$l_own\"\n  -  changing
        ownership to: \"$l_user\"\n"
                       chown "$l_user" "$l_home"
                    fi
                    if [ $(( $l_mode & $l_mask )) -gt 0 ]; then
                       l_output2="$l_output2\n  - User: \"$l_user\" Home \"$l_home\" is mode: \"$l_mode\" should be mode:
        \"$l_max\" or more restrictive\n  -  removing excess permissions\n"
                       chmod g-w,o-rwx "$l_home"
                    fi
                 done <<< "$(stat -Lc '%U %#a' "$l_home")"
              else
                 l_output2="$l_output2\n  - User: \"$l_user\" Home \"$l_home\" Doesn't exist\n  -  Please create a home in
        accordance with local site policy"
              fi
           done <<< "$(printf '%s\n' "${a_uarr[@]}")"
           if [ -z "$l_output2" ]; then # If l_output2 is empty, we pass
              echo -e " - No modification needed to local interactive users home directories"
           else
              echo -e "\n$l_output2"
           fi
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.9', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:

  "7.2.10":
    title: '7.2.10 | Ensure local interactive user dot files access is configured - manual'
    section: 'Local User and Group Settings'
    description: |
        While the system administrator can establish secure permissions for users dot files, the users can easily override
        these. .forward
         file specifies an email address to forward the users mail to.             .rhost
         file provides the remote authentication database for the rcp, rlogin, and rsh commands and the rcmd function. These
        files bypass the standard passwordbased user authentication mechanism. They specify remote hosts and users that are
        considered trusted i.e. are allowed to access the local system without supplying a password             .netrc
         file contains data for logging into a remote host or passing authentication to an API.             .bashhistory
         file keeps track of the users commands.
    remediation: |
        Making global modifications to users' files without alerting the user community can result in unexpected outages and
        unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions
        and determine the action to be taken in accordance with site policy. The following script will:
        remove excessive permissions on                    dot
         files within interactive users' home directories
        change ownership of                    dot
         files within interactive users' home directories to the user
        change group ownership of                    dot
         files within interactive users' home directories to the user's primary group
        list                    .forward
         and                    .rhost
         files to be investigated and manually deleted
        #!/usr/bin/env bash

        {
           l_valid_shells="^($( awk -F\/ '$NF != "nologin" {print}' /etc/shells | sed -rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d
        '|' - ))$"
           unset a_uarr && a_uarr=() # Clear and initialize array
           while read -r l_epu l_eph; do # Populate array with users and user home location
              [[ -n "$l_epu" && -n "$l_eph" ]] && a_uarr+=("$l_epu $l_eph")
           done <<< "$(awk -v pat="$l_valid_shells" -F: '$(NF) ~ pat { print $1 " " $(NF-1) }' /etc/passwd)"
           l_asize="${#a_uarr[@]}" # Here if we want to look at number of users before proceeding
           l_maxsize="1000" # Maximum number of local interactive users before warning (Default 1,000)
           [ "$l_asize " -gt "$l_maxsize" ] && echo -e "\n  ** INFO **\n  - \"$l_asize\" Local interactive users found on the
        system\n  - This may be a long running check\n"
           file_access_fix()
           {
              l_facout2=""
              l_max="$( printf '%o' $(( 0777 & ~$l_mask)) )"
              if [ $(( $l_mode & $l_mask )) -gt 0 ]; then
                 echo -e "  - File: \"$l_hdfile\" is mode: \"$l_mode\" and should be mode: \"$l_max\" or more restrictive\n   -
        Changing to mode \"$l_max\""
                 chmod "$l_chp" "$l_hdfile"
              fi
              if [[ ! "$l_owner" =~ ($l_user) ]]; then
                 echo -e "  - File: \"$l_hdfile\" owned by: \"$l_owner\" and should be owned by \"${l_user//|/ or }\"\n   -
        Changing ownership to \"$l_user\""
                 chown "$l_user" "$l_hdfile"
              fi
              if [[ ! "$l_gowner" =~ ($l_group) ]]; then
                 echo -e "  - File: \"$l_hdfile\" group owned by: \"$l_gowner\" and should be group owned by \"${l_group//|/ or
        }\"\n   - Changing group ownership to \"$l_group\""
                 chgrp "$l_group" "$l_hdfile"
              fi
           }
           while read -r l_user l_home; do
              if [ -d "$l_home" ]; then
                 echo -e "\n - Checking user: \"$l_user\" home directory: \"$l_home\""
                 l_group="$(id -gn "$l_user" | xargs)"
                 l_group="${l_group// /|}"
                 while IFS= read -r -d $'\0' l_hdfile; do
                    while read -r l_mode l_owner l_gowner; do
                       case "$(basename "$l_hdfile")" in
                          .forward | .rhost )
                             echo -e "  - File: \"$l_hdfile\" exists\n   - Please investigate and manually delete \"$l_hdfile\""
                          ;;
                          .netrc )
                             l_mask='0177'
                             l_chp="u-x,go-rwx"
                             file_access_fix ;;
                          .bash_history )
                             l_mask='0177'
                             l_chp="u-x,go-rwx"
                             file_access_fix ;;
                          * )
                             l_mask='0133'
                             l_chp="u-x,go-wx"
                             file_access_fix ;;
                          esac
                    done <<< "$(stat -Lc '%#a %U %G' "$l_hdfile")"
                 done < <(find "$l_home" -xdev -type f -name '.*' -print0)
              fi
           done <<< "$(printf '%s\n' "${a_uarr[@]}")"
           unset a_uarr # Remove array
        }
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_7.2.10', 'cis_ubuntu_linux_22.04_lts_benchmark']
    enabled: false
    properties:
      match: all
      rules:
