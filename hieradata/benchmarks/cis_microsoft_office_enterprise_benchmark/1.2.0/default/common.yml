---

inspec_rules:
  "1.1.4.1.1":
    title: '1.1.4.1.1 | L1 Ensure Add-on Management is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting manages Internet Explorer addons  which addins are always enabled, always disabled blocked, or
        configurable by the user.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to `Enabled: check all applications':
        Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE Security\Add-on
        Management
         Impact: Some legitimate programs, including ones from Microsoft, use add-ons to display documents, audio, and video in
        Internet Explorer. The organization's Group Policy should incorporate approved, commonly used add-ons to avoid limiting
        important user functionality.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_addon_management'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.2":
    title: '1.1.4.1.2 | L1 Ensure Bind to object is set to Enabled'
    section: 'IE Security'
    description: |
        This setting determines whether Microsoft Internet Explorer performs its typical safety checks on Microsoft ActiveX
        controls when opening URLs that are passed to it by an Office application. By default, Internet Explorer performs
        additional safety checks when ActiveX controls are initialized. Specifically, it prevents the control from being created
        if the kill bit is set in the registry. It also checks the security settings for the zone of the URL in which the
        control is instantiated to determine whether the control can be safely initialized. For the same behavior of the
        selectable applications, such as Excel and Word when they instantiate the use of Internet Explorer, the policy must be
        Enabled
         and the applications selected.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Bind to Object
         Impact: Enabling this setting can cause some disruptions for users who open Web pages that contain potentially
        dangerous ActiveX controls from Office applications. However, because any affected controls are usually blocked by
        default when Internet Explorer opens Web pages, most users should not experience significant usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_safe_bindtoobject'
        - checks:
            - rule: 'should have_property "exprwd.exe"'
            - name: 'exprwd.exe'
              rule: "should have_property_value('exprwd.exe', :dword, '1')"

  "1.1.4.1.3":
    title: '1.1.4.1.3 | L1 Ensure Consistent Mime Handling is set to Enabled'
    section: 'IE Security'
    description: |
        Internet Explorer uses Multipurpose Internet Mail Extensions MIME data to determine file handling procedures for files
        received through a Web server. This policy setting determines whether Internet Explorer requires that all filetype
        information provided by Web servers be consistent. For example, if the MIME type of a file is text/plain but the MIME
        data indicates that the file is really an executable file, Internet Explorer changes its extension to reflect this
        executable status. This capability helps ensure that executable code cannot masquerade as other types of trustable data.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Consistent Mime Handling
         Impact: Internet Explorer uses both the extension of the filename and the MIME information to decide how to handle a
        file. Enabling this setting requires that information in the MIME header matches the file extension provided. Since
        mismatched files will be blocked by enabling this setting, ensure that any web server under organizational control is
        set up correctly.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_mime_handling'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.4":
    title: '1.1.4.1.4 | L1 Ensure Disable user name and password is set to Enabled'
    section: 'IE Security'
    description: |
        This setting controls whether Internet Explorer opens URLs containing user information that are passed to it by an
        Office application.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Disable User Name and Password
         Impact: Enabling this setting can cause some disruptions for users who open URLs containing user authentication
        information from Office applications. Because such URLs are blocked by default when Internet Explorer opens Web pages
        through conventional means, however, most users should not experience significant usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_http_username_password_disable'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.5":
    title: '1.1.4.1.5 | L1 Ensure Information Bar is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting determines whether the Information Bar is displayed for Internet Explorer processes when file or
        code installations are restricted. By default, the Information Bar is displayed for Internet Explorer processes.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Information Bar
         Impact: The security bar will be enabled for each of the specified applications.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_securityband'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.6":
    title: '1.1.4.1.6 | L1 Ensure Local Machine Zone Lockdown Security is set to Enabled'
    section: 'IE Security'
    description: |
        This setting allows for configuration of policy settings in the zone consistent with a selected security level, for
        example, Low, Medium Low, Medium, or High. When Internet Explorer opens a Web page, it places restrictions on what the
        page can do, based on the pages Internet Explorer security zone. There are several possible security zones, each with
        different sets of restrictions. The security zone for a page is determined by its location. For example, pages that are
        located on the Internet will normally be in the more restrictive Internet security zone. They might not be allowed to
        perform some operations, such as accessing the local hard drive. Pages that are located on your corporate network would
        normally be in the Intranet security zone, and therefore have fewer restrictions.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Local Machine Zone Lockdown Security
         Impact: If you enable this policy setting, the Local Machine zone security applies to all local files and content
        processed by the specified applications. If you disable or do not configure this policy setting, Local Machine zone
        security is not applied to local files or content processed by the specified applications.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_localmachine_lockdown'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.7":
    title: '1.1.4.1.7 | L1 Ensure Mime Sniffing Safety Feature is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting determines whether Internet Explorer MIME sniffing prevents promotion of a file of one type to a
        more dangerous file type. For example, it does not allow script to run from a file marked as text. For Office, this
        setting affects any webbased content that is accessed within Office.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Mime Sniffing Safety Feature
         Impact: When set to Enabled, MIME sniffing will not promote a file of one type to a more dangerous file type. If you
        disable this policy setting, MIME sniffing configures Internet Explorer processes to allow promotion of a file from one
        type to a more dangerous file type. For example, a text file could be promoted to an executable file, which is dangerous
        because any code in the supposed text file would be executed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_mime_sniffing'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.8":
    title: '1.1.4.1.8 | L1 Ensure Navigate URL is set to Enabled'
    section: 'IE Security'
    description: |
        This setting controls whether Internet Explorer attempts to load malformed URLs that are passed to it from Office
        applications.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Navigate URL
         Impact: Enabling this setting does not block any legitimate URLs, and is therefore unlikely to cause usability issues
        for any Office users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_validate_navigate_url'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.9":
    title: '1.1.4.1.9 | L1 Ensure Object Caching Protection is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting defines whether a reference to an object is accessible when the user navigates within the same
        domain or to a new domain. For Office, this applies to URLs accessed within Office applications. By default in Internet
        Explorer, a reference to an object is no longer accessible when the user browses to a new domain. There is a new
        security context for all scriptable objects so that access to all cached objects is blocked. Additionally, access is
        blocked when browsing within the same domain fully qualified domain name. A reference to an object is no longer
        accessible after the context has changed due to navigation.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Object Caching Protection
         Impact: If you enable this policy setting, object reference is no longer accessible when navigating within or across
        domains for each specified application. If you disable or do not configure this policy setting, object reference is
        retained when navigating within or across domains in the Restricted Zone sites.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_object_caching'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.10":
    title: '1.1.4.1.10 | L1 Ensure Protection From Zone Elevation is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting prevents processes running in one zone from being elevated to higher privileges in another zone.
        Zone elevation attacks can be severe and happen relatively frequently.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Protection From Zone Elevation
         Impact: Websites that rely on navigation to other higher privileged sites may not properly function. To allow such
        websites to properly function, use Group Policy to add them to the Trusted sites zone. Note:
         Enabling this setting also disables JavaScript navigation if no security context is present.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.10', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_zone_elevation'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.11":
    title: '1.1.4.1.11 | L1 Ensure Restrict ActiveX Install is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting enables blocking of ActiveX control installation prompts for Internet Explorer processes. Users
        often choose to install software such as ActiveX controls that are not permitted by their organizations security policy.
        Such software can pose significant security and privacy risks to networks.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Restrict ActiveX Install
         Impact: Microsoft ActiveX controls allow unmanaged, unprotected code to run on the user computers. ActiveX controls do
        not run within a protected container in the browser like other types of HTML or Microsoft Silverlight-based controls.
        Disabling or not configuring this setting does not block prompts for ActiveX control installations and these prompts
        display to users. This could allow malicious code to become active on user computers or the network.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_restrict_activexinstall'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.12":
    title: '1.1.4.1.12 | L1 Ensure Restrict File Download is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting suppresses file download prompts that are not userinitiated. In certain circumstances, websites can
        initiate file download prompts without interaction from users. This technique can allow websites to put unauthorized
        files on users hard drives if they click the wrong button and accept the download.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Restrict File Download
         Impact: User-initiated downloads can still occur, so the majority of legitimate user download interactions remain
        unaffected. It is possible that some advanced users may expect their user preferences to control this behavior, and for
        this reason they may be confused when this preference is overridden by this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.12', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_restrict_filedownload'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.13":
    title: '1.1.4.1.13 | L1 Ensure Saved from URL is set to Enabled'
    section: 'IE Security'
    description: |
        This setting controls whether Internet Explorer evaluates URLs passed to it by Office applications for Mark of the Web
        MOTW comments.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Saved from URL
         Impact: Enabling this setting can cause some Web pages saved on UNC shares to run in a more restrictive security zone
        when opened from Office applications than they would if the setting were disabled or not configured. However, a page
        with a MOTW indicating it was saved from an Internet site is presumed to have been designed to run in the Internet zone
        in the first place, so most users should not experience significant usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.13', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_unc_savedfilecheck'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.4.1.14":
    title: '1.1.4.1.14 | L1 Ensure Scripted Window Security Restrictions is set to Enabled'
    section: 'IE Security'
    description: |
        This policy setting controls the Scripted Window Security Restrictions security feature, which restricts popup windows
        and prohibits scripts from displaying windows title and status bars in a way that is not visible to the user, or hides
        other windows title and status bars.
        The recommended state for this setting is                  Enabled groove.exe, excel.exe, mspub.exe, powerpnt.exe,
        pptview.exe, visio.exe, winproj.exe, winword.exe, outlook.exe, spDesign.exe, exprwd.exe, msaccess.exe, onent.exe,
        mse7.exe
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Check all
        applications
        :                   Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Security Settings\IE
        Security\Scripted Window Security Restrictions
         Impact: It is unlikely that any valid applications would use such deceptive methods to accomplish a task. For this
        reason, it is unlikely that organizations may encounter any major limitations due to using this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.4.1.14', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\software\microsoft\internet explorer\main\featurecontrol\feature_window_restrictions'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '1')"

  "1.1.5.1":
    title: '1.1.5.1 | L1 Ensure Enable Automatic Updates is set to Enabled'
    section: 'Updates'
    description: |
        This policy setting controls whether the Office automatic updates are enabled or disabled for all Office products
        installed by using ClicktoRun. Note
         This policy has no effect on Office products installed via Windows Installer.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        .                 Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Updates\Enable
        Automatic Updates
         Impact: Office updates for Click-to-Run installations of Microsoft Office are applied in the background and have no
        adverse effect on users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.5.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\office\16.0\common\officeupdate'
        - checks:
            - rule: 'should have_property "enableautomaticupdates"'
            - name: 'enableautomaticupdates'
              rule: "should have_property_value('enableautomaticupdates', :dword, '1')"

  "1.1.5.2":
    title: '1.1.5.2 | L1 Ensure Hide option to enable or disable updates is set to Enabled'
    section: 'Updates'
    description: |
        This policy setting determines if the user interface UI options to enable or disable Office automatic updates is visible
        to users. These options are found in the Product Information area of all Office applications installed via ClicktoRun.
        This policy setting has no effect on Office applications installed via Windows Installer.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        .                 Computer Configuration\Administrative Templates\Microsoft Office 2016 (Machine)\Updates\Hide option to
        enable or disable updates
         Impact: Office updates for Click-to-Run installations of Microsoft Office are applied in the background and have no
        adverse effect on users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.1.5.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\office\16.0\common\officeupdate'
        - checks:
            - rule: 'should have_property "hideenabledisableupdates"'
            - name: 'hideenabledisableupdates'
              rule: "should have_property_value('hideenabledisableupdates', :dword, '1')"

  "1.3.1":
    title: '1.3.1 | L1 Ensure Block Flash activation in Office documents is set to Enabled Block all activation'
    section: 'MS Security Guide'
    description: |
        This policy setting controls whether the Adobe Flash control can be activated by Office documents. Note that activation
        blocking applies only within Office processes. Block all activation prevents the Flash control from being loaded,
        whether directly referenced by the document or indirectly by another embedded object.
        The recommended state for this setting is              Enabled Block all activation
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled: Block all
        activation
        .               Computer Configuration\Administrative Templates\MS Security Guide\Block Flash activation in Office
        documents
         Note:
         This Group Policy path does not exist by default. An additional Group Policy template (SecGuide.admx/adml) is required
        - it is available from Microsoft at this                  link
        .               Impact: None - this enforces the default behavior of Microsoft Office.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility'
        - checks:
            - rule: 'should have_property "Comment"'
            - name: 'Comment'
              rule: "should have_property_value('Comment', :dword, '1024')"

  "1.3.2":
    title: '1.3.2 | L1 Ensure Restrict legacy JScript execution for Office is set to Enabled'
    section: 'MS Security Guide'
    description: |
        This policy setting controls JScript execution per Security Zone within Internet Explorer and WebBrowser Control WebOC
        for Office applications. JScript is Microsofts legacy dialect of the ECMAScript standard that is used in Microsofts
        Internet Explorer 11 and older. If Enabled, Office applications will not execute legacy JScript for the Internet or
        Restricted Sites zones and users arent notified by the application that legacy JScript execution is restricted. Modern
        JScript9 will continue to function for all zones.
        The recommended state for this setting is              Enabled
                           Access 69632
                           Excel 69632
                           OneNote 69632
                           Outlook 69632
                           PowerPoint 69632
                           Project 69632
                           Publisher 69632
                           Visio 69632
                           Word 69632
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                  Enabled
        .               Computer Configuration\Administrative Templates\MS Security Guide\Restrict legacy JScript execution for
        Office
         Note:
         This Group Policy path does not exist by default. An additional Group Policy template (SecGuide.admx/adml) is required
        - it is available from Microsoft at this                  link
        .               Impact: It's important to determine whether legacy JScript is being used to provide business-critical
        functionality before enabling this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_1.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\internet explorer\main\featurecontrol\FEATURE_RESTRICT_LEGACY_JSCRIPT_PER_SECURITY_ZONE'
        - checks:
            - rule: 'should have_property "excel.exe"'
            - name: 'excel.exe'
              rule: "should have_property_value('excel.exe', :dword, '69632')"

  "2.1.1.3.2.1.1":
    title: '2.1.1.3.2.1.1 | L1 Ensure Allow Trusted Locations on the network is set to Disabled'
    section: 'Trusted Locations'
    description: |
        This policy setting controls whether trusted locations on the network can be used. Trusted locations specified in the
        Trust Center are used to define file locations that are assumed to be safe by the application opening the file.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Access 2016\Application
        Settings\Security\Trust Center\Trusted Locations\Allow Trusted Locations on the network
         Impact: Disabling this setting will cause disruption for users who add network locations to the Trusted Locations list.
        These custom locations added by users are ignored but not removed. Trusted locations added in Group Policy that specify
        a network location are also ignored.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1.3.2.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\security\trusted locations'
        - checks:
            - rule: 'should have_property "allownetworklocations"'
            - name: 'allownetworklocations'
              rule: "should have_property_value('allownetworklocations', :dword, '0')"

  "2.1.1.3.2.1.2":
    title: '2.1.1.3.2.1.2 | L2 Ensure Disable all trusted locations is set to Enabled'
    section: 'Trusted Locations'
    description: |
        This policy setting allows administrators to disable all trusted locations in the specified applications.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Access 2016\Application
        Settings\Security\Trust Center\Trusted Locations\Disable all trusted locations
         Impact: All trusted locations (those specified in the Trust Center) in the specified applications are ignored,
        including any trusted locations established by Office 2016 during setup, deployed to users using Group Policy, or added
        by users themselves. Users will be prompted again when opening files from trusted locations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.1.1.3.2.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\security\trusted locations'
        - checks:
            - rule: 'should have_property "alllocationsdisabled"'
            - name: 'alllocationsdisabled'
              rule: "should have_property_value('alllocationsdisabled', :dword, '1')"

  "2.1.1.3.2.2":
    title: '2.1.1.3.2.2 | L1 Ensure Block macros from running in Office files from the internet is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting allows the blocking of macros from running in Office files that come from the internet. By enabling
        this policy setting, macros are blocked from running, even if Enable all macros is selected in the Macro Settings
        section of the Trust Center. Users will receive a notification that macros are blocked from running. The exceptions when
        macros will be allowed to run are The Office file is saved to a Trusted Location. The Office file was previously trusted
        by the user. Macros are digitally signed and the matching Trusted Publisher certificate is installed on the device.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Access 2016\Application
        Settings\Security\Trust Center\Block macros from running in Office files from the internet
         Impact: This enforces the default behavior and should not cause additional impact.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1.3.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\Access\Security'
        - checks:
            - rule: 'should have_property "blockcontentexecutionfrominternet"'
            - name: 'blockcontentexecutionfrominternet'
              rule: "should have_property_value('blockcontentexecutionfrominternet', :dword, '1')"

  "2.1.1.3.2.3":
    title: '2.1.1.3.2.3 | L1 Ensure Disable Trust Bar Notification for unsigned application add-ins and block them is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether the specified Office application notifies users when unsigned application addins
        are loaded or silently disable such addins without notification. Note
         For this policy to apply the                    Require that application addins are signed by Trusted Publisher
         policy setting needs to be                    Enabled
        . This will prevent users from changing the                    Disable Trust Bar Notification for Unsigned Application
        Addins and Block Them
         policy setting.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Access 2016\Application
        Settings\Security\Trust Center\Disable Trust Bar Notification for unsigned application add-ins and block them
         Impact: If an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-
        ins the application loads will be disabled, and the application will display the Trust Bar at the top of the active
        window. The Trust Bar contains a message that informs users about the unsigned add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1.3.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\Access\Security'
        - checks:
            - rule: 'should have_property "notbpromptunsignedaddin"'
            - name: 'notbpromptunsignedaddin'
              rule: "should have_property_value('notbpromptunsignedaddin', :dword, '1')"

  "2.1.1.3.2.4":
    title: '2.1.1.3.2.4 | L1 Ensure Require that application add-ins are signed by Trusted Publisher is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether addins for the specified Office applications must be digitally signed by a trusted
        publisher.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Access 2016\Application
        Settings\Security\Trust Center\Require that application add-ins are signed by Trusted Publisher
         Impact: This setting could cause disruptions for users who rely on add-ins that are not signed by trusted publishers.
        Users will have to obtain signed versions of such add-ins or stop using them. Office stores certificates for trusted
        publishers in the trusted publisher store. Earlier versions of Office stored trusted publisher certificate information
        (specifically, the certificate thumbprint) in a special Office trusted publisher store. Office still reads trusted
        publisher certificate information from the Office trusted publisher store but does not write information to this store.
        If a list of trusted publishers in a previous version of Office was created and upgrade the Office release, the trusted
        publisher list will still be recognized.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1.3.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\Access\Security'
        - checks:
            - rule: 'should have_property "requireaddinsig"'
            - name: 'requireaddinsig'
              rule: "should have_property_value('requireaddinsig', :dword, '1')"

  "2.1.1.4.1.1":
    title: '2.1.1.4.1.1 | L1 Ensure Underline hyperlinks is set to Enabled'
    section: 'General'
    description: |
        This policy setting controls whether hyperlinks in Access tables, queries, forms, and reports are underlined.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Access 2016\Application Settings\Web
        Options...\General\Underline hyperlinks
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.1.4.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\internet'
        - checks:
            - rule: 'should have_property "donotunderlinehyperlinks"'
            - name: 'donotunderlinehyperlinks'
              rule: "should have_property_value('donotunderlinehyperlinks', :dword, '0')"

  "2.1.4.1":
    title: '2.1.4.1 | L1 Ensure Default file format is set to Enabled Access 2007'
    section: 'Miscellaneous'
    description: |
        This policy setting controls whether new database files are created in the new Access format or in a format used by
        earlier versions of Access.
        The recommended state for this setting is                Enabled Access 2007
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Access 2007
        .                 User Configuration\Administrative Templates\Microsoft Access 2016\Miscellaneous\Default file format
         Impact: Enabling this setting does not prevent users from choosing a different file format for a new Access file, and
        therefore it is unlikely to affect usability for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.4.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\settings'
        - checks:
            - rule: 'should have_property "default file format"'
            - name: 'default file format'
              rule: "should have_property_value('default file format', :dword, '12')"

  "2.1.4.2":
    title: '2.1.4.2 | L1 Ensure Do not prompt to convert older databases is set to Disabled'
    section: 'Miscellaneous'
    description: |
        This policy setting controls whether Access prompts users to convert older databases when they are opened.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        .                 User Configuration\Administrative Templates\Microsoft Access 2016\Miscellaneous\Do not prompt to
        convert older databases
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.4.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\settings'
        - checks:
            - rule: 'should have_property "noconvertdialog"'
            - name: 'noconvertdialog'
              rule: "should have_property_value('noconvertdialog', :dword, '0')"

  "2.1.5.1":
    title: '2.1.5.1 | L1 Ensure Modal Trust Decision Only is set to Disabled'
    section: 'Tools | Security'
    description: |
        This policy setting controls how Access notifies users about untrusted components.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        .                 User Configuration\Administrative Templates\Microsoft Access 2016\Tools | Security\Modal Trust
        Decision Only
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.1.5.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\access\security'
        - checks:
            - rule: 'should have_property "modaltrustdecisiononly"'
            - name: 'modaltrustdecisiononly'
              rule: "should have_property_value('modaltrustdecisiononly', :dword, '0')"

  "2.2.2.1":
    title: '2.2.2.1 | L1 Ensure Do not show data extraction options when opening corrupt workbooks is set to Enabled'
    section: 'Data Recovery'
    description: |
        This policy setting controls whether Excel presents users with a list of data extraction options before beginning an
        Open and Repair operation when users choose to open a corrupt workbook in repair or extract mode.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Excel 2016\Data Recovery\Do Not Show Data
        Extraction Options When Opening Corrupt Workbooks
         Impact: This setting will prevent Excel users from choosing how workbooks are recovered, which could increase desktop
        support requests.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options'
        - checks:
            - rule: 'should have_property "extractdatadisableui"'
            - name: 'extractdatadisableui'
              rule: "should have_property_value('extractdatadisableui', :dword, '1')"

  "2.2.4.1.1.1.1":
    title: '2.2.4.1.1.1.1 | L1 Ensure Load Pictures from Web pages not created in Excel is set to Disabled'
    section: 'General'
    description: |
        This policy setting controls whether Excel loads graphics when opening Web pages that were not created in Excel.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Advanced\Web
        Options...\General\Load Pictures from Web Pages Not Created in Excel
         Impact: Excel will not load pictures from Web pages that were not created in Excel. This configuration can cause some
        disruptions for users who load Web pages in Excel that were created by other applications. Users who do not load Web
        pages in Excel will not be affected by this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.1.1.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\internet'
        - checks:
            - rule: 'should have_property "donotloadpictures"'
            - name: 'donotloadpictures'
              rule: "should have_property_value('donotloadpictures', :dword, '1')"

  "2.2.4.1.2":
    title: '2.2.4.1.2 | L1 Ensure Ask to update automatic links is set to Enabled'
    section: 'Advanced'
    description: |
        This policy setting controls whether Excel prompts users to update automatic links, or whether the updates occur in the
        background with no prompt.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Advanced\Ask to
        Update Automatic Links
         Impact: Users who work with Excel documents that contain external content will not be able to automatically update that
        content.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options\binaryoptions'
        - checks:
            - rule: 'should have_property "fupdateext_78_1"'
            - name: 'fupdateext_78_1'
              rule: "should have_property_value('fupdateext_78_1', :dword, '0')"

  "2.2.4.5.1.1":
    title: '2.2.4.5.1.1 | L1 Ensure Internet and network paths as hyperlinks is set to Disabled'
    section: 'Autocorrect Options'
    description: |
        This policy setting determines whether Excel automatically creates hyperlinks when users enter URL or UNC path
        information.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel
        Options\Proofing\Autocorrect Options\Internet and Network Paths as Hyperlinks
         Impact: Excel users will still be able to create new hyperlinks manually, so it is unlikely to cause significant
        disruptions for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.5.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options'
        - checks:
            - rule: 'should have_property "autohyperlink"'
            - name: 'autohyperlink'
              rule: "should have_property_value('autohyperlink', :dword, '0')"

  "2.2.4.6.1":
    title: '2.2.4.6.1 | L1 Ensure Default file format is set to Enabled Excel Workbook .xlsx'
    section: 'Save'
    description: |
        This policy setting controls the default file format for saving workbooks in Excel.
        The recommended state for this setting is                  Enabled Excel Workbook .xlsx
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to:                      Enabled: Excel
        Workbook (*.xlsx)
        :                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Save\Default File
        Format
         Impact: Enabling this setting does not prevent users from choosing a different file format for a new Excel file, and
        therefore, it is unlikely to affect usability for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.6.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\options'
        - checks:
            - rule: 'should have_property "defaultformat"'
            - name: 'defaultformat'
              rule: "should have_property_value('defaultformat', :dword, '51')"

  "2.2.4.6.2":
    title: '2.2.4.6.2 | L1 Ensure Disable AutoRepublish is set to Enabled'
    section: 'Save'
    description: |
        This policy setting allows administrators to disable the AutoRepublish feature in Excel. If users choose to publish
        Excel data to a static Web page and enable the AutoRepublish feature, Excel saves a copy of the data to the Web page
        every time the user saves the workbook. By default, a message dialog displays every time the user saves a published
        workbook when AutoRepublish is enabled. From this dialog, the user can disable AutoRepublish temporarily or permanently,
        or select Do not show this message again to prevent the dialog from appearing after every save. If the user selects Do
        not show this message again, Excel will continue to automatically republish the data after every save without informing
        the user.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Save\Disable
        AutoRepublish
         Impact: If there is a critical business that needs to use the AutoRepublish feature, it might not be possible to enable
        this setting. However, in most situations users will be able to publish data to the Web manually.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.6.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options'
        - checks:
            - rule: 'should have_property "disableautorepublish"'
            - name: 'disableautorepublish'
              rule: "should have_property_value('disableautorepublish', :dword, '1')"

  "2.2.4.6.3":
    title: '2.2.4.6.3 | L1 Ensure Do not show AutoRepublish warning alert is set to Disabled'
    section: 'Save'
    description: |
        This policy setting controls whether Excel displays an alert before republishing a workbook to the World Wide Web.
        AutoRepublish is a feature in Excel that allows workbooks to be automatically republished to the World Wide Web each
        time the workbook is saved. Several might need to be made to allow the workbook to be successfully published, including
        the following External references are converted to values. Hidden formulas become visible. The Set precision as
        displayed option, which appears beneath the When calculating this workbook heading in the Advanced section of the Excel
        Options dialog box, is no longer available. These types of changes can mean that the version on the Web page might not
        be the same as the Excel file.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Save\Do Not Show
        AutoRepublish Warning Alert
         Impact: Configuring this setting to "Always show the alert before publishing" reinforces the default functionality in
        Excel, and is therefore unlikely to cause usability issues for most users
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.6.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options'
        - checks:
            - rule: 'should have_property "disableautorepublishwarning"'
            - name: 'disableautorepublishwarning'
              rule: "should have_property_value('disableautorepublishwarning', :dword, '0')"

  "2.2.4.7.2.1.1":
    title: '2.2.4.7.2.1.1 | L1 Ensure Always prevent untrusted Microsoft Query files from opening is set to Enabled'
    section: 'External Content'
    description: |
        This policy setting controls whether Microsoft Query files .iqy, oqy, .dqy, and .rqy in an untrusted location are
        prevented from opening. Using Microsoft Query, users can connect to external data sources, select data from those
        external sources, import that data into worksheets, and refresh it to keep worksheet data synchronized with the data in
        the external sources. Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\External Content\Always prevent untrusted Microsoft Query files from opening
         Impact: Microsoft Query files in an untrusted location are prevented from opening. Users will not be able to change
        this setting under File > Options > Trust Center > Trust Center Settings > External Content.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security\external content'
        - checks:
            - rule: 'should have_property "enableblockunsecurequeryfiles"'
            - name: 'enableblockunsecurequeryfiles'
              rule: "should have_property_value('enableblockunsecurequeryfiles', :dword, '1')"

  "2.2.4.7.2.1.2":
    title: '2.2.4.7.2.1.2 | L1 Ensure Dont allow Dynamic Data Exchange DDE server launch in Excel is set to Enabled'
    section: 'External Content'
    description: |
        This policy setting allows controls whether Dynamic Data Exchange DDE server launch is allowed. The DDE protocol is a
        set of messages and guidelines. It sends messages between applications that share data and uses shared memory to
        exchange data between applications. Applications can use the DDE protocol for onetime data transfers and for continuous
        exchanges in which applications send updates to one another as new data becomes available. Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .
        User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust Center\External
        Content\Dont allow Dynamic Data Exchange (DDE) server launch in Excel
                                          Impact: None - DDE Launch is disabled by default. Enforcing this policy ensures users
        cannot enter an unsecure state.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security\external content'
        - checks:
            - rule: 'should have_property "disableddeserverlaunch"'
            - name: 'disableddeserverlaunch'
              rule: "should have_property_value('disableddeserverlaunch', :dword, '1')"

  "2.2.4.7.2.1.3":
    title: '2.2.4.7.2.1.3 | L1 Ensure Dont allow Dynamic Data Exchange DDE server lookup in Excel is set to Enabled'
    section: 'External Content'
    description: |
        This policy setting allows controls whether Dynamic Data Exchange DDE server lookup is allowed. The DDE protocol is a
        set of messages and guidelines. It sends messages between applications that share data and uses shared memory to
        exchange data between applications. Applications can use the DDE protocol for onetime data transfers and for continuous
        exchanges in which applications send updates to one another as new data becomes available. Dynamic Data Exchange Server
        Lookup allows Excel to find and use visible DDE servers on the network.
        The recommended state for this setting is                      Enabled
        .                   Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\External Content\Dont allow Dynamic Data Exchange (DDE) server lookup in Excel
         Impact: When enabled DDE server lookup isnt allowed, and users cant turn on DDE server lookup in the Trust Center. A
        Systems Administrator would need to implement DDE under a zero-trust framework.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security\external content'
        - checks:
            - rule: 'should have_property "disableddeserverlookup"'
            - name: 'disableddeserverlookup'
              rule: "should have_property_value('disableddeserverlookup', :dword, '1')"

  "2.2.4.7.2.2.1":
    title: '2.2.4.7.2.2.1 | L1 Ensure dBase III IV files is set to Enable OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with dBase III /IV files format.
        Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\dBase III /IV Files
         Impact: Users will not be able to open, save, or view dBase III /IV files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "dbasefiles"'
            - name: 'dbasefiles'
              rule: "should have_property_value('dbasefiles', :dword, '2')"

  "2.2.4.7.2.2.2":
    title: '2.2.4.7.2.2.2 | L1 Ensure Dif and Sylk files is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Dif and Sylk file format.
        Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Dif and Sylk Files
         Impact: Users will not be able to open, save, or view Dif and Sylk files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "difandsylkfiles"'
            - name: 'difandsylkfiles'
              rule: "should have_property_value('difandsylkfiles', :dword, '2')"

  "2.2.4.7.2.2.3":
    title: '2.2.4.7.2.2.3 | L1 Ensure Excel 2 macrosheets and add-in files is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 2 macrosheets file
        format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 2 Macrosheets and Add-in Files
         Impact: Users will not be able to open, save, or view Excel 2 macrosheets.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl2macros"'
            - name: 'xl2macros'
              rule: "should have_property_value('xl2macros', :dword, '2')"

  "2.2.4.7.2.2.4":
    title: '2.2.4.7.2.2.4 | L1 Ensure Excel 2 worksheets is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 2 worksheets file
        format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 2 Worksheets
         Impact: Users will not be able to open, save, or view Excel 2 worksheets.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl2worksheets"'
            - name: 'xl2worksheets'
              rule: "should have_property_value('xl2worksheets', :dword, '2')"

  "2.2.4.7.2.2.5":
    title: '2.2.4.7.2.2.5 | L1 Ensure Excel 3 macrosheets and add-in files is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 3 macrosheets file
        format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
                                    Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 3 Macrosheets and Add-in Files
         Impact: Users will not be able to open, save, or view Excel 3 macrosheets.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl3macros"'
            - name: 'xl3macros'
              rule: "should have_property_value('xl3macros', :dword, '2')"

  "2.2.4.7.2.2.6":
    title: '2.2.4.7.2.2.6 | L1 Ensure Excel 3 worksheets is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 3 worksheets file
        format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 3 Worksheets
         Impact: Users will not be able to open, save, or view Excel 3 worksheets.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl3worksheets"'
            - name: 'xl3worksheets'
              rule: "should have_property_value('xl3worksheets', :dword, '2')"

  "2.2.4.7.2.2.7":
    title: '2.2.4.7.2.2.7 | L1 Ensure Excel 4 macrosheets and add-in files is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 4 macrosheets and
        addin file format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 4 macrosheets and add-in Files
         Impact: Users will not be able to open, save, or view Excel 4 macrosheets and add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl4macros"'
            - name: 'xl4macros'
              rule: "should have_property_value('xl4macros', :dword, '2')"

  "2.2.4.7.2.2.8":
    title: '2.2.4.7.2.2.8 | L1 Ensure Excel 4 workbooks is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel 4 workbooks file format. Open/Save
        blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 4 Workbooks
         Impact: Users will not be able to open, save, or view Excel 4 workbooks.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl4workbooks"'
            - name: 'xl4workbooks'
              rule: "should have_property_value('xl4workbooks', :dword, '2')"

  "2.2.4.7.2.2.9":
    title: '2.2.4.7.2.2.9 | L1 Ensure Excel 4 worksheets is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 4 worksheets file
        format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 4 Worksheets
         Impact: Users will not be able to open, save, or view Excel 4 worksheets.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl4worksheets"'
            - name: 'xl4worksheets'
              rule: "should have_property_value('xl4worksheets', :dword, '2')"

  "2.2.4.7.2.2.10":
    title: '2.2.4.7.2.2.10 | L1 Ensure Excel 95 workbooks is set to Enabled OpenSave Blocked Use Open Policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel 95 workbooks. Open/Save blocked, use
        open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 95 Workbooks
         Impact: Users will not be able to open, save, or view Excel 95 workbooks.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.10', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl95workbooks"'
            - name: 'xl95workbooks'
              rule: "should have_property_value('xl95workbooks', :dword, '2')"

  "2.2.4.7.2.2.11":
    title: '2.2.4.7.2.2.11 | L1 Ensure Excel 95-97 workbooks and templates  is set to Enabled OpenSave Blocked Use Open Policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 9597 workbooks and
        templates file format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 95-97 Workbooks and Templates
         Impact: Users will not be able to open, save, or view Excel 95-97 workbooks and templates.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl9597workbooksandtemplates"'
            - name: 'xl9597workbooksandtemplates'
              rule: "should have_property_value('xl9597workbooksandtemplates', :dword, '2')"

  "2.2.4.7.2.2.12":
    title: '2.2.4.7.2.2.12 | L1 Ensure Excel 97-2003 workbooks and templates  is set to Enabled OpenSave Blocked Use Open Policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Excel files with Excel 972003 workbooks and
        templates file format. Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Excel 97-2003 workbooks and templates
         Impact: Users will not be able to open, save, or view Excel 97-2003 workbooks and templates.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.12', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "xl97workbooksandtemplates"'
            - name: 'xl97workbooksandtemplates'
              rule: "should have_property_value('xl97workbooksandtemplates', :dword, '2')"

  "2.2.4.7.2.2.13":
    title: '2.2.4.7.2.2.13 | L1 Ensure Set default file block behavior is set to Enabled Blocked files are not opened'
    section: 'File Block Settings'
    description: |
        This policy setting determines if users can open, view, or edit Word files that are by default blocked by Microsoft
        Office.
        The recommended state for this setting is                      Enabled Blocked files are not opened
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Blocked files are not opened
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Set Default File Block Behavior
         Impact: Enabling this setting prevents users from opening, viewing, or editing certain types of files in Word.
        Productivity could be affected if users who require access to any of these file types cannot access them.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.13', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '0')"

  "2.2.4.7.2.2.14":
    title: '2.2.4.7.2.2.14 | L1 Ensure Web pages and Excel 2003 XML spreadsheets is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Web pages and Excel 2003 XML spreadsheets.
        Open/Save blocked, use open policy
         Both opening and saving of the file type will be blocked. The file will open based on the policy setting configured in
        the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\File Block Settings\Web Pages and Excel 2003 XML Spreadsheets
         Impact:
        Users will not be able to open, save, or view Web pages and Excel 2003 XML spreadsheets. In addition, the following file
        types will open in Protected View:                            .mht
                                                .mhtml
                                                .htm
                                                .html
                                                .xml
                                                .xlmss
                                             While in OneNote using the function "Convert a Table to Excel" may cause OneNote to
        freeze until a dialogue box is confirmed.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.2.14', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "htmlandxmlssfiles"'
            - name: 'htmlandxmlssfiles'
              rule: "should have_property_value('htmlandxmlssfiles', :dword, '2')"

  "2.2.4.7.2.3.1":
    title: '2.2.4.7.2.3.1 | L1 Ensure Always open untrusted database files in Protected View is set to Enabled'
    section: 'Protected View'
    description: |
        This policy setting controls whether database files .dbf opened from an untrusted location are always opened in
        Protected View.
        The recommended state for this setting is                      Enabled
        .                   Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Always open untrusted database files in Protected View
         Impact: Database files opened from an untrusted location are always opened in Protected View. Users will not be able to
        change this setting under Trust Center Settings > Protected View.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\protectedview'
        - checks:
            - rule: 'should have_property "enabledatabasefileprotectedview"'
            - name: 'enabledatabasefileprotectedview'
              rule: "should have_property_value('enabledatabasefileprotectedview', :dword, '1')"

  "2.2.4.7.2.3.2":
    title: '2.2.4.7.2.3.2 | L1 Ensure Do not open files from the internet zone in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines whether files downloaded from the Internet zone open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Do not open files from the internet zone in Protected View
         Impact: When files open in Protected View, some functionality will be unavailable; users will be unable to edit the
        file.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\protectedview'
        - checks:
            - rule: 'should have_property "disableinternetfilesinpv"'
            - name: 'disableinternetfilesinpv'
              rule: "should have_property_value('disableinternetfilesinpv', :dword, '0')"

  "2.2.4.7.2.3.3":
    title: '2.2.4.7.2.3.3 | L1 Ensure Do not open files in unsafe locations in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if files located in unsafe locations will open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Do Not Open Files in Unsafe Locations in Protected View
         Impact: Some functionality is not available when files are opened in Protected View. In such cases, users must move the
        files from unsafe locations to safe locations in order to access them with full functionality.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\protectedview'
        - checks:
            - rule: 'should have_property "disableunsafelocationsinpv"'
            - name: 'disableunsafelocationsinpv'
              rule: "should have_property_value('disableunsafelocationsinpv', :dword, '0')"

  "2.2.4.7.2.3.4":
    title: '2.2.4.7.2.3.4 | L1 Ensure Set document behavior if file validation fails is set to Enabled Open in Protected View'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Enabled Open in Protected View
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled: Open
        in Protected View
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Set document behavior if file validation fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\filevalidation'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '1')"

  "2.2.4.7.2.3.5":
    title: '2.2.4.7.2.3.5 | L1 Ensure Set document behavior if file validation fails is set to Unchecked Do not allow edit'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Unchecked Do not allow edit
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Unchecked: Do
        not allow edit
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Set document behavior if file validation fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\filevalidation'
        - checks:
            - rule: 'should have_property "disableeditfrompv"'
            - name: 'disableeditfrompv'
              rule: "should have_property_value('disableeditfrompv', :dword, '1')"

  "2.2.4.7.2.3.6":
    title: '2.2.4.7.2.3.6 | L1 Ensure Turn off Protected View for attachments opened from Outlook is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if Excel files in Outlook attachments open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Protected View\Turn off Protected View for attachments opened from Outlook
         Impact: Some functionality is not available when files are opened in Protected View; users will be unable to edit the
        file.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.3.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\protectedview'
        - checks:
            - rule: 'should have_property "disableattachmentsinpv"'
            - name: 'disableattachmentsinpv'
              rule: "should have_property_value('disableattachmentsinpv', :dword, '0')"

  "2.2.4.7.2.4.1":
    title: '2.2.4.7.2.4.1 | L1 Ensure Allow Trusted Locations on the network is set to Disabled'
    section: 'Trusted Locations'
    description: |
        This policy setting controls whether trusted locations on the network can be used. Trusted locations specified in the
        Trust Center are used to define file locations that are assumed to be safe by the application opening the file.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Trusted Locations\Allow Trusted Locations on the network
         Impact: Disabling this setting will cause disruption for users who add network locations to the Trusted Locations list.
        These custom locations added by users are ignored but not removed. Trusted locations added in Group Policy that specify
        a network location are also ignored.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.4.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\trusted locations'
        - checks:
            - rule: 'should have_property "allownetworklocations"'
            - name: 'allownetworklocations'
              rule: "should have_property_value('allownetworklocations', :dword, '0')"

  "2.2.4.7.2.4.2":
    title: '2.2.4.7.2.4.2 | L2 Ensure Disable all trusted locations is set to Enabled'
    section: 'Trusted Locations'
    description: |
        This policy setting allows administrators to disable all trusted locations in the specified applications.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Trusted Locations\Disable all trusted locations
         Impact: All trusted locations (those specified in the Trust Center) in the specified applications are ignored,
        including any trusted locations established by Office 2016 during setup, deployed to users using Group Policy, or added
        by users themselves. Users will be prompted again when opening files from trusted locations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.2.4.7.2.4.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\trusted locations'
        - checks:
            - rule: 'should have_property "alllocationsdisabled"'
            - name: 'alllocationsdisabled'
              rule: "should have_property_value('alllocationsdisabled', :dword, '1')"

  "2.2.4.7.2.5":
    title: '2.2.4.7.2.5 | L1 Ensure Block Excel XLL Add-ins that come from an untrusted source is set to Enabled Blocked'
    section: 'Trust Center'
    description: |
        An Excel addin is a collection of custom code and functionality that enhances Microsoft Excels capabilities. These
        addins can be created by thirdparty developers or by Excel users themselves. Once installed, they become part of Excel
        and can be used across different workbooks. .XLL
         Addins are native code addins written in C or C programming languages. They offer high performance and direct access to
        Excels internal functions, making them suitable for complex and computationally intensive tasks.
        The recommended state for this setting is                    Enabled Blocked
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Block Excel XLL Add-ins that come from an untrusted source
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security'
        - checks:
            - rule: 'should have_property "blockxllfrominternet"'
            - name: 'blockxllfrominternet'
              rule: "should have_property_value('blockxllfrominternet', :dword, '1')"

  "2.2.4.7.2.6":
    title: '2.2.4.7.2.6 | L1 Ensure Block macros from running in Office files from the internet is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting allows the blocking of macros from running in Office files that come from the internet. By enabling
        this policy setting, macros are blocked from running, even if Enable all macros is selected in the Macro Settings
        section of the Trust Center. Users will receive a notification that macros are blocked from running. The exceptions when
        macros will be allowed to run are The Office file is saved to a Trusted Location. The Office file was previously trusted
        by the user. Macros are digitally signed and the matching Trusted Publisher certificate is installed on the device.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Block macros from running in Office files from the internet
         Impact: This enforces the default behavior and should not cause additional impact.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security'
        - checks:
            - rule: 'should have_property "blockcontentexecutionfrominternet"'
            - name: 'blockcontentexecutionfrominternet'
              rule: "should have_property_value('blockcontentexecutionfrominternet', :dword, '1')"

  "2.2.4.7.2.7":
    title: '2.2.4.7.2.7 | L1 Ensure Disable Trust Bar Notification for unsigned application add-ins and block them is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether the specified Office application notifies users when unsigned application addins
        are loaded or silently disable such addins without notification.
        The recommended state for this setting is                    Enabled
        .                 Note
         For this policy to apply the                    Require that application addins are signed by Trusted Publisher
         policy setting needs to be enabled. This will prevent users from changing the                    Disable Trust Bar
        Notification for Unsigned Application Addins and Block Them
         policy setting.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Disable Trust Bar Notification for unsigned application add-ins and block them
         Impact: If an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-
        ins the application loads will be disabled, and the application will display the Trust Bar at the top of the active
        window. The Trust Bar contains a message that informs users about the unsigned add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "notbpromptunsignedaddin"'
            - name: 'notbpromptunsignedaddin'
              rule: "should have_property_value('notbpromptunsignedaddin', :dword, '1')"

  "2.2.4.7.2.8":
    title: '2.2.4.7.2.8 | L1 Ensure Macro Notification Settings is set to Enabled Disable VBA macros except digitally signed macros'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros or
        Excel 4.0 XLM macros are present. Multiple Office apps support VBA macros, but XLM macros are only supported by Excel.
        Disable VBA macros except digitally signed macros
         The application displays the Trust Bar for digitally signed macros, allowing users to enable them or leave them
        disabled. Any unsigned macros are disabled, and users are not notified.
        The recommended state for this setting is                    Enabled Disable VBA macros except digitally signed macros
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Disable
        VBA macros except digitally signed macros
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Macro Notification Settings
         Impact: This configuration causes documents and templates that contain unsigned macros to lose any functionality
        supplied by those macros. To prevent this loss of functionality, users can install the macros in a trusted location,
        unless the Disable all trusted locations setting is configured to Enabled, which will block them from doing so. If your
        organization does not use any officially sanctioned macros, consider choosing No Warnings for all macros but disable all
        macros for even stronger security.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "vbawarnings"'
            - name: 'vbawarnings'
              rule: "should have_property_value('vbawarnings', :dword, '3')"

  "2.2.4.7.2.9":
    title: '2.2.4.7.2.9 | L1 Ensure Macro Notification Settings is set to Require macros to be signed by a trusted publisher'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros or
        Excel 4.0 XLM macros are present. Multiple Office apps support VBA macros, but XLM macros are only supported by Excel.
        Disable VBA macros except digitally signed macros
         The application displays the Trust Bar for digitally signed macros, allowing users to enable them or leave them
        disabled. Any unsigned macros are disabled, and users are not notified.  Requiring macros to be signed by a trusted
        publisher will block any macro signatures not added to the trusted publisher list.
        The recommended state for this setting is                    Require macros to be signed by a trusted publisher checked
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Require macros to
        be signed by a trusted publisher
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Macro Notification Settings
         Impact: This configuration causes documents and templates that contain unsigned macros to lose any functionality
        supplied by those macros. To prevent this loss of functionality, users can install the macros in a trusted location,
        unless the Disable all trusted locations setting is configured to Enabled, which will block them from doing so. If your
        organization does not use any officially sanctioned macros, consider choosing No Warnings for all macros but disable all
        macros for even stronger security.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "vbadigsigtrustedpublishers"'
            - name: 'vbadigsigtrustedpublishers'
              rule: "should have_property_value('vbadigsigtrustedpublishers', :dword, '1')"

  "2.2.4.7.2.10":
    title: '2.2.4.7.2.10 | L1 Ensure Prevent Excel from running XLM macros is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting will prevent Excel from running Excel 4.0 XLM macros.  XLM macros were first added to Excel in 1992
        and were disabled in Excel Build 16.0.14427.10000 by Microsoft in 2021.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Prevent Excel from running XLM macros
         Impact: This enforces the default behavior. Existing XLM macros will not function and should be migrated.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.10', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\excel\Security'
        - checks:
            - rule: 'should have_property "xl4macrooff"'
            - name: 'xl4macrooff'
              rule: "should have_property_value('xl4macrooff', :dword, '1')"

  "2.2.4.7.2.11":
    title: '2.2.4.7.2.11 | L1 Ensure Require that application add-ins are signed by Trusted Publisher is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether addins for the specified Office applications must be digitally signed by a trusted
        publisher.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Require that application add-ins are signed by Trusted Publisher
         Impact: This setting could cause disruptions for users who rely on add-ins that are not signed by trusted publishers.
        These users will either have to obtain signed versions of such add-ins or stop using them. Office stores certificates
        for trusted publishers in the trusted publisher store. Earlier versions of Office stored trusted publisher certificate
        information (specifically, the certificate thumbprint) in a special Office trusted publisher store. Office still reads
        trusted publisher certificate information from the Office trusted publisher store but does not write information to this
        store. If a list of trusted publishers in a previous version of Office was created and upgrade the Office release, the
        trusted publisher list will still be recognized.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "requireaddinsig"'
            - name: 'requireaddinsig'
              rule: "should have_property_value('requireaddinsig', :dword, '1')"

  "2.2.4.7.2.12":
    title: '2.2.4.7.2.12 | L1 Ensure Store macro in Personal Macro Workbook by default is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls the default location for storing macros in Excel. The Record Macro dialog box includes a
        dropdown menu that allows users to choose whether to store the new macro in the current workbook, a new workbook, or
        their personal macro workbook Personal.xlsb, a hidden workbook that opens every time Excel starts.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Store Macro In Personal Macro Workbook by Default
         Impact: Enabling this setting does not prevent users from selecting a different location for storing macros, so it is
        unlikely to cause significant usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.12', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\options\binaryoptions'
        - checks:
            - rule: 'should have_property "fglobalsheet_37_1"'
            - name: 'fglobalsheet_37_1'
              rule: "should have_property_value('fglobalsheet_37_1', :dword, '1')"

  "2.2.4.7.2.13":
    title: '2.2.4.7.2.13 | L1 Ensure Trust access to Visual Basic Project is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether automation clients such as Microsoft Visual Studio 2005 Tools for Microsoft Office
        VSTO can access the Visual Basic for Applications project system in the specified applications. VSTO projects require
        access to the Visual Basic for Applications project system in Excel, PowerPoint, and Word, even though the projects do
        not use Visual Basic for Applications. Designtime support of controls in both Visual Basic and C projects depend on the
        Visual Basic for Applications project system in Word and Excel.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        .                     User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Trust
        Center\Trust Access To Visual Basic Project
         Impact: None - this is the default behavior. By default, Excel, Word, and PowerPoint do not allow automation clients to
        have programmatic access to VBA projects. Users can enable this by selecting the Trust access to the VBA project object
        model in the Macro Settings section of the Trust Center. However, doing so allows macros in any documents the user opens
        to access the core Visual Basic objects, methods, and properties, which represents a potential security hazard.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.2.13', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "accessvbom"'
            - name: 'accessvbom'
              rule: "should have_property_value('accessvbom', :dword, '0')"

  "2.2.4.7.3":
    title: '2.2.4.7.3 | L1 Ensure Force file extension to match file type is set to Enabled Always match file type'
    section: 'Security'
    description: |
        This policy setting controls how Excel loads file types that do not match their extension. Excel can load files with
        extensions that do not match the files type. For example, if a commaseparated values CSV file named example.csv is
        renamed example.xls or any other file extension supported by Excel 2003 and earlier only, Excel can properly load it as
        a CSV file. Policy options for working with files that have nonmatching extensions Always match file type
          Excel does not open any files that have nonmatching extensions.
        The recommended state for this setting is                  Enabled Always match file type
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Always
        match file type
        .                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Force File
        Extension to Match File Type
         Impact:
        Earlier versions of Excel did not enforce file type matching. Enabling this setting and selecting
        Always match file type
         might cause disruptions for users who rely on the functionality of earlier versions of Excel and could interfere with
        the operation of tools and scripts that rely on it.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "extensionhardening"'
            - name: 'extensionhardening'
              rule: "should have_property_value('extensionhardening', :dword, '2')"

  "2.2.4.7.4":
    title: '2.2.4.7.4 | L1 Ensure Scan encrypted macros in Excel Open XML workbooks is set to Enabled Scan encrypted macros default'
    section: 'Security'
    description: |
        This policy setting controls whether encrypted macros in Open XML documents are required to be scanned with antivirus
        software before being opened.
        The recommended state for this setting is                  Enabled Scan encrypted macros default
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Scan
        encrypted macros (default)
        .                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Scan
        Encrypted Macros in Excel Open XML Workbooks
         Impact: None - this is the default behavior. By default, encrypted macros will be disabled unless they are scanned by
        antivirus software immediately before being loaded.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "excelbypassencryptedmacroscan"'
            - name: 'excelbypassencryptedmacroscan'
              rule: "should have_property_value('excelbypassencryptedmacroscan', :dword, '0')"

  "2.2.4.7.5":
    title: '2.2.4.7.5 | L1 Ensure Turn off file validation is set to Disabled'
    section: 'Security'
    description: |
        This policy setting controls the turn off the file validation feature. Office Binary Documents 972003 are checked to see
        if they conform against the file format schema before they are opened.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        .                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\Turn Off
        File Validation
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\filevalidation'
        - checks:
            - rule: 'should have_property "enableonload"'
            - name: 'enableonload'
              rule: "should have_property_value('enableonload', :dword, '1')"

  "2.2.4.7.6":
    title: '2.2.4.7.6 | L1 Ensure WEBSERVICE Function Notification Settings is set to Enabled Disable all without notification or Enabled Disable all with notification'
    section: 'Security'
    description: |
        This policy setting controls how Excel will warn users when WEBSERVICE functions are present. When selecting the option
        Disable all with notification the application displays the Trust Bar for all WEBSERVICE functions. This option enforces
        the default configuration in Office.
        The recommended state for this setting is                  Enabled Disable all without notification
         or                  Enabled Disable all with notification
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Disable
        all without notification
         or                      Enabled: Disable all with notification
        .                   User Configuration\Administrative Templates\Microsoft Excel 2016\Excel Options\Security\WEBSERVICE
        Function Notification Settings
         Impact: Users will not be notified when a WEBSERVICE function is disabled.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.2.4.7.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security'
        - checks:
            - rule: 'should have_property "webservicefunctionwarnings"'
            - name: 'webservicefunctionwarnings'
              rule: "should have_property_value('webservicefunctionwarnings', :dword, '1')"

  "2.3.8.1":
    title: '2.3.8.1 | L1 Ensure  Document Information Panel Beaconing UI is set to Enabled Always show UI'
    section: 'Document Information Panel'
    description: |
        This policy setting controls whether users see a security warning when they open custom Document Information Panels that
        contain a Web beaconing threat. InfoPath can be used to create custom Document Information Panels that can be attached
        to Excel workbooks, PowerPoint presentations, and Word documents.
        The recommended state for this setting is                Enabled Always show UI
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Always show
        UI
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Document Information Panel\Document
        Information Panel Beaconing UI
         Impact: Enabling this setting and selecting "Always show UI" from the drop-down menu can cause some disruptions for
        users who often open documents containing custom Document Information Panels.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.8.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\documentinformationpanel'
        - checks:
            - rule: 'should have_property "msoridcuxdocspropertypanelbeaconing"'
            - name: 'msoridcuxdocspropertypanelbeaconing'
              rule: "should have_property_value('msoridcuxdocspropertypanelbeaconing', :dword, '1')"

  "2.3.12.1.2":
    title: '2.3.12.1.2 | L1 Ensure Disable UI extending from documents and templates is set to Enabled'
    section: 'Customize'
    description: |
        This policy setting controls whether Office applications load any custom user interface UI code included with a document
        or template. Office allows developers to extend the UI with customization code that is included in a document or
        template.
        The recommended state for this setting is                  Enabled
                                 Disallow in Word, Excel, PowerPoint, Access, Outlook, Publisher, Project, Visio, InfoPath
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled:
                                       Disallow in Word, Excel, PowerPoint, Access, Outlook, Publisher, Project, Visio, InfoPath
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Global Options\Customize\Disable
        UI extending from documents and templates
         Impact: Enabling this setting will prevent developers from using documents and templates to extend the UI, which some
        organizations do to increase user productivity. If the organization makes use of a modified UI, it might not be feasible
        to enable this setting. Sometimes only specific teams in an organization require a modified UI, and this setting could
        be enabled for the rest of the organization.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.12.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\toolbars\access'
        - checks:
            - rule: 'should have_property "noextensibilitycustomizationfromdocument"'
            - name: 'noextensibilitycustomizationfromdocument'
              rule: "should have_property_value('noextensibilitycustomizationfromdocument', :dword, '1')"

  "2.3.18.1":
    title: '2.3.18.1 | L1 Ensure Allow users with earlier versions of Office to read with browsers... is set to Disabled'
    section: 'Manage Restricted Permissions'
    description: |
        This policy setting will allow users with earlier versions of Office to read documents with browsers supporting
        Information Rights Management.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Manage Restricted Permissions\Allow
        users with earlier versions of Office to read with browsers....
         Impact: Disabling this setting enforces the default configuration and is therefore unlikely to cause significant
        usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.18.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\drm'
        - checks:
            - rule: 'should have_property "includehtml"'
            - name: 'includehtml'
              rule: "should have_property_value('includehtml', :dword, '0')"

  "2.3.18.2":
    title: '2.3.18.2 | L1 Ensure Always expand groups in Office when restricting permission for documents is set to Enabled'
    section: 'Manage Restricted Permissions'
    description: |
        This policy setting controls whether group names automatically expand to display all the members of the group when
        selected in the Permissions dialog box.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Manage Restricted Permissions\Always
        expand groups in office when restricting permission for documents
         Impact: Enabling this setting changes the way the Permissions dialog box displays names and should not create
        significant usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.18.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\drm\autoexpanddls'
        - checks:
            - rule: 'should have_property "autoexpanddlsenable"'
            - name: 'autoexpanddlsenable'
              rule: "should have_property_value('autoexpanddlsenable', :dword, '1')"

  "2.3.18.3":
    title: '2.3.18.3 | L1 Ensure Always require users to connect to verify permission is set to Enabled'
    section: 'Manage Restricted Permissions'
    description: |
        This policy setting controls whether users are required to connect to the Internet or a local network to have their
        licenses confirmed every time they attempt to open Excel workbooks, InfoPath forms or templates, Outlook email messages,
        PowerPoint presentations, or Word documents that are protected by Information Rights Management IRM. This policy is
        useful for logging the usage of files with restricted permissions on the server.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Manage Restricted Permissions\Always
        require users to connect to verify permission
         Impact: Enabling this setting could create problems for users who need to open rights-managed files when they are not
        connected to the Internet, such as mobile users. Consider surveying the organization to determine users' need for
        offline use of rights-managed files before enabling this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.18.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\drm'
        - checks:
            - rule: 'should have_property "requireconnection"'
            - name: 'requireconnection'
              rule: "should have_property_value('requireconnection', :dword, '1')"

  "2.3.18.4":
    title: '2.3.18.4 | L1 Ensure Never allow users to specify groups when restricting permission for documents is set to Enabled'
    section: 'Manage Restricted Permissions'
    description: |
        This policy setting controls whether Office users can assign permissions to distribution lists when using Information
        Rights Management.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Manage Restricted Permissions\Never
        Allow Users to Specify Groups When Restricting Permission for Documents
         Impact: Enabling this setting could cause some disruptions for Office users who are accustomed to specifying
        distribution groups when defining permissions for a document. These users will have to list users individually in the
        Permission dialog box to assign them permission to read or modify the document. Users who do not use Information Rights
        Management will not be affected by this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.18.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\drm'
        - checks:
            - rule: 'should have_property "neverallowdls"'
            - name: 'neverallowdls'
              rule: "should have_property_value('neverallowdls', :dword, '1')"

  "2.3.18.5":
    title: '2.3.18.5 | L1 Ensure Prevent users from changing permissions on rights managed content is set to Disabled'
    section: 'Manage Restricted Permissions'
    description: |
        This policy setting controls whether Office users can change permissions for content that is protected with Information
        Rights Management IRM. The Information Rights Management feature of Office allows individuals and administrators to
        specify access permissions to Word documents, Excel workbooks, PowerPoint presentations, InfoPath templates and forms,
        and Outlook email messages. This functionality helps prevent sensitive information from being printed, forwarded, or
        copied by unauthorized people.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Manage Restricted
        Permissions\Prevent Users From Changing Permissions on Rights Managed Content
         Impact: Disabling this setting enforces the Office default configuration and is therefore unlikely to cause significant
        usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.18.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\drm'
        - checks:
            - rule: 'should have_property "disablecreation"'
            - name: 'disablecreation'
              rule: "should have_property_value('disablecreation', :dword, '0')"

  "2.3.22.2":
    title: '2.3.22.2 | L1 Ensure Block signing into Office is set to Enabled Org ID only'
    section: 'Miscellaneous'
    description: |
        This policy setting controls whether users can provide credentials to Office using either their Microsoft Account or the
        user ID assigned by the organization for accessing Office 365.
        By selecting the                Org ID only
         option, users can sign in only by using the user ID assigned by the organization for accessing Office 365.
        The recommended state for this setting is                Enabled Org ID only
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Org ID only
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Miscellaneous\Block Signing into
        Office
         Impact: Users will be unable to connect to cloud services not maintained by the organization (such as SharePoint
        services in Office 365) and access the files and services provided by the cloud services.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.22.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\signin'
        - checks:
            - rule: 'should have_property "signinoptions"'
            - name: 'signinoptions'
              rule: "should have_property_value('signinoptions', :dword, '2')"

  "2.3.22.3":
    title: '2.3.22.3 | L1 Ensure Control Blogging is set to Enabled All Blogging Disabled'
    section: 'Miscellaneous'
    description: |
        This policy setting controls whether users can compose and post blog entries from Word.
        The recommended state for this setting is                Enabled All Blogging Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: All Blogging
        Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Miscellaneous\Control Blogging
         Impact: Disabling the blogging feature in Word may cause disruptions for users who use Word to compose and post blog
        entries. Any users who have a legitimate need to post blog entries will have to use another tool.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.22.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\common\blog'
        - checks:
            - rule: 'should have_property "disableblog"'
            - name: 'disableblog'
              rule: "should have_property_value('disableblog', :dword, '2')"

  "2.3.23.1":
    title: '2.3.23.1 | L1 Ensure Block opening of pre-release versions of file formats new to Excel 2016 through the Compatibility Pack for Office 2016 and Excel 2016 Converter is set to Enabled'
    section: 'Office 2016 Converters'
    description: |
        This policy setting controls whether users with the Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint
        2016 File Formats installed can open Office Open XML files saved with prerelease versions of Excel 2016. Excel Open XML
        files usually have the following extensions .xlsx, .xlsm, .xltx, .xltm, .xlam.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Office 2016 Converters\Block opening
        of pre-release versions of file formats new to Excel 2016 through the Compatibility Pack for Office 2016 and Excel 2016
        Converter
         Impact: Enabling this setting enforces the default configuration and is therefore unlikely to cause usability issues
        for most users. Note:
         See Plan block file format settings in the Office Resource Kit for more information about using Group Policy to manage
        and enforce file format requirements. Also, see the "File Block Technology" section in Chapter 4 of the Microsoft Office
        Security Guide for information about the Microsoft Office Isolated Conversion Environment (MOICE), which provides
        another method.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.23.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\excel\security\fileblock'
        - checks:
            - rule: 'should have_property "excel12betafilesfromconverters"'
            - name: 'excel12betafilesfromconverters'
              rule: "should have_property_value('excel12betafilesfromconverters', :dword, '1')"

  "2.3.23.2":
    title: '2.3.23.2 | L1 Ensure Block opening of pre-release versions of file formats new to PowerPoint 2016 through the Compatibility Pack for Office 2016 and PowerPoint 2016 Converter is set to Enabled'
    section: 'Office 2016 Converters'
    description: |
        This policy setting controls whether users with the Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint
        2016 File Formats installed can open Office Open XML files saved with prerelease versions of PowerPoint 2016. PowerPoint
        Open XML files usually have the following extensions .pptx, .pptm, .potx, .potm, .ppsx, .ppsm, .ppam, .thmx, .xml.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Office 2016 Converters\Block opening
        of pre-release versions of file formats new to PowerPoint 2016 through the Compatibility Pack for Office 2016 and
        PowerPoint 2016 Converter
         Impact: Enabling this setting enforces the default configuration and is therefore unlikely to cause usability issues
        for most users. Note:
         See Plan block file format settings in the Office Resource Kit for more information about using Group Policy to manage
        and enforce file format requirements. Also, see the "File Block Technology" section in Chapter 4 of the Microsoft Office
        Security Guide for information about the Microsoft Office Isolated Conversion Environment (MOICE), which provides
        another method.                   Note #2:
         When enabling this group policy, the following group policy is also set to                      Enabled
         in the Group Policy Editor:                   User Configuration\Administrative Templates\Microsoft PowerPoint
        2016\PowerPoint Options\Security\Trust Center\File Block Settings\PowerPoint beta converters

        Both                      PowerPoint beta converters
         and this group policy setting in this recommendation share the same registry key and value, so there is no adverse
        impact from this.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.23.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\fileblock'
        - checks:
            - rule: 'should have_property "powerpoint12betafilesfromconverters"'
            - name: 'powerpoint12betafilesfromconverters'
              rule: "should have_property_value('powerpoint12betafilesfromconverters', :dword, '1')"

  "2.3.24.2":
    title: '2.3.24.2 | L2 Ensure Remove Office Presentation Service from the list of online presentation services in PowerPoint and Word is set to Enabled'
    section: 'Present Online'
    description: |
        This policy setting controls removal of Office Presentation Service from the list of online presentation services in
        PowerPoint and Word. This list appears when a user selects Present Online from the Share tab in Backstage view and in
        the ribbon in PowerPoint.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Present Online\Remove Office
        Presentation Service from the list of online presentation services in PowerPoint and Word
         Impact: Users that utilize Office Presentation Service for PowerPoint and Word will need to share their presentation
        another way.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.3.24.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\broadcast'
        - checks:
            - rule: 'should have_property "disabledefaultservice"'
            - name: 'disabledefaultservice'
              rule: "should have_property_value('disabledefaultservice', :dword, '1')"

  "2.3.25.1.1":
    title: '2.3.25.1.1 | L1 Ensure Allow users to submit feedback to Microsoft is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether users can provide feedback to Microsoft about their product experiences with
        Microsoft 365 products. Microsoft will use this feedback to improve the product for users. Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise, and to
        subscription versions of Project and Visio.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :
        User Configuration\Administrative Templates\Microsoft Office 2016\Privacy\Trust Center\Allow users to submit feedback to
        Microsoft
                                    Impact: If this policy setting is disabled, users will not be able to submit feedback to
        Microsoft.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.25.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\feedback'
        - checks:
            - rule: 'should have_property "enabled"'
            - name: 'enabled'
              rule: "should have_property_value('enabled', :dword, '0')"

  "2.3.25.1.2":
    title: '2.3.25.1.2 | L1 Ensure Automatically receive small updates to improve reliability is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether Microsoft Office Diagnostics is enabled. Office Diagnostics enables Microsoft to
        diagnose system problems by periodically downloading a small file to the computer.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Privacy\Trust Center\Automatically
        Receive Small Updates to Improve Reliability
         Impact: Disabling this setting will prevent users from receiving information and advice from Microsoft about fixing and
        preventing Office application errors, which could cause your support department to experience an increase in desktop
        support requests.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.25.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common'
        - checks:
            - rule: 'should have_property "updatereliabilitydata"'
            - name: 'updatereliabilitydata'
              rule: "should have_property_value('updatereliabilitydata', :dword, '0')"

  "2.3.25.1.3":
    title: '2.3.25.1.3 | L1 Ensure Disable Opt-in Wizard on first run is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether users see the Optin Wizard the first time they run a Microsoft Office application.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Privacy\Trust Center\Disable Opt-
        in Wizard on First Run
         Impact: Enabling this setting will prevent users from opting in to the services listed above. This can prevent users
        from receiving the latest program updates, security fixes, and Help content. If this setting is enabled, consider
        ensuring that such updates are made available to users through alternate means.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.25.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\general'
        - checks:
            - rule: 'should have_property "shownfirstrunoptin"'
            - name: 'shownfirstrunoptin'
              rule: "should have_property_value('shownfirstrunoptin', :dword, '1')"

  "2.3.25.1.4":
    title: '2.3.25.1.4 | L1 Ensure Enable Customer Experience Improvement Program is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether users can participate in the Microsoft Office Customer Experience Improvement
        Program to help improve Microsoft Office. When users choose to participate in the Customer Experience Improvement
        Program CEIP, Office 2016 applications automatically send information to Microsoft about how the applications are used.
        This information is combined with other CEIP data to help Microsoft solve problems and to improve the products and
        features customers use most often. This feature does not collect users names, addresses, or any other identifying
        information except the IP address that is used to send the data.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Privacy\Trust Center\Enable
        Customer Experience Improvement Program
         Impact: The Customer Experience Improvement Program sends data to Microsoft silently and without affecting application
        usage, so choosing Disabled will not cause usability issues for Office users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.25.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common'
        - checks:
            - rule: 'should have_property "qmenable"'
            - name: 'qmenable'
              rule: "should have_property_value('qmenable', :dword, '0')"

  "2.3.25.1.5":
    title: '2.3.25.1.5 | L1 Ensure Send personal information is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether users can send personal information to Office. When users choose to send
        information Office applications automatically send information to Office.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Privacy\Trust Center\Send personal
        information
         Impact: If this policy setting is disabled, Office users cannot send personal information to Office.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.25.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common'
        - checks:
            - rule: 'should have_property "sendcustomerdata"'
            - name: 'sendcustomerdata'
              rule: "should have_property_value('sendcustomerdata', :dword, '0')"

  "2.3.27.3.4":
    title: '2.3.27.3.4 | L1 Ensure Allow mix of policy and user locations is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether trusted locations can be defined by users, the Office Customization Tool OCT, and
        Group Policy, or if they must be defined by Group Policy alone.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Trust
        Center\Allow Mix of Policy and User Locations
         Impact: Disabling this setting will cause some disruption for users who have defined their own trusted locations in the
        Trust Center. Applications will treat such locations like any other untrusted locations, which means that users will see
        Message Bar warnings about active content such as ActiveX controls and VBA macros when they open files, and they will
        have to choose whether to enable controls and macros or leave them disabled.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.3.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security\trusted locations'
        - checks:
            - rule: 'should have_property "allow user locations"'
            - name: 'allow user locations'
              rule: "should have_property_value('allow user locations', :dword, '0')"

  "2.3.27.4":
    title: '2.3.27.4 | L1 Ensure ActiveX Control Initialization is set to Enabled 6'
    section: 'Security Settings'
    description: |
        This policy setting specifies the Microsoft ActiveX initialization security level for all Microsoft Office applications.
        The recommended state for this setting is                Enabled 6
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: 6
                                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\ActiveX
        Control Initialization
         Impact: This setting only increases security for ActiveX controls that are accurately marked as SFI. In situations that
        involve malicious or poorly designed code, an ActiveX control might be inaccurately marked as SFI. Important
        : Some ActiveX controls do not respect the safe mode registry setting, and therefore might load persisted data even
        though this setting is configured to instruct the control to use safe mode.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\common\security'
        - checks:
            - rule: 'should have_property "uficontrols"'
            - name: 'uficontrols'
              rule: "should have_property_value('uficontrols', :dword, '6')"

  "2.3.27.5":
    title: '2.3.27.5 | L1 Ensure Allow Basic Authentication prompts from network proxies is set to Disabled'
    section: 'Security Settings'
    description: |
        Apps such as Word and Excel allow users to use Basic authentication to connect to resources on web servers by sending
        usernames and passwords with each request. These credentials are often stored on the servers, making it easier for
        attackers to capture them and reuse them against other endpoints or services.
        The recommended state for this setting is                Disabled
        .             Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise, and to
        subscription versions of Project and Visio.             Note 2
         This change doesnt affect Outlook connecting to onpremises Exchange Server using Basic authentication.
        This change also doesnt affect Outlook connecting to Exchange Online using Basic authentication. There is a separate
        effort to deprecate Basic authentication with Exchange Online. For more information, see                Basic
        authentication deprecation in Exchange Online
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Allow Basic
        Authentication prompts from network proxies
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\identity'
        - checks:
            - rule: 'should have_property "basicauthproxybehavior"'
            - name: 'basicauthproxybehavior'
              rule: "should have_property_value('basicauthproxybehavior', :dword, '0')"

  "2.3.27.6":
    title: '2.3.27.6 | L1 Ensure Allow VBA to load typelib references by path from untrusted intranet locations is set to Disabled'
    section: 'Security Settings'
    description: |
        This policy setting permits VBA to load typelib references by explicit path read from the project data if that path
        points to an intranet location that is not explicitly in the system trusted sites list. If this policy setting is
        enabled, VBA will treat intranet paths like local machine paths, and therefore VBA will attempt to search for
        unregistered references in intranet locations that are not local machine or in the systems trusted sites list.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Allow VBA to load
        typelib references by path from untrusted intranet locations
         Impact: None - this policy enforces the default configuration.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\vba\security'
        - checks:
            - rule: 'should have_property "allowvbaintranetreferences"'
            - name: 'allowvbaintranetreferences'
              rule: "should have_property_value('allowvbaintranetreferences', :dword, '0')"

  "2.3.27.7":
    title: '2.3.27.7 | L1 Ensure Automation Security is set to Enabled Disable Macros by default'
    section: 'Security Settings'
    description: |
        This policy setting controls whether macros can run in an Office application that is opened programmatically by another
        application. Policy setting option Disable macros by default
          All macros are disabled in the programmatically opened application.
        The recommended state for this setting is                Enabled Disable Macros by default
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Disable
        Macros by default
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Automation
        Security
         Impact: "Disable macros by default" could limit functionality if an external application programmatically opens a
        Office application to open a document or template containing macros.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\common\security'
        - checks:
            - rule: 'should have_property "automationsecurity"'
            - name: 'automationsecurity'
              rule: "should have_property_value('automationsecurity', :dword, '3')"

  "2.3.27.8":
    title: '2.3.27.8 | L1 Ensure Control how Office handles form-based sign-in prompts is set to Enabled Block all prompts'
    section: 'Security Settings'
    description: |
        This policy setting controls how Office applications handle formbased signin prompts. Office Forms Based Authentication
        MSOFBA is a protocol used in Office suite applications since Microsoft Office 2007.  It provides a method to
        authenticate to other services via HTTP over a network connection.
        The recommended state for this setting is                Enabled Block all prompts
                           Note
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise, and to
        subscription versions of Project and Visio.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Block all
        prompts
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Control how Office
        handles form-based sign-in prompts
         Impact: This enforces the default configuration of Office and will only impact users who have already permitted it in
        the Trust Center.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common'
        - checks:
            - rule: 'should have_property "fbabehavior"'
            - name: 'fbabehavior'
              rule: "should have_property_value('fbabehavior', :dword, '1')"

  "2.3.27.9":
    title: '2.3.27.9 | L1 Ensure Disable additional security checks on VBA library references that may refer to unsafe locations on the local machine is set to Disabled'
    section: 'Security Settings'
    description: |
        This policy setting restricts VBA to checking project library references only against the registry and trusted zones.
        The recommended state for this setting is                Disabled
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Disable additional
        security checks on VBA library references that may refer to unsafe locations on the local machine
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\vba\security'
        - checks:
            - rule: 'should have_property "disablestrictvbarefssecurity"'
            - name: 'disablestrictvbarefssecurity'
              rule: "should have_property_value('disablestrictvbarefssecurity', :dword, '0')"

  "2.3.27.10":
    title: '2.3.27.10 | L1 Ensure Disable all Trust Bar notifications for security issues is set to Disabled'
    section: 'Security Settings'
    description: |
        This policy setting controls whether Office applications notify users when potentially unsafe features or content are
        detected, or whether such features or content are silently disabled without notification.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Disable all Trust
        Bar notifications for security issues
         Impact: This setting does not modify the default configuration, and therefore is unlikely to cause any usability
        issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.10', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\trustcenter'
        - checks:
            - rule: 'should have_property "trustbar"'
            - name: 'trustbar'
              rule: "should have_property_value('trustbar', :dword, '0')"

  "2.3.27.11":
    title: '2.3.27.11 | L1 Ensure Disable password to open UI is set to Disabled'
    section: 'Security Settings'
    description: |
        This policy setting controls whether Office users can add password encryption to documents. Users would access this
        feature in Microsoft Office tabclick Info, click Protect Document, then click Encrypt with Password.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Disable password
        to open UI
         Impact: The recommended settings enforce the default configuration, and therefore will not affect usability. Typically,
        this setting should not be enabled, because doing so will prevent users from adding passwords to Office files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "disablepasswordui"'
            - name: 'disablepasswordui'
              rule: "should have_property_value('disablepasswordui', :dword, '0')"

  "2.3.27.12":
    title: '2.3.27.12 | L1 Ensure Encryption mode for Information Rights Management IRM is set to Enabled Cipher Block Chaining CBC'
    section: 'Security Settings'
    description: |
        This setting controls the encryption mode that Office uses to protect content with Information Rights Management. For
        Microsoft 365 Apps Version 2304 or later Cipher Block Chaining CBC mode is used For earlier Microsoft 365 Apps and
        Office LTSC 2021, 2019, and 2016 Electronic Codebook ECB mode is used
        The recommended state for this setting is                Enabled Cipher Block Chaining CBC
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Cipher Block
        Chaining (CBC)
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Encryption mode
        for Information Rights Management (IRM)
         Impact: There is no impact or additional overhead associated with using CBC over ECB.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.12', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\drm'
        - checks:
            - rule: 'should have_property "compatibleencryption"'
            - name: 'compatibleencryption'
              rule: "should have_property_value('compatibleencryption', :dword, '1')"

  "2.3.27.13":
    title: '2.3.27.13 | L1 Ensure Encryption type for password protected Office 97-2003 files is set to Enabled'
    section: 'Security Settings'
    description: |
        This policy setting enables specification of an encryption type for passwordprotected Office 972003 files.
        The recommended state for this setting is                Enabled Microsoft Enhanced RSA and AES Cryptographic
        Provider,AES 256,256
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Microsoft
        Enhanced RSA and AES Cryptographic Provider,AES 256,256
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Encryption type
        for password protected Office 97-2003 files
         Impact: Consider the needs of the organization and users when selecting an encryption method to enforce. If working for
        a government agency, contracting for a government agency, or otherwise working with very sensitive information, select a
        method that complies with policies that govern how such information is processed. Remember to ensure that the selected
        cryptographic service provider is installed on the computers of all users who need to work with password-protected
        Office 97-2003 files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.13', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "defaultencryption12"'
            - name: 'defaultencryption12'
              rule: "should have_property_value('defaultencryption12', :dword, 'Microsoft Enhanced RSA and AES Cryptographic Provider,AES 256,256')"

  "2.3.27.14":
    title: '2.3.27.14 | L1 Ensure Encryption type for password protected Office Open XML files is set to Enabled'
    section: 'Security Settings'
    description: |
        This policy setting allows for specification of an encryption type for Office Open XML files. The chosen encryption type
        must have a corresponding cryptographic service provider CSP installed on the computer that encrypts the file.
        The recommended state for this setting is                Enabled Microsoft Enhanced RSA and AES Cryptographic
        Provider,AES 256,256
        .             Note
         This policy setting does not take effect unless the registry key
        HKEYCURRENTUSER\Software\Microsoft\Office\16.0office application name\Security\Crypto\CompatMode
         is set to                0
        . By default, the                CompatMode
         value is set to                1
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Microsoft
        Enhanced RSA and AES Cryptographic Provider,AES 256,256
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Encryption type
        for password protected Office Open XML files
         Impact: Consider the needs of the organization and users when selecting an encryption method to enforce. If working for
        a government agency, contracting for a government agency, or otherwise working with very sensitive information, select a
        method that complies with policies that govern how such information is processed. Remember to ensure that the selected
        cryptographic service provider is installed on the computers of all users who need to work with password-protected
        Office Open XML files.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.14', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "openxmlencryption"'
            - name: 'openxmlencryption'
              rule: "should have_property_value('openxmlencryption', :dword, 'Microsoft Enhanced RSA and AES Cryptographic Provider,AES 256,256')"

  "2.3.27.15":
    title: '2.3.27.15 | L1 Ensure Load Controls in Forms3 is set to Enabled 4'
    section: 'Security Settings'
    description: |
        This policy setting determines how ActiveX controls in UserForms should be initialized based upon whether they are Safe
        For Initialization SFI or Unsafe for Initialization UFI. Policy setting option options for load controls in Forms3 4
          For a UFI signed control, load with the default properties of the control. For an SFI signed control, load in safe
        mode considered to be the safest mode.
        The recommended state for this setting is                Enabled 4
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: 4
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Load Controls in
        Forms3
         Impact: Disabling the policy is the equivalent to enabling it and selecting option 1, which is the default behavior and
        therefore unlikely to cause any unexpected usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.15', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\vba\security'
        - checks:
            - rule: 'should have_property "loadcontrolsinforms"'
            - name: 'loadcontrolsinforms'
              rule: "should have_property_value('loadcontrolsinforms', :dword, '4')"

  "2.3.27.16":
    title: '2.3.27.16 | L1 Ensure Macro Runtime Scan Scope is set to Enabled Enable for all documents'
    section: 'Security Settings'
    description: |
        This policy setting specifies the behavior for both the VBA and Excel 4.0 XLM runtime scan features. Multiple Office
        apps support VBA macros, but XLM macros are only supported by Excel. The VBA and XLM runtimesreport to an antivirus
        system certain highrisk code behaviors the macro is about to execute. This allows the antivirus system to indicate
        whether or not the macro behavior is malicious. If the behavior is determined to be malicious, the Office application
        closes the session and the antivirus system can quarantine the file. If the behavior is nonmalicious, the macro
        execution proceeds.
        The recommended state for this setting is                Enabled Enable for all documents
                           Note
         Macros can only be scanned if the antivirus software registers as an Antimalware Scan Interface AMSI provider on the
        device.             Note 2
         This policy setting only applies to subscription versions of Office, such as Microsoft 365 Apps for enterprise.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Enable for
        all documents
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Macro Runtime Scan
        Scope
         Impact: When macro runtime scanning is enabled, the runtime performance of affectedVBA projects and XLM sheets may be
        reduced.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.16', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "macroruntimescanscope"'
            - name: 'macroruntimescanscope'
              rule: "should have_property_value('macroruntimescanscope', :dword, '2')"

  "2.3.27.17":
    title: '2.3.27.17 | L1 Ensure Protect document metadata for password protected files is set to Enabled'
    section: 'Security Settings'
    description: |
        This policy setting determines whether metadata is encrypted when an Office Open XML file is password protected.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Protect document
        metadata for password protected files
         Impact: Enabling this setting might interfere with the functioning of tools that aggregate and display metadata
        information for Office Open XML files, but is otherwise unlikely to cause significant usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.17', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "openxmlencryptproperty"'
            - name: 'openxmlencryptproperty'
              rule: "should have_property_value('openxmlencryptproperty', :dword, '1')"

  "2.3.27.18":
    title: '2.3.27.18 | L1 Ensure Protect document metadata for rights managed Office Open XML Files is set to Enabled'
    section: 'Security Settings'
    description: |
        This policy setting determines whether metadata is encrypted in Office Open XML files that are protected by Information
        Rights Management IRM.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Protect document
        metadata for rights managed Office Open XML Files
         Impact: Enabling this setting might interfere with the functioning of tools that aggregate and display metadata
        information for Office Open XML files, but is otherwise unlikely to cause significant usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.18', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "drmencryptproperty"'
            - name: 'drmencryptproperty'
              rule: "should have_property_value('drmencryptproperty', :dword, '1')"

  "2.3.27.19":
    title: '2.3.27.19 | L1 Ensure Suppress hyperlink warnings is set to Disabled'
    section: 'Security Settings'
    description: |
        This policy setting controls whether Office applications notify users about unsafe hyperlinks. Links that Office
        considers unsafe include links to executable files, TIFF files, and Microsoft Document Imaging MDI files. Other unsafe
        links are those that use protocols considered to be unsafe such as javascript.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Security Settings\Suppress Hyperlink
        Warnings
         Impact: This setting does not alter the default configuration and therefore is unlikely to provide any usability
        concerns.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.27.19', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\security'
        - checks:
            - rule: 'should have_property "disablehyperlinkwarning"'
            - name: 'disablehyperlinkwarning'
              rule: "should have_property_value('disablehyperlinkwarning', :dword, '0')"

  "2.3.28.2":
    title: '2.3.28.2 | L1 Ensure Disable the Office client from polling the SharePoint Server for published links is set to Enabled'
    section: 'Server Settings'
    description: |
        This policy setting controls whether Office applications can poll Office servers to retrieve lists of published links.
        The recommended state for this setting is                Enabled
        .             Note
         This policy setting applies to Microsoft SharePoint Server specifically. It does not apply to Microsoft SharePoint
        Foundation.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Server Settings\Disable the Office
        client from polling the SharePoint Server for published links
         Impact: If this setting is Enabled, users will not be able to use the list of published links to open and save files
        directly from within Office applications, which could hinder the use of SharePoint Server for document collaboration.
        Note#2:
         This setting applies to Microsoft Office SharePoint Server specifically. It does not apply to Windows SharePoint
        Services (WSS).
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.28.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\portal'
        - checks:
            - rule: 'should have_property "linkpublishingdisabled"'
            - name: 'linkpublishingdisabled'
              rule: "should have_property_value('linkpublishingdisabled', :dword, '1')"

  "2.3.29.1.1":
    title: '2.3.29.1.1 | L1 Ensure Disable Internet Fax feature is set to Enabled'
    section: 'Fax'
    description: |
        This policy setting determines whether users can access the Internet Fax feature in Office applications.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Services\Fax\Disable Internet Fax
        Feature
         Impact: If the Internet Fax feature is used by the organization to send faxes, enabling this setting will cause users
        to lose this functionality. In such situations, ensure that users who need to send faxes have some other mechanism for
        doing so.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.29.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\services\fax'
        - checks:
            - rule: 'should have_property "nofax"'
            - name: 'nofax'
              rule: "should have_property_value('nofax', :dword, '1')"

  "2.3.31.1":
    title: '2.3.31.1 | L1 Ensure Legacy format signatures is set to Disabled'
    section: 'Signing'
    description: |
        This policy setting controls whether users can apply binary format digital signatures to Office 972003 documents.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Signing\Legacy format signatures
         Impact: Enabling this setting is not likely to cause significant usability issues for most Office users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.31.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\signatures'
        - checks:
            - rule: 'should have_property "enablecreationofweakxpsignatures"'
            - name: 'enablecreationofweakxpsignatures'
              rule: "should have_property_value('enablecreationofweakxpsignatures', :dword, '0')"

  "2.3.31.2":
    title: '2.3.31.2 | L1 Ensure Suppress external signature services menu item is set to Enabled'
    section: 'Signing'
    description: |
        This policy setting controls whether Outlook displays the Add Signature Services menu item.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Signing\Suppress external signature
        services menu item
         Impact: Enabling this setting prevents users from adding a signature service from Microsoft Office.com, but should not
        otherwise cause significant usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.31.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\signatures'
        - checks:
            - rule: 'should have_property "suppressextsigningsvcs"'
            - name: 'suppressextsigningsvcs'
              rule: "should have_property_value('suppressextsigningsvcs', :dword, '1')"

  "2.3.32.1":
    title: '2.3.32.1 | L1 Ensure Disable Smart Documents use of manifests is set to Enabled'
    section: 'Smart Documents (Word, Excel)'
    description: |
        This policy setting controls whether Office applications can load an XML expansion pack manifest file with a Smart
        Document. An XML expansion pack is the group of files that constitutes a Smart Document in Excel and Word. Packaging of
        one or more components provides the logic needed for a Smart Document using an XML expansion pack. These components can
        include any type of file, including XML schemas, Extensible Stylesheet Language Transforms XSLTs, dynamiclink libraries
        DLLs, and image files, as well as additional XML files, HTML files, Word files, Excel files, and text files. The key
        component to building an XML expansion pack is creating an XML expansion pack manifest file. By creating this file, the
        locations of all files that make up the XML expansion pack is specified, as well as information that instructs Office
        how to set up the files for Smart Document. The XML expansion pack can also contain information about how to set up some
        files, such as how to install and register a COM object required by the XML expansion pack.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Office 2016\Smart Documents (Word,
        Excel)\Disable Smart Document's Use of Manifests
         Impact: Enabling this setting prevents users from working with Smart Documents.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.32.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\common\smart tag'
        - checks:
            - rule: 'should have_property "neverloadmanifests"'
            - name: 'neverloadmanifests'
              rule: "should have_property_value('neverloadmanifests', :dword, '1')"

  "2.3.36.1.1":
    title: '2.3.36.1.1 | L2 Ensure Conversion Service Options is set to Enabled Do not allow to use Microsoft Conversion Service'
    section: 'Conversion Service'
    description: |
        This policy setting controls users access to the online features of Office 2016.
        The recommended state for this setting is                  Enabled Do not allow to use Microsoft Conversion Service
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Do not
        allow to use Microsoft Conversion Service
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Tools | Options | General |
        Service Options...\Online Content\Conversion Service\Conversion Service Options
         Impact: Conversion services will be unavailable.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.3.36.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\internet'
        - checks:
            - rule: 'should have_property "useconversionservices"'
            - name: 'useconversionservices'
              rule: "should have_property_value('useconversionservices', :dword, '0')"

  "2.3.36.2.1":
    title: '2.3.36.2.1 | L2 Ensure Online Content Options is set to Enabled Do not allow Office to connect to the Internet'
    section: 'Online Content'
    description: |
        This policy setting controls users access to the online features of Office.
        The recommended state for this setting is                  Enabled Do not allow Office to connect to the Internet
                              Note
         This does not apply to Office 365 Apps for Enterprise but does apply to Office 2016 and 2019. Office 365 has a separate
        set of group policies for these controls.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Do not
        allow Office to connect to the Internet
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Tools | Options | General |
        Service Options...\Online Content\Online Content Options
         Impact: Configuring this setting to "Do not allow Office to connect to the internet" will cause disruptions for users
        who are accustomed to receiving content from Microsoft Office.com within Office applications. These users will still
        have to access Microsoft Office.com using their Web browsers to obtain this content, if permitted.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.3.36.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\internet'
        - checks:
            - rule: 'should have_property "useonlinecontent"'
            - name: 'useonlinecontent'
              rule: "should have_property_value('useonlinecontent', :dword, '0')"

  "2.3.37.3.1":
    title: '2.3.37.3.1 | L1 Ensure Open Office documents as readwrite while browsing is set to Disabled'
    section: 'Files'
    description: |
        This policy setting controls whether users can edit and save Office documents on Web servers that they have opened using
        Internet Explorer.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Tools | Options | General | Web
        Options...\Files\Open Office Documents as Read/Write While Browsing
         Impact: This setting enforces the Office default configuration and therefore should have minimal impact on users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.3.37.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\internet'
        - checks:
            - rule: 'should have_property "opendocumentsreadwritewhilebrowsing"'
            - name: 'opendocumentsreadwritewhilebrowsing'
              rule: "should have_property_value('opendocumentsreadwritewhilebrowsing', :dword, '0')"

  "2.3.38.1.1":
    title: '2.3.38.1.1 | L2 Ensure Improve Proofing Tools is set to Disabled'
    section: 'Proofing Data Collection'
    description: |
        This policy setting controls whether the Help Improve Proofing Tools feature sends usage data to Microsoft. The Help
        Improve Proofing Tools feature collects data about use of the Proofing Tools, such as additions to the custom
        dictionary, and sends it to Microsoft. After about six months, the feature stops sending data to Microsoft and deletes
        the data collection file from the users computer.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Office 2016\Tools | Options |
        Spelling\Proofing Data Collection\Improve Proofing Tools
         Impact: The Customer Experience Improvement Program sends proofing tool data to Microsoft silently and without
        affecting application usage, so disabling the collection and transmission of proofing tool data is unlikely to cause
        usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.3.38.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\common\ptwatson'
        - checks:
            - rule: 'should have_property "ptwoptin"'
            - name: 'ptwoptin'
              rule: "should have_property_value('ptwoptin', :dword, '0')"

  "2.5.1.2.1":
    title: '2.5.1.2.1 | L1 Ensure Authentication with Exchange server  is set to  Enabled Kerberos Password Authentication'
    section: 'Exchange'
    description: |
        This policy setting controls which authentication method Outlook uses to authenticate with Microsoft Exchange Server.
        The recommended state for this setting is                  Enabled Kerberos Password Authentication
        .               Warning
         When connecting to Office 365, this setting must be set to                  Disabled
        .               Note
          Exchange Server supports the Kerberos authentication protocol and NTLM for authentication. The Kerberos protocol is
        the more secure authentication method and is supported on Windows 2000 Server and later versions. NTLM authentication is
        supported in preWindows 2000 environments.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled:
        Kerberos/NTLM Password Authentication
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account
        Settings\Exchange\Authentication with Exchange Server
         Impact: The recommended value for this setting in the Microsoft baselines enforces the default configuration and is
        therefore unlikely to cause significant usability issues for most users. Warning:
         Testing of this setting is necessary before deployment as it could cause interruptions in service.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "authenticationservice"'
            - name: 'authenticationservice'
              rule: "should have_property_value('authenticationservice', :dword, '16')"

  "2.5.1.2.2":
    title: '2.5.1.2.2 | L1 Ensure Do not allow users to change permissions on folders is set to Enabled'
    section: 'Exchange'
    description: |
        This policy setting prevents users from changing their mail folder permissions. If this policy setting is enabled,
        Outlook users cannot change permissions on folders the settings on the Permissions tab are disabled. Enabling this
        policy setting does not affect existing permissions, and users can still change permissions by sending a sharing
        message.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\Exchange\Do not
        allow users to change permissions on folders
         Impact: Enabling this setting prevents Outlook users from sharing folders they control with other users. Users who want
        to share folders will need to ask an administrator to make the necessary change.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\folders'
        - checks:
            - rule: 'should have_property "disableeditpermissions"'
            - name: 'disableeditpermissions'
              rule: "should have_property_value('disableeditpermissions', :dword, '1')"

  "2.5.1.2.3":
    title: '2.5.1.2.3 | L1 Ensure Enable RPC encryption is set to Enabled'
    section: 'Exchange'
    description: |
        This policy setting controls whether Outlook uses remote procedure call RPC encryption to communicate with Microsoft
        Exchange servers. If this policy setting is enabled, Outlook uses RPC encryption when communicating with an Exchange
        server.
        The recommended state for this setting is                  Enabled
        .               Note
         RPC encryption only encrypts the data from the Outlook client computer to the Exchange server. It does not encrypt the
        messages themselves as they traverse the Internet.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\Exchange\Enable
        RPC encryption
         Impact: This is the default behavior and would only impact unsupported versions of Outlook.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\rpc'
        - checks:
            - rule: 'should have_property "enablerpcencryption"'
            - name: 'enablerpcencryption'
              rule: "should have_property_value('enablerpcencryption', :dword, '1')"

  "2.5.1.5.1":
    title: '2.5.1.5.1 | L1 Ensure Automatically download attachments is set to Disabled'
    section: 'Internet Calendars'
    description: |
        This policy setting controls whether Outlook downloads files attached to Internet Calendar appointments.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\Internet
        Calendars\Automatically download attachments
         Impact: Disabling this setting enforces the default configuration in Outlook, and therefore is unlikely to cause
        usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.5.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\webcal'
        - checks:
            - rule: 'should have_property "enableattachments"'
            - name: 'enableattachments'
              rule: "should have_property_value('enableattachments', :dword, '0')"

  "2.5.1.5.2":
    title: '2.5.1.5.2 | L1 Ensure Do not include Internet Calendar integration in Outlook is set to Enabled'
    section: 'Internet Calendars'
    description: |
        This policy setting controls Internet Calendar integration in Outlook. The Internet Calendar feature in Outlook enables
        users to publish calendars online using the webcal// protocol and subscribe to calendars that others have published.
        When users subscribe to an Internet calendar, Outlook queries the calendar at regular intervals and downloads any
        changes as they are posted.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\Internet
        Calendars\Do not include Internet Calendar integration in Outlook
         Impact: Enabling this setting can cause disruptions for users who subscribe to Internet calendars from within Outlook.
        These users will have to use another method to access Internet calendar data.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.5.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\webcal'
        - checks:
            - rule: 'should have_property "disable"'
            - name: 'disable'
              rule: "should have_property_value('disable', :dword, '1')"

  "2.5.1.6.1":
    title: '2.5.1.6.1 | L1 Ensure Download full text of articles as HTML attachments is set to Disabled'
    section: 'RSS Feeds'
    description: |
        This policy setting controls whether Outlook automatically makes an offline copy of the RSS items as HTML attachments.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\RSS
        Feeds\Download full text of articles as HTML attachments
         Impact: This setting enforces the default configuration and therefore should have minimal impact on most users.
        Disabling this setting could cause minor disruptions for users who are accustomed to reading articles as HTML
        attachments within Outlook. These users will have to click the View article link to open such articles in the default
        Web browser.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.6.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\rss'
        - checks:
            - rule: 'should have_property "enablefulltexthtml"'
            - name: 'enablefulltexthtml'
              rule: "should have_property_value('enablefulltexthtml', :dword, '0')"

  "2.5.1.6.2":
    title: '2.5.1.6.2 | L1 Ensure Synchronize Outlook RSS Feeds with Common Feed List is set to Disabled'
    section: 'RSS Feeds'
    description: |
        This policy setting controls whether Outlook subscribes to the Common Feed List, which is made available to multiple RSS
        clients. The Common Feed List is a hierarchical set of RSS Feeds to which clients such as Outlook, the Feeds list in
        Internet Explorer 7, and the Feed Headlines Sidebar gadget in Windows Vista can subscribe.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\RSS
        Feeds\Synchronize Outlook RSS Feeds with Common Feed List
         Impact: Disabling this setting can cause disruptions for users who are accustomed to accessing the Common Feed List in
        Outlook. Users will still have access to the Common Feed List through Internet Explorer 7 and other client programs.
        Disabling this setting does not prevent users from maintaining a separate RSS Feeds subscriptions list in Outlook.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.6.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\rss'
        - checks:
            - rule: 'should have_property "synctosyscfl"'
            - name: 'synctosyscfl'
              rule: "should have_property_value('synctosyscfl', :dword, '0')"

  "2.5.1.6.3":
    title: '2.5.1.6.3 | L1 Ensure Turn off RSS feature is set to Enabled'
    section: 'RSS Feeds'
    description: |
        This policy setting controls the RSS aggregation feature in Outlook. Users can subscribe to RSS feeds from within
        Outlook and read RSS items like email messages.
        The recommended state for this setting is                 Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Account Settings\RSS Feeds\Turn
        Off RSS Feature
         Impact: Enabling this setting might cause some disruptions for users who are accustomed to reading RSS feeds in
        Outlook. It does not affect the performance of other RSS clients, such as Internet Explorer 7.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.1.6.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\rss'
        - checks:
            - rule: 'should have_property "disable"'
            - name: 'disable'
              rule: "should have_property_value('disable', :dword, '1')"

  "2.5.4.1":
    title: '2.5.4.1 | L1 Ensure Do not allow Home Page URL to be set in folder Properties is set to Enabled'
    section: 'Folder Home Pages for Outlook Special Folders'
    description: |
        Users can set a URL to be used as the Home Page for a folder by entering the URL on the Home Page tab on the folders
        Properties dialog box.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Folder Home Pages for Outlook
        Special Folders\Do not allow Home Page URL to be set in folder Properties
         Impact: Users will be unable to configure this option.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.4.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\webview'
        - checks:
            - rule: 'should have_property "disable"'
            - name: 'disable'
              rule: "should have_property_value('disable', :dword, '1')"

  "2.5.7.1":
    title: '2.5.7.1 | L1 Ensure Disable user entries to server list is set to Enabled Publish default disallow others'
    section: 'Meeting Workspace'
    description: |
        This policy setting controls whether Outlook users can add entries to the list of SharePoint servers when establishing a
        meeting workspace.
        The recommended state for this setting is                Enabled Publish default, disallow others
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Publish
        default, disallow others
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Meeting Workspace\Disable user
        entries to server list
         Impact: Users in the organization who have a legitimate need to use servers other than those in the published server
        list will need to obtain administrative assistance.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.7.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\meetings\profile'
        - checks:
            - rule: 'should have_property "serverui"'
            - name: 'serverui'
              rule: "should have_property_value('serverui', :dword, '2')"

  "2.5.9.2.1":
    title: '2.5.9.2.1 | L1 Ensure PST Null Data on Delete is set to Enabled'
    section: 'PST Settings'
    description: |
        This policy setting controls whether Outlook is forced to fully nullify deleted data in users Personal Folder files .pst
        at the time that the data is deleted.
        The recommended state for this setting is                  Enabled
        .               Note
         This setting does not apply to .ost files generated when Outlook is connected to either Exchange or Exchange Online.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Miscellaneous\PST Settings\PST
        Null Data on Delete
         Impact: Forensics and data recovery of objects permanently removed by a user taking action to empty their Outlook trash
        bin will be made more difficult. These will need to be recovered by another method such as a system backup.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.9.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\pst'
        - checks:
            - rule: 'should have_property "pstnullfreeondelete"'
            - name: 'pstnullfreeondelete'
              rule: "should have_property_value('pstnullfreeondelete', :dword, '1')"

  "2.5.10.4.2.2":
    title: '2.5.10.4.2.2 | L1 Ensure Plain Text Options is set to Disabled'
    section: 'Internet Formatting'
    description: |
        This policy setting controls how plain text messages are formatted when they are sent from Outlook.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook Options\Mail
        Format\Internet Formatting\Plain text options
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.4.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "message plain format mime"'
            - name: 'message plain format mime'
              rule: "should have_property_value('message plain format mime', :dword, '1')"

  "2.5.10.6.1.2":
    title: '2.5.10.6.1.2 | L1 Ensure Do not allow folders in non-default stores to be set as folder home pages is set to Enabled'
    section: 'Advanced'
    description: |
        This setting allows unblocking of folder home pages for folders in nondefault stores.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Other\Advanced\Do not allow folders in non-default stores to be set as folder home pages
         Impact: None - This is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.6.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "nondefaultstorescript"'
            - name: 'nondefaultstorescript'
              rule: "should have_property_value('nondefaultstorescript', :dword, '0')"

  "2.5.10.6.1.3":
    title: '2.5.10.6.1.3 | L1 Ensure Do not allow Outlook object model scripts to run for public folders is set to Enabled'
    section: 'Advanced'
    description: |
        This policy setting controls whether Outlook executes scripts that are associated with custom forms or folder home pages
        for public folders. By enabling this policy setting, Outlook cannot execute any scripts associated with public folders,
        overriding any configuration changes on users computers.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Other\Advanced\Do not allow Outlook object model scripts to run for public folders
         Impact: If organizations use custom forms or public folder home pages that contain scripts, enabling this setting can
        reduce their functionality or render them unusable. Consider surveying the organization's public folders for affected
        items before enabling this setting.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.6.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "publicfolderscript"'
            - name: 'publicfolderscript'
              rule: "should have_property_value('publicfolderscript', :dword, '0')"

  "2.5.10.6.1.4":
    title: '2.5.10.6.1.4 | L1 Ensure Do not allow Outlook object model scripts to run for shared folders is set to Enabled'
    section: 'Advanced'
    description: |
        This policy setting controls whether Outlook executes scripts associated with custom forms or folder home pages for
        shared folders. If this policy setting is enabled, Outlook cannot execute any scripts associated with shared folders,
        overriding any configuration changes on users computers.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Other\Advanced\Do not allow Outlook object model scripts to run for shared folders
         Impact: Enabling this setting enforces the default configuration in Outlook, and therefore is unlikely to cause
        usability issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.6.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "sharedfolderscript"'
            - name: 'sharedfolderscript'
              rule: "should have_property_value('sharedfolderscript', :dword, '0')"

  "2.5.10.6.1.5":
    title: '2.5.10.6.1.5 | L1 Ensure Use Unicode format when dragging e-mail message to file system is set to Disabled'
    section: 'Advanced'
    description: |
        This policy setting controls whether email messages dragged from Outlook to the file system are saved in Unicode or ANSI
        format.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Other\Advanced\Use Unicode format when dragging e-mail message to file system
         Impact: ANSI file encoding may limit the overall size a .msg file can reach, although a single mail item should not be
        of concern.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.6.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\general'
        - checks:
            - rule: 'should have_property "msgformat"'
            - name: 'msgformat'
              rule: "should have_property_value('msgformat', :dword, '0')"

  "2.5.10.6.3":
    title: '2.5.10.6.3 | L1 Ensure Make Outlook the default program for E-mail Contacts and Calendar is set to Enabled'
    section: 'Other'
    description: |
        This policy setting controls whether Outlook is the default program for email, contacts, and calendar services. If this
        policy setting is enabled, the Make Outlook the default program for Email, Contacts, and Calendar check box on the
        General tab of the Office Center is selected and users cannot change it.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook Options\Other\Make
        Outlook the default program for E-mail, Contacts, and Calendar
         Impact: In most environments that use the Microsoft Office system, Outlook is often already the default program for
        e-mail, contacts, and calendaring for most users. Enabling this setting is therefore unlikely to cause usability issues.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.6.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\general'
        - checks:
            - rule: 'should have_property "check default client"'
            - name: 'check default client'
              rule: "should have_property_value('check default client', :dword, '1')"

  "2.5.10.8.1.2.1":
    title: '2.5.10.8.1.2.1 | L1 Ensure Access to published calendars is set to Enabled'
    section: 'Office.com Sharing Service'
    description: |
        This policy setting determines what restrictions apply to users who publish their calendars on Office.com or thirdparty
        World Wide Web Distributed Authoring and Versioning WebDAV servers.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        :                       User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Calendar Options\Office.com Sharing Service\Access to published calendars
         Impact: Most users do not publish their calendars to be available to every user on Office.com, so the effect will
        likely be minimal.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.1.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\pubcal'
        - checks:
            - rule: 'should have_property "restrictedaccessonly"'
            - name: 'restrictedaccessonly'
              rule: "should have_property_value('restrictedaccessonly', :dword, '1')"

  "2.5.10.8.1.2.2":
    title: '2.5.10.8.1.2.2 | L1 Ensure Prevent publishing to a DAV server is set to Enabled'
    section: 'Office.com Sharing Service'
    description: |
        This policy setting controls whether Outlook users can publish their calendars to a Distributed Authoring and Versioning
        DAV server.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        :                       User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Calendar Options\Office.com Sharing Service\Prevent publishing to a DAV server
         Impact: This setting could cause disruptions for Outlook users who publish their calendar data to a DAV server. Such
        users will need to publish their calendar data to a different resource, such as the Microsoft Online Calendar Sharing
        Service, or stop publishing their calendar data.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.1.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\pubcal'
        - checks:
            - rule: 'should have_property "disabledav"'
            - name: 'disabledav'
              rule: "should have_property_value('disabledav', :dword, '1')"

  "2.5.10.8.1.2.3":
    title: '2.5.10.8.1.2.3 | L1 Ensure Prevent publishing to Office.com is set to Enabled'
    section: 'Office.com Sharing Service'
    description: |
        This policy setting controls whether Outlook users can publish their calendars to the Office.com Calendar Sharing
        Service.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        :                       User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Calendar Options\Office.com Sharing Service\Prevent publishing to Office.com
         Impact: This setting could cause disruptions for Outlook users who publish their calendar data to Microsoft Office.com.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.1.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\pubcal'
        - checks:
            - rule: 'should have_property "disableofficeonline"'
            - name: 'disableofficeonline'
              rule: "should have_property_value('disableofficeonline', :dword, '1')"

  "2.5.10.8.1.2.4":
    title: '2.5.10.8.1.2.4 | L1 Ensure Restrict level of calendar details users can publish is set to Enabled Disables Full details and Limited details'
    section: 'Office.com Sharing Service'
    description: |
        This policy setting controls the level of calendar details that Outlook users can publish to the Microsoft Outlook
        Calendar Sharing Service.
        The recommended state for this setting is                      Enabled Disables Full details and Limited details
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Disables 'Full details' and 'Limited details'
        :                       User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Calendar Options\Office.com Sharing Service\Restrict level of calendar details users can publish
         Impact: This setting could cause disruptions for Outlook users who rely on the ability to publish details of their
        appointments to the Microsoft Office Outlook Calendar Sharing Service. These users will have to communicate appointment
        details to outside parties by other means.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.1.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\pubcal'
        - checks:
            - rule: 'should have_property "publishcalendardetailspolicy"'
            - name: 'publishcalendardetailspolicy'
              rule: "should have_property_value('publishcalendardetailspolicy', :dword, '16384')"

  "2.5.10.8.1.2.5":
    title: '2.5.10.8.1.2.5 | L1 Ensure Restrict upload method is set to Enabled'
    section: 'Office.com Sharing Service'
    description: |
        This policy setting controls whether Outlook can automatically upload calendar updates to Office.com.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        :                       User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Calendar Options\Office.com Sharing Service\Restrict upload method
         Impact: This setting could cause disruptions for users who publish their calendars to the Microsoft Office Outlook
        Calendar Sharing Service. These users will have to use the Single Upload option to manually update their calendars. If
        users do not publish regularly, their online calendars could become significantly out of date.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.1.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\pubcal'
        - checks:
            - rule: 'should have_property "singleuploadonly"'
            - name: 'singleuploadonly'
              rule: "should have_property_value('singleuploadonly', :dword, '1')"

  "2.5.10.8.3.1":
    title: '2.5.10.8.3.1 | L2 Ensure Read e-mail as plain text is set to Enabled'
    section: 'E-mail Options'
    description: |
        This policy setting determines whether Outlook renders all email messages in plain text format for reading. Outlook can
        display email messages and other items in three formats plain text, Rich Text Format RTF, and HTML. If this policy is
        enabled, the Read all standard mail in plain text check box option is selected in the Email Security section of the
        Trust Center and users cannot change it.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\E-mail Options\Read e-mail as plain text
         Impact: Enabling this setting forces Outlook to display all messages in plain text, which could cause disruptions for
        users who receive messages in HTML or RTF formats. Inline graphics in the messages will not display, and the text of
        formatted messages might become distorted or illegible.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.5.10.8.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "readasplain"'
            - name: 'readasplain'
              rule: "should have_property_value('readasplain', :dword, '1')"

  "2.5.10.8.3.2":
    title: '2.5.10.8.3.2 | L2 Ensure Read signed e-mail as plain text is set to Enabled'
    section: 'E-mail Options'
    description: |
        This policy setting determines whether Outlook renders all digitally signed email in plain text format for reading.
        Outlook can display email messages and other items in three formats plain text, Rich Text Format RTF, and HTML. If you
        enable this policy setting, the Read all standard mail in plain text check box option is selected in the Email Security
        section of the Trust Center and users cannot change it.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\E-mail Options\Read signed e-mail as plain text
         Impact: Enabling this setting forces Outlook to display signed messages in plain text, which could cause disruptions
        for users who receive signed messages in HTML or RTF formats. Inline graphics in the messages will not display, and the
        text of formatted messages might become distorted or illegible.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.5.10.8.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "readsignedasplain"'
            - name: 'readsignedasplain'
              rule: "should have_property_value('readsignedasplain', :dword, '1')"

  "2.5.10.8.4.1":
    title: '2.5.10.8.4.1 | L1 Ensure Add e-mail recipients to users Safe Senders Lists is set to Disabled'
    section: 'Junk E-mail'
    description: |
        This policy setting controls whether recipients email addresses are automatically added to the users Safe Senders List
        in Microsoft Outlook.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Junk E-mail\Add e-mail recipients to users' Safe Senders Lists
         Impact: In most situations, modifying this setting will have minimal effect on usability. However, if users send e-mail
        messages to many recipients, manually adding the recipients to a Safe Senders List might affect productivity. In such
        situations, administrators can choose to enable the setting for some groups of users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.4.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "junkmailtrustoutgoingrecipients"'
            - name: 'junkmailtrustoutgoingrecipients'
              rule: "should have_property_value('junkmailtrustoutgoingrecipients', :dword, '0')"

  "2.5.10.8.4.2":
    title: '2.5.10.8.4.2 | L1 Ensure Hide Junk Mail UI is set to Disabled'
    section: 'Junk E-mail'
    description: |
        This policy setting controls whether the Junk Email Filter is enabled in Outlook.
        The recommended state for this setting is                    Disabled
        .                 Note
         This policy setting does not affect the configuration of the Microsoft Exchange Server Intelligent Message Filter IMF,
        which provides serverlevel junk email filtering.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Junk E-mail\Hide Junk Mail UI
         Impact: This setting enforces the default and should have no impact to users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.4.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook'
        - checks:
            - rule: 'should have_property "disableantispam"'
            - name: 'disableantispam'
              rule: "should have_property_value('disableantispam', :dword, '0')"

  "2.5.10.8.4.3":
    title: '2.5.10.8.4.3 | L1 Ensure Junk E-mail protection level is set to Enabled High'
    section: 'Junk E-mail'
    description: |
        This policy setting controls your Junk Email protection level.
        By selecting the                    High
         option, Outlook intercepts most junk email, but might incorrectly classify some legitimate messages as junk. Users are
        advised to check their Junk Email folders often.
        The recommended state for this setting is                    Enabled High
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        :                        High
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Junk E-mail\Junk E-mail protection level
         Impact:
        Users may experience more false positives when this is set to                          High
        , requiring them to check their Junk e-mail folder more often.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.4.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "junkmailprotection"'
            - name: 'junkmailprotection'
              rule: "should have_property_value('junkmailprotection', :dword, '3')"

  "2.5.10.8.4.4":
    title: '2.5.10.8.4.4 | L1 Ensure Trust e-mail from contacts is set to Disabled'
    section: 'Junk E-mail'
    description: |
        This policy setting controls whether Outlook analyzes email from users Contacts when filtering junk email.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook
        Options\Preferences\Junk E-mail\Trust e-mail from contacts
         Impact: When disabled, users may find the e-mail from a contact could end up in the junk e-mail box depending on the
        contents of the e-mail. Outlook users will need to check this folder more often as to not miss something, but this will
        allow for more scrutiny and less trust of said e-mails.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.10.8.4.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "junkmailtrustcontacts"'
            - name: 'junkmailtrustcontacts'
              rule: "should have_property_value('junkmailtrustcontacts', :dword, '0')"

  "2.5.10.11":
    title: '2.5.10.11 | L2 Ensure Internet and network paths into hyperlinks is set to Disabled'
    section: 'Outlook Options'
    description: |
        This policy setting specifies whether Outlook automatically turns text that represents Internet and network paths into
        hyperlinks. This option can also be configured by selecting the Internet and network paths with hyperlinks check box
        that is available on the Outlook.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook Options\Internet and
        Network Paths into Hyperlinks
         Impact: Users will not be able to click on hyperlinks for Internet and network paths. Instead they will need to
        manually copy and paste the URL or path.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.5.10.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\autoformat'
        - checks:
            - rule: 'should have_property "pgrfafo_25_1"'
            - name: 'pgrfafo_25_1'
              rule: "should have_property_value('pgrfafo_25_1', :dword, '0')"

  "2.5.11.1":
    title: '2.5.11.1 | L1 Ensure Turn off Outlook Social Connector is set to Enabled'
    section: 'Outlook Social Connector'
    description: |
        This policy setting allows the configuration of the Outlook Social Connector. The Outlook Social Connector allows users
        to work in Outlook while staying up to date on the status and activities of their friends and contacts, whether theyre
        from an organization, or from social networking sites on the Internet, like Facebook and LinkedIn.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Outlook Social Connector\Turn off
        Outlook Social Connector
         Impact: The Outlook Social Connector will be disabled preventing users from synchronizing data in Outlook with their
        social media networks.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.11.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\outlook\socialconnector'
        - checks:
            - rule: 'should have_property "runosc"'
            - name: 'runosc'
              rule: "should have_property_value('runosc', :dword, '0')"

  "2.5.14.1.1":
    title: '2.5.14.1.1 | L1 Ensure Automatically download content for e-mail from people in Safe Senders and Safe Recipients Lists is set to Disabled'
    section: 'Automatic Picture Download Settings'
    description: |
        This policy setting controls whether Outlook automatically downloads external content in emails from senders in the Safe
        Senders List or Safe Recipients List.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Automatic Picture
        Download Settings\Automatically download content for e-mail from people in Safe Senders and Safe Recipients Lists
         Impact: Outlook will not automatically download external content for messages sent by people listed in user's Safe
        Senders Lists or Safe Recipients Lists. This will cause users to have to download content for each message individually.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "unblockspecificsenders"'
            - name: 'unblockspecificsenders'
              rule: "should have_property_value('unblockspecificsenders', :dword, '0')"

  "2.5.14.1.2":
    title: '2.5.14.1.2 | L1 Ensure Block Trusted Zones is set to Enabled'
    section: 'Automatic Picture Download Settings'
    description: |
        This policy setting controls whether pictures from sites in the Trusted Sites security zone are automatically downloaded
        in Outlook email messages and other items.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Automatic Picture
        Download Settings\Block Trusted Zones
         Impact: Outlook will not automatically download external content for messages sent by people listed in user's Safe
        Senders Lists or Safe Recipients Lists. This will cause users to have to download content for each message individually.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "trustedzone"'
            - name: 'trustedzone'
              rule: "should have_property_value('trustedzone', :dword, '0')"

  "2.5.14.1.3":
    title: '2.5.14.1.3 | L1 Ensure Display pictures and external content in HTML e-mail is set to Enabled'
    section: 'Automatic Picture Download Settings'
    description: |
        This policy setting controls whether Outlook downloads untrusted pictures and external content located in HTML email
        messages without users explicitly choosing to download them.
        The recommended state for this setting is                  Enabled
        .               Note
         If Outlooks default blocking configuration is overridden, in the Trust Center or by some other method, Outlook will
        display external content in all HTML email messages, including any that include Web beacons.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Automatic Picture
        Download Settings\Display pictures and external content in HTML e-mail
         Impact: None - This is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "blockextcontent"'
            - name: 'blockextcontent'
              rule: "should have_property_value('blockextcontent', :dword, '1')"

  "2.5.14.1.4":
    title: '2.5.14.1.4 | L1 Ensure Do not permit download of content from safe zones is set to Disabled'
    section: 'Automatic Picture Download Settings'
    description: |
        This policy setting controls whether Outlook automatically downloads content from safe zones when displaying messages.
        The recommended state for this setting is                  Disabled
        .               Note
         This policy setting is                  backwards
        . Despite the name,                  disabling
         this policy setting prevents the download of content from safe zones and enabling the policy setting allows it.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Automatic Picture
        Download Settings\Do not permit download of content from safe zones
         Impact: Users with e-mail messages that include content from safe zones will be required to download content for each
        message individually.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "unblocksafezone"'
            - name: 'unblocksafezone'
              rule: "should have_property_value('unblocksafezone', :dword, '1')"

  "2.5.14.1.5":
    title: '2.5.14.1.5 | L1 Ensure Include Internet in Safe Zones for Automatic Picture Download is set to Disabled'
    section: 'Automatic Picture Download Settings'
    description: |
        This policy setting controls whether pictures and external content in HTML email messages from untrusted senders on the
        Internet are downloaded without Outlook users explicitly choosing to do so. When Disabled, Outlook does not consider the
        Internet a safe zone, which means that Outlook will not automatically download content from external servers unless the
        sender is included in the Safe Senders list. Recipients can choose to download external content from untrusted senders
        on a messagebymessage basis.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :
        User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Automatic Picture Download Settings\Include
        Internet in Safe Zones for Automatic Picture Download
                                    Impact: None - this is the default behavor.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "internet"'
            - name: 'internet'
              rule: "should have_property_value('internet', :dword, '0')"

  "2.5.14.2.1.1":
    title: '2.5.14.2.1.1 | L1 Ensure Attachment Secure Temporary Folder is set to Disabled'
    section: 'Signature Status Dialog Box'
    description: |
        This policy setting allows administrators to specify a folder path for the Secure Temporary Files  rather than using the
        one that is randomly generated by Outlook.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Status dialog box\Attachment Secure Temporary Folder
         Impact: None - This enforces the default.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_CURRENT_USER\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should_not have_property "outlooksecuretempfolder"'

  "2.5.14.2.1.2":
    title: '2.5.14.2.1.2 | L1 Ensure Missing CRLs is set to Enabled Error'
    section: 'Signature Status Dialog Box'
    description: |
        This policy setting controls whether Outlook considers a missing certificate revocation list CRL a warning or an error.
        Digital certificates contain an attribute that shows where the corresponding CRL is located. CRLs contain lists of
        digital certificates that have been revoked by their controlling certification authorities CAs, typically because the
        certificates were issued improperly, or their associated private keys were compromised.
        The recommended state for this setting is                    Enabled Error
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Error
        .                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Status dialog box\Missing CRLs
         Impact: Users will be prevented from using certificates when the appropriate CRL is not available to verify them. This
        could  increase desktop support requests.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "sigstatusnocrl"'
            - name: 'sigstatusnocrl'
              rule: "should have_property_value('sigstatusnocrl', :dword, '1')"

  "2.5.14.2.1.3":
    title: '2.5.14.2.1.3 | L1 Ensure Missing Root Certificates is set to Enabled Error'
    section: 'Signature Status Dialog Box'
    description: |
        This policy setting controls how Outlook functions when a root certificate is missing. Outlook will display either an
        error or warning based on the status of the root certificate.
        The recommended state for this setting is                    Enabled Error
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Error
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Status dialog box\Missing root certificates
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "sigstatusnotrustdecision"'
            - name: 'sigstatusnotrustdecision'
              rule: "should have_property_value('sigstatusnotrustdecision', :dword, '2')"

  "2.5.14.2.1.4":
    title: '2.5.14.2.1.4 | L1 Ensure Promote Level 2 errors as errors not warnings is set to Disabled'
    section: 'Signature Status Dialog Box'
    description: |
        This policy setting allows the configuration of Level 2 errors as warnings instead of errors. Level 2 errors occur when
        the message signature appears to be valid, but there are other issues with the signature.
        The recommended state for this setting is                    Disabled
        .                 Note
         Potential Level 2 error conditions include the following                 Unknown Signature Algorithm No Signing
        Certification Found Bad Attribute Sets No Issuer Certificate found No CRL Found Outofdate CRL Root Trust Problem
        Outofdate CTL Note 2
         The title of the Group Policy text is slightly misleading.                    Promote Level 2 errors as errors, not
        warnings
         should actually read                    Promote Level 2 errors as warnings, not errors
         which would align more closely with the description of the various states Enable/Disable.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Status dialog box\Promote Level 2 errors as errors, not warnings
         Impact: Disabling this setting can cause disruptions for users who work with digital certificates in Outlook. These
        users may experience an increased number of errors that prevent them from working effectively with e-mail, which could
        increase desktop support requests.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promoteerrorsaswarnings"'
            - name: 'promoteerrorsaswarnings'
              rule: "should have_property_value('promoteerrorsaswarnings', :dword, '0')"

  "2.5.14.2.1.5":
    title: '2.5.14.2.1.5 | L1 Ensure Retrieving CRLs Certificate Revocation Lists is set to Enabled When online always retrieve the CRL'
    section: 'Signature Status Dialog Box'
    description: |
        This policy setting controls how Outlook retrieves Certificate Revocation Lists CRLs to verify the validity of
        certificates. CRLs are lists of digital certificates that have been revoked by their controlling Certificate Authority
        CAs, typically because the certificates were issued improperly or their associated private keys were compromised.
        The recommended state for this setting is                    Enabled When online always retrieve the CRL
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: When
        online always retrieve the CRL
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Status dialog box\Retrieving CRLs (Certificate Revocation Lists)
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "usecrlchasing"'
            - name: 'usecrlchasing'
              rule: "should have_property_value('usecrlchasing', :dword, '1')"

  "2.5.14.2.2":
    title: '2.5.14.2.2 | L1 Ensure Do not display Publish to GAL button is set to Enabled'
    section: 'Cryptography'
    description: |
        This policy setting controls whether Outlook users can publish email certificates to the Global Address List GAL. The
        GAL contains information for all email users, distribution groups, and Exchange resources.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Do not
        display 'Publish to GAL' button
         Impact: Only Administrators will be able to publish a new or updated certificate to the GAL.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "publishtogaldisabled"'
            - name: 'publishtogaldisabled'
              rule: "should have_property_value('publishtogaldisabled', :dword, '1')"

  "2.5.14.2.3":
    title: '2.5.14.2.3 | L1 Ensure Do not provide Continue option on Encryption warning dialog boxes is set to Enabled'
    section: 'Cryptography'
    description: |
        This setting controls whether Outlook users are allowed to send email messages after they see an encryption warning
        dialog.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Do not
        provide Continue option on Encryption warning dialog boxes
         Impact: Enabling this setting can cause disruptions if Outlook users attempt to send messages with encryption errors,
        although the errors themselves would likely cause disruptions in most cases if the messages were allowed to be sent.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "disablecontinueencryption"'
            - name: 'disablecontinueencryption'
              rule: "should have_property_value('disablecontinueencryption', :dword, '1')"

  "2.5.14.2.4":
    title: '2.5.14.2.4 | L1 Ensure Message Formats is set to Enabled SMIME'
    section: 'Cryptography'
    description: |
        This policy setting controls which message encryption formats Outlook can use. Outlook supports three formats for
        encrypting and signing messages S/MIME, Exchange, and Fortezza.
        The recommended state for this setting is                  Enabled S/MIME
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: S/MIME
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Message
        Formats
         Impact: None - This is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "msgformats"'
            - name: 'msgformats'
              rule: "should have_property_value('msgformats', :dword, '1')"

  "2.5.14.2.5":
    title: '2.5.14.2.5 | L1 Ensure Minimum encryption settings is set to Enabled 256'
    section: 'Cryptography'
    description: |
        This policy setting allows the configuration of the minimum cryptographic key length for encrypting email messages.
        The recommended state for this setting is                  Enabled 256
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: 256
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Minimum
        encryption settings
         Impact: Users who see the minimum encryption warning display can still choose to send the message with the selected
        key, so little to no impact is expected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "minenckey"'
            - name: 'minenckey'
              rule: "should have_property_value('minenckey', :dword, '256')"

  "2.5.14.2.6":
    title: '2.5.14.2.6 | L1 Ensure SMIME interoperability with external clients is set to Enabled Handle internally'
    section: 'Cryptography'
    description: |
        This policy setting controls whether Outlook decodes encrypted messages itself or passes them to an external program for
        processing.
        If the option                  Handle internally
         is selected, Outlook decrypts all S/MIME messages itself.
        The recommended state for this setting is                  Enabled Handle internally
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Handle
        internally
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\S/MIME
        interoperability with external clients
         Impact:
        The recommended configuration for this setting is                        Handle internally
        , which enforces the default configuration in Outlook and is unlikely to cause usability issues for most users.
        In some situations, administrators might wish to use an external program, such as an add-in, to handle S/MIME message
        decryption. If a designated external program needed to handle S/MIME messages, an exception to this recommendation must
        be made.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "externalsmime"'
            - name: 'externalsmime'
              rule: "should have_property_value('externalsmime', :dword, '0')"

  "2.5.14.2.7":
    title: '2.5.14.2.7 | L1 Ensure Signature Warning is set to Enabled Always warn about invalid signatures'
    section: 'Cryptography'
    description: |
        This policy setting controls how Outlook warns users about messages with invalid digital signatures.
        The recommended state for this setting is                  Enabled Always warn about invalid signatures
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Always
        warn about invalid signatures
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Cryptography\Signature
        Warning
         Impact: None - This is the default behavior. Enabling this setting could cause some disruptions for Outlook users who
        receive a lot of e-mail messages signed with invalid signatures. These users will see a warning dialog box every time
        they open a signed e-mail message.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.2.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "warnaboutinvalid"'
            - name: 'warnaboutinvalid'
              rule: "should have_property_value('warnaboutinvalid', :dword, '1')"

  "2.5.14.3.1.1":
    title: '2.5.14.3.1.1 | L1 Ensure Allow users to demote attachments to Level 2 is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls whether Outlook users can demote attachments to Level 2 by using a registry key, which will
        allow them to save files to disk and open them from that location. Outlook uses two levels of security to restrict
        access to files attached to email messages or other items. Files with specific extensions can be categorized as Level 1
        users cannot view the file or Level 2 users can open the file after saving it to disk. Users can freely open files of
        types that are not categorized as Level 1 or Level 2.
        The recommended state for this setting is                    Disabled
        .                 Note
         If this policy is enabled, users can create a list of Level 1 file types to demote to Level 2 by adding the file types
        to the                    HKEYCURRENTUSER\Software\Microsoft\Office\16.0\Outlook\Security\Level1Remove
         registry key.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Allow users to demote attachments to Level 2
         Impact: Users will not be able to demote a Level 1 file to a Level 2 file.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "allowuserstolowerattachments"'
            - name: 'allowuserstolowerattachments'
              rule: "should have_property_value('allowuserstolowerattachments', :dword, '0')"

  "2.5.14.3.1.2":
    title: '2.5.14.3.1.2 | L1 Ensure Display Level 1 attachments is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls whether Outlook blocks potentially dangerous attachments designated Level 1. To protect
        users from viruses and other harmful files, Outlook uses two levels of security, designated Level 1 and Level 2, to
        restrict access to files attached to email messages or other items. Potentially harmful files can be classified into
        these two levels by file type extension, with all other file types considered safe.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Display Level 1 attachments
         Impact:
        See                          attachment file types restricted by Office
         for the full list of file types classified Level 1 by default.                       Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark in Section 2.5.14.3.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "showlevel1attach"'
            - name: 'showlevel1attach'
              rule: "should have_property_value('showlevel1attach', :dword, '0')"

  "2.5.14.3.1.3":
    title: '2.5.14.3.1.3 | L1 Ensure Do not prompt about Level 1 attachments when closing an item is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls whether Outlook displays a warning before closing an item that contains an unsafe
        attachment that will be blocked when the item is reopened.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Do not prompt about Level 1 attachments when closing an item
         Impact: None - this is the default behavior. Important:
         For this setting to apply, the Outlook Security Mode setting must be enabled in                          User
        Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark in Section 2.5.14.3.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "dontpromptlevel1attachclose"'
            - name: 'dontpromptlevel1attachclose'
              rule: "should have_property_value('dontpromptlevel1attachclose', :dword, '0')"

  "2.5.14.3.1.4":
    title: '2.5.14.3.1.4 | L1 Ensure Do not prompt about Level 1 attachments when sending an item is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls whether Outlook displays a warning before sending an item that contains an unsafe
        attachment that will be blocked when the item is opened by a recipient.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Do not prompt about Level 1 attachments when sending an item
         Impact: None - this is the default behavior. Important:
         For this setting to apply, the Outlook Security Mode setting must be enabled in                          User
        Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "dontpromptlevel1attachsend"'
            - name: 'dontpromptlevel1attachsend'
              rule: "should have_property_value('dontpromptlevel1attachsend', :dword, '0')"

  "2.5.14.3.1.5":
    title: '2.5.14.3.1.5 | L1 Ensure Remove file extensions blocked as Level 1 is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls which types of attachments determined by file extension Outlook prevents from being
        delivered. Outlook uses two levels of security to restrict users access to files attached to email messages or other
        items. Files with specific extensions can be categorized as Level 1 users cannot view the file or Level 2 users can open
        the file after saving it to disk. Users can freely open files of types that are not categorized as Level 1 or Level 2.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Remove file extensions blocked as Level 1
         Impact: Any extensions that are already on the list will be ignored, which means that Outlook will block access to them
        again. This configuration could cause disruptions for users who are accustomed to sending and receiving such files.
        Important:
         For this setting to apply, the Outlook Security Mode setting must be enabled in                          User
        Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should_not have_property "fileextensionsremovelevel1"'

  "2.5.14.3.1.6":
    title: '2.5.14.3.1.6 | L1 Ensure Remove file extensions blocked as Level 2 is set to Disabled'
    section: 'Attachment Security'
    description: |
        This policy setting controls which types of attachments determined by file extension must be saved to disk before users
        can open them. Files with specific extensions can be categorized as Level 1 users cannot view the file or Level 2 users
        can open the file after saving it to disk. Users can freely open files of types that are not categorized as Level 1 or
        Level 2.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Attachment Security\Remove file extensions blocked as Level 2
         Impact: Disabling this setting enforces the default configuration, and is therefore unlikely to cause usability issues
        for most users. Important:
         For this setting to apply, the Outlook Security Mode setting must be enabled in                          User
        Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark in Section 2.5.14.3.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.1.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_CURRENT_USER\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should_not have_property "fileextensionsremovelevel2"'

  "2.5.14.3.2.1":
    title: '2.5.14.3.2.1 | L1 Ensure Allow scripts in one-off Outlook forms is set to Disabled'
    section: 'Custom Form Security'
    description: |
        This policy setting controls whether scripts can run in Outlook forms in which the script and layout are contained
        within the message.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Disabled
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Custom Form Security\Allow scripts in one-off Outlook forms
         Impact: None - this is the default behavior.  Unless users have a legitimate business need for such functionality, this
        setting should be disabled. Important:
         For this setting to apply, the Outlook Security Mode setting must be enabled in                          User
        Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security
         with                          Use Outlook Security Group Policy
         selected, as set in this benchmark in Section 2.5.14.3.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "enableoneoffformscripts"'
            - name: 'enableoneoffformscripts'
              rule: "should have_property_value('enableoneoffformscripts', :dword, '0')"

  "2.5.14.3.2.2":
    title: '2.5.14.3.2.2 | L1 Ensure Set Outlook object model custom actions execution prompt is set to Enabled Automatically Deny'
    section: 'Custom Form Security'
    description: |
        This policy setting controls whether Outlook prompts users before executing a custom action. Custom actions add
        functionality to Outlook that can be triggered as part of a rule. Among other possible features, custom actions can be
        created that reply to messages in ways that circumvent the Outlook models programmatic send protections.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Custom Form Security\Set Outlook object model custom actions execution prompt
         Impact:
        Configuring this setting to                          Automatically Deny
         prevents Outlook from executing any custom actions that use the Outlook object model. Users will not be able to utilize
        this function.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoomcustomaction"'
            - name: 'promptoomcustomaction'
              rule: "should have_property_value('promptoomcustomaction', :dword, '0')"

  "2.5.14.3.3.2":
    title: '2.5.14.3.3.2 | L1 Ensure Configure Outlook object model prompt when accessing an address book is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when an untrusted program attempts to gain access to an Address Book using the
        Outlook object model. The Outlook object model includes entry points to access Outlook data, save data to specified
        locations, and send emails.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt when accessing an address book
         Impact: Untrusted programs will not be able to gain access to the Address Book using the Outlook object model.
        Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.                       If
        Group Policy security settings are used for Outlook, the Programmatic Access section of the Trust Center is not used. In
        this situation, the default is to prompt users based on computer security, which is the equivalent of the Only when
        antivirus software is out of date or not running option in the Trust Center, and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoomaddressinformationaccess"'
            - name: 'promptoomaddressinformationaccess'
              rule: "should have_property_value('promptoomaddressinformationaccess', :dword, '0')"

  "2.5.14.3.3.3":
    title: '2.5.14.3.3.3 | L1 Ensure Configure Outlook object model prompt When accessing the Formula property of a UserProperty object is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when a user designs a custom form in Outlook and attempts to bind an Address
        Information field to a combination or formula custom field. The Outlook object model includes entry points to access
        Outlook data, save data to specified locations, and send emails.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt When accessing the Formula property of a
        UserProperty object
         Impact: Users will not be able to controls what happens when a custom form in Outlook is created and will not be able
        to bind an Address Information field to a combination or formula custom field. Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.
        If Group Policy security settings are used for Outlook, the                          Programmatic Access
         section of the Trust Center is not used. In this situation, the default is to prompt users based on computer security,
        which is the equivalent of the                          Only when antivirus software is out of date or not running
         option in the Trust Center, and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoommeetingtaskrequestresponse"'
            - name: 'promptoommeetingtaskrequestresponse'
              rule: "should have_property_value('promptoommeetingtaskrequestresponse', :dword, '0')"

  "2.5.14.3.3.4":
    title: '2.5.14.3.3.4 | L1 Ensure Configure Outlook object model prompt when executing Save As is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when an untrusted program attempts to use the Save As command to
        programmatically save an item.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                         Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt when executing Save As
         Impact: Untrusted programs will not be able to use the Save As command to programmatically save an item. Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.
        If Group Policy security settings are used for Outlook, the                          Programmatic Access
         section of the Trust Center is not used. In this situation, the default is to prompt users based on computer security,
        which is the equivalent of the                          Only when antivirus software is out of date or not running
         option in the Trust Center, and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoomsaveas"'
            - name: 'promptoomsaveas'
              rule: "should have_property_value('promptoomsaveas', :dword, '0')"

  "2.5.14.3.3.5":
    title: '2.5.14.3.3.5 | L1 Ensure Configure Outlook object model prompt when reading address information is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when an untrusted program attempts to gain access to a recipient field, such
        as the                    To
         field, using the Outlook object model.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt when reading address information
         Impact:
        Untrusted programs will not be able to gain access to a recipient field, such as the                          To:
         field, using the Outlook object model.                       Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.
        If Group Policy security settings are used for Outlook, the                          Programmatic Access
         section of the Trust Center is not used. In this situation, the default is to prompt users based on computer security,
        which is the equivalent of the                          Only when antivirus software is out of date or not running
         option in the Trust Center, and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoomaddressinformationaccess"'
            - name: 'promptoomaddressinformationaccess'
              rule: "should have_property_value('promptoomaddressinformationaccess', :dword, '0')"

  "2.5.14.3.3.6":
    title: '2.5.14.3.3.6 | L1 Ensure Configure Outlook object model prompt when responding to meeting and task requests is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when an untrusted program attempts to programmatically send an email in
        Outlook using the Response method of a task or meeting request.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt when responding to meeting and task
        requests\Configure Outlook object model prompt when responding to meeting and task requests
         Impact: Untrusted programs will not be able to programmatically send an e-mail in Outlook using the Response method of
        a task or meeting request. Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.
        If Group Policy security settings are used for Outlook, the                          Programmatic Access
         section of the Trust Center is not used. In this situation, the default is to prompt users based on computer security,
        which is the equivalent of the Only when antivirus software is out of date or not running option in the Trust Center,
        and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoommeetingtaskrequestresponse"'
            - name: 'promptoommeetingtaskrequestresponse'
              rule: "should have_property_value('promptoommeetingtaskrequestresponse', :dword, '0')"

  "2.5.14.3.3.7":
    title: '2.5.14.3.3.7 | L1 Ensure Configure Outlook object model prompt when sending mail is set to Enabled Automatically Deny'
    section: 'Programmatic Security'
    description: |
        This policy setting controls what happens when an untrusted program attempts to send email programmatically using the
        Outlook object model.
        When the option                    Automatically deny
         is selected, Outlook will automatically deny programmatic access requests from any program.
        The recommended state for this setting is                    Enabled Automatically Deny
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled:
        Automatically Deny
        :                     User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Programmatic Security\Configure Outlook object model prompt when sending mail
         Impact: An untrusted program will not be able to send e-mail programmatically using the Outlook object model.
        Important:
         For this setting to apply, the                          Outlook Security Mode
         setting must be enabled in                          User Configuration\Administrative Templates\Microsoft Outlook
        2016\Security\Security
         with Use Outlook Security Group Policy selected, as set in this benchmark in Section 2.5.14.3.
        If Group Policy security settings are used for Outlook, the                          Programmatic Access
         section of the Trust Center is not used. In this situation, the default is to prompt users based on computer security,
        which is the equivalent of the Only when antivirus software is out of date or not running option in the Trust Center,
        and the user experience is not affected.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.3.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "promptoomsend"'
            - name: 'promptoomsend'
              rule: "should have_property_value('promptoomsend', :dword, '0')"

  "2.5.14.3.4":
    title: '2.5.14.3.4 | L1 Ensure Outlook Security Mode is set to Enabled Use Outlook Security Group Policy'
    section: 'Security Form Settings'
    description: |
        This policy setting controls which set of security settings are enforced in Outlook.
        When the option                  Use Outlook Security Group Policy
         is selected, Outlook uses security settings from Group Policy.
        The recommended state for this setting is                  Enabled Use Outlook Security Group Policy
        .               Note
         This setting must be enabled if other Outlook security policy settings mentioned in this guide are applied.
        Note 2
         In previous versions of Outlook, when security settings were published in a form in Exchange Server public folders,
        users who needed these settings required the
        HKEYCURRENTUSER\Software\Policies\Microsoft\SecurityCheckAdminSettings
         registry key to be set on their computers for the settings to apply. In Outlook, the
        CheckAdminSettings
         registry key is no longer used to determine users security settings. Instead, the Outlook Security Mode setting can be
        used to determine whether Outlook security should be controlled directly by Group Policy, by the security form from the
        Outlook Security Settings Public Folder, or by the settings on users own computers.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Use
        Outlook Security Group Policy
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Security Form
        Settings\Outlook Security Mode
         Impact: Enabling this setting prevents users from modifying their own security settings, so it might cause an increase
        in support calls.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.3.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "adminsecuritymode"'
            - name: 'adminsecuritymode'
              rule: "should have_property_value('adminsecuritymode', :dword, '3')"

  "2.5.14.4.1":
    title: '2.5.14.4.1 | L1 Ensure Allow hyperlinks in suspected phishing e-mail messages is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether hyperlinks in suspected phishing email messages in Outlook are allowed. By default,
        Outlook handles suspicious messages in two ways If the Junk Email Filter does not consider a message to be spam but does
        consider it to be phishing, the message    is left in the Inbox but any links in the message are disabled and users
        cannot use the Reply and Reply All   functionality. In addition, any attachments in the suspicious message are blocked.
        If the Junk Email Filter considers the message to be both spam and phishing, the message is automatically sent to    the
        Junk Email folder. Any message sent to the Junk Email folder is converted to plain text format and all links    are
        disabled. In addition, the Reply and Reply All functionality is disabled and any attachments in the message are
        blocked. The InfoBar alerts users to this change in functionality. If users are certain that a message is legitimate,
        they can click the InfoBar and enable the links in the message. Users can change the way Outlook handles phishing
        messages in the Junk Email Options dialog box by clearing the Disable links and other functionality in phishing messages
        Recommended check box. If this check box is cleared, Outlook will not disable links in suspected phishing messages
        unless they are classified as junk email, which could allow users to disclose confidential information to malicious Web
        sites.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Trust Center\Allow
        hyperlinks in suspected phishing e-mail messages
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.4.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\options\mail'
        - checks:
            - rule: 'should have_property "junkmailenablelinks"'
            - name: 'junkmailenablelinks'
              rule: "should have_property_value('junkmailenablelinks', :dword, '0')"

  "2.5.14.4.2":
    title: '2.5.14.4.2 | L1 Ensure Security setting for macros is set to Enabled Warn for signed disable unsigned'
    section: 'Trust Center'
    description: |
        This policy setting controls the security level for macros in Outlook. Macros are a single instruction that expands
        automatically into a set of instructions to perform a particular task. Available Policy Options Always warn
          This option corresponds to the Warnings for all macros option in the Macro Security section of    the Outlook Trust
        Center. Outlook disables all macros that are not opened from a trusted location, even if the    macros are signed by a
        trusted publisher. For each disabled macro, Outlook displays a security alert dialog box    with information about the
        macro and its digital signature if present, and allows users to enable the macro or    leave it disabled.
        Never warn, disable all
          This option corresponds to the No warnings and disable all macros option in the Trust    Center. Outlook disables all
        macros that are not opened from trusted locations, and does not notify users.               Warning for signed, disable
        unsigned
          This option corresponds to the Warnings for signed macros all unsigned    macros are disabled option in the Trust
        Center. Outlook handles macros as follows               If a macro is digitally signed by a trusted publisher, the macro
        can run if the user has already trusted the
        publisher. If a macro has a valid signature from a publisher that the user has not trusted, the security alert dialog
        box
        for the macro lets the user choose whether to enable the macro for the current session, disable the macro for
        the current session, or to add the publisher to the Trusted Publishers list so that it will run without
        prompting the user in the future. If a macro does not have a valid signature, Outlook disables it without prompting the
        user, unless it is
        opened from a trusted location. No security check
          This option corresponds to the No security check for macros Not recommended option in the    Trust Center. Outlook
        runs all macros without prompting users. This configuration makes users computers    vulnerable to potentially malicious
        code and is not recommended.
        The recommended state for this setting is                  Enabled Warn for signed, disable unsigned
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Warn for
        signed, disable unsigned
        :                   User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Trust Center\Security
        setting for macros
         Impact: None - this is enforcing the default behavior. Unsigned macros will be disabled.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.4.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "level"'
            - name: 'level'
              rule: "should have_property_value('level', :dword, '3')"

  "2.5.14.5":
    title: '2.5.14.5 | L1 Ensure Allow Active X One Off Forms is set to Enabled Load only Outlook Controls'
    section: 'Security'
    description: |
        This policy setting configures the use of thirdparty ActiveX controls in Outlook. This setting can can be configured so
        that Safe Controls Microsoft Forms 2.0 controls and the Outlook Recipient and Body controls are allowed in oneoff forms,
        or so that all ActiveX controls are allowed to run.
        The recommended state for this setting is                Enabled Load only Outlook Controls
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: Load only
        Outlook Controls
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Allow Active X One Off
        Forms
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "allowactivexoneoffforms"'
            - name: 'allowactivexoneoffforms'
              rule: "should have_property_value('allowactivexoneoffforms', :dword, '0')"

  "2.5.14.6":
    title: '2.5.14.6 | L1 Ensure Disable Remember password for Internet e-mail accounts is set to Enabled'
    section: 'Security'
    description: |
        This policy setting hides the users ability to cache passwords locally in the computers registry. When configured, this
        policy will hide the                Remember Password
         checkbox and not allow users to have Outlook remember their password.
        The recommended state for this setting is                Enabled
        .             Note
         POP3, IMAP, and HTTP email accounts are all considered Internet email accounts in Outlook. Email account options are
        listed on the Server Type dialog box when users choose New under Tools  Account Settings.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Disable 'Remember
        password' for Internet e-mail accounts
         Impact: Users will have to enter their email account passwords for any email services that do not accept their Windows
        credentials. Note:
         For Exchange servers that are members of the same Active Directory domain, enabling this setting should not cause users
        to be prompted for their credentials since Exchange will accept their domain credentials.                   Note #2:
         For Exchange servers in                      untrusted domains
         and other types of email accounts, users might be forced to reenter their password frequently.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "enablerememberpwd"'
            - name: 'enablerememberpwd'
              rule: "should have_property_value('enablerememberpwd', :dword, '0')"

  "2.5.14.7":
    title: '2.5.14.7 | L1 Ensure Do not automatically sign replies is set to Disabled'
    section: 'Security'
    description: |
        This policy setting specifies whether replies will be automatically digitally signed.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Do not automatically sign
        replies
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "nosignonreply"'
            - name: 'nosignonreply'
              rule: "should have_property_value('nosignonreply', :dword, '0')"

  "2.5.14.8":
    title: '2.5.14.8 | L1 Ensure Prevent users from customizing attachment security settings is set to Enabled'
    section: 'Security'
    description: |
        This policy setting prevents users from overriding the set of attachments blocked by Outlook.
        The recommended state for this setting is                Enabled
        .             Note
         Outlook also checks the                Level1Remove
         registry key which could allow the user to save the file to disk when this setting is specified.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Prevent users from
        customizing attachment security settings
         Impact: Users will not be able to customize the attachment security settings and legitimate attachments might be
        blocked.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook'
        - checks:
            - rule: 'should have_property "disallowattachmentcustomization"'
            - name: 'disallowattachmentcustomization'
              rule: "should have_property_value('disallowattachmentcustomization', :dword, '1')"

  "2.5.14.9":
    title: '2.5.14.9 | L1 Ensure Prompt user to choose security settings if default settings fail is set to Disabled'
    section: 'Security'
    description: |
        This policy setting configures whether users are  prompted to choose Outlook security settings if the default settings
        fail to apply.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        :                 User Configuration\Administrative Templates\Microsoft Outlook 2016\Security\Prompt user to choose
        security settings if default settings fail
         Impact: Enabling this setting will prevent a prompt from appearing when the default security settings fail and users
        will not be able to choose security settings.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.5.14.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\outlook\security'
        - checks:
            - rule: 'should have_property "forcedefaultprofile"'
            - name: 'forcedefaultprofile'
              rule: "should have_property_value('forcedefaultprofile', :dword, '0')"

  "2.6.5.2":
    title: '2.6.5.2 | L2 Ensure Disable Slide Update is set to Enabled'
    section: 'Miscellaneous'
    description: |
        This policy setting controls whether users can link slides in a presentation with their counterparts in a PowerPoint
        Slide Library. PowerPoint users can share and reuse slide content by storing individual slide files in a centrally
        located Slide Library on a server running Office SharePoint Server. Using the Slide Update feature, users can associate
        a slide in a presentation on a users computer with the original slide that resides in the Slide Library on the server.
        The recommended state for this setting is                Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled
        :                 User Configuration\Administrative Templates\Microsoft PowerPoint 2016\Miscellaneous\Disable Slide
        Update
         Impact: Enabling this setting prevents PowerPoint from checking Slide Libraries for slide updates.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.6.5.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\slide libraries'
        - checks:
            - rule: 'should have_property "disableslideupdate"'
            - name: 'disableslideupdate'
              rule: "should have_property_value('disableslideupdate', :dword, '1')"

  "2.6.6.5.1":
    title: '2.6.6.5.1 | L1 Ensure Default file format is set to Enabled PowerPoint Presentation pptx'
    section: 'Save'
    description: |
        This policy setting governs the default format for new presentation files that users create.
        The recommended state for this setting is                  Enabled PowerPoint Presentation pptx
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                       Enabled:
        PowerPoint Presentation (*pptx)
        :                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Save\Default file format
         Impact: Enabling this setting does not prevent users from choosing a different file format for a new PowerPoint file,
        therefore it is unlikely to affect usability for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.5.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\options'
        - checks:
            - rule: 'should have_property "defaultformat"'
            - name: 'defaultformat'
              rule: "should have_property_value('defaultformat', :dword, '27')"

  "2.6.6.6.2.1.1":
    title: '2.6.6.6.2.1.1 | L1 Ensure PowerPoint 97-2003 presentations shows templates and add-in files is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save PowerPoint files with PowerPoint 972003
        presentations, shows, templates and addin files.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .                   Note Use Open Policy
         action is defined by the                      Set default file block behavior
         group policy setting which is included in this benchmark.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\File Block Settings\PowerPoint 97-2003 presentations, shows, templates and add-in files
         Impact: Users will not be able to open, save, or view files of the specified format.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\powerpoint\security\fileblock'
        - checks:
            - rule: 'should have_property "binaryfiles"'
            - name: 'binaryfiles'
              rule: "should have_property_value('binaryfiles', :dword, '2')"

  "2.6.6.6.2.1.2":
    title: '2.6.6.6.2.1.2 | L1 Ensure Set default file block behavior to Enabled Blocked files are not opened'
    section: 'File Block Settings'
    description: |
        This policy setting determines if users can open, view, or edit Word files that are by default blocked by Microsoft
        Office.
        The recommended state for this setting is                      Enabled Blocked files are not opened
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Blocked files are not opened
        :                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\File Block Settings\Set Default File Block Behavior
         Impact: Enabling this setting prevents users from opening, viewing, or editing certain types of files in Word.
        Productivity could be affected if users who require access to any of these file types cannot access them.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\powerpoint\security\fileblock'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '0')"

  "2.6.6.6.2.2.1":
    title: '2.6.6.6.2.2.1 | L1 Ensure Do not open files from the Internet zone in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines whether files downloaded from the Internet zone open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Protected View\Do not open files from the Internet zone in Protected View
         Impact: When files open in Protected View, some functionality will be unavailable and productivity in your organization
        could be affected. When this is undesirable, users will have to add sites to their trusted sites list, thus allowing the
        files to be opened in normal view with all functionality available.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\protectedview'
        - checks:
            - rule: 'should have_property "disableinternetfilesinpv"'
            - name: 'disableinternetfilesinpv'
              rule: "should have_property_value('disableinternetfilesinpv', :dword, '0')"

  "2.6.6.6.2.2.2":
    title: '2.6.6.6.2.2.2 | L1 Ensure Do not open files in unsafe locations in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if files located in unsafe locations will open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Protected View\Do not open files in unsafe locations in Protected View
         Impact: Some functionality is not available when files are opened in Protected View. In such cases, users must move the
        files from unsafe locations to save locations in order to access them with full functionality.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\protectedview'
        - checks:
            - rule: 'should have_property "disableunsafelocationsinpv"'
            - name: 'disableunsafelocationsinpv'
              rule: "should have_property_value('disableunsafelocationsinpv', :dword, '0')"

  "2.6.6.6.2.2.3":
    title: '2.6.6.6.2.2.3 | L1 Ensure Set document behavior if file validation fails is set to Enabled Open in Protected View'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Enabled Open in Protected View
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled: Open
        in Protected View
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Protected View\Set Document Behavior if File Validation Fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\filevalidation'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '1')"

  "2.6.6.6.2.2.4":
    title: '2.6.6.6.2.2.4 | L1 Ensure Set document behavior if file validation fails is set to Unchecked Do not allow edit'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Unchecked Do not allow edit
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Unchecked: Do
        not allow edit
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Protected View\Set Document Behavior if File Validation Fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\filevalidation'
        - checks:
            - rule: 'should have_property "disableeditfrompv"'
            - name: 'disableeditfrompv'
              rule: "should have_property_value('disableeditfrompv', :dword, '1')"

  "2.6.6.6.2.2.5":
    title: '2.6.6.6.2.2.5 | L1 Ensure Turn off Protected View for attachments opened from Outlook is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if PowerPoint files in Outlook attachments open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Protected View\Turn off Protected View for attachments opened from Outlook
         Impact: Some functionality is not available when files are opened in Protected View. In such cases, users must move the
        files from unsafe locations to save locations in order to access them with full functionality.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\protectedview'
        - checks:
            - rule: 'should have_property "disableattachmentsinpv"'
            - name: 'disableattachmentsinpv'
              rule: "should have_property_value('disableattachmentsinpv', :dword, '0')"

  "2.6.6.6.2.3.1":
    title: '2.6.6.6.2.3.1 | L1 Ensure Allow Trusted Locations on the network is set to Disabled'
    section: 'Trusted Locations'
    description: |
        This policy setting controls whether trusted locations on the network can be used. Trusted locations specified in the
        Trust Center are used to define file locations that are assumed to be safe by the application opening the file.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Trusted Locations\Allow Trusted Locations on the network
         Impact: Disabling this setting will cause disruption for users who add network locations to the Trusted Locations list.
        These custom locations added by users are ignored but not removed. Trusted locations added in Group Policy that specify
        a network location are also ignored.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\trusted locations'
        - checks:
            - rule: 'should have_property "allownetworklocations"'
            - name: 'allownetworklocations'
              rule: "should have_property_value('allownetworklocations', :dword, '0')"

  "2.6.6.6.2.3.2":
    title: '2.6.6.6.2.3.2 | L2 Ensure Disable all trusted locations is set to Enabled'
    section: 'Trusted Locations'
    description: |
        This policy setting allows administrators to disable all trusted locations in the specified applications.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Trusted Locations\Disable all trusted locations
         Impact: All trusted locations (those specified in the Trust Center) in the specified applications are ignored,
        including any trusted locations established by Office 2016 during setup, deployed to users using Group Policy, or added
        by users themselves. Users will be prompted again when opening files from trusted locations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.6.6.6.2.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\trusted locations'
        - checks:
            - rule: 'should have_property "alllocationsdisabled"'
            - name: 'alllocationsdisabled'
              rule: "should have_property_value('alllocationsdisabled', :dword, '1')"

  "2.6.6.6.2.4":
    title: '2.6.6.6.2.4 | L1 Ensure Block macros from running in Office files from the Internet is set to Enabled'
    section: 'Trust Center'
    description: |
        Windows Attachment Execution Service places a marker in the files alternate data stream to indicate it came from the
        Internet zone. If you enable this policy setting, macros are blocked from running, even if Enable all macros is selected
        in the Macro Settings section of the Trust Center. Users will receive a notification that macros are blocked from
        running. The exceptions when macros will be allowed to run are The Office file is saved to a Trusted Location. The
        Office file was previously trusted by the user. Macros are digitally signed and the matching Trusted Publisher
        certificate is installed on the device.
        The recommended state for this setting is                    Enabled
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Block macros from running in Office files from the Internet
         Impact: As this measure is enforcing the default, there is little or no impact.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "blockcontentexecutionfrominternet"'
            - name: 'blockcontentexecutionfrominternet'
              rule: "should have_property_value('blockcontentexecutionfrominternet', :dword, '1')"

  "2.6.6.6.2.5":
    title: '2.6.6.6.2.5 | L1 Ensure Disable Trust Bar Notification for unsigned application add-ins and block them is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether the specified Office application notifies users when unsigned application addins
        are loaded or silently disable such addins without notification. Note
         For this policy to apply, the                    Require that application addins are signed by Trusted Publisher
         policy setting needs to be enabled. This will prevents users from changing the                    Disable Trust Bar
        Notification for Unsigned Application Addins and Block Them
         policy setting.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Disable Trust Bar Notification for Unsigned Application Add-ins and Block Them
         Impact: If an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-
        ins the application loads will be disabled and the application will display the Trust Bar at the top of the active
        window. The Trust Bar contains a message that informs users about the unsigned add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "notbpromptunsignedaddin"'
            - name: 'notbpromptunsignedaddin'
              rule: "should have_property_value('notbpromptunsignedaddin', :dword, '1')"

  "2.6.6.6.2.6":
    title: '2.6.6.6.2.6 | L1 Ensure Require that application add-ins are signed by Trusted Publisher is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether addins for this application must be digitally signed by a trusted publisher.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Require that application add-ins are aigned by Trusted Publisher
         Impact: This setting could cause disruptions for users who rely on add-ins that are not signed by trusted publishers.
        These users will either have to obtain signed versions of such add-ins or stop using them.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "requireaddinsig"'
            - name: 'requireaddinsig'
              rule: "should have_property_value('requireaddinsig', :dword, '1')"

  "2.6.6.6.2.7":
    title: '2.6.6.6.2.7 | L1 Ensure Trust Access to Visual Basic Project is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether automation clients such as Microsoft Visual Studio 2005 Tools for Microsoft Office
        VSTO can access the Visual Basic for Applications project system in the specified applications. VSTO projects require
        access to the Visual Basic for Applications project system in Excel, PowerPoint, and Word, even though the projects do
        not use Visual Basic for Applications. Designtime support of controls in both Visual Basic and C projects depends on the
        Visual Basic for Applications project system in Word and Excel.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        .                     User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\Trust Access to Visual Basic Project
         Impact: None - this is the default behavior. By default, Excel, Word, and PowerPoint do not allow automation clients to
        have programmatic access to VBA projects. Users can enable this by selecting the Trust access to the VBA project object
        model in the Macro Settings section of the Trust Center. However, doing so allows macros in any documents the user opens
        to access the core Visual Basic objects, methods, and properties, which represents a potential security hazard.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "accessvbom"'
            - name: 'accessvbom'
              rule: "should have_property_value('accessvbom', :dword, '0')"

  "2.6.6.6.2.8":
    title: '2.6.6.6.2.8 | L1 Ensure VBA Macro Notification Settings is set to Enabled Disable all except digitally signed macros'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present.
        The recommended state for this setting is                    Enabled Disable all except digitally signed macros
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Disable
        all except digitally signed macros
        .                     User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\VBA Macro Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                          Enabled
        , which will not allow the user to add to the trusted location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "vbawarnings"'
            - name: 'vbawarnings'
              rule: "should have_property_value('vbawarnings', :dword, '3')"

  "2.6.6.6.2.9":
    title: '2.6.6.6.2.9 | L1 Ensure VBA Macro Notification Settings is set to Require macros to be signed by a trusted publisher'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present. If the Require macros to be signed by a trusted publisher check box is selected, users opening files with
        digitally signed macros but not by a Trusted Publisher will receive a notification that macros are blocked from running.
        The recommended state for this setting is                    Require macros to be signed by a trusted publisher
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to `Require macros to be signed by a
        trusted publisher'. User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Trust Center\VBA Macro Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                          Enabled
        , which will not allow the user to add to the trusted location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.2.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "vbadigsigtrustedpublishers"'
            - name: 'vbadigsigtrustedpublishers'
              rule: "should have_property_value('vbadigsigtrustedpublishers', :dword, '1')"

  "2.6.6.6.3":
    title: '2.6.6.6.3 | L1 Ensure Make hidden markup visible is set to Enabled'
    section: 'Security'
    description: |
        This policy setting controls whether hidden markup is visible when users open PowerPoint files in standard or HTML
        format.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Make hidden markup visible
         Impact: In most cases, markup is intended to be visible to users. Markup does not display in presentation mode in
        PowerPoint, even if it is visible in design mode, so it is likely that this setting will have a minimal impact on
        usability.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\options'
        - checks:
            - rule: 'should have_property "markupopensave"'
            - name: 'markupopensave'
              rule: "should have_property_value('markupopensave', :dword, '1')"

  "2.6.6.6.4":
    title: '2.6.6.6.4 | L1 Ensure Run Programs is set to Enabled disable dont run any programs'
    section: 'Security'
    description: |
        This policy setting controls the prompting and activation behavior for the                  Run Programs
         option for action buttons in PowerPoint.
        By choosing the                  Disable dont run any programs
         option, if users click an action button with the                  Run Programs
         action assigned to it, nothing will happen.
        The recommended state for this setting is                  Enabled Disable dont run any programs
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: disable
        (don't run any programs)
        .                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Run Programs
         Impact: Users who wish to create or use presentations that launch external programs when action buttons are clicked
        will not be able to do so. These users will have to launch any external programs manually at the appropriate times when
        delivering presentations.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "runprograms"'
            - name: 'runprograms'
              rule: "should have_property_value('runprograms', :dword, '0')"

  "2.6.6.6.5":
    title: '2.6.6.6.5 | L1 Ensure Scan encrypted macros in PowerPoint Open XML presentations is set to Enabled Scan encrypted macros'
    section: 'Security'
    description: |
        This policy setting controls whether encrypted macros in Open XML documents are required to be scanned with antivirus
        software before being opened.
        The recommended state for this setting is                  Enabled Scan encrypted macros
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Scan
        encrypted macros
        .                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Scan encrypted macros in PowerPoint Open XML presentations
         Impact: None - this is the default behavior. By default, encrypted macros will be disabled unless they are scanned by
        antivirus software immediately before being loaded.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "powerpointbypassencryptedmacroscan"'
            - name: 'powerpointbypassencryptedmacroscan'
              rule: "should have_property_value('powerpointbypassencryptedmacroscan', :dword, '0')"

  "2.6.6.6.6":
    title: '2.6.6.6.6 | L1 Ensure Turn off file validation is set to Disabled'
    section: 'Security'
    description: |
        This policy setting controls the file validation feature. Office File Validation is a feature that performs security
        checks on files. If Office File Validation detects a problem with a file, the file cannot be opened.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        .                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Turn off file validation
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security\filevalidation'
        - checks:
            - rule: 'should have_property "enableonload"'
            - name: 'enableonload'
              rule: "should have_property_value('enableonload', :dword, '1')"

  "2.6.6.6.7":
    title: '2.6.6.6.7 | L1 Ensure Unblock automatic download of linked images is set to Disabled'
    section: 'Security'
    description: |
        This policy setting determines whether PowerPoint automatically downloads links from external sources.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        :                   User Configuration\Administrative Templates\Microsoft PowerPoint 2016\PowerPoint
        Options\Security\Unblock automatic download of linked images
         Impact: Disabling this setting enforces the default configuration of PowerPoint and is unlikely to cause usability
        issues for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.6.6.6.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\powerpoint\security'
        - checks:
            - rule: 'should have_property "downloadimages"'
            - name: 'downloadimages'
              rule: "should have_property_value('downloadimages', :dword, '0')"

  "2.8.4.1.1":
    title: '2.8.4.1.1 | L1 Ensure Block macros from running in Office files from the internet is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting allows the blocking of macros from running in Office files that come from the internet. By enabling
        this policy setting, macros are blocked from running, even if Enable all macros is selected in the Macro Settings
        section of the Trust Center. Users will receive a notification that macros are blocked from running. The exceptions when
        macros will be allowed to run are The Office file is saved to a Trusted Location. The Office file was previously trusted
        by the user. Macros are digitally signed and the matching Trusted Publisher certificate is installed on the device.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        :                   User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Trust Center\Block
        macros from running in Office files from the internet
         Impact: This enforces the default behavior and should not cause additional impact.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\publisher\security'
        - checks:
            - rule: 'should have_property "blockcontentexecutionfrominternet"'
            - name: 'blockcontentexecutionfrominternet'
              rule: "should have_property_value('blockcontentexecutionfrominternet', :dword, '1')"

  "2.8.4.1.2":
    title: '2.8.4.1.2 | L1 Ensure Disable Trust Bar Notification for unsigned application add-ins and block them is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether the specified Office application notifies users when unsigned application addins
        are loaded or silently disables such addins without notification. Note
         For this policy to apply, the                  Require that application addins are signed by Trusted Publisher
         policy setting needs to be enabled. This will prevent users from changing the                  Disable Trust Bar
        Notification for Unsigned Application Addins and Block Them
         policy setting.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        .                   User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Trust Center\Disable
        Trust Bar Notification for unsigned application add-ins and block them
         Impact: If an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-
        ins the application loads will be disabled and the application will display the Trust Bar at the top of the active
        window. The Trust Bar contains a message that informs users about the unsigned add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\publisher\security'
        - checks:
            - rule: 'should have_property "notbpromptunsignedaddin"'
            - name: 'notbpromptunsignedaddin'
              rule: "should have_property_value('notbpromptunsignedaddin', :dword, '1')"

  "2.8.4.1.3":
    title: '2.8.4.1.3 | L1 Ensure Require that application add-ins are signed by Trusted Publisher to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether addins for the specified Office applications must be digitally signed by a trusted
        publisher.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        .                   User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Trust Center\Require
        that application add-ins are signed by Trusted Publisher
         Impact: This setting could cause disruptions for users who rely on add-ins that are not signed by trusted publishers.
        These users will either have to obtain signed versions of such add-ins or stop using them. Office stores certificates
        for trusted publishers in the trusted publisher store. Earlier versions of Office stored trusted publisher certificate
        information (specifically, the certificate thumbprint) in a special Office trusted publisher store. Office still reads
        trusted publisher certificate information from the Office trusted publisher store but does not write information to this
        store. If a list of trusted publishers in a previous version of Office was created and the Office release is upgraded,
        the trusted publisher list will still be recognized. However, any trusted publisher certificates that were added to the
        list will be stored in the Internet Explorer trusted publisher store.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\publisher\security'
        - checks:
            - rule: 'should have_property "requireaddinsig"'
            - name: 'requireaddinsig'
              rule: "should have_property_value('requireaddinsig', :dword, '1')"

  "2.8.4.1.4":
    title: '2.8.4.1.4 | L1 Ensure VBA Macro Notification Settings is set to Enabled Disable all except digitally signed macros'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present.
        The recommended state for this setting is                  Enabled Disable all except digitally signed macros
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Disable
        all except digitally signed macros
        .                   User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Trust Center\VBA Macro
        Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                        Enabled
        , which will not allow the user to add to the trusted location.                     Warning:
         With the                        Disable all except digitally signed macros
         option selected, users will not be able to open unsigned Access databases.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\publisher\security'
        - checks:
            - rule: 'should have_property "vbawarnings"'
            - name: 'vbawarnings'
              rule: "should have_property_value('vbawarnings', :dword, '3')"

  "2.8.4.1.5":
    title: '2.8.4.1.5 | L1 Ensure VBA Macro Notification Settings is set to Require macros to be signed by a trusted publisher'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present.
        The recommended state for this setting is                  Require macros to be signed by a trusted publisher
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Require macros to
        be signed by a trusted publisher
        .                   User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Trust Center\VBA Macro
        Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                        Enabled
        , which will not allow the user to add to the trusted location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\publisher\security'
        - checks:
            - rule: 'should have_property "vbadigsigtrustedpublishers"'
            - name: 'vbadigsigtrustedpublishers'
              rule: "should have_property_value('vbadigsigtrustedpublishers', :dword, '1')"

  "2.8.4.2":
    title: '2.8.4.2 | L1 Ensure Publisher Automation Security Level is set to Enabled By UI prompted'
    section: 'Security'
    description: |
        This policy setting controls whether macros opened programmatically by another application can run in Publisher and how
        those macros will run.
        The recommended state for this setting is                By UI prompted
        .             Note
         With the above macro functionality configuration selected, macro behavior will be determined by the setting
        VBA Macro Notification Settings
         in the Trust Center.
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Enabled: By UI
        (prompted)
        :                 User Configuration\Administrative Templates\Microsoft Publisher 2016\Security\Publisher Automation
        Security Level
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                      Enabled
        , which will not allow the user to add to the trusted location.                   Warning:
         With the                      Disable all except digitally signed macros
         option selected, users will not be able to open unsigned Access databases.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.8.4.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\common\security'
        - checks:
            - rule: 'should have_property "automationsecuritypublisher"'
            - name: 'automationsecuritypublisher'
              rule: "should have_property_value('automationsecuritypublisher', :dword, '2')"

  "2.11.6.2":
    title: '2.11.6.2 | L2 Ensure Use online translation dictionaries is set to Disabled'
    section: 'Miscellaneous'
    description: |
        This policy setting determines if online dictionaries are used for the translation of text through the Research pane.
        The recommended state for this setting is                Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                    Disabled
        .                 User Configuration\Administrative Templates\Microsoft Word 2016\Miscellaneous\Use online translation
        dictionaries
         Impact: Users will not be able to translate text through the Research pane by using the online dictionaries.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.11.6.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\common\research\translation'
        - checks:
            - rule: 'should have_property "useonline"'
            - name: 'useonline'
              rule: "should have_property_value('useonline', :dword, '0')"

  "2.11.8.1.2":
    title: '2.11.8.1.2 | L1 Ensure Update automatic links at Open  is set to Disabled'
    section: 'Advanced'
    description: |
        This policy setting configures the check/uncheck box in the corresponding UI option for updating automatic links when a
        document is opened.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        .                   User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Advanced\Update
        automatic links at Open
         Impact: Users who work with Word documents that contain external content will not be able to automatically update that
        content.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\options'
        - checks:
            - rule: 'should have_property "dontupdatelinks"'
            - name: 'dontupdatelinks'
              rule: "should have_property_value('dontupdatelinks', :dword, '1')"

  "2.11.8.3.1":
    title: '2.11.8.3.1 | L1 Ensure Hidden text is set to Enabled'
    section: 'Display'
    description: |
        This policy setting controls whether text that is formatted as hidden displays in Microsoft Word.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        .                   User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Display\Hidden text
         Impact: Displaying hidden text can change the way a document flows as well as make it difficult to judge the number of
        pages in a document where Word will insert automatic page breaks.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\options'
        - checks:
            - rule: 'should have_property "showhiddentext"'
            - name: 'showhiddentext'
              rule: "should have_property_value('showhiddentext', :dword, '1')"

  "2.11.8.6.1":
    title: '2.11.8.6.1 | L1 Ensure Default file format  is set to Enabled Word Document .docx'
    section: 'Save'
    description: |
        This policy setting determines the default file format for saving files in Word. Note
         This policy setting is often set in combination with the                  Save As Open XML in Compatibility Mode
         policy setting.
        The recommended state for this setting is                  Enabled Word Document .docx
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled: Word
        Document (.docx)
        .                   User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Save\Default file
        format
         Impact: Enabling this setting does not prevent users from choosing a different file format for a new Word file,
        therefore it is unlikely to affect usability for most users.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.6.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\word\options'
        - checks:
            - rule: 'should have_property "defaultformat"'
            - name: 'defaultformat'
              rule: "should have_property_value('defaultformat', :dword, '^[\S]+$')"

  "2.11.8.7.2.1.1":
    title: '2.11.8.7.2.1.1 | L1 Ensure Set default file block behavior is set to Enabled Blocked files are not opened'
    section: 'File Block Settings'
    description: |
        This policy setting determines if users can open, view, or edit Word files that are by default blocked by Microsoft
        Office.
        The recommended state for this setting is                      Enabled Blocked files are not opened
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Set Default File Block Behavior
         Impact: Enabling this setting prevents users from opening, viewing, or editing certain types of files in Word.
        Productivity could be affected if users who require access to any of these file types cannot access them.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '0')"

  "2.11.8.7.2.1.2":
    title: '2.11.8.7.2.1.2 | L1 Ensure Word 2 and earlier binary documents and templates  is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 2 and earlier binary documents and
        templates.
        By choosing the                      Open/Save blocked, use open policy
        , both the opening and saving of the file type will be blocked. The file will open based on the policy setting
        configured in the                      default file block behavior
         key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 2 and Earlier Binary Documents and Templates
         Impact: Word 2 and earlier binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word2files"'
            - name: 'word2files'
              rule: "should have_property_value('word2files', :dword, '2')"

  "2.11.8.7.2.1.3":
    title: '2.11.8.7.2.1.3 | L1 Ensure Word 2000 binary documents and templates is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 2000 binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
         both the opening and saving of the file type will be blocked. The file will open based on the policy setting configured
        in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 2000 binary documents and templates
         Impact: Word 2000 binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word2000files"'
            - name: 'word2000files'
              rule: "should have_property_value('word2000files', :dword, '2')"

  "2.11.8.7.2.1.4":
    title: '2.11.8.7.2.1.4 | L1 Ensure Word 2003 binary documents and templates is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 2003 binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
         both the opening and saving of the file type will be blocked. The file will open based on the policy setting configured
        in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 2003 binary documents and templates
         Impact: Word 2003 binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word2003files"'
            - name: 'word2003files'
              rule: "should have_property_value('word2003files', :dword, '2')"

  "2.11.8.7.2.1.5":
    title: '2.11.8.7.2.1.5 | L1 Ensure Word 2007 and later binary documents and templates is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 2007 and later binary documents and
        templates.
        By choosing the                      Open/Save blocked, use open policy
         both the opening and saving of the file type will be blocked. The file will open based on the policy setting configured
        in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 2007 and later binary documents and templates
         Impact: Word 2007 and later binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word2007files"'
            - name: 'word2007files'
              rule: "should have_property_value('word2007files', :dword, '2')"

  "2.11.8.7.2.1.6":
    title: '2.11.8.7.2.1.6 | L1 Ensure Word 6.0 binary documents and templates  is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 6.0 binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
        , both the opening and saving of the file type will be blocked. The file will open based on the policy setting
        configured in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 6.0 Binary Documents and Templates
         Impact: Word 6.0 binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word60files"'
            - name: 'word60files'
              rule: "should have_property_value('word60files', :dword, '2')"

  "2.11.8.7.2.1.7":
    title: '2.11.8.7.2.1.7 | L1 Ensure Word 95 binary documents and templates  is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 95 binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
        , both the opening and saving of the file type will be blocked. The file will open based on the policy setting
        configured in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 95 Binary Documents and Templates
         Impact: Word 95 binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word95files"'
            - name: 'word95files'
              rule: "should have_property_value('word95files', :dword, '2')"

  "2.11.8.7.2.1.8":
    title: '2.11.8.7.2.1.8 | L1 Ensure Word 97 binary documents and templates  is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word 97 binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
         both the opening and saving of the file type will be blocked. The file will open based on the policy setting configured
        in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word 97 Binary Documents and Templates
         Impact: Word 97 binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "word97files"'
            - name: 'word97files'
              rule: "should have_property_value('word97files', :dword, '2')"

  "2.11.8.7.2.1.9":
    title: '2.11.8.7.2.1.9 | L1 Ensure Word XP binary documents and templates is set to Enabled OpenSave blocked use open policy'
    section: 'File Block Settings'
    description: |
        This policy setting determines whether users can open, view, edit, or save Word XP binary documents and templates.
        By choosing the                      Open/Save blocked, use open policy
         both the opening and saving of the file type will be blocked. The file will open based on the policy setting configured
        in the default file block behavior key.
        The recommended state for this setting is                      Enabled Open/Save blocked, use open policy
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled:
        Open/Save blocked, use open policy
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\File Block Settings\Word XP binary documents and templates
         Impact: Word XP binary documents and templates will not open in Microsoft Word.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.1.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\fileblock'
        - checks:
            - rule: 'should have_property "wordxpfiles"'
            - name: 'wordxpfiles'
              rule: "should have_property_value('wordxpfiles', :dword, '2')"

  "2.11.8.7.2.2.1":
    title: '2.11.8.7.2.2.1 | L1 Ensure Do not open files from the internet zone in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines whether files downloaded from the Internet zone open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Protected View\Do Not Open Files From The Internet Zone in Protected View
         Impact: When files open in Protected View, some functionality will be unavailable. Users will be unable to edit the
        file.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.2.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\protectedview'
        - checks:
            - rule: 'should have_property "disableinternetfilesinpv"'
            - name: 'disableinternetfilesinpv'
              rule: "should have_property_value('disableinternetfilesinpv', :dword, '0')"

  "2.11.8.7.2.2.2":
    title: '2.11.8.7.2.2.2 | L1 Ensure Do not open files in unsafe locations in Protected View is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if files located in unsafe locations will open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Protected View\Do Not Open Files in Unsafe Locations in Protected View
         Impact: Some functionality is not available when files are opened in Protected View. In such cases, users must move the
        files from unsafe locations to safe locations in order to access them with full functionality.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.2.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\protectedview'
        - checks:
            - rule: 'should have_property "disableunsafelocationsinpv"'
            - name: 'disableunsafelocationsinpv'
              rule: "should have_property_value('disableunsafelocationsinpv', :dword, '0')"

  "2.11.8.7.2.2.3":
    title: '2.11.8.7.2.2.3 | L1 Ensure Set document behavior if file validation fails is set to Enabled Open in Protected View'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Enabled Open in Protected View
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled: Open
        in Protected View
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Protected View\Document Behavior if File Validation Fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.2.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\filevalidation'
        - checks:
            - rule: 'should have_property "openinprotectedview"'
            - name: 'openinprotectedview'
              rule: "should have_property_value('openinprotectedview', :dword, '1')"

  "2.11.8.7.2.2.4":
    title: '2.11.8.7.2.2.4 | L1 Ensure Set document behavior if file validation fails is set to Unchecked Do not allow edit'
    section: 'Protected View'
    description: |
        This policy setting controls how Office handles documents when they fail file validation. Office File Validation is a
        feature that performs security checks on files. If Office File Validation detects a problem with a file, the file cannot
        be opened.
        The recommended state for this setting is                      Unchecked Do not allow edit
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Unchecked: Do
        not allow edit
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Protected View\Document Behavior if File Validation Fails
         Impact: Files that are blocked by the validation fail rule will not open on a user's computer.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\filevalidation'
        - checks:
            - rule: 'should have_property "disableeditfrompv"'
            - name: 'disableeditfrompv'
              rule: "should have_property_value('disableeditfrompv', :dword, '1')"

  "2.11.8.7.2.2.5":
    title: '2.11.8.7.2.2.5 | L1 Ensure Turn off Protected View for attachments opened from Outlook is set to Disabled'
    section: 'Protected View'
    description: |
        This policy setting determines if Word files in Outlook attachments open in Protected View.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Protected View\Turn Off Protected View for Attachments Opened From Outlook
         Impact: Some functionality is not available when files are opened in Protected View. Users will be unable to edit
        documents.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\protectedview'
        - checks:
            - rule: 'should have_property "disableattachmentsinpv"'
            - name: 'disableattachmentsinpv'
              rule: "should have_property_value('disableattachmentsinpv', :dword, '0')"

  "2.11.8.7.2.3.1":
    title: '2.11.8.7.2.3.1 | L1 Ensure Allow Trusted Locations on the network is set to Disabled'
    section: 'Trusted Locations'
    description: |
        This policy setting controls whether trusted locations on the network can be used. Trusted locations specified in the
        Trust Center are used to define file locations that are assumed to be safe by the application opening the file.
        The recommended state for this setting is                      Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Disabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Trusted Locations\Allow Trusted Locations on the Network
         Impact: Disabling this setting will cause disruption for users who add network locations to the Trusted Locations list.
        These custom locations added by users are ignored but not removed. Trusted locations added in Group Policy that specify
        a network location are also ignored.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.3.1', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\trusted locations'
        - checks:
            - rule: 'should have_property "allownetworklocations"'
            - name: 'allownetworklocations'
              rule: "should have_property_value('allownetworklocations', :dword, '0')"

  "2.11.8.7.2.3.2":
    title: '2.11.8.7.2.3.2 | L2 Ensure Disable all trusted locations  is set to Enabled'
    section: 'Trusted Locations'
    description: |
        This policy setting allows administrators to disable all trusted locations in the specified applications.
        The recommended state for this setting is                      Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                          Enabled
        .                       User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Trusted Locations\Disable All Trusted Locations
         Impact: All trusted locations (those specified in the Trust Center) in the specified applications are ignored,
        including any trusted locations established by Office 2016 during setup, deployed to users using Group Policy, or added
        by users themselves. Users will be prompted again when opening files from trusted locations.
    type: Undefined
    impact: '1.0'
    tags: ['level2', 'rule_2.11.8.7.2.3.2', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\trusted locations'
        - checks:
            - rule: 'should have_property "alllocationsdisabled"'
            - name: 'alllocationsdisabled'
              rule: "should have_property_value('alllocationsdisabled', :dword, '1')"

  "2.11.8.7.2.4":
    title: '2.11.8.7.2.4 | L1 Ensure Block macros from running in Office files from the Internet is set to Enabled'
    section: 'Trust Center'
    description: |
        Windows Attachment Execution Service places a marker in the files alternate data stream to indicate it came from the
        Internet zone. If you enable this policy setting, macros are blocked from running, even if Enable all macros is selected
        in the Macro Settings section of the Trust Center. Users will receive a notification that macros are blocked from
        running. The exceptions when macros will be allowed to run are The Office file is saved to a Trusted Location. The
        Office file was previously trusted by the user. Macros are digitally signed and the matching Trusted Publisher
        certificate is installed on the device.
        The recommended state for this setting is                    Enabled
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Block macros from running in Office files from the Internet
         Impact: As this measure is enforcing the default, there is little or no impact.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\software\policies\microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "blockcontentexecutionfrominternet"'
            - name: 'blockcontentexecutionfrominternet'
              rule: "should have_property_value('blockcontentexecutionfrominternet', :dword, '1')"

  "2.11.8.7.2.5":
    title: '2.11.8.7.2.5 | L1 Ensure Disable Trust Bar Notification for unsigned application add-ins and block them is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether the specified Office application notifies users when unsigned application addins
        are loaded or silently disables such addins without notification. Note
         For this policy to apply, the                    Require that application addins are signed by Trusted Publisher
         policy setting needs to be enabled. This will prevent users from changing the                    Disable Trust Bar
        Notification for unsigned application addins and block them
         policy setting.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Disable Trust Bar Notification for unsigned application add-ins and block them
         Impact: If an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-
        ins the application loads will be disabled and the application will display the Trust Bar at the top of the active
        window. The Trust Bar contains a message that informs users about the unsigned add-in.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.5', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "notbpromptunsignedaddin"'
            - name: 'notbpromptunsignedaddin'
              rule: "should have_property_value('notbpromptunsignedaddin', :dword, '1')"

  "2.11.8.7.2.6":
    title: '2.11.8.7.2.6 | L1 Ensure Dynamic Data Exchange is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls the ability to use Dynamic Data Exchange DDE in Word.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Dynamic Data Exchange
         Impact: None - DDE is disabled by default in Word. Enforcing this policy ensures users cannot enter an unsecure state.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.6', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_CURRENT_USER\SOFTWARE\policies\microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should_not have_property "allowdde"'

  "2.11.8.7.2.7":
    title: '2.11.8.7.2.7 | L1 Ensure Require that application add-ins are signed by Trusted Publisher is set to Enabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether addins for the specified Office applications must be digitally signed by a trusted
        publisher.
        The recommended state for this setting is                    Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Require that application add-ins are signed by Trusted Publisher
         Impact: This setting could cause disruptions for users who rely on add-ins that are not signed by trusted publishers.
        These users will either have to obtain signed versions of such add-ins or stop using them. Office stores certificates
        for trusted publishers in the trusted publisher store. Earlier versions of Office stored trusted publisher certificate
        information (specifically, the certificate thumbprint) in a special Office trusted publisher store. Office still reads
        trusted publisher certificate information from the Office trusted publisher store but does not write information to this
        store. If a list of trusted publishers in a previous version of Office was created and the Office release was upgraded,
        the trusted publisher list will still be recognized. However, any trusted publisher certificates that were added to the
        list will be stored in the Internet Explorer trusted publisher store.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.7', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "requireaddinsig"'
            - name: 'requireaddinsig'
              rule: "should have_property_value('requireaddinsig', :dword, '1')"

  "2.11.8.7.2.8":
    title: '2.11.8.7.2.8 | L1 Ensure Scan encrypted macros in Word Open XML Documents to Enabled Scan encrypted macros default'
    section: 'Trust Center'
    description: |
        This policy setting controls whether encrypted macros in Open XML documents are required to be scanned with antivirus
        software before being opened.
        The recommended state for this setting is                    Enabled Scan encrypted macros default
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Scan
        encrypted macros (default)
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Scan encrypted macros in Word Open XML Documents
         Impact: None - this is the default behavior. By default, encrypted macros will be disabled unless they are scanned by
        antivirus software immediately before being loaded.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.8', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "wordbypassencryptedmacroscan"'
            - name: 'wordbypassencryptedmacroscan'
              rule: "should have_property_value('wordbypassencryptedmacroscan', :dword, '0')"

  "2.11.8.7.2.9":
    title: '2.11.8.7.2.9 | L1 Ensure Trust access to Visual Basic Project is set to Disabled'
    section: 'Trust Center'
    description: |
        This policy setting controls whether automation clients such as Microsoft Visual Studio 2005 Tools for Microsoft Office
        VSTO can access the Visual Basic for Applications project system in the specified applications. VSTO projects require
        access to the Visual Basic for Applications project system in Excel, PowerPoint, and Word, even though the projects do
        not use Visual Basic for Applications. Designtime support of controls in both Visual Basic and C projects depends on the
        Visual Basic for Applications project system in Word and Excel.
        The recommended state for this setting is                    Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Disabled
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\Trust access to Visual Basic Project
         Impact: None - this is the default behavior. By default, Excel, Word, and PowerPoint do not allow automation clients to
        have programmatic access to VBA projects. Users can enable this by selecting the Trust access to the VBA project object
        model in the Macro Settings section of the Trust Center. However, doing so allows macros in any documents the user opens
        to access the core Visual Basic objects, methods, and properties, which represents a potential security hazard.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.9', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "accessvbom"'
            - name: 'accessvbom'
              rule: "should have_property_value('accessvbom', :dword, '0')"

  "2.11.8.7.2.10":
    title: '2.11.8.7.2.10 | L1 Ensure VBA Macro Notification Settings is set to Enabled Disable all except digitally signed macros'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present.
        The recommended state for this setting is                    Enabled Disable all except digitally signed macros
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Enabled: Disable
        all except digitally signed macros
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\VBA Macro Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                          Enabled
        , which will not allow the user to add to the trusted location.                       Warning:
         With the                          Disable all except digitally signed macros
         option selected, users will not be able to open unsigned Access databases.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.10', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "vbawarnings"'
            - name: 'vbawarnings'
              rule: "should have_property_value('vbawarnings', :dword, '3')"

  "2.11.8.7.2.11":
    title: '2.11.8.7.2.11 | L1 Ensure VBA Macro Notification Settings is set to Require macros to be signed by a trusted publisher'
    section: 'Trust Center'
    description: |
        This policy setting controls how the specified applications warn users when Visual Basic for Applications VBA macros are
        present.
        The recommended state for this setting is                    Require macros to be signed by a trusted publisher
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                        Require macros to
        be signed by a trusted publisher
        .                     User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Trust
        Center\VBA Macro Notification Settings
         Impact:
        This configuration causes documents and templates that contain unsigned macros to lose all functionality supplied by the
        macro. To prevent this loss of functionality, users can install the macro in a trusted location, unless the
        Disable all trusted locations
         setting is configured to                          Enabled
        , which will not allow the user to add to the trusted location.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.2.11', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security'
        - checks:
            - rule: 'should have_property "vbadigsigtrustedpublishers"'
            - name: 'vbadigsigtrustedpublishers'
              rule: "should have_property_value('vbadigsigtrustedpublishers', :dword, '1')"

  "2.11.8.7.3":
    title: '2.11.8.7.3 | L1 Ensure Make hidden markup visible is set to Enabled'
    section: 'Security'
    description: |
        This policy setting controls whether hidden markup is visible when users open Word documents in standard or HTML format.
        The recommended state for this setting is                  Enabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Enabled
        .                   User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Make hidden
        markup visible
         Impact: In most cases, markup is intended to be visible to users. Markup does not display in presentation mode in Word,
        even if it is visible in design mode, so it is likely that this setting will have a minimal impact on usability.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.3', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\options'
        - checks:
            - rule: 'should have_property "showmarkupopensave"'
            - name: 'showmarkupopensave'
              rule: "should have_property_value('showmarkupopensave', :dword, '1')"

  "2.11.8.7.4":
    title: '2.11.8.7.4 | L1 Ensure Turn off file validation is set to Disabled'
    section: 'Security'
    description: |
        This policy setting allows you turn off the file validation feature. Office Binary Documents 972003 are checked to see
        if they conform against the file format schema before they are opened.
        The recommended state for this setting is                  Disabled
        .
    remediation: |
        To establish the recommended configuration via GP, set the following UI path to                      Disabled
        .                   User Configuration\Administrative Templates\Microsoft Word 2016\Word Options\Security\Turn off file
        validation
         Impact: None - this is the default behavior.
    type: Undefined
    impact: '1.0'
    tags: ['level1', 'rule_2.11.8.7.4', 'cis_microsoft_office_enterprise_benchmark']
    enabled: true
    properties:
      match: all
      rules:
        - path: 'HKEY_USERS\\SOFTWARE\Policies\Microsoft\office\16.0\word\security\filevalidation'
        - checks:
            - rule: 'should have_property "enableonload"'
            - name: 'enableonload'
              rule: "should have_property_value('enableonload', :dword, '1')"
